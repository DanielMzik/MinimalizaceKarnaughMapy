/*! For license information please see main.be341b11.js.LICENSE.txt */
(()=>{var t={43:(t,e,i)=>{"use strict";t.exports=i(202)},153:(t,e,i)=>{"use strict";var n=i(43),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function h(t,e,i){var n,o={},h=null,u=null;for(n in void 0!==i&&(h=""+i),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(u=e.ref),e)r.call(e,n)&&!l.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===o[n]&&(o[n]=e[n]);return{$$typeof:s,type:t,key:h,ref:u,props:o,_owner:a.current}}e.jsx=h,e.jsxs=h},202:(t,e)=>{"use strict";var i=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function y(t,e,i){this.props=t,this.context=e,this.refs=m,this.updater=i||g}function x(){}function v(t,e,i){this.props=t,this.context=e,this.refs=m,this.updater=i||g}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},x.prototype=y.prototype;var b=v.prototype=new x;b.constructor=v,p(b,y.prototype),b.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function M(t,e,n){var s,o={},r=null,a=null;if(null!=e)for(s in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(r=""+e.key),e)k.call(e,s)&&!P.hasOwnProperty(s)&&(o[s]=e[s]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var h=Array(l),u=0;u<l;u++)h[u]=arguments[u+2];o.children=h}if(t&&t.defaultProps)for(s in l=t.defaultProps)void 0===o[s]&&(o[s]=l[s]);return{$$typeof:i,type:t,key:r,ref:a,props:o,_owner:S.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var N=/\/+/g;function T(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function L(t,e,s,o,r){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case i:case n:l=!0}}if(l)return r=r(l=t),t=""===o?"."+T(l,0):o,w(r)?(s="",null!=t&&(s=t.replace(N,"$&/")+"/"),L(r,e,s,"",(function(t){return t}))):null!=r&&(C(r)&&(r=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(r,s+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(N,"$&/")+"/")+t)),e.push(r)),1;if(l=0,o=""===o?".":o+":",w(t))for(var h=0;h<t.length;h++){var u=o+T(a=t[h],h);l+=L(a,e,s,u,r)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),h=0;!(a=t.next()).done;)l+=L(a=a.value,e,s,u=o+T(a,h++),r);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function A(t,e,i){if(null==t)return t;var n=[],s=0;return L(t,n,"","",(function(t){return e.call(i,t,s++)})),n}function D(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var F={current:null},O={transition:null},E={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function R(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:A,forEach:function(t,e,i){A(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=s,e.Profiler=r,e.PureComponent=v,e.StrictMode=o,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E,e.act=R,e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=p({},t.props),o=t.key,r=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(r=e.ref,a=S.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)k.call(e,h)&&!P.hasOwnProperty(h)&&(s[h]=void 0===e[h]&&void 0!==l?l[h]:e[h])}var h=arguments.length-2;if(1===h)s.children=n;else if(1<h){l=Array(h);for(var u=0;u<h;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:i,type:t.type,key:o,ref:r,props:s,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=M,e.createFactory=function(t){var e=M.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:h,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:D}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=O.transition;O.transition={};try{t()}finally{O.transition=e}},e.unstable_act=R,e.useCallback=function(t,e){return F.current.useCallback(t,e)},e.useContext=function(t){return F.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return F.current.useDeferredValue(t)},e.useEffect=function(t,e){return F.current.useEffect(t,e)},e.useId=function(){return F.current.useId()},e.useImperativeHandle=function(t,e,i){return F.current.useImperativeHandle(t,e,i)},e.useInsertionEffect=function(t,e){return F.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return F.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return F.current.useMemo(t,e)},e.useReducer=function(t,e,i){return F.current.useReducer(t,e,i)},e.useRef=function(t){return F.current.useRef(t)},e.useState=function(t){return F.current.useState(t)},e.useSyncExternalStore=function(t,e,i){return F.current.useSyncExternalStore(t,e,i)},e.useTransition=function(){return F.current.useTransition()},e.version="18.3.1"},234:(t,e)=>{"use strict";function i(t,e){var i=t.length;t.push(e);t:for(;0<i;){var n=i-1>>>1,s=t[n];if(!(0<o(s,e)))break t;t[n]=e,t[i]=s,i=n}}function n(t){return 0===t.length?null:t[0]}function s(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var n=0,s=t.length,r=s>>>1;n<r;){var a=2*(n+1)-1,l=t[a],h=a+1,u=t[h];if(0>o(l,i))h<s&&0>o(u,l)?(t[n]=u,t[h]=i,n=h):(t[n]=l,t[a]=i,n=a);else{if(!(h<s&&0>o(u,i)))break t;t[n]=u,t[h]=i,n=h}}}return e}function o(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var r=performance;e.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var h=[],u=[],c=1,d=null,f=3,g=!1,p=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,x="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function b(t){for(var e=n(u);null!==e;){if(null===e.callback)s(u);else{if(!(e.startTime<=t))break;s(u),e.sortIndex=e.expirationTime,i(h,e)}e=n(u)}}function w(t){if(m=!1,b(t),!p)if(null!==n(h))p=!0,O(k);else{var e=n(u);null!==e&&E(w,e.startTime-t)}}function k(t,i){p=!1,m&&(m=!1,x(C),C=-1),g=!0;var o=f;try{for(b(i),d=n(h);null!==d&&(!(d.expirationTime>i)||t&&!L());){var r=d.callback;if("function"===typeof r){d.callback=null,f=d.priorityLevel;var a=r(d.expirationTime<=i);i=e.unstable_now(),"function"===typeof a?d.callback=a:d===n(h)&&s(h),b(i)}else s(h);d=n(h)}if(null!==d)var l=!0;else{var c=n(u);null!==c&&E(w,c.startTime-i),l=!1}return l}finally{d=null,f=o,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,P=!1,M=null,C=-1,N=5,T=-1;function L(){return!(e.unstable_now()-T<N)}function A(){if(null!==M){var t=e.unstable_now();T=t;var i=!0;try{i=M(!0,t)}finally{i?S():(P=!1,M=null)}}else P=!1}if("function"===typeof v)S=function(){v(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,F=D.port2;D.port1.onmessage=A,S=function(){F.postMessage(null)}}else S=function(){y(A,0)};function O(t){M=t,P||(P=!0,S())}function E(t,i){C=y((function(){t(e.unstable_now())}),i)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){p||g||(p=!0,O(k))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(h)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var i=f;f=e;try{return t()}finally{f=i}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=f;f=t;try{return e()}finally{f=i}},e.unstable_scheduleCallback=function(t,s,o){var r=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?r+o:r:o=r,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:c++,callback:s,priorityLevel:t,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>r?(t.sortIndex=o,i(u,t),null===n(h)&&t===n(u)&&(m?(x(C),C=-1):m=!0,E(w,o-r))):(t.sortIndex=a,i(h,t),p||g||(p=!0,O(k))),t},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(t){var e=f;return function(){var i=f;f=e;try{return t.apply(this,arguments)}finally{f=i}}}},579:(t,e,i)=>{"use strict";t.exports=i(153)},613:function(t,e){var i;!function(e,i){"use strict";"object"===typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!==typeof window?window:this,(function(n,s){"use strict";var o=[],r=Object.getPrototypeOf,a=o.slice,l=o.flat?function(t){return o.flat.call(t)}:function(t){return o.concat.apply([],t)},h=o.push,u=o.indexOf,c={},d=c.toString,f=c.hasOwnProperty,g=f.toString,p=g.call(Object),m={},y=function(t){return"function"===typeof t&&"number"!==typeof t.nodeType&&"function"!==typeof t.item},x=function(t){return null!=t&&t===t.window},v=n.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function w(t,e,i){var n,s,o=(i=i||v).createElement("script");if(o.text=t,e)for(n in b)(s=e[n]||e.getAttribute&&e.getAttribute(n))&&o.setAttribute(n,s);i.head.appendChild(o).parentNode.removeChild(o)}function k(t){return null==t?t+"":"object"===typeof t||"function"===typeof t?c[d.call(t)]||"object":typeof t}var S="3.7.1",P=/HTML$/i,M=function(t,e){return new M.fn.init(t,e)};function C(t){var e=!!t&&"length"in t&&t.length,i=k(t);return!y(t)&&!x(t)&&("array"===i||0===e||"number"===typeof e&&e>0&&e-1 in t)}function N(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}M.fn=M.prototype={jquery:S,constructor:M,length:0,toArray:function(){return a.call(this)},get:function(t){return null==t?a.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=M.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return M.each(this,t)},map:function(t){return this.pushStack(M.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(M.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(M.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:o.sort,splice:o.splice},M.extend=M.fn.extend=function(){var t,e,i,n,s,o,r=arguments[0]||{},a=1,l=arguments.length,h=!1;for("boolean"===typeof r&&(h=r,r=arguments[a]||{},a++),"object"===typeof r||y(r)||(r={}),a===l&&(r=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)n=t[e],"__proto__"!==e&&r!==n&&(h&&n&&(M.isPlainObject(n)||(s=Array.isArray(n)))?(i=r[e],o=s&&!Array.isArray(i)?[]:s||M.isPlainObject(i)?i:{},s=!1,r[e]=M.extend(h,o,n)):void 0!==n&&(r[e]=n));return r},M.extend({expando:"jQuery"+(S+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==d.call(t))&&(!(e=r(t))||"function"===typeof(i=f.call(e,"constructor")&&e.constructor)&&g.call(i)===p)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){w(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(C(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},text:function(t){var e,i="",n=0,s=t.nodeType;if(!s)for(;e=t[n++];)i+=M.text(e);return 1===s||11===s?t.textContent:9===s?t.documentElement.textContent:3===s||4===s?t.nodeValue:i},makeArray:function(t,e){var i=e||[];return null!=t&&(C(Object(t))?M.merge(i,"string"===typeof t?[t]:t):h.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:u.call(e,t,i)},isXMLDoc:function(t){var e=t&&t.namespaceURI,i=t&&(t.ownerDocument||t).documentElement;return!P.test(e||i&&i.nodeName||"HTML")},merge:function(t,e){for(var i=+e.length,n=0,s=t.length;n<i;n++)t[s++]=e[n];return t.length=s,t},grep:function(t,e,i){for(var n=[],s=0,o=t.length,r=!i;s<o;s++)!e(t[s],s)!==r&&n.push(t[s]);return n},map:function(t,e,i){var n,s,o=0,r=[];if(C(t))for(n=t.length;o<n;o++)null!=(s=e(t[o],o,i))&&r.push(s);else for(o in t)null!=(s=e(t[o],o,i))&&r.push(s);return l(r)},guid:1,support:m}),"function"===typeof Symbol&&(M.fn[Symbol.iterator]=o[Symbol.iterator]),M.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){c["[object "+e+"]"]=e.toLowerCase()}));var T=o.pop,L=o.sort,A=o.splice,D="[\\x20\\t\\r\\n\\f]",F=new RegExp("^"+D+"+|((?:^|[^\\\\])(?:\\\\.)*)"+D+"+$","g");M.contains=function(t,e){var i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(t.contains?t.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))};var O=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function E(t,e){return e?"\0"===t?"\ufffd":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}M.escapeSelector=function(t){return(t+"").replace(O,E)};var R=v,B=h;!function(){var t,e,i,s,r,l,h,c,d,g,p=B,y=M.expando,x=0,v=0,b=tt(),w=tt(),k=tt(),S=tt(),P=function(t,e){return t===e&&(r=!0),0},C="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="(?:\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",E="\\["+D+"*("+O+")(?:"+D+"*([*^$|!~]?=)"+D+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+O+"))|)"+D+"*\\]",I=":("+O+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+E+")*)|.*)\\)|)",z=new RegExp(D+"+","g"),j=new RegExp("^"+D+"*,"+D+"*"),V=new RegExp("^"+D+"*([>+~]|"+D+")"+D+"*"),U=new RegExp(D+"|>"),X=new RegExp(I),K=new RegExp("^"+O+"$"),G={ID:new RegExp("^#("+O+")"),CLASS:new RegExp("^\\.("+O+")"),TAG:new RegExp("^("+O+"|[*])"),ATTR:new RegExp("^"+E),PSEUDO:new RegExp("^"+I),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+D+"*(even|odd|(([+-]|)(\\d*)n|)"+D+"*(?:([+-]|)"+D+"*(\\d+)|))"+D+"*\\)|)","i"),bool:new RegExp("^(?:"+C+")$","i"),needsContext:new RegExp("^"+D+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+D+"*((?:-\\d)?\\d*)"+D+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,H=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_=/[+~]/,W=new RegExp("\\\\[\\da-fA-F]{1,6}"+D+"?|\\\\([^\\r\\n\\f])","g"),$=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},J=function(){lt()},Z=dt((function(t){return!0===t.disabled&&N(t,"fieldset")}),{dir:"parentNode",next:"legend"});try{p.apply(o=a.call(R.childNodes),R.childNodes),o[R.childNodes.length].nodeType}catch(vt){p={apply:function(t,e){B.apply(t,a.call(e))},call:function(t){B.apply(t,a.call(arguments,1))}}}function Q(t,e,i,n){var s,o,r,a,h,u,f,g=e&&e.ownerDocument,x=e?e.nodeType:9;if(i=i||[],"string"!==typeof t||!t||1!==x&&9!==x&&11!==x)return i;if(!n&&(lt(e),e=e||l,c)){if(11!==x&&(h=H.exec(t)))if(s=h[1]){if(9===x){if(!(r=e.getElementById(s)))return i;if(r.id===s)return p.call(i,r),i}else if(g&&(r=g.getElementById(s))&&Q.contains(e,r)&&r.id===s)return p.call(i,r),i}else{if(h[2])return p.apply(i,e.getElementsByTagName(t)),i;if((s=h[3])&&e.getElementsByClassName)return p.apply(i,e.getElementsByClassName(s)),i}if(!S[t+" "]&&(!d||!d.test(t))){if(f=t,g=e,1===x&&(U.test(t)||V.test(t))){for((g=_.test(t)&&at(e.parentNode)||e)==e&&m.scope||((a=e.getAttribute("id"))?a=M.escapeSelector(a):e.setAttribute("id",a=y)),o=(u=ut(t)).length;o--;)u[o]=(a?"#"+a:":scope")+" "+ct(u[o]);f=u.join(",")}try{return p.apply(i,g.querySelectorAll(f)),i}catch(v){S(t,!0)}finally{a===y&&e.removeAttribute("id")}}}return xt(t.replace(F,"$1"),e,i,n)}function tt(){var t=[];return function i(n,s){return t.push(n+" ")>e.cacheLength&&delete i[t.shift()],i[n+" "]=s}}function et(t){return t[y]=!0,t}function it(t){var e=l.createElement("fieldset");try{return!!t(e)}catch(vt){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function nt(t){return function(e){return N(e,"input")&&e.type===t}}function st(t){return function(e){return(N(e,"input")||N(e,"button"))&&e.type===t}}function ot(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&Z(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function rt(t){return et((function(e){return e=+e,et((function(i,n){for(var s,o=t([],i.length,e),r=o.length;r--;)i[s=o[r]]&&(i[s]=!(n[s]=i[s]))}))}))}function at(t){return t&&"undefined"!==typeof t.getElementsByTagName&&t}function lt(t){var i,n=t?t.ownerDocument||t:R;return n!=l&&9===n.nodeType&&n.documentElement?(h=(l=n).documentElement,c=!M.isXMLDoc(l),g=h.matches||h.webkitMatchesSelector||h.msMatchesSelector,h.msMatchesSelector&&R!=l&&(i=l.defaultView)&&i.top!==i&&i.addEventListener("unload",J),m.getById=it((function(t){return h.appendChild(t).id=M.expando,!l.getElementsByName||!l.getElementsByName(M.expando).length})),m.disconnectedMatch=it((function(t){return g.call(t,"*")})),m.scope=it((function(){return l.querySelectorAll(":scope")})),m.cssHas=it((function(){try{return l.querySelector(":has(*,:jqfake)"),!1}catch(vt){return!0}})),m.getById?(e.filter.ID=function(t){var e=t.replace(W,$);return function(t){return t.getAttribute("id")===e}},e.find.ID=function(t,e){if("undefined"!==typeof e.getElementById&&c){var i=e.getElementById(t);return i?[i]:[]}}):(e.filter.ID=function(t){var e=t.replace(W,$);return function(t){var i="undefined"!==typeof t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},e.find.ID=function(t,e){if("undefined"!==typeof e.getElementById&&c){var i,n,s,o=e.getElementById(t);if(o){if((i=o.getAttributeNode("id"))&&i.value===t)return[o];for(s=e.getElementsByName(t),n=0;o=s[n++];)if((i=o.getAttributeNode("id"))&&i.value===t)return[o]}return[]}}),e.find.TAG=function(t,e){return"undefined"!==typeof e.getElementsByTagName?e.getElementsByTagName(t):e.querySelectorAll(t)},e.find.CLASS=function(t,e){if("undefined"!==typeof e.getElementsByClassName&&c)return e.getElementsByClassName(t)},d=[],it((function(t){var e;h.appendChild(t).innerHTML="<a id='"+y+"' href='' disabled='disabled'></a><select id='"+y+"-\r\\' disabled='disabled'><option selected=''></option></select>",t.querySelectorAll("[selected]").length||d.push("\\["+D+"*(?:value|"+C+")"),t.querySelectorAll("[id~="+y+"-]").length||d.push("~="),t.querySelectorAll("a#"+y+"+*").length||d.push(".#.+[+~]"),t.querySelectorAll(":checked").length||d.push(":checked"),(e=l.createElement("input")).setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),h.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(e=l.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||d.push("\\["+D+"*name"+D+"*="+D+"*(?:''|\"\")")})),m.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),P=function(t,e){if(t===e)return r=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!m.sortDetached&&e.compareDocumentPosition(t)===i?t===l||t.ownerDocument==R&&Q.contains(R,t)?-1:e===l||e.ownerDocument==R&&Q.contains(R,e)?1:s?u.call(s,t)-u.call(s,e):0:4&i?-1:1)},l):l}for(t in Q.matches=function(t,e){return Q(t,null,null,e)},Q.matchesSelector=function(t,e){if(lt(t),c&&!S[e+" "]&&(!d||!d.test(e)))try{var i=g.call(t,e);if(i||m.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(vt){S(e,!0)}return Q(e,l,null,[t]).length>0},Q.contains=function(t,e){return(t.ownerDocument||t)!=l&&lt(t),M.contains(t,e)},Q.attr=function(t,i){(t.ownerDocument||t)!=l&&lt(t);var n=e.attrHandle[i.toLowerCase()],s=n&&f.call(e.attrHandle,i.toLowerCase())?n(t,i,!c):void 0;return void 0!==s?s:t.getAttribute(i)},Q.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},M.uniqueSort=function(t){var e,i=[],n=0,o=0;if(r=!m.sortStable,s=!m.sortStable&&a.call(t,0),L.call(t,P),r){for(;e=t[o++];)e===t[o]&&(n=i.push(o));for(;n--;)A.call(t,i[n],1)}return s=null,t},M.fn.uniqueSort=function(){return this.pushStack(M.uniqueSort(a.apply(this)))},e=M.expr={cacheLength:50,createPseudo:et,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(W,$),t[3]=(t[3]||t[4]||t[5]||"").replace(W,$),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||Q.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&Q.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&X.test(i)&&(e=ut(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(W,$).toLowerCase();return"*"===t?function(){return!0}:function(t){return N(t,e)}},CLASS:function(t){var e=b[t+" "];return e||(e=new RegExp("(^|"+D+")"+t+"("+D+"|$)"))&&b(t,(function(t){return e.test("string"===typeof t.className&&t.className||"undefined"!==typeof t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var s=Q.attr(n,t);return null==s?"!="===e:!e||(s+="","="===e?s===i:"!="===e?s!==i:"^="===e?i&&0===s.indexOf(i):"*="===e?i&&s.indexOf(i)>-1:"$="===e?i&&s.slice(-i.length)===i:"~="===e?(" "+s.replace(z," ")+" ").indexOf(i)>-1:"|="===e&&(s===i||s.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,s){var o="nth"!==t.slice(0,3),r="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,l){var h,u,c,d,f,g=o!==r?"nextSibling":"previousSibling",p=e.parentNode,m=a&&e.nodeName.toLowerCase(),v=!l&&!a,b=!1;if(p){if(o){for(;g;){for(c=e;c=c[g];)if(a?N(c,m):1===c.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[r?p.firstChild:p.lastChild],r&&v){for(b=(d=(h=(u=p[y]||(p[y]={}))[t]||[])[0]===x&&h[1])&&h[2],c=d&&p.childNodes[d];c=++d&&c&&c[g]||(b=d=0)||f.pop();)if(1===c.nodeType&&++b&&c===e){u[t]=[x,d,b];break}}else if(v&&(b=d=(h=(u=e[y]||(e[y]={}))[t]||[])[0]===x&&h[1]),!1===b)for(;(c=++d&&c&&c[g]||(b=d=0)||f.pop())&&(!(a?N(c,m):1===c.nodeType)||!++b||(v&&((u=c[y]||(c[y]={}))[t]=[x,b]),c!==e)););return(b-=s)===n||b%n===0&&b/n>=0}}},PSEUDO:function(t,i){var n,s=e.pseudos[t]||e.setFilters[t.toLowerCase()]||Q.error("unsupported pseudo: "+t);return s[y]?s(i):s.length>1?(n=[t,t,"",i],e.setFilters.hasOwnProperty(t.toLowerCase())?et((function(t,e){for(var n,o=s(t,i),r=o.length;r--;)t[n=u.call(t,o[r])]=!(e[n]=o[r])})):function(t){return s(t,0,n)}):s}},pseudos:{not:et((function(t){var e=[],i=[],n=yt(t.replace(F,"$1"));return n[y]?et((function(t,e,i,s){for(var o,r=n(t,null,s,[]),a=t.length;a--;)(o=r[a])&&(t[a]=!(e[a]=o))})):function(t,s,o){return e[0]=t,n(e,null,o,i),e[0]=null,!i.pop()}})),has:et((function(t){return function(e){return Q(t,e).length>0}})),contains:et((function(t){return t=t.replace(W,$),function(e){return(e.textContent||M.text(e)).indexOf(t)>-1}})),lang:et((function(t){return K.test(t||"")||Q.error("unsupported lang: "+t),t=t.replace(W,$).toLowerCase(),function(e){var i;do{if(i=c?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(t){var e=n.location&&n.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===h},focus:function(t){return t===function(){try{return l.activeElement}catch(t){}}()&&l.hasFocus()&&!!(t.type||t.href||~t.tabIndex)},enabled:ot(!1),disabled:ot(!0),checked:function(t){return N(t,"input")&&!!t.checked||N(t,"option")&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!e.pseudos.empty(t)},header:function(t){return q.test(t.nodeName)},input:function(t){return Y.test(t.nodeName)},button:function(t){return N(t,"input")&&"button"===t.type||N(t,"button")},text:function(t){var e;return N(t,"input")&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:rt((function(){return[0]})),last:rt((function(t,e){return[e-1]})),eq:rt((function(t,e,i){return[i<0?i+e:i]})),even:rt((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:rt((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:rt((function(t,e,i){var n;for(n=i<0?i+e:i>e?e:i;--n>=0;)t.push(n);return t})),gt:rt((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}},e.pseudos.nth=e.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})e.pseudos[t]=nt(t);for(t in{submit:!0,reset:!0})e.pseudos[t]=st(t);function ht(){}function ut(t,i){var n,s,o,r,a,l,h,u=w[t+" "];if(u)return i?0:u.slice(0);for(a=t,l=[],h=e.preFilter;a;){for(r in n&&!(s=j.exec(a))||(s&&(a=a.slice(s[0].length)||a),l.push(o=[])),n=!1,(s=V.exec(a))&&(n=s.shift(),o.push({value:n,type:s[0].replace(F," ")}),a=a.slice(n.length)),e.filter)!(s=G[r].exec(a))||h[r]&&!(s=h[r](s))||(n=s.shift(),o.push({value:n,type:r,matches:s}),a=a.slice(n.length));if(!n)break}return i?a.length:a?Q.error(t):w(t,l).slice(0)}function ct(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function dt(t,e,i){var n=e.dir,s=e.next,o=s||n,r=i&&"parentNode"===o,a=v++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,s);return!1}:function(e,i,l){var h,u,c=[x,a];if(l){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||r)if(u=e[y]||(e[y]={}),s&&N(e,s))e=e[n]||e;else{if((h=u[o])&&h[0]===x&&h[1]===a)return c[2]=h[2];if(u[o]=c,c[2]=t(e,i,l))return!0}return!1}}function ft(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function gt(t,e,i,n,s){for(var o,r=[],a=0,l=t.length,h=null!=e;a<l;a++)(o=t[a])&&(i&&!i(o,n,s)||(r.push(o),h&&e.push(a)));return r}function pt(t,e,i,n,s,o){return n&&!n[y]&&(n=pt(n)),s&&!s[y]&&(s=pt(s,o)),et((function(o,r,a,l){var h,c,d,f,g=[],m=[],y=r.length,x=o||function(t,e,i){for(var n=0,s=e.length;n<s;n++)Q(t,e[n],i);return i}(e||"*",a.nodeType?[a]:a,[]),v=!t||!o&&e?x:gt(x,g,t,a,l);if(i?i(v,f=s||(o?t:y||n)?[]:r,a,l):f=v,n)for(h=gt(f,m),n(h,[],a,l),c=h.length;c--;)(d=h[c])&&(f[m[c]]=!(v[m[c]]=d));if(o){if(s||t){if(s){for(h=[],c=f.length;c--;)(d=f[c])&&h.push(v[c]=d);s(null,f=[],h,l)}for(c=f.length;c--;)(d=f[c])&&(h=s?u.call(o,d):g[c])>-1&&(o[h]=!(r[h]=d))}}else f=gt(f===r?f.splice(y,f.length):f),s?s(null,r,f,l):p.apply(r,f)}))}function mt(t){for(var n,s,o,r=t.length,a=e.relative[t[0].type],l=a||e.relative[" "],h=a?1:0,c=dt((function(t){return t===n}),l,!0),d=dt((function(t){return u.call(n,t)>-1}),l,!0),f=[function(t,e,s){var o=!a&&(s||e!=i)||((n=e).nodeType?c(t,e,s):d(t,e,s));return n=null,o}];h<r;h++)if(s=e.relative[t[h].type])f=[dt(ft(f),s)];else{if((s=e.filter[t[h].type].apply(null,t[h].matches))[y]){for(o=++h;o<r&&!e.relative[t[o].type];o++);return pt(h>1&&ft(f),h>1&&ct(t.slice(0,h-1).concat({value:" "===t[h-2].type?"*":""})).replace(F,"$1"),s,h<o&&mt(t.slice(h,o)),o<r&&mt(t=t.slice(o)),o<r&&ct(t))}f.push(s)}return ft(f)}function yt(t,n){var s,o=[],r=[],a=k[t+" "];if(!a){for(n||(n=ut(t)),s=n.length;s--;)(a=mt(n[s]))[y]?o.push(a):r.push(a);a=k(t,function(t,n){var s=n.length>0,o=t.length>0,r=function(r,a,h,u,d){var f,g,m,y=0,v="0",b=r&&[],w=[],k=i,S=r||o&&e.find.TAG("*",d),P=x+=null==k?1:Math.random()||.1,C=S.length;for(d&&(i=a==l||a||d);v!==C&&null!=(f=S[v]);v++){if(o&&f){for(g=0,a||f.ownerDocument==l||(lt(f),h=!c);m=t[g++];)if(m(f,a||l,h)){p.call(u,f);break}d&&(x=P)}s&&((f=!m&&f)&&y--,r&&b.push(f))}if(y+=v,s&&v!==y){for(g=0;m=n[g++];)m(b,w,a,h);if(r){if(y>0)for(;v--;)b[v]||w[v]||(w[v]=T.call(u));w=gt(w)}p.apply(u,w),d&&!r&&w.length>0&&y+n.length>1&&M.uniqueSort(u)}return d&&(x=P,i=k),b};return s?et(r):r}(r,o)),a.selector=t}return a}function xt(t,i,n,s){var o,r,a,l,h,u="function"===typeof t&&t,d=!s&&ut(t=u.selector||t);if(n=n||[],1===d.length){if((r=d[0]=d[0].slice(0)).length>2&&"ID"===(a=r[0]).type&&9===i.nodeType&&c&&e.relative[r[1].type]){if(!(i=(e.find.ID(a.matches[0].replace(W,$),i)||[])[0]))return n;u&&(i=i.parentNode),t=t.slice(r.shift().value.length)}for(o=G.needsContext.test(t)?0:r.length;o--&&(a=r[o],!e.relative[l=a.type]);)if((h=e.find[l])&&(s=h(a.matches[0].replace(W,$),_.test(r[0].type)&&at(i.parentNode)||i))){if(r.splice(o,1),!(t=s.length&&ct(r)))return p.apply(n,s),n;break}}return(u||yt(t,d))(s,i,!c,n,!i||_.test(t)&&at(i.parentNode)||i),n}ht.prototype=e.filters=e.pseudos,e.setFilters=new ht,m.sortStable=y.split("").sort(P).join("")===y,lt(),m.sortDetached=it((function(t){return 1&t.compareDocumentPosition(l.createElement("fieldset"))})),M.find=Q,M.expr[":"]=M.expr.pseudos,M.unique=M.uniqueSort,Q.compile=yt,Q.select=xt,Q.setDocument=lt,Q.tokenize=ut,Q.escape=M.escapeSelector,Q.getText=M.text,Q.isXML=M.isXMLDoc,Q.selectors=M.expr,Q.support=M.support,Q.uniqueSort=M.uniqueSort}();var I=function(t,e,i){for(var n=[],s=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(s&&M(t).is(i))break;n.push(t)}return n},z=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},j=M.expr.match.needsContext,V=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function U(t,e,i){return y(e)?M.grep(t,(function(t,n){return!!e.call(t,n,t)!==i})):e.nodeType?M.grep(t,(function(t){return t===e!==i})):"string"!==typeof e?M.grep(t,(function(t){return u.call(e,t)>-1!==i})):M.filter(e,t,i)}M.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?M.find.matchesSelector(n,t)?[n]:[]:M.find.matches(t,M.grep(e,(function(t){return 1===t.nodeType})))},M.fn.extend({find:function(t){var e,i,n=this.length,s=this;if("string"!==typeof t)return this.pushStack(M(t).filter((function(){for(e=0;e<n;e++)if(M.contains(s[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)M.find(t,s[e],i);return n>1?M.uniqueSort(i):i},filter:function(t){return this.pushStack(U(this,t||[],!1))},not:function(t){return this.pushStack(U(this,t||[],!0))},is:function(t){return!!U(this,"string"===typeof t&&j.test(t)?M(t):t||[],!1).length}});var X,K=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(M.fn.init=function(t,e,i){var n,s;if(!t)return this;if(i=i||X,"string"===typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:K.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof M?e[0]:e,M.merge(this,M.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:v,!0)),V.test(n[1])&&M.isPlainObject(e))for(n in e)y(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(s=v.getElementById(n[2]))&&(this[0]=s,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==i.ready?i.ready(t):t(M):M.makeArray(t,this)}).prototype=M.fn,X=M(v);var G=/^(?:parents|prev(?:Until|All))/,Y={children:!0,contents:!0,next:!0,prev:!0};function q(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}M.fn.extend({has:function(t){var e=M(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(M.contains(this,e[t]))return!0}))},closest:function(t,e){var i,n=0,s=this.length,o=[],r="string"!==typeof t&&M(t);if(!j.test(t))for(;n<s;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&M.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?M.uniqueSort(o):o)},index:function(t){return t?"string"===typeof t?u.call(M(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(M.uniqueSort(M.merge(this.get(),M(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),M.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return I(t,"parentNode")},parentsUntil:function(t,e,i){return I(t,"parentNode",i)},next:function(t){return q(t,"nextSibling")},prev:function(t){return q(t,"previousSibling")},nextAll:function(t){return I(t,"nextSibling")},prevAll:function(t){return I(t,"previousSibling")},nextUntil:function(t,e,i){return I(t,"nextSibling",i)},prevUntil:function(t,e,i){return I(t,"previousSibling",i)},siblings:function(t){return z((t.parentNode||{}).firstChild,t)},children:function(t){return z(t.firstChild)},contents:function(t){return null!=t.contentDocument&&r(t.contentDocument)?t.contentDocument:(N(t,"template")&&(t=t.content||t),M.merge([],t.childNodes))}},(function(t,e){M.fn[t]=function(i,n){var s=M.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"===typeof n&&(s=M.filter(n,s)),this.length>1&&(Y[t]||M.uniqueSort(s),G.test(t)&&s.reverse()),this.pushStack(s)}}));var H=/[^\x20\t\r\n\f]+/g;function _(t){return t}function W(t){throw t}function $(t,e,i,n){var s;try{t&&y(s=t.promise)?s.call(t).done(e).fail(i):t&&y(s=t.then)?s.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}M.Callbacks=function(t){t="string"===typeof t?function(t){var e={};return M.each(t.match(H)||[],(function(t,i){e[i]=!0})),e}(t):M.extend({},t);var e,i,n,s,o=[],r=[],a=-1,l=function(){for(s=s||t.once,n=e=!0;r.length;a=-1)for(i=r.shift();++a<o.length;)!1===o[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=o.length,i=!1);t.memory||(i=!1),e=!1,s&&(o=i?[]:"")},h={add:function(){return o&&(i&&!e&&(a=o.length-1,r.push(i)),function e(i){M.each(i,(function(i,n){y(n)?t.unique&&h.has(n)||o.push(n):n&&n.length&&"string"!==k(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove:function(){return M.each(arguments,(function(t,e){for(var i;(i=M.inArray(e,o,i))>-1;)o.splice(i,1),i<=a&&a--})),this},has:function(t){return t?M.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return s=r=[],o=i="",this},disabled:function(){return!o},lock:function(){return s=r=[],i||e||(o=i=""),this},locked:function(){return!!s},fireWith:function(t,i){return s||(i=[t,(i=i||[]).slice?i.slice():i],r.push(i),e||l()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},M.extend({Deferred:function(t){var e=[["notify","progress",M.Callbacks("memory"),M.Callbacks("memory"),2],["resolve","done",M.Callbacks("once memory"),M.Callbacks("once memory"),0,"resolved"],["reject","fail",M.Callbacks("once memory"),M.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return s.then(null,t)},pipe:function(){var t=arguments;return M.Deferred((function(i){M.each(e,(function(e,n){var s=y(t[n[4]])&&t[n[4]];o[n[1]]((function(){var t=s&&s.apply(this,arguments);t&&y(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[n[0]+"With"](this,s?[t]:arguments)}))})),t=null})).promise()},then:function(t,i,s){var o=0;function r(t,e,i,s){return function(){var a=this,l=arguments,h=function(){var n,h;if(!(t<o)){if((n=i.apply(a,l))===e.promise())throw new TypeError("Thenable self-resolution");h=n&&("object"===typeof n||"function"===typeof n)&&n.then,y(h)?s?h.call(n,r(o,e,_,s),r(o,e,W,s)):(o++,h.call(n,r(o,e,_,s),r(o,e,W,s),r(o,e,_,e.notifyWith))):(i!==_&&(a=void 0,l=[n]),(s||e.resolveWith)(a,l))}},u=s?h:function(){try{h()}catch(n){M.Deferred.exceptionHook&&M.Deferred.exceptionHook(n,u.error),t+1>=o&&(i!==W&&(a=void 0,l=[n]),e.rejectWith(a,l))}};t?u():(M.Deferred.getErrorHook?u.error=M.Deferred.getErrorHook():M.Deferred.getStackHook&&(u.error=M.Deferred.getStackHook()),n.setTimeout(u))}}return M.Deferred((function(n){e[0][3].add(r(0,n,y(s)?s:_,n.notifyWith)),e[1][3].add(r(0,n,y(t)?t:_)),e[2][3].add(r(0,n,y(i)?i:W))})).promise()},promise:function(t){return null!=t?M.extend(t,s):s}},o={};return M.each(e,(function(t,n){var r=n[2],a=n[5];s[n[1]]=r.add,a&&r.add((function(){i=a}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),r.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=r.fireWith})),s.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,i=e,n=Array(i),s=a.call(arguments),o=M.Deferred(),r=function(t){return function(i){n[t]=this,s[t]=arguments.length>1?a.call(arguments):i,--e||o.resolveWith(n,s)}};if(e<=1&&($(t,o.done(r(i)).resolve,o.reject,!e),"pending"===o.state()||y(s[i]&&s[i].then)))return o.then();for(;i--;)$(s[i],r(i),o.reject);return o.promise()}});var J=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;M.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&J.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},M.readyException=function(t){n.setTimeout((function(){throw t}))};var Z=M.Deferred();function Q(){v.removeEventListener("DOMContentLoaded",Q),n.removeEventListener("load",Q),M.ready()}M.fn.ready=function(t){return Z.then(t).catch((function(t){M.readyException(t)})),this},M.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--M.readyWait:M.isReady)||(M.isReady=!0,!0!==t&&--M.readyWait>0||Z.resolveWith(v,[M]))}}),M.ready.then=Z.then,"complete"===v.readyState||"loading"!==v.readyState&&!v.documentElement.doScroll?n.setTimeout(M.ready):(v.addEventListener("DOMContentLoaded",Q),n.addEventListener("load",Q));var tt=function(t,e,i,n,s,o,r){var a=0,l=t.length,h=null==i;if("object"===k(i))for(a in s=!0,i)tt(t,e,a,i[a],!0,o,r);else if(void 0!==n&&(s=!0,y(n)||(r=!0),h&&(r?(e.call(t,n),e=null):(h=e,e=function(t,e,i){return h.call(M(t),i)})),e))for(;a<l;a++)e(t[a],i,r?n:n.call(t[a],a,e(t[a],i)));return s?t:h?e.call(t):l?e(t[0],i):o},et=/^-ms-/,it=/-([a-z])/g;function nt(t,e){return e.toUpperCase()}function st(t){return t.replace(et,"ms-").replace(it,nt)}var ot=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function rt(){this.expando=M.expando+rt.uid++}rt.uid=1,rt.prototype={cache:function(t){var e=t[this.expando];return e||(e={},ot(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,s=this.cache(t);if("string"===typeof e)s[st(e)]=i;else for(n in e)s[st(n)]=e[n];return s},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][st(e)]},access:function(t,e,i){return void 0===e||e&&"string"===typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(st):(e=st(e))in n?[e]:e.match(H)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||M.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!M.isEmptyObject(e)}};var at=new rt,lt=new rt,ht=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ut=/[A-Z]/g;function ct(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(ut,"-$&").toLowerCase(),"string"===typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:ht.test(t)?JSON.parse(t):t)}(i)}catch(s){}lt.set(t,e,i)}else i=void 0;return i}M.extend({hasData:function(t){return lt.hasData(t)||at.hasData(t)},data:function(t,e,i){return lt.access(t,e,i)},removeData:function(t,e){lt.remove(t,e)},_data:function(t,e,i){return at.access(t,e,i)},_removeData:function(t,e){at.remove(t,e)}}),M.fn.extend({data:function(t,e){var i,n,s,o=this[0],r=o&&o.attributes;if(void 0===t){if(this.length&&(s=lt.get(o),1===o.nodeType&&!at.get(o,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&0===(n=r[i].name).indexOf("data-")&&(n=st(n.slice(5)),ct(o,n,s[n]));at.set(o,"hasDataAttrs",!0)}return s}return"object"===typeof t?this.each((function(){lt.set(this,t)})):tt(this,(function(e){var i;if(o&&void 0===e)return void 0!==(i=lt.get(o,t))||void 0!==(i=ct(o,t))?i:void 0;this.each((function(){lt.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){lt.remove(this,t)}))}}),M.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=at.get(t,e),i&&(!n||Array.isArray(i)?n=at.access(t,e,M.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=M.queue(t,e),n=i.length,s=i.shift(),o=M._queueHooks(t,e);"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete o.stop,s.call(t,(function(){M.dequeue(t,e)}),o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return at.get(t,i)||at.access(t,i,{empty:M.Callbacks("once memory").add((function(){at.remove(t,[e+"queue",i])}))})}}),M.fn.extend({queue:function(t,e){var i=2;return"string"!==typeof t&&(e=t,t="fx",i--),arguments.length<i?M.queue(this[0],t):void 0===e?this:this.each((function(){var i=M.queue(this,t,e);M._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&M.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){M.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,s=M.Deferred(),o=this,r=this.length,a=function(){--n||s.resolveWith(o,[o])};for("string"!==typeof t&&(e=t,t=void 0),t=t||"fx";r--;)(i=at.get(o[r],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),s.promise(e)}});var dt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ft=new RegExp("^(?:([+-])=|)("+dt+")([a-z%]*)$","i"),gt=["Top","Right","Bottom","Left"],pt=v.documentElement,mt=function(t){return M.contains(t.ownerDocument,t)},yt={composed:!0};pt.getRootNode&&(mt=function(t){return M.contains(t.ownerDocument,t)||t.getRootNode(yt)===t.ownerDocument});var xt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&mt(t)&&"none"===M.css(t,"display")};function vt(t,e,i,n){var s,o,r=20,a=n?function(){return n.cur()}:function(){return M.css(t,e,"")},l=a(),h=i&&i[3]||(M.cssNumber[e]?"":"px"),u=t.nodeType&&(M.cssNumber[e]||"px"!==h&&+l)&&ft.exec(M.css(t,e));if(u&&u[3]!==h){for(l/=2,h=h||u[3],u=+l||1;r--;)M.style(t,e,u+h),(1-o)*(1-(o=a()/l||.5))<=0&&(r=0),u/=o;u*=2,M.style(t,e,u+h),i=i||[]}return i&&(u=+u||+l||0,s=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=h,n.start=u,n.end=s)),s}var bt={};function wt(t){var e,i=t.ownerDocument,n=t.nodeName,s=bt[n];return s||(e=i.body.appendChild(i.createElement(n)),s=M.css(e,"display"),e.parentNode.removeChild(e),"none"===s&&(s="block"),bt[n]=s,s)}function kt(t,e){for(var i,n,s=[],o=0,r=t.length;o<r;o++)(n=t[o]).style&&(i=n.style.display,e?("none"===i&&(s[o]=at.get(n,"display")||null,s[o]||(n.style.display="")),""===n.style.display&&xt(n)&&(s[o]=wt(n))):"none"!==i&&(s[o]="none",at.set(n,"display",i)));for(o=0;o<r;o++)null!=s[o]&&(t[o].style.display=s[o]);return t}M.fn.extend({show:function(){return kt(this,!0)},hide:function(){return kt(this)},toggle:function(t){return"boolean"===typeof t?t?this.show():this.hide():this.each((function(){xt(this)?M(this).show():M(this).hide()}))}});var St=/^(?:checkbox|radio)$/i,Pt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Mt=/^$|^module$|\/(?:java|ecma)script/i;!function(){var t=v.createDocumentFragment().appendChild(v.createElement("div")),e=v.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),m.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,t.innerHTML="<option></option>",m.option=!!t.lastChild}();var Ct={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Nt(t,e){var i;return i="undefined"!==typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!==typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&N(t,e)?M.merge([t],i):i}function Tt(t,e){for(var i=0,n=t.length;i<n;i++)at.set(t[i],"globalEval",!e||at.get(e[i],"globalEval"))}Ct.tbody=Ct.tfoot=Ct.colgroup=Ct.caption=Ct.thead,Ct.th=Ct.td,m.option||(Ct.optgroup=Ct.option=[1,"<select multiple='multiple'>","</select>"]);var Lt=/<|&#?\w+;/;function At(t,e,i,n,s){for(var o,r,a,l,h,u,c=e.createDocumentFragment(),d=[],f=0,g=t.length;f<g;f++)if((o=t[f])||0===o)if("object"===k(o))M.merge(d,o.nodeType?[o]:o);else if(Lt.test(o)){for(r=r||c.appendChild(e.createElement("div")),a=(Pt.exec(o)||["",""])[1].toLowerCase(),l=Ct[a]||Ct._default,r.innerHTML=l[1]+M.htmlPrefilter(o)+l[2],u=l[0];u--;)r=r.lastChild;M.merge(d,r.childNodes),(r=c.firstChild).textContent=""}else d.push(e.createTextNode(o));for(c.textContent="",f=0;o=d[f++];)if(n&&M.inArray(o,n)>-1)s&&s.push(o);else if(h=mt(o),r=Nt(c.appendChild(o),"script"),h&&Tt(r),i)for(u=0;o=r[u++];)Mt.test(o.type||"")&&i.push(o);return c}var Dt=/^([^.]*)(?:\.(.+)|)/;function Ft(){return!0}function Ot(){return!1}function Et(t,e,i,n,s,o){var r,a;if("object"===typeof e){for(a in"string"!==typeof i&&(n=n||i,i=void 0),e)Et(t,a,i,n,e[a],o);return t}if(null==n&&null==s?(s=i,n=i=void 0):null==s&&("string"===typeof i?(s=n,n=void 0):(s=n,n=i,i=void 0)),!1===s)s=Ot;else if(!s)return t;return 1===o&&(r=s,s=function(t){return M().off(t),r.apply(this,arguments)},s.guid=r.guid||(r.guid=M.guid++)),t.each((function(){M.event.add(this,e,s,n,i)}))}function Rt(t,e,i){i?(at.set(t,e,!1),M.event.add(t,e,{namespace:!1,handler:function(t){var i,n=at.get(this,e);if(1&t.isTrigger&&this[e]){if(n)(M.event.special[e]||{}).delegateType&&t.stopPropagation();else if(n=a.call(arguments),at.set(this,e,n),this[e](),i=at.get(this,e),at.set(this,e,!1),n!==i)return t.stopImmediatePropagation(),t.preventDefault(),i}else n&&(at.set(this,e,M.event.trigger(n[0],n.slice(1),this)),t.stopPropagation(),t.isImmediatePropagationStopped=Ft)}})):void 0===at.get(t,e)&&M.event.add(t,e,Ft)}M.event={global:{},add:function(t,e,i,n,s){var o,r,a,l,h,u,c,d,f,g,p,m=at.get(t);if(ot(t))for(i.handler&&(i=(o=i).handler,s=o.selector),s&&M.find.matchesSelector(pt,s),i.guid||(i.guid=M.guid++),(l=m.events)||(l=m.events=Object.create(null)),(r=m.handle)||(r=m.handle=function(e){return"undefined"!==typeof M&&M.event.triggered!==e.type?M.event.dispatch.apply(t,arguments):void 0}),h=(e=(e||"").match(H)||[""]).length;h--;)f=p=(a=Dt.exec(e[h])||[])[1],g=(a[2]||"").split(".").sort(),f&&(c=M.event.special[f]||{},f=(s?c.delegateType:c.bindType)||f,c=M.event.special[f]||{},u=M.extend({type:f,origType:p,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&M.expr.match.needsContext.test(s),namespace:g.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,n,g,r)||t.addEventListener&&t.addEventListener(f,r)),c.add&&(c.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),s?d.splice(d.delegateCount++,0,u):d.push(u),M.event.global[f]=!0)},remove:function(t,e,i,n,s){var o,r,a,l,h,u,c,d,f,g,p,m=at.hasData(t)&&at.get(t);if(m&&(l=m.events)){for(h=(e=(e||"").match(H)||[""]).length;h--;)if(f=p=(a=Dt.exec(e[h])||[])[1],g=(a[2]||"").split(".").sort(),f){for(c=M.event.special[f]||{},d=l[f=(n?c.delegateType:c.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=o=d.length;o--;)u=d[o],!s&&p!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,c.remove&&c.remove.call(t,u));r&&!d.length&&(c.teardown&&!1!==c.teardown.call(t,g,m.handle)||M.removeEvent(t,f,m.handle),delete l[f])}else for(f in l)M.event.remove(t,f+e[h],i,n,!0);M.isEmptyObject(l)&&at.remove(t,"handle events")}},dispatch:function(t){var e,i,n,s,o,r,a=new Array(arguments.length),l=M.event.fix(t),h=(at.get(this,"events")||Object.create(null))[l.type]||[],u=M.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(r=M.event.handlers.call(this,l,h),e=0;(s=r[e++])&&!l.isPropagationStopped();)for(l.currentTarget=s.elem,i=0;(o=s.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(n=((M.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,a))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,n,s,o,r,a=[],l=e.delegateCount,h=t.target;if(l&&h.nodeType&&!("click"===t.type&&t.button>=1))for(;h!==this;h=h.parentNode||this)if(1===h.nodeType&&("click"!==t.type||!0!==h.disabled)){for(o=[],r={},i=0;i<l;i++)void 0===r[s=(n=e[i]).selector+" "]&&(r[s]=n.needsContext?M(s,this).index(h)>-1:M.find(s,this,null,[h]).length),r[s]&&o.push(n);o.length&&a.push({elem:h,handlers:o})}return h=this,l<e.length&&a.push({elem:h,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(M.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[M.expando]?t:new M.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return St.test(e.type)&&e.click&&N(e,"input")&&Rt(e,"click",!0),!1},trigger:function(t){var e=this||t;return St.test(e.type)&&e.click&&N(e,"input")&&Rt(e,"click"),!0},_default:function(t){var e=t.target;return St.test(e.type)&&e.click&&N(e,"input")&&at.get(e,"click")||N(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},M.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},M.Event=function(t,e){if(!(this instanceof M.Event))return new M.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Ft:Ot,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&M.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[M.expando]=!0},M.Event.prototype={constructor:M.Event,isDefaultPrevented:Ot,isPropagationStopped:Ot,isImmediatePropagationStopped:Ot,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Ft,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Ft,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Ft,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},M.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},M.event.addProp),M.each({focus:"focusin",blur:"focusout"},(function(t,e){function i(t){if(v.documentMode){var i=at.get(this,"handle"),n=M.event.fix(t);n.type="focusin"===t.type?"focus":"blur",n.isSimulated=!0,i(t),n.target===n.currentTarget&&i(n)}else M.event.simulate(e,t.target,M.event.fix(t))}M.event.special[t]={setup:function(){var n;if(Rt(this,t,!0),!v.documentMode)return!1;(n=at.get(this,e))||this.addEventListener(e,i),at.set(this,e,(n||0)+1)},trigger:function(){return Rt(this,t),!0},teardown:function(){var t;if(!v.documentMode)return!1;(t=at.get(this,e)-1)?at.set(this,e,t):(this.removeEventListener(e,i),at.remove(this,e))},_default:function(e){return at.get(e.target,t)},delegateType:e},M.event.special[e]={setup:function(){var n=this.ownerDocument||this.document||this,s=v.documentMode?this:n,o=at.get(s,e);o||(v.documentMode?this.addEventListener(e,i):n.addEventListener(t,i,!0)),at.set(s,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,s=v.documentMode?this:n,o=at.get(s,e)-1;o?at.set(s,e,o):(v.documentMode?this.removeEventListener(e,i):n.removeEventListener(t,i,!0),at.remove(s,e))}}})),M.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){M.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,s=t.handleObj;return n&&(n===this||M.contains(this,n))||(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}})),M.fn.extend({on:function(t,e,i,n){return Et(this,t,e,i,n)},one:function(t,e,i,n){return Et(this,t,e,i,n,1)},off:function(t,e,i){var n,s;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,M(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"===typeof t){for(s in t)this.off(s,e,t[s]);return this}return!1!==e&&"function"!==typeof e||(i=e,e=void 0),!1===i&&(i=Ot),this.each((function(){M.event.remove(this,t,i,e)}))}});var Bt=/<script|<style|<link/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,zt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function jt(t,e){return N(t,"table")&&N(11!==e.nodeType?e:e.firstChild,"tr")&&M(t).children("tbody")[0]||t}function Vt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ut(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Xt(t,e){var i,n,s,o,r,a;if(1===e.nodeType){if(at.hasData(t)&&(a=at.get(t).events))for(s in at.remove(e,"handle events"),a)for(i=0,n=a[s].length;i<n;i++)M.event.add(e,s,a[s][i]);lt.hasData(t)&&(o=lt.access(t),r=M.extend({},o),lt.set(e,r))}}function Kt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&St.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function Gt(t,e,i,n){e=l(e);var s,o,r,a,h,u,c=0,d=t.length,f=d-1,g=e[0],p=y(g);if(p||d>1&&"string"===typeof g&&!m.checkClone&&It.test(g))return t.each((function(s){var o=t.eq(s);p&&(e[0]=g.call(this,s,o.html())),Gt(o,e,i,n)}));if(d&&(o=(s=At(e,t[0].ownerDocument,!1,t,n)).firstChild,1===s.childNodes.length&&(s=o),o||n)){for(a=(r=M.map(Nt(s,"script"),Vt)).length;c<d;c++)h=s,c!==f&&(h=M.clone(h,!0,!0),a&&M.merge(r,Nt(h,"script"))),i.call(t[c],h,c);if(a)for(u=r[r.length-1].ownerDocument,M.map(r,Ut),c=0;c<a;c++)h=r[c],Mt.test(h.type||"")&&!at.access(h,"globalEval")&&M.contains(u,h)&&(h.src&&"module"!==(h.type||"").toLowerCase()?M._evalUrl&&!h.noModule&&M._evalUrl(h.src,{nonce:h.nonce||h.getAttribute("nonce")},u):w(h.textContent.replace(zt,""),h,u))}return t}function Yt(t,e,i){for(var n,s=e?M.filter(e,t):t,o=0;null!=(n=s[o]);o++)i||1!==n.nodeType||M.cleanData(Nt(n)),n.parentNode&&(i&&mt(n)&&Tt(Nt(n,"script")),n.parentNode.removeChild(n));return t}M.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,s,o,r,a=t.cloneNode(!0),l=mt(t);if(!m.noCloneChecked&&(1===t.nodeType||11===t.nodeType)&&!M.isXMLDoc(t))for(r=Nt(a),n=0,s=(o=Nt(t)).length;n<s;n++)Kt(o[n],r[n]);if(e)if(i)for(o=o||Nt(t),r=r||Nt(a),n=0,s=o.length;n<s;n++)Xt(o[n],r[n]);else Xt(t,a);return(r=Nt(a,"script")).length>0&&Tt(r,!l&&Nt(t,"script")),a},cleanData:function(t){for(var e,i,n,s=M.event.special,o=0;void 0!==(i=t[o]);o++)if(ot(i)){if(e=i[at.expando]){if(e.events)for(n in e.events)s[n]?M.event.remove(i,n):M.removeEvent(i,n,e.handle);i[at.expando]=void 0}i[lt.expando]&&(i[lt.expando]=void 0)}}}),M.fn.extend({detach:function(t){return Yt(this,t,!0)},remove:function(t){return Yt(this,t)},text:function(t){return tt(this,(function(t){return void 0===t?M.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Gt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||jt(this,t).appendChild(t)}))},prepend:function(){return Gt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=jt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Gt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Gt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(M.cleanData(Nt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return M.clone(this,t,e)}))},html:function(t){return tt(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"===typeof t&&!Bt.test(t)&&!Ct[(Pt.exec(t)||["",""])[1].toLowerCase()]){t=M.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(M.cleanData(Nt(e,!1)),e.innerHTML=t);e=0}catch(s){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Gt(this,arguments,(function(e){var i=this.parentNode;M.inArray(this,t)<0&&(M.cleanData(Nt(this)),i&&i.replaceChild(e,this))}),t)}}),M.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){M.fn[t]=function(t){for(var i,n=[],s=M(t),o=s.length-1,r=0;r<=o;r++)i=r===o?this:this.clone(!0),M(s[r])[e](i),h.apply(n,i.get());return this.pushStack(n)}}));var qt=new RegExp("^("+dt+")(?!px)[a-z%]+$","i"),Ht=/^--/,_t=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Wt=function(t,e,i){var n,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];for(s in n=i.call(t),e)t.style[s]=o[s];return n},$t=new RegExp(gt.join("|"),"i");function Jt(t,e,i){var n,s,o,r,a=Ht.test(e),l=t.style;return(i=i||_t(t))&&(r=i.getPropertyValue(e)||i[e],a&&r&&(r=r.replace(F,"$1")||void 0),""!==r||mt(t)||(r=M.style(t,e)),!m.pixelBoxStyles()&&qt.test(r)&&$t.test(e)&&(n=l.width,s=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=r,r=i.width,l.width=n,l.minWidth=s,l.maxWidth=o)),void 0!==r?r+"":r}function Zt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){h.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",pt.appendChild(h).appendChild(u);var t=n.getComputedStyle(u);i="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",r=36===e(t.right),s=36===e(t.width),u.style.position="absolute",o=12===e(u.offsetWidth/3),pt.removeChild(h),u=null}}function e(t){return Math.round(parseFloat(t))}var i,s,o,r,a,l,h=v.createElement("div"),u=v.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===u.style.backgroundClip,M.extend(m,{boxSizingReliable:function(){return t(),s},pixelBoxStyles:function(){return t(),r},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,e,i,s;return null==a&&(t=v.createElement("table"),e=v.createElement("tr"),i=v.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="box-sizing:content-box;border:1px solid",e.style.height="1px",i.style.height="9px",i.style.display="block",pt.appendChild(t).appendChild(e).appendChild(i),s=n.getComputedStyle(e),a=parseInt(s.height,10)+parseInt(s.borderTopWidth,10)+parseInt(s.borderBottomWidth,10)===e.offsetHeight,pt.removeChild(t)),a}}))}();var Qt=["Webkit","Moz","ms"],te=v.createElement("div").style,ee={};function ie(t){var e=M.cssProps[t]||ee[t];return e||(t in te?t:ee[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=Qt.length;i--;)if((t=Qt[i]+e)in te)return t}(t)||t)}var ne=/^(none|table(?!-c[ea]).+)/,se={position:"absolute",visibility:"hidden",display:"block"},oe={letterSpacing:"0",fontWeight:"400"};function re(t,e,i){var n=ft.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function ae(t,e,i,n,s,o){var r="width"===e?1:0,a=0,l=0,h=0;if(i===(n?"border":"content"))return 0;for(;r<4;r+=2)"margin"===i&&(h+=M.css(t,i+gt[r],!0,s)),n?("content"===i&&(l-=M.css(t,"padding"+gt[r],!0,s)),"margin"!==i&&(l-=M.css(t,"border"+gt[r]+"Width",!0,s))):(l+=M.css(t,"padding"+gt[r],!0,s),"padding"!==i?l+=M.css(t,"border"+gt[r]+"Width",!0,s):a+=M.css(t,"border"+gt[r]+"Width",!0,s));return!n&&o>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l+h}function le(t,e,i){var n=_t(t),s=(!m.boxSizingReliable()||i)&&"border-box"===M.css(t,"boxSizing",!1,n),o=s,r=Jt(t,e,n),a="offset"+e[0].toUpperCase()+e.slice(1);if(qt.test(r)){if(!i)return r;r="auto"}return(!m.boxSizingReliable()&&s||!m.reliableTrDimensions()&&N(t,"tr")||"auto"===r||!parseFloat(r)&&"inline"===M.css(t,"display",!1,n))&&t.getClientRects().length&&(s="border-box"===M.css(t,"boxSizing",!1,n),(o=a in t)&&(r=t[a])),(r=parseFloat(r)||0)+ae(t,e,i||(s?"border":"content"),o,n,r)+"px"}function he(t,e,i,n,s){return new he.prototype.init(t,e,i,n,s)}M.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Jt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,o,r,a=st(e),l=Ht.test(e),h=t.style;if(l||(e=ie(a)),r=M.cssHooks[e]||M.cssHooks[a],void 0===i)return r&&"get"in r&&void 0!==(s=r.get(t,!1,n))?s:h[e];"string"===(o=typeof i)&&(s=ft.exec(i))&&s[1]&&(i=vt(t,e,s),o="number"),null!=i&&i===i&&("number"!==o||l||(i+=s&&s[3]||(M.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),r&&"set"in r&&void 0===(i=r.set(t,i,n))||(l?h.setProperty(e,i):h[e]=i))}},css:function(t,e,i,n){var s,o,r,a=st(e);return Ht.test(e)||(e=ie(a)),(r=M.cssHooks[e]||M.cssHooks[a])&&"get"in r&&(s=r.get(t,!0,i)),void 0===s&&(s=Jt(t,e,n)),"normal"===s&&e in oe&&(s=oe[e]),""===i||i?(o=parseFloat(s),!0===i||isFinite(o)?o||0:s):s}}),M.each(["height","width"],(function(t,e){M.cssHooks[e]={get:function(t,i,n){if(i)return!ne.test(M.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?le(t,e,n):Wt(t,se,(function(){return le(t,e,n)}))},set:function(t,i,n){var s,o=_t(t),r=!m.scrollboxSize()&&"absolute"===o.position,a=(r||n)&&"border-box"===M.css(t,"boxSizing",!1,o),l=n?ae(t,e,n,a,o):0;return a&&r&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-ae(t,e,"border",!1,o)-.5)),l&&(s=ft.exec(i))&&"px"!==(s[3]||"px")&&(t.style[e]=i,i=M.css(t,e)),re(0,i,l)}}})),M.cssHooks.marginLeft=Zt(m.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Jt(t,"marginLeft"))||t.getBoundingClientRect().left-Wt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),M.each({margin:"",padding:"",border:"Width"},(function(t,e){M.cssHooks[t+e]={expand:function(i){for(var n=0,s={},o="string"===typeof i?i.split(" "):[i];n<4;n++)s[t+gt[n]+e]=o[n]||o[n-2]||o[0];return s}},"margin"!==t&&(M.cssHooks[t+e].set=re)})),M.fn.extend({css:function(t,e){return tt(this,(function(t,e,i){var n,s,o={},r=0;if(Array.isArray(e)){for(n=_t(t),s=e.length;r<s;r++)o[e[r]]=M.css(t,e[r],!1,n);return o}return void 0!==i?M.style(t,e,i):M.css(t,e)}),t,e,arguments.length>1)}}),M.Tween=he,he.prototype={constructor:he,init:function(t,e,i,n,s,o){this.elem=t,this.prop=i,this.easing=s||M.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(M.cssNumber[i]?"":"px")},cur:function(){var t=he.propHooks[this.prop];return t&&t.get?t.get(this):he.propHooks._default.get(this)},run:function(t){var e,i=he.propHooks[this.prop];return this.options.duration?this.pos=e=M.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):he.propHooks._default.set(this),this}},he.prototype.init.prototype=he.prototype,he.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=M.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){M.fx.step[t.prop]?M.fx.step[t.prop](t):1!==t.elem.nodeType||!M.cssHooks[t.prop]&&null==t.elem.style[ie(t.prop)]?t.elem[t.prop]=t.now:M.style(t.elem,t.prop,t.now+t.unit)}}},he.propHooks.scrollTop=he.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},M.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},M.fx=he.prototype.init,M.fx.step={};var ue,ce,de=/^(?:toggle|show|hide)$/,fe=/queueHooks$/;function ge(){ce&&(!1===v.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ge):n.setTimeout(ge,M.fx.interval),M.fx.tick())}function pe(){return n.setTimeout((function(){ue=void 0})),ue=Date.now()}function me(t,e){var i,n=0,s={height:t};for(e=e?1:0;n<4;n+=2-e)s["margin"+(i=gt[n])]=s["padding"+i]=t;return e&&(s.opacity=s.width=t),s}function ye(t,e,i){for(var n,s=(xe.tweeners[e]||[]).concat(xe.tweeners["*"]),o=0,r=s.length;o<r;o++)if(n=s[o].call(i,e,t))return n}function xe(t,e,i){var n,s,o=0,r=xe.prefilters.length,a=M.Deferred().always((function(){delete l.elem})),l=function(){if(s)return!1;for(var e=ue||pe(),i=Math.max(0,h.startTime+h.duration-e),n=1-(i/h.duration||0),o=0,r=h.tweens.length;o<r;o++)h.tweens[o].run(n);return a.notifyWith(t,[h,n,i]),n<1&&r?i:(r||a.notifyWith(t,[h,1,0]),a.resolveWith(t,[h]),!1)},h=a.promise({elem:t,props:M.extend({},e),opts:M.extend(!0,{specialEasing:{},easing:M.easing._default},i),originalProperties:e,originalOptions:i,startTime:ue||pe(),duration:i.duration,tweens:[],createTween:function(e,i){var n=M.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(s)return this;for(s=!0;i<n;i++)h.tweens[i].run(1);return e?(a.notifyWith(t,[h,1,0]),a.resolveWith(t,[h,e])):a.rejectWith(t,[h,e]),this}}),u=h.props;for(!function(t,e){var i,n,s,o,r;for(i in t)if(s=e[n=st(i)],o=t[i],Array.isArray(o)&&(s=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),(r=M.cssHooks[n])&&"expand"in r)for(i in o=r.expand(o),delete t[n],o)i in t||(t[i]=o[i],e[i]=s);else e[n]=s}(u,h.opts.specialEasing);o<r;o++)if(n=xe.prefilters[o].call(h,t,u,h.opts))return y(n.stop)&&(M._queueHooks(h.elem,h.opts.queue).stop=n.stop.bind(n)),n;return M.map(u,ye,h),y(h.opts.start)&&h.opts.start.call(t,h),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always),M.fx.timer(M.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h}M.Animation=M.extend(xe,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return vt(i.elem,t,ft.exec(e),i),i}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(H);for(var i,n=0,s=t.length;n<s;n++)i=t[n],xe.tweeners[i]=xe.tweeners[i]||[],xe.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,s,o,r,a,l,h,u,c="width"in e||"height"in e,d=this,f={},g=t.style,p=t.nodeType&&xt(t),m=at.get(t,"fxshow");for(n in i.queue||(null==(r=M._queueHooks(t,"fx")).unqueued&&(r.unqueued=0,a=r.empty.fire,r.empty.fire=function(){r.unqueued||a()}),r.unqueued++,d.always((function(){d.always((function(){r.unqueued--,M.queue(t,"fx").length||r.empty.fire()}))}))),e)if(s=e[n],de.test(s)){if(delete e[n],o=o||"toggle"===s,s===(p?"hide":"show")){if("show"!==s||!m||void 0===m[n])continue;p=!0}f[n]=m&&m[n]||M.style(t,n)}if((l=!M.isEmptyObject(e))||!M.isEmptyObject(f))for(n in c&&1===t.nodeType&&(i.overflow=[g.overflow,g.overflowX,g.overflowY],null==(h=m&&m.display)&&(h=at.get(t,"display")),"none"===(u=M.css(t,"display"))&&(h?u=h:(kt([t],!0),h=t.style.display||h,u=M.css(t,"display"),kt([t]))),("inline"===u||"inline-block"===u&&null!=h)&&"none"===M.css(t,"float")&&(l||(d.done((function(){g.display=h})),null==h&&(u=g.display,h="none"===u?"":u)),g.display="inline-block")),i.overflow&&(g.overflow="hidden",d.always((function(){g.overflow=i.overflow[0],g.overflowX=i.overflow[1],g.overflowY=i.overflow[2]}))),l=!1,f)l||(m?"hidden"in m&&(p=m.hidden):m=at.access(t,"fxshow",{display:h}),o&&(m.hidden=!p),p&&kt([t],!0),d.done((function(){for(n in p||kt([t]),at.remove(t,"fxshow"),f)M.style(t,n,f[n])}))),l=ye(p?m[n]:0,n,d),n in m||(m[n]=l.start,p&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?xe.prefilters.unshift(t):xe.prefilters.push(t)}}),M.speed=function(t,e,i){var n=t&&"object"===typeof t?M.extend({},t):{complete:i||!i&&e||y(t)&&t,duration:t,easing:i&&e||e&&!y(e)&&e};return M.fx.off?n.duration=0:"number"!==typeof n.duration&&(n.duration in M.fx.speeds?n.duration=M.fx.speeds[n.duration]:n.duration=M.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){y(n.old)&&n.old.call(this),n.queue&&M.dequeue(this,n.queue)},n},M.fn.extend({fadeTo:function(t,e,i,n){return this.filter(xt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=M.isEmptyObject(t),o=M.speed(e,i,n),r=function(){var e=xe(this,M.extend({},t),o);(s||at.get(this,"finish"))&&e.stop(!0)};return r.finish=r,s||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!==typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,s=null!=t&&t+"queueHooks",o=M.timers,r=at.get(this);if(s)r[s]&&r[s].stop&&n(r[s]);else for(s in r)r[s]&&r[s].stop&&fe.test(s)&&n(r[s]);for(s=o.length;s--;)o[s].elem!==this||null!=t&&o[s].queue!==t||(o[s].anim.stop(i),e=!1,o.splice(s,1));!e&&i||M.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=at.get(this),n=i[t+"queue"],s=i[t+"queueHooks"],o=M.timers,r=n?n.length:0;for(i.finish=!0,M.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<r;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),M.each(["toggle","show","hide"],(function(t,e){var i=M.fn[e];M.fn[e]=function(t,n,s){return null==t||"boolean"===typeof t?i.apply(this,arguments):this.animate(me(e,!0),t,n,s)}})),M.each({slideDown:me("show"),slideUp:me("hide"),slideToggle:me("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){M.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),M.timers=[],M.fx.tick=function(){var t,e=0,i=M.timers;for(ue=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||M.fx.stop(),ue=void 0},M.fx.timer=function(t){M.timers.push(t),M.fx.start()},M.fx.interval=13,M.fx.start=function(){ce||(ce=!0,ge())},M.fx.stop=function(){ce=null},M.fx.speeds={slow:600,fast:200,_default:400},M.fn.delay=function(t,e){return t=M.fx&&M.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var s=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(s)}}))},function(){var t=v.createElement("input"),e=v.createElement("select").appendChild(v.createElement("option"));t.type="checkbox",m.checkOn=""!==t.value,m.optSelected=e.selected,(t=v.createElement("input")).value="t",t.type="radio",m.radioValue="t"===t.value}();var ve,be=M.expr.attrHandle;M.fn.extend({attr:function(t,e){return tt(this,M.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){M.removeAttr(this,t)}))}}),M.extend({attr:function(t,e,i){var n,s,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"===typeof t.getAttribute?M.prop(t,e,i):(1===o&&M.isXMLDoc(t)||(s=M.attrHooks[e.toLowerCase()]||(M.expr.match.bool.test(e)?ve:void 0)),void 0!==i?null===i?void M.removeAttr(t,e):s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:(t.setAttribute(e,i+""),i):s&&"get"in s&&null!==(n=s.get(t,e))?n:null==(n=M.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&N(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,s=e&&e.match(H);if(s&&1===t.nodeType)for(;i=s[n++];)t.removeAttribute(i)}}),ve={set:function(t,e,i){return!1===e?M.removeAttr(t,i):t.setAttribute(i,i),i}},M.each(M.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=be[e]||M.find.attr;be[e]=function(t,e,n){var s,o,r=e.toLowerCase();return n||(o=be[r],be[r]=s,s=null!=i(t,e,n)?r:null,be[r]=o),s}}));var we=/^(?:input|select|textarea|button)$/i,ke=/^(?:a|area)$/i;function Se(t){return(t.match(H)||[]).join(" ")}function Pe(t){return t.getAttribute&&t.getAttribute("class")||""}function Me(t){return Array.isArray(t)?t:"string"===typeof t&&t.match(H)||[]}M.fn.extend({prop:function(t,e){return tt(this,M.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[M.propFix[t]||t]}))}}),M.extend({prop:function(t,e,i){var n,s,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&M.isXMLDoc(t)||(e=M.propFix[e]||e,s=M.propHooks[e]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:t[e]=i:s&&"get"in s&&null!==(n=s.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=M.find.attr(t,"tabindex");return e?parseInt(e,10):we.test(t.nodeName)||ke.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(M.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),M.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){M.propFix[this.toLowerCase()]=this})),M.fn.extend({addClass:function(t){var e,i,n,s,o,r;return y(t)?this.each((function(e){M(this).addClass(t.call(this,e,Pe(this)))})):(e=Me(t)).length?this.each((function(){if(n=Pe(this),i=1===this.nodeType&&" "+Se(n)+" "){for(o=0;o<e.length;o++)s=e[o],i.indexOf(" "+s+" ")<0&&(i+=s+" ");r=Se(i),n!==r&&this.setAttribute("class",r)}})):this},removeClass:function(t){var e,i,n,s,o,r;return y(t)?this.each((function(e){M(this).removeClass(t.call(this,e,Pe(this)))})):arguments.length?(e=Me(t)).length?this.each((function(){if(n=Pe(this),i=1===this.nodeType&&" "+Se(n)+" "){for(o=0;o<e.length;o++)for(s=e[o];i.indexOf(" "+s+" ")>-1;)i=i.replace(" "+s+" "," ");r=Se(i),n!==r&&this.setAttribute("class",r)}})):this:this.attr("class","")},toggleClass:function(t,e){var i,n,s,o,r=typeof t,a="string"===r||Array.isArray(t);return y(t)?this.each((function(i){M(this).toggleClass(t.call(this,i,Pe(this),e),e)})):"boolean"===typeof e&&a?e?this.addClass(t):this.removeClass(t):(i=Me(t),this.each((function(){if(a)for(o=M(this),s=0;s<i.length;s++)n=i[s],o.hasClass(n)?o.removeClass(n):o.addClass(n);else void 0!==t&&"boolean"!==r||((n=Pe(this))&&at.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",n||!1===t?"":at.get(this,"__className__")||""))})))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+Se(Pe(i))+" ").indexOf(e)>-1)return!0;return!1}});var Ce=/\r/g;M.fn.extend({val:function(t){var e,i,n,s=this[0];return arguments.length?(n=y(t),this.each((function(i){var s;1===this.nodeType&&(null==(s=n?t.call(this,i,M(this).val()):t)?s="":"number"===typeof s?s+="":Array.isArray(s)&&(s=M.map(s,(function(t){return null==t?"":t+""}))),(e=M.valHooks[this.type]||M.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,s,"value")||(this.value=s))}))):s?(e=M.valHooks[s.type]||M.valHooks[s.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(s,"value"))?i:"string"===typeof(i=s.value)?i.replace(Ce,""):null==i?"":i:void 0}}),M.extend({valHooks:{option:{get:function(t){var e=M.find.attr(t,"value");return null!=e?e:Se(M.text(t))}},select:{get:function(t){var e,i,n,s=t.options,o=t.selectedIndex,r="select-one"===t.type,a=r?null:[],l=r?o+1:s.length;for(n=o<0?l:r?o:0;n<l;n++)if(((i=s[n]).selected||n===o)&&!i.disabled&&(!i.parentNode.disabled||!N(i.parentNode,"optgroup"))){if(e=M(i).val(),r)return e;a.push(e)}return a},set:function(t,e){for(var i,n,s=t.options,o=M.makeArray(e),r=s.length;r--;)((n=s[r]).selected=M.inArray(M.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),M.each(["radio","checkbox"],(function(){M.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=M.inArray(M(t).val(),e)>-1}},m.checkOn||(M.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var Ne=n.location,Te={guid:Date.now()},Le=/\?/;M.parseXML=function(t){var e,i;if(!t||"string"!==typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(s){}return i=e&&e.getElementsByTagName("parsererror")[0],e&&!i||M.error("Invalid XML: "+(i?M.map(i.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var Ae=/^(?:focusinfocus|focusoutblur)$/,De=function(t){t.stopPropagation()};M.extend(M.event,{trigger:function(t,e,i,s){var o,r,a,l,h,u,c,d,g=[i||v],p=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];if(r=d=a=i=i||v,3!==i.nodeType&&8!==i.nodeType&&!Ae.test(p+M.event.triggered)&&(p.indexOf(".")>-1&&(m=p.split("."),p=m.shift(),m.sort()),h=p.indexOf(":")<0&&"on"+p,(t=t[M.expando]?t:new M.Event(p,"object"===typeof t&&t)).isTrigger=s?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:M.makeArray(e,[t]),c=M.event.special[p]||{},s||!c.trigger||!1!==c.trigger.apply(i,e))){if(!s&&!c.noBubble&&!x(i)){for(l=c.delegateType||p,Ae.test(l+p)||(r=r.parentNode);r;r=r.parentNode)g.push(r),a=r;a===(i.ownerDocument||v)&&g.push(a.defaultView||a.parentWindow||n)}for(o=0;(r=g[o++])&&!t.isPropagationStopped();)d=r,t.type=o>1?l:c.bindType||p,(u=(at.get(r,"events")||Object.create(null))[t.type]&&at.get(r,"handle"))&&u.apply(r,e),(u=h&&r[h])&&u.apply&&ot(r)&&(t.result=u.apply(r,e),!1===t.result&&t.preventDefault());return t.type=p,s||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(g.pop(),e)||!ot(i)||h&&y(i[p])&&!x(i)&&((a=i[h])&&(i[h]=null),M.event.triggered=p,t.isPropagationStopped()&&d.addEventListener(p,De),i[p](),t.isPropagationStopped()&&d.removeEventListener(p,De),M.event.triggered=void 0,a&&(i[h]=a)),t.result}},simulate:function(t,e,i){var n=M.extend(new M.Event,i,{type:t,isSimulated:!0});M.event.trigger(n,null,e)}}),M.fn.extend({trigger:function(t,e){return this.each((function(){M.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return M.event.trigger(t,e,i,!0)}});var Fe=/\[\]$/,Oe=/\r?\n/g,Ee=/^(?:submit|button|image|reset|file)$/i,Re=/^(?:input|select|textarea|keygen)/i;function Be(t,e,i,n){var s;if(Array.isArray(e))M.each(e,(function(e,s){i||Fe.test(t)?n(t,s):Be(t+"["+("object"===typeof s&&null!=s?e:"")+"]",s,i,n)}));else if(i||"object"!==k(e))n(t,e);else for(s in e)Be(t+"["+s+"]",e[s],i,n)}M.param=function(t,e){var i,n=[],s=function(t,e){var i=y(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!M.isPlainObject(t))M.each(t,(function(){s(this.name,this.value)}));else for(i in t)Be(i,t[i],e,s);return n.join("&")},M.fn.extend({serialize:function(){return M.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=M.prop(this,"elements");return t?M.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!M(this).is(":disabled")&&Re.test(this.nodeName)&&!Ee.test(t)&&(this.checked||!St.test(t))})).map((function(t,e){var i=M(this).val();return null==i?null:Array.isArray(i)?M.map(i,(function(t){return{name:e.name,value:t.replace(Oe,"\r\n")}})):{name:e.name,value:i.replace(Oe,"\r\n")}})).get()}});var Ie=/%20/g,ze=/#.*$/,je=/([?&])_=[^&]*/,Ve=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ue=/^(?:GET|HEAD)$/,Xe=/^\/\//,Ke={},Ge={},Ye="*/".concat("*"),qe=v.createElement("a");function He(t){return function(e,i){"string"!==typeof e&&(i=e,e="*");var n,s=0,o=e.toLowerCase().match(H)||[];if(y(i))for(;n=o[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function _e(t,e,i,n){var s={},o=t===Ge;function r(a){var l;return s[a]=!0,M.each(t[a]||[],(function(t,a){var h=a(e,i,n);return"string"!==typeof h||o||s[h]?o?!(l=h):void 0:(e.dataTypes.unshift(h),r(h),!1)})),l}return r(e.dataTypes[0])||!s["*"]&&r("*")}function We(t,e){var i,n,s=M.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((s[i]?t:n||(n={}))[i]=e[i]);return n&&M.extend(!0,t,n),t}qe.href=Ne.href,M.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ne.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ne.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ye,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":M.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?We(We(t,M.ajaxSettings),e):We(M.ajaxSettings,t)},ajaxPrefilter:He(Ke),ajaxTransport:He(Ge),ajax:function(t,e){"object"===typeof t&&(e=t,t=void 0),e=e||{};var i,s,o,r,a,l,h,u,c,d,f=M.ajaxSetup({},e),g=f.context||f,p=f.context&&(g.nodeType||g.jquery)?M(g):M.event,m=M.Deferred(),y=M.Callbacks("once memory"),x=f.statusCode||{},b={},w={},k="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(h){if(!r)for(r={};e=Ve.exec(o);)r[e[1].toLowerCase()+" "]=(r[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=r[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return h?o:null},setRequestHeader:function(t,e){return null==h&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==h&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(h)S.always(t[S.status]);else for(e in t)x[e]=[x[e],t[e]];return this},abort:function(t){var e=t||k;return i&&i.abort(e),P(0,e),this}};if(m.promise(S),f.url=((t||f.url||Ne.href)+"").replace(Xe,Ne.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(H)||[""],null==f.crossDomain){l=v.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=qe.protocol+"//"+qe.host!==l.protocol+"//"+l.host}catch(C){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!==typeof f.data&&(f.data=M.param(f.data,f.traditional)),_e(Ke,f,e,S),h)return S;for(c in(u=M.event&&f.global)&&0===M.active++&&M.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ue.test(f.type),s=f.url.replace(ze,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ie,"+")):(d=f.url.slice(s.length),f.data&&(f.processData||"string"===typeof f.data)&&(s+=(Le.test(s)?"&":"?")+f.data,delete f.data),!1===f.cache&&(s=s.replace(je,"$1"),d=(Le.test(s)?"&":"?")+"_="+Te.guid+++d),f.url=s+d),f.ifModified&&(M.lastModified[s]&&S.setRequestHeader("If-Modified-Since",M.lastModified[s]),M.etag[s]&&S.setRequestHeader("If-None-Match",M.etag[s])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&S.setRequestHeader("Content-Type",f.contentType),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Ye+"; q=0.01":""):f.accepts["*"]),f.headers)S.setRequestHeader(c,f.headers[c]);if(f.beforeSend&&(!1===f.beforeSend.call(g,S,f)||h))return S.abort();if(k="abort",y.add(f.complete),S.done(f.success),S.fail(f.error),i=_e(Ge,f,e,S)){if(S.readyState=1,u&&p.trigger("ajaxSend",[S,f]),h)return S;f.async&&f.timeout>0&&(a=n.setTimeout((function(){S.abort("timeout")}),f.timeout));try{h=!1,i.send(b,P)}catch(C){if(h)throw C;P(-1,C)}}else P(-1,"No Transport");function P(t,e,r,l){var c,d,v,b,w,k=e;h||(h=!0,a&&n.clearTimeout(a),i=void 0,o=l||"",S.readyState=t>0?4:0,c=t>=200&&t<300||304===t,r&&(b=function(t,e,i){for(var n,s,o,r,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(s in a)if(a[s]&&a[s].test(n)){l.unshift(s);break}if(l[0]in i)o=l[0];else{for(s in i){if(!l[0]||t.converters[s+" "+l[0]]){o=s;break}r||(r=s)}o=o||r}if(o)return o!==l[0]&&l.unshift(o),i[o]}(f,S,r)),!c&&M.inArray("script",f.dataTypes)>-1&&M.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),b=function(t,e,i,n){var s,o,r,a,l,h={},u=t.dataTypes.slice();if(u[1])for(r in t.converters)h[r.toLowerCase()]=t.converters[r];for(o=u.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(r=h[l+" "+o]||h["* "+o]))for(s in h)if((a=s.split(" "))[1]===o&&(r=h[l+" "+a[0]]||h["* "+a[0]])){!0===r?r=h[s]:!0!==h[s]&&(o=a[0],u.unshift(a[1]));break}if(!0!==r)if(r&&t.throws)e=r(e);else try{e=r(e)}catch(C){return{state:"parsererror",error:r?C:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,b,S,c),c?(f.ifModified&&((w=S.getResponseHeader("Last-Modified"))&&(M.lastModified[s]=w),(w=S.getResponseHeader("etag"))&&(M.etag[s]=w)),204===t||"HEAD"===f.type?k="nocontent":304===t?k="notmodified":(k=b.state,d=b.data,c=!(v=b.error))):(v=k,!t&&k||(k="error",t<0&&(t=0))),S.status=t,S.statusText=(e||k)+"",c?m.resolveWith(g,[d,k,S]):m.rejectWith(g,[S,k,v]),S.statusCode(x),x=void 0,u&&p.trigger(c?"ajaxSuccess":"ajaxError",[S,f,c?d:v]),y.fireWith(g,[S,k]),u&&(p.trigger("ajaxComplete",[S,f]),--M.active||M.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,i){return M.get(t,e,i,"json")},getScript:function(t,e){return M.get(t,void 0,e,"script")}}),M.each(["get","post"],(function(t,e){M[e]=function(t,i,n,s){return y(i)&&(s=s||n,n=i,i=void 0),M.ajax(M.extend({url:t,type:e,dataType:s,data:i,success:n},M.isPlainObject(t)&&t))}})),M.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),M._evalUrl=function(t,e,i){return M.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){M.globalEval(t,e,i)}})},M.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=M(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y(t)?this.each((function(e){M(this).wrapInner(t.call(this,e))})):this.each((function(){var e=M(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y(t);return this.each((function(i){M(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){M(this).replaceWith(this.childNodes)})),this}}),M.expr.pseudos.hidden=function(t){return!M.expr.pseudos.visible(t)},M.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},M.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var $e={0:200,1223:204},Je=M.ajaxSettings.xhr();m.cors=!!Je&&"withCredentials"in Je,m.ajax=Je=!!Je,M.ajaxTransport((function(t){var e,i;if(m.cors||Je&&!t.crossDomain)return{send:function(s,o){var r,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)a[r]=t.xhrFields[r];for(r in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest"),s)a.setRequestHeader(r,s[r]);e=function(t){return function(){e&&(e=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!==typeof a.status?o(0,"error"):o(a.status,a.statusText):o($e[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!==typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),i=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&n.setTimeout((function(){e&&i()}))},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(l){if(e)throw l}},abort:function(){e&&e()}}})),M.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),M.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return M.globalEval(t),t}}}),M.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),M.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain||t.scriptAttrs)return{send:function(n,s){e=M("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&s("error"===t.type?404:200,t.type)}),v.head.appendChild(e[0])},abort:function(){i&&i()}}}));var Ze=[],Qe=/(=)\?(?=&|$)|\?\?/;M.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ze.pop()||M.expando+"_"+Te.guid++;return this[t]=!0,t}}),M.ajaxPrefilter("json jsonp",(function(t,e,i){var s,o,r,a=!1!==t.jsonp&&(Qe.test(t.url)?"url":"string"===typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return s=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Qe,"$1"+s):!1!==t.jsonp&&(t.url+=(Le.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return r||M.error(s+" was not called"),r[0]},t.dataTypes[0]="json",o=n[s],n[s]=function(){r=arguments},i.always((function(){void 0===o?M(n).removeProp(s):n[s]=o,t[s]&&(t.jsonpCallback=e.jsonpCallback,Ze.push(s)),r&&y(o)&&o(r[0]),r=o=void 0})),"script"})),m.createHTMLDocument=function(){var t=v.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),M.parseHTML=function(t,e,i){return"string"!==typeof t?[]:("boolean"===typeof e&&(i=e,e=!1),e||(m.createHTMLDocument?((n=(e=v.implementation.createHTMLDocument("")).createElement("base")).href=v.location.href,e.head.appendChild(n)):e=v),o=!i&&[],(s=V.exec(t))?[e.createElement(s[1])]:(s=At([t],e,o),o&&o.length&&M(o).remove(),M.merge([],s.childNodes)));var n,s,o},M.fn.load=function(t,e,i){var n,s,o,r=this,a=t.indexOf(" ");return a>-1&&(n=Se(t.slice(a)),t=t.slice(0,a)),y(e)?(i=e,e=void 0):e&&"object"===typeof e&&(s="POST"),r.length>0&&M.ajax({url:t,type:s||"GET",dataType:"html",data:e}).done((function(t){o=arguments,r.html(n?M("<div>").append(M.parseHTML(t)).find(n):t)})).always(i&&function(t,e){r.each((function(){i.apply(this,o||[t.responseText,e,t])}))}),this},M.expr.pseudos.animated=function(t){return M.grep(M.timers,(function(e){return t===e.elem})).length},M.offset={setOffset:function(t,e,i){var n,s,o,r,a,l,h=M.css(t,"position"),u=M(t),c={};"static"===h&&(t.style.position="relative"),a=u.offset(),o=M.css(t,"top"),l=M.css(t,"left"),("absolute"===h||"fixed"===h)&&(o+l).indexOf("auto")>-1?(r=(n=u.position()).top,s=n.left):(r=parseFloat(o)||0,s=parseFloat(l)||0),y(e)&&(e=e.call(t,i,M.extend({},a))),null!=e.top&&(c.top=e.top-a.top+r),null!=e.left&&(c.left=e.left-a.left+s),"using"in e?e.using.call(t,c):u.css(c)}},M.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){M.offset.setOffset(this,t,e)}));var e,i,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],s={top:0,left:0};if("fixed"===M.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===M.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((s=M(t).offset()).top+=M.css(t,"borderTopWidth",!0),s.left+=M.css(t,"borderLeftWidth",!0))}return{top:e.top-s.top-M.css(n,"marginTop",!0),left:e.left-s.left-M.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===M.css(t,"position");)t=t.offsetParent;return t||pt}))}}),M.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;M.fn[t]=function(n){return tt(this,(function(t,n,s){var o;if(x(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===s)return o?o[e]:t[n];o?o.scrollTo(i?o.pageXOffset:s,i?s:o.pageYOffset):t[n]=s}),t,n,arguments.length)}})),M.each(["top","left"],(function(t,e){M.cssHooks[e]=Zt(m.pixelPosition,(function(t,i){if(i)return i=Jt(t,e),qt.test(i)?M(t).position()[e]+"px":i}))})),M.each({Height:"height",Width:"width"},(function(t,e){M.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){M.fn[n]=function(s,o){var r=arguments.length&&(i||"boolean"!==typeof s),a=i||(!0===s||!0===o?"margin":"border");return tt(this,(function(e,i,s){var o;return x(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===s?M.css(e,i,a):M.style(e,i,s,a)}),e,r?s:void 0,r)}}))})),M.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){M.fn[e]=function(t){return this.on(e,t)}})),M.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.on("mouseenter",t).on("mouseleave",e||t)}}),M.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){M.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}));var ti=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;M.proxy=function(t,e){var i,n,s;if("string"===typeof e&&(i=t[e],e=t,t=i),y(t))return n=a.call(arguments,2),s=function(){return t.apply(e||this,n.concat(a.call(arguments)))},s.guid=t.guid=t.guid||M.guid++,s},M.holdReady=function(t){t?M.readyWait++:M.ready(!0)},M.isArray=Array.isArray,M.parseJSON=JSON.parse,M.nodeName=N,M.isFunction=y,M.isWindow=x,M.camelCase=st,M.type=k,M.now=Date.now,M.isNumeric=function(t){var e=M.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},M.trim=function(t){return null==t?"":(t+"").replace(ti,"$1")},void 0===(i=function(){return M}.apply(e,[]))||(t.exports=i);var ei=n.jQuery,ii=n.$;return M.noConflict=function(t){return n.$===M&&(n.$=ii),t&&n.jQuery===M&&(n.jQuery=ei),M},"undefined"===typeof s&&(n.jQuery=n.$=M),M}))},730:(t,e,i)=>{"use strict";var n=i(43),s=i(853);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function l(t,e){h(t,e),h(t+"Capture",e)}function h(t,e){for(a[t]=e,t=0;t<e.length;t++)r.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function p(t,e,i,n,s,o,r){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=r}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new p(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new p(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new p(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new p(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new p(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new p(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new p(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new p(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new p(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function x(t){return t[1].toUpperCase()}function v(t,e,i,n){var s=m.hasOwnProperty(e)?m[e]:null;(null!==s?0!==s.type:n||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,i,n){if(null===e||"undefined"===typeof e||function(t,e,i,n){if(null!==i&&0===i.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,i,s,n)&&(i=null),n||null===s?function(t){return!!c.call(g,t)||!c.call(f,t)&&(d.test(t)?g[t]=!0:(f[t]=!0,!1))}(e)&&(null===i?t.removeAttribute(e):t.setAttribute(e,""+i)):s.mustUseProperty?t[s.propertyName]=null===i?3!==s.type&&"":i:(e=s.attributeName,n=s.attributeNamespace,null===i?t.removeAttribute(e):(i=3===(s=s.type)||4===s&&!0===i?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,x);m[e]=new p(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,x);m[e]=new p(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,x);m[e]=new p(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new p(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new p(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),N=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),F=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var E=Symbol.iterator;function R(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=E&&t[E]||t["@@iterator"])?t:null}var B,I=Object.assign;function z(t){if(void 0===B)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);B=e&&e[1]||""}return"\n"+B+t}var j=!1;function V(t,e){if(!t||j)return"";j=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var n=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){n=h}t.call(e.prototype)}else{try{throw Error()}catch(h){n=h}t()}}catch(h){if(h&&n&&"string"===typeof h.stack){for(var s=h.stack.split("\n"),o=n.stack.split("\n"),r=s.length-1,a=o.length-1;1<=r&&0<=a&&s[r]!==o[a];)a--;for(;1<=r&&0<=a;r--,a--)if(s[r]!==o[a]){if(1!==r||1!==a)do{if(r--,0>--a||s[r]!==o[a]){var l="\n"+s[r].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=r&&0<=a);break}}}finally{j=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?z(t):""}function U(t){switch(t.tag){case 5:return z(t.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return t=V(t.type,!1);case 11:return t=V(t.type.render,!1);case 1:return t=V(t.type,!0);default:return""}}function X(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case S:return"Fragment";case k:return"Portal";case M:return"Profiler";case P:return"StrictMode";case L:return"Suspense";case A:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case N:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case T:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case D:return null!==(e=t.displayName||null)?e:X(t.type)||"Memo";case F:e=t._payload,t=t._init;try{return X(t(e))}catch(i){}}return null}function K(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(e);case 8:return e===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function G(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function Y(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function q(t){t._valueTracker||(t._valueTracker=function(t){var e=Y(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var s=i.get,o=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(t){n=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(t){n=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function H(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=Y(t)?t.checked?"true":"false":t.value),(t=n)!==i&&(e.setValue(t),!0)}function _(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function W(t,e){var i=e.checked;return I({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:t._wrapperState.initialChecked})}function $(t,e){var i=null==e.defaultValue?"":e.defaultValue,n=null!=e.checked?e.checked:e.defaultChecked;i=G(null!=e.value?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&v(t,"checked",e,!1)}function Z(t,e){J(t,e);var i=G(e.value),n=e.type;if(null!=i)"number"===n?(0===i&&""===t.value||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if("submit"===n||"reset"===n)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,i):e.hasOwnProperty("defaultValue")&&tt(t,e.type,G(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Q(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!("submit"!==n&&"reset"!==n||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}""!==(i=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==i&&(t.name=i)}function tt(t,e,i){"number"===e&&_(t.ownerDocument)===t||(null==i?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var et=Array.isArray;function it(t,e,i,n){if(t=t.options,e){e={};for(var s=0;s<i.length;s++)e["$"+i[s]]=!0;for(i=0;i<t.length;i++)s=e.hasOwnProperty("$"+t[i].value),t[i].selected!==s&&(t[i].selected=s),s&&n&&(t[i].defaultSelected=!0)}else{for(i=""+G(i),e=null,s=0;s<t.length;s++){if(t[s].value===i)return t[s].selected=!0,void(n&&(t[s].defaultSelected=!0));null!==e||t[s].disabled||(e=t[s])}null!==e&&(e.selected=!0)}}function nt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return I({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function st(t,e){var i=e.value;if(null==i){if(i=e.children,e=e.defaultValue,null!=i){if(null!=e)throw Error(o(92));if(et(i)){if(1<i.length)throw Error(o(93));i=i[0]}e=i}null==e&&(e=""),i=e}t._wrapperState={initialValue:G(i)}}function ot(t,e){var i=G(e.value),n=G(e.defaultValue);null!=i&&((i=""+i)!==t.value&&(t.value=i),null==e.defaultValue&&t.defaultValue!==i&&(t.defaultValue=i)),null!=n&&(t.defaultValue=""+n)}function rt(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function at(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?at(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ht,ut,ct=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ht=ht||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ht.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,i,n){MSApp.execUnsafeLocalFunction((function(){return ut(t,e)}))}:ut);function dt(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gt=["Webkit","ms","Moz","O"];function pt(t,e,i){return null==e||"boolean"===typeof e||""===e?"":i||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function mt(t,e){for(var i in t=t.style,e)if(e.hasOwnProperty(i)){var n=0===i.indexOf("--"),s=pt(i,e[i],n);"float"===i&&(i="cssFloat"),n?t.setProperty(i,s):t[i]=s}}Object.keys(ft).forEach((function(t){gt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var yt=I({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(o(62))}}function vt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function wt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var kt=null,St=null,Pt=null;function Mt(t){if(t=vs(t)){if("function"!==typeof kt)throw Error(o(280));var e=t.stateNode;e&&(e=ws(e),kt(t.stateNode,t.type,e))}}function Ct(t){St?Pt?Pt.push(t):Pt=[t]:St=t}function Nt(){if(St){var t=St,e=Pt;if(Pt=St=null,Mt(t),e)for(t=0;t<e.length;t++)Mt(e[t])}}function Tt(t,e){return t(e)}function Lt(){}var At=!1;function Dt(t,e,i){if(At)return t(e,i);At=!0;try{return Tt(t,e,i)}finally{At=!1,(null!==St||null!==Pt)&&(Lt(),Nt())}}function Ft(t,e){var i=t.stateNode;if(null===i)return null;var n=ws(i);if(null===n)return null;i=n[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!n;break t;default:t=!1}if(t)return null;if(i&&"function"!==typeof i)throw Error(o(231,e,typeof i));return i}var Ot=!1;if(u)try{var Et={};Object.defineProperty(Et,"passive",{get:function(){Ot=!0}}),window.addEventListener("test",Et,Et),window.removeEventListener("test",Et,Et)}catch(ut){Ot=!1}function Rt(t,e,i,n,s,o,r,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(i,h)}catch(u){this.onError(u)}}var Bt=!1,It=null,zt=!1,jt=null,Vt={onError:function(t){Bt=!0,It=t}};function Ut(t,e,i,n,s,o,r,a,l){Bt=!1,It=null,Rt.apply(Vt,arguments)}function Xt(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function Kt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Gt(t){if(Xt(t)!==t)throw Error(o(188))}function Yt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Xt(t)))throw Error(o(188));return e!==t?null:t}for(var i=t,n=e;;){var s=i.return;if(null===s)break;var r=s.alternate;if(null===r){if(null!==(n=s.return)){i=n;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===i)return Gt(s),t;if(r===n)return Gt(s),e;r=r.sibling}throw Error(o(188))}if(i.return!==n.return)i=s,n=r;else{for(var a=!1,l=s.child;l;){if(l===i){a=!0,i=s,n=r;break}if(l===n){a=!0,n=s,i=r;break}l=l.sibling}if(!a){for(l=r.child;l;){if(l===i){a=!0,i=r,n=s;break}if(l===n){a=!0,n=r,i=s;break}l=l.sibling}if(!a)throw Error(o(189))}}if(i.alternate!==n)throw Error(o(190))}if(3!==i.tag)throw Error(o(188));return i.stateNode.current===i?t:e}(t))?qt(t):null}function qt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=qt(t);if(null!==e)return e;t=t.sibling}return null}var Ht=s.unstable_scheduleCallback,_t=s.unstable_cancelCallback,Wt=s.unstable_shouldYield,$t=s.unstable_requestPaint,Jt=s.unstable_now,Zt=s.unstable_getCurrentPriorityLevel,Qt=s.unstable_ImmediatePriority,te=s.unstable_UserBlockingPriority,ee=s.unstable_NormalPriority,ie=s.unstable_LowPriority,ne=s.unstable_IdlePriority,se=null,oe=null;var re=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(ae(t)/le|0)|0},ae=Math.log,le=Math.LN2;var he=64,ue=4194304;function ce(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var i=t.pendingLanes;if(0===i)return 0;var n=0,s=t.suspendedLanes,o=t.pingedLanes,r=268435455&i;if(0!==r){var a=r&~s;0!==a?n=ce(a):0!==(o&=r)&&(n=ce(o))}else 0!==(r=i&~s)?n=ce(r):0!==o&&(n=ce(o));if(0===n)return 0;if(0!==e&&e!==n&&0===(e&s)&&((s=n&-n)>=(o=e&-e)||16===s&&0!==(4194240&o)))return e;if(0!==(4&n)&&(n|=16&i),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=n;0<e;)s=1<<(i=31-re(e)),n|=t[i],e&=~s;return n}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function ge(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function pe(){var t=he;return 0===(4194240&(he<<=1))&&(he=64),t}function me(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function ye(t,e,i){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-re(e)]=i}function xe(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var n=31-re(i),s=1<<n;s&e|t[n]&e&&(t[n]|=e),i&=~s}}var ve=0;function be(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var we,ke,Se,Pe,Me,Ce=!1,Ne=[],Te=null,Le=null,Ae=null,De=new Map,Fe=new Map,Oe=[],Ee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Re(t,e){switch(t){case"focusin":case"focusout":Te=null;break;case"dragenter":case"dragleave":Le=null;break;case"mouseover":case"mouseout":Ae=null;break;case"pointerover":case"pointerout":De.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fe.delete(e.pointerId)}}function Be(t,e,i,n,s,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:i,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},null!==e&&(null!==(e=vs(e))&&ke(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,null!==s&&-1===e.indexOf(s)&&e.push(s),t)}function Ie(t){var e=xs(t.target);if(null!==e){var i=Xt(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=Kt(i)))return t.blockedOn=e,void Me(t.priority,(function(){Se(i)}))}else if(3===e&&i.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function ze(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=We(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==i)return null!==(e=vs(i))&&ke(e),t.blockedOn=i,!1;var n=new(i=t.nativeEvent).constructor(i.type,i);bt=n,i.target.dispatchEvent(n),bt=null,e.shift()}return!0}function je(t,e,i){ze(t)&&i.delete(e)}function Ve(){Ce=!1,null!==Te&&ze(Te)&&(Te=null),null!==Le&&ze(Le)&&(Le=null),null!==Ae&&ze(Ae)&&(Ae=null),De.forEach(je),Fe.forEach(je)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ve)))}function Xe(t){function e(e){return Ue(e,t)}if(0<Ne.length){Ue(Ne[0],t);for(var i=1;i<Ne.length;i++){var n=Ne[i];n.blockedOn===t&&(n.blockedOn=null)}}for(null!==Te&&Ue(Te,t),null!==Le&&Ue(Le,t),null!==Ae&&Ue(Ae,t),De.forEach(e),Fe.forEach(e),i=0;i<Oe.length;i++)(n=Oe[i]).blockedOn===t&&(n.blockedOn=null);for(;0<Oe.length&&null===(i=Oe[0]).blockedOn;)Ie(i),null===i.blockedOn&&Oe.shift()}var Ke=b.ReactCurrentBatchConfig,Ge=!0;function Ye(t,e,i,n){var s=ve,o=Ke.transition;Ke.transition=null;try{ve=1,He(t,e,i,n)}finally{ve=s,Ke.transition=o}}function qe(t,e,i,n){var s=ve,o=Ke.transition;Ke.transition=null;try{ve=4,He(t,e,i,n)}finally{ve=s,Ke.transition=o}}function He(t,e,i,n){if(Ge){var s=We(t,e,i,n);if(null===s)Gn(t,e,n,_e,i),Re(t,n);else if(function(t,e,i,n,s){switch(e){case"focusin":return Te=Be(Te,t,e,i,n,s),!0;case"dragenter":return Le=Be(Le,t,e,i,n,s),!0;case"mouseover":return Ae=Be(Ae,t,e,i,n,s),!0;case"pointerover":var o=s.pointerId;return De.set(o,Be(De.get(o)||null,t,e,i,n,s)),!0;case"gotpointercapture":return o=s.pointerId,Fe.set(o,Be(Fe.get(o)||null,t,e,i,n,s)),!0}return!1}(s,t,e,i,n))n.stopPropagation();else if(Re(t,n),4&e&&-1<Ee.indexOf(t)){for(;null!==s;){var o=vs(s);if(null!==o&&we(o),null===(o=We(t,e,i,n))&&Gn(t,e,n,_e,i),o===s)break;s=o}null!==s&&n.stopPropagation()}else Gn(t,e,n,null,i)}}var _e=null;function We(t,e,i,n){if(_e=null,null!==(t=xs(t=wt(n))))if(null===(e=Xt(t)))t=null;else if(13===(i=e.tag)){if(null!==(t=Kt(e)))return t;t=null}else if(3===i){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _e=t,null}function $e(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zt()){case Qt:return 1;case te:return 4;case ee:case ie:return 16;case ne:return 536870912;default:return 16}default:return 16}}var Je=null,Ze=null,Qe=null;function ti(){if(Qe)return Qe;var t,e,i=Ze,n=i.length,s="value"in Je?Je.value:Je.textContent,o=s.length;for(t=0;t<n&&i[t]===s[t];t++);var r=n-t;for(e=1;e<=r&&i[n-e]===s[o-e];e++);return Qe=s.slice(t,1<e?1-e:void 0)}function ei(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function ii(){return!0}function ni(){return!1}function si(t){function e(e,i,n,s,o){for(var r in this._reactName=e,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(r)&&(e=t[r],this[r]=e?e(s):s[r]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?ii:ni,this.isPropagationStopped=ni,this}return I(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),e}var oi,ri,ai,li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hi=si(li),ui=I({},li,{view:0,detail:0}),ci=si(ui),di=I({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pi,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ai&&(ai&&"mousemove"===t.type?(oi=t.screenX-ai.screenX,ri=t.screenY-ai.screenY):ri=oi=0,ai=t),oi)},movementY:function(t){return"movementY"in t?t.movementY:ri}}),fi=si(di),gi=si(I({},di,{dataTransfer:0})),pi=si(I({},ui,{relatedTarget:0})),mi=si(I({},li,{animationName:0,elapsedTime:0,pseudoElement:0})),yi=I({},li,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xi=si(yi),vi=si(I({},li,{data:0})),bi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ki={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Si(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=ki[t])&&!!e[t]}function Pi(){return Si}var Mi=I({},ui,{key:function(t){if(t.key){var e=bi[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ei(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wi[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pi,charCode:function(t){return"keypress"===t.type?ei(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ei(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Ci=si(Mi),Ni=si(I({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ti=si(I({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pi})),Li=si(I({},li,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ai=I({},di,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Di=si(Ai),Fi=[9,13,27,32],Oi=u&&"CompositionEvent"in window,Ei=null;u&&"documentMode"in document&&(Ei=document.documentMode);var Ri=u&&"TextEvent"in window&&!Ei,Bi=u&&(!Oi||Ei&&8<Ei&&11>=Ei),Ii=String.fromCharCode(32),zi=!1;function ji(t,e){switch(t){case"keyup":return-1!==Fi.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vi(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Ui=!1;var Xi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ki(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Xi[t.type]:"textarea"===e}function Gi(t,e,i,n){Ct(n),0<(e=qn(e,"onChange")).length&&(i=new hi("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var Yi=null,qi=null;function Hi(t){zn(t,0)}function _i(t){if(H(bs(t)))return t}function Wi(t,e){if("change"===t)return e}var $i=!1;if(u){var Ji;if(u){var Zi="oninput"in document;if(!Zi){var Qi=document.createElement("div");Qi.setAttribute("oninput","return;"),Zi="function"===typeof Qi.oninput}Ji=Zi}else Ji=!1;$i=Ji&&(!document.documentMode||9<document.documentMode)}function tn(){Yi&&(Yi.detachEvent("onpropertychange",en),qi=Yi=null)}function en(t){if("value"===t.propertyName&&_i(qi)){var e=[];Gi(e,qi,t,wt(t)),Dt(Hi,e)}}function nn(t,e,i){"focusin"===t?(tn(),qi=i,(Yi=e).attachEvent("onpropertychange",en)):"focusout"===t&&tn()}function sn(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return _i(qi)}function on(t,e){if("click"===t)return _i(e)}function rn(t,e){if("input"===t||"change"===t)return _i(e)}var an="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function ln(t,e){if(an(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var s=i[n];if(!c.call(e,s)||!an(t[s],e[s]))return!1}return!0}function hn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function un(t,e){var i,n=hn(t);for(t=0;n;){if(3===n.nodeType){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=hn(n)}}function cn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?cn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dn(){for(var t=window,e=_();e instanceof t.HTMLIFrameElement;){try{var i="string"===typeof e.contentWindow.location.href}catch(n){i=!1}if(!i)break;e=_((t=e.contentWindow).document)}return e}function fn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function gn(t){var e=dn(),i=t.focusedElem,n=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&cn(i.ownerDocument.documentElement,i)){if(null!==n&&fn(i))if(e=n.start,void 0===(t=n.end)&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if((t=(e=i.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var s=i.textContent.length,o=Math.min(n.start,s);n=void 0===n.end?o:Math.min(n.end,s),!t.extend&&o>n&&(s=n,n=o,o=s),s=un(i,o);var r=un(i,n);s&&r&&(1!==t.rangeCount||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==r.node||t.focusOffset!==r.offset)&&((e=e.createRange()).setStart(s.node,s.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(r.node,r.offset)):(e.setEnd(r.node,r.offset),t.addRange(e)))}for(e=[],t=i;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof i.focus&&i.focus(),i=0;i<e.length;i++)(t=e[i]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pn=u&&"documentMode"in document&&11>=document.documentMode,mn=null,yn=null,xn=null,vn=!1;function bn(t,e,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;vn||null==mn||mn!==_(n)||("selectionStart"in(n=mn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},xn&&ln(xn,n)||(xn=n,0<(n=qn(yn,"onSelect")).length&&(e=new hi("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=mn)))}function wn(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var kn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Sn={},Pn={};function Mn(t){if(Sn[t])return Sn[t];if(!kn[t])return t;var e,i=kn[t];for(e in i)if(i.hasOwnProperty(e)&&e in Pn)return Sn[t]=i[e];return t}u&&(Pn=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);var Cn=Mn("animationend"),Nn=Mn("animationiteration"),Tn=Mn("animationstart"),Ln=Mn("transitionend"),An=new Map,Dn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fn(t,e){An.set(t,e),l(e,[t])}for(var On=0;On<Dn.length;On++){var En=Dn[On];Fn(En.toLowerCase(),"on"+(En[0].toUpperCase()+En.slice(1)))}Fn(Cn,"onAnimationEnd"),Fn(Nn,"onAnimationIteration"),Fn(Tn,"onAnimationStart"),Fn("dblclick","onDoubleClick"),Fn("focusin","onFocus"),Fn("focusout","onBlur"),Fn(Ln,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rn));function In(t,e,i){var n=t.type||"unknown-event";t.currentTarget=i,function(t,e,i,n,s,r,a,l,h){if(Ut.apply(this,arguments),Bt){if(!Bt)throw Error(o(198));var u=It;Bt=!1,It=null,zt||(zt=!0,jt=u)}}(n,e,void 0,t),t.currentTarget=null}function zn(t,e){e=0!==(4&e);for(var i=0;i<t.length;i++){var n=t[i],s=n.event;n=n.listeners;t:{var o=void 0;if(e)for(var r=n.length-1;0<=r;r--){var a=n[r],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break t;In(s,a,h),o=l}else for(r=0;r<n.length;r++){if(l=(a=n[r]).instance,h=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break t;In(s,a,h),o=l}}}if(zt)throw t=jt,zt=!1,jt=null,t}function jn(t,e){var i=e[ps];void 0===i&&(i=e[ps]=new Set);var n=t+"__bubble";i.has(n)||(Kn(e,t,2,!1),i.add(n))}function Vn(t,e,i){var n=0;e&&(n|=4),Kn(i,t,n,e)}var Un="_reactListening"+Math.random().toString(36).slice(2);function Xn(t){if(!t[Un]){t[Un]=!0,r.forEach((function(e){"selectionchange"!==e&&(Bn.has(e)||Vn(e,!1,t),Vn(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Un]||(e[Un]=!0,Vn("selectionchange",!1,e))}}function Kn(t,e,i,n){switch($e(e)){case 1:var s=Ye;break;case 4:s=qe;break;default:s=He}i=s.bind(null,e,i,t),s=void 0,!Ot||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(s=!0),n?void 0!==s?t.addEventListener(e,i,{capture:!0,passive:s}):t.addEventListener(e,i,!0):void 0!==s?t.addEventListener(e,i,{passive:s}):t.addEventListener(e,i,!1)}function Gn(t,e,i,n,s){var o=n;if(0===(1&e)&&0===(2&e)&&null!==n)t:for(;;){if(null===n)return;var r=n.tag;if(3===r||4===r){var a=n.stateNode.containerInfo;if(a===s||8===a.nodeType&&a.parentNode===s)break;if(4===r)for(r=n.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;r=r.return}for(;null!==a;){if(null===(r=xs(a)))return;if(5===(l=r.tag)||6===l){n=o=r;continue t}a=a.parentNode}}n=n.return}Dt((function(){var n=o,s=wt(i),r=[];t:{var a=An.get(t);if(void 0!==a){var l=hi,h=t;switch(t){case"keypress":if(0===ei(i))break t;case"keydown":case"keyup":l=Ci;break;case"focusin":h="focus",l=pi;break;case"focusout":h="blur",l=pi;break;case"beforeblur":case"afterblur":l=pi;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ti;break;case Cn:case Nn:case Tn:l=mi;break;case Ln:l=Li;break;case"scroll":l=ci;break;case"wheel":l=Di;break;case"copy":case"cut":case"paste":l=xi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ni}var u=0!==(4&e),c=!u&&"scroll"===t,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,g=n;null!==g;){var p=(f=g).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==d&&(null!=(p=Ft(g,d))&&u.push(Yn(g,p,f)))),c)break;g=g.return}0<u.length&&(a=new l(a,h,null,i,s),r.push({event:a,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||i===bt||!(h=i.relatedTarget||i.fromElement)||!xs(h)&&!h[gs])&&(l||a)&&(a=s.window===s?s:(a=s.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(h=(h=i.relatedTarget||i.toElement)?xs(h):null)&&(h!==(c=Xt(h))||5!==h.tag&&6!==h.tag)&&(h=null)):(l=null,h=n),l!==h)){if(u=fi,p="onMouseLeave",d="onMouseEnter",g="mouse","pointerout"!==t&&"pointerover"!==t||(u=Ni,p="onPointerLeave",d="onPointerEnter",g="pointer"),c=null==l?a:bs(l),f=null==h?a:bs(h),(a=new u(p,g+"leave",l,i,s)).target=c,a.relatedTarget=f,p=null,xs(s)===n&&((u=new u(d,g+"enter",h,i,s)).target=f,u.relatedTarget=c,p=u),c=p,l&&h)t:{for(d=h,g=0,f=u=l;f;f=Hn(f))g++;for(f=0,p=d;p;p=Hn(p))f++;for(;0<g-f;)u=Hn(u),g--;for(;0<f-g;)d=Hn(d),f--;for(;g--;){if(u===d||null!==d&&u===d.alternate)break t;u=Hn(u),d=Hn(d)}u=null}else u=null;null!==l&&_n(r,a,l,u,!1),null!==h&&null!==c&&_n(r,c,h,u,!0)}if("select"===(l=(a=n?bs(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Wi;else if(Ki(a))if($i)m=rn;else{m=sn;var y=nn}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=on);switch(m&&(m=m(t,n))?Gi(r,m,i,s):(y&&y(t,a,n),"focusout"===t&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&tt(a,"number",a.value)),y=n?bs(n):window,t){case"focusin":(Ki(y)||"true"===y.contentEditable)&&(mn=y,yn=n,xn=null);break;case"focusout":xn=yn=mn=null;break;case"mousedown":vn=!0;break;case"contextmenu":case"mouseup":case"dragend":vn=!1,bn(r,i,s);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":bn(r,i,s)}var x;if(Oi)t:{switch(t){case"compositionstart":var v="onCompositionStart";break t;case"compositionend":v="onCompositionEnd";break t;case"compositionupdate":v="onCompositionUpdate";break t}v=void 0}else Ui?ji(t,i)&&(v="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(v="onCompositionStart");v&&(Bi&&"ko"!==i.locale&&(Ui||"onCompositionStart"!==v?"onCompositionEnd"===v&&Ui&&(x=ti()):(Ze="value"in(Je=s)?Je.value:Je.textContent,Ui=!0)),0<(y=qn(n,v)).length&&(v=new vi(v,t,null,i,s),r.push({event:v,listeners:y}),x?v.data=x:null!==(x=Vi(i))&&(v.data=x))),(x=Ri?function(t,e){switch(t){case"compositionend":return Vi(e);case"keypress":return 32!==e.which?null:(zi=!0,Ii);case"textInput":return(t=e.data)===Ii&&zi?null:t;default:return null}}(t,i):function(t,e){if(Ui)return"compositionend"===t||!Oi&&ji(t,e)?(t=ti(),Qe=Ze=Je=null,Ui=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bi&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(n=qn(n,"onBeforeInput")).length&&(s=new vi("onBeforeInput","beforeinput",null,i,s),r.push({event:s,listeners:n}),s.data=x))}zn(r,e)}))}function Yn(t,e,i){return{instance:t,listener:e,currentTarget:i}}function qn(t,e){for(var i=e+"Capture",n=[];null!==t;){var s=t,o=s.stateNode;5===s.tag&&null!==o&&(s=o,null!=(o=Ft(t,i))&&n.unshift(Yn(t,o,s)),null!=(o=Ft(t,e))&&n.push(Yn(t,o,s))),t=t.return}return n}function Hn(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function _n(t,e,i,n,s){for(var o=e._reactName,r=[];null!==i&&i!==n;){var a=i,l=a.alternate,h=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==h&&(a=h,s?null!=(l=Ft(i,o))&&r.unshift(Yn(i,l,a)):s||null!=(l=Ft(i,o))&&r.push(Yn(i,l,a))),i=i.return}0!==r.length&&t.push({event:e,listeners:r})}var Wn=/\r\n?/g,$n=/\u0000|\uFFFD/g;function Jn(t){return("string"===typeof t?t:""+t).replace(Wn,"\n").replace($n,"")}function Zn(t,e,i){if(e=Jn(e),Jn(t)!==e&&i)throw Error(o(425))}function Qn(){}var ts=null,es=null;function is(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ns="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,os="function"===typeof Promise?Promise:void 0,rs="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof os?function(t){return os.resolve(null).then(t).catch(as)}:ns;function as(t){setTimeout((function(){throw t}))}function ls(t,e){var i=e,n=0;do{var s=i.nextSibling;if(t.removeChild(i),s&&8===s.nodeType)if("/$"===(i=s.data)){if(0===n)return t.removeChild(s),void Xe(e);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=s}while(i);Xe(e)}function hs(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function us(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}var cs=Math.random().toString(36).slice(2),ds="__reactFiber$"+cs,fs="__reactProps$"+cs,gs="__reactContainer$"+cs,ps="__reactEvents$"+cs,ms="__reactListeners$"+cs,ys="__reactHandles$"+cs;function xs(t){var e=t[ds];if(e)return e;for(var i=t.parentNode;i;){if(e=i[gs]||i[ds]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=us(t);null!==t;){if(i=t[ds])return i;t=us(t)}return e}i=(t=i).parentNode}return null}function vs(t){return!(t=t[ds]||t[gs])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function bs(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function ws(t){return t[fs]||null}var ks=[],Ss=-1;function Ps(t){return{current:t}}function Ms(t){0>Ss||(t.current=ks[Ss],ks[Ss]=null,Ss--)}function Cs(t,e){Ss++,ks[Ss]=t.current,t.current=e}var Ns={},Ts=Ps(Ns),Ls=Ps(!1),As=Ns;function Ds(t,e){var i=t.type.contextTypes;if(!i)return Ns;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s,o={};for(s in i)o[s]=e[s];return n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Fs(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Os(){Ms(Ls),Ms(Ts)}function Es(t,e,i){if(Ts.current!==Ns)throw Error(o(168));Cs(Ts,e),Cs(Ls,i)}function Rs(t,e,i){var n=t.stateNode;if(e=e.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var s in n=n.getChildContext())if(!(s in e))throw Error(o(108,K(t)||"Unknown",s));return I({},i,n)}function Bs(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ns,As=Ts.current,Cs(Ts,t),Cs(Ls,Ls.current),!0}function Is(t,e,i){var n=t.stateNode;if(!n)throw Error(o(169));i?(t=Rs(t,e,As),n.__reactInternalMemoizedMergedChildContext=t,Ms(Ls),Ms(Ts),Cs(Ts,t)):Ms(Ls),Cs(Ls,i)}var zs=null,js=!1,Vs=!1;function Us(t){null===zs?zs=[t]:zs.push(t)}function Xs(){if(!Vs&&null!==zs){Vs=!0;var t=0,e=ve;try{var i=zs;for(ve=1;t<i.length;t++){var n=i[t];do{n=n(!0)}while(null!==n)}zs=null,js=!1}catch(s){throw null!==zs&&(zs=zs.slice(t+1)),Ht(Qt,Xs),s}finally{ve=e,Vs=!1}}return null}var Ks=[],Gs=0,Ys=null,qs=0,Hs=[],_s=0,Ws=null,$s=1,Js="";function Zs(t,e){Ks[Gs++]=qs,Ks[Gs++]=Ys,Ys=t,qs=e}function Qs(t,e,i){Hs[_s++]=$s,Hs[_s++]=Js,Hs[_s++]=Ws,Ws=t;var n=$s;t=Js;var s=32-re(n)-1;n&=~(1<<s),i+=1;var o=32-re(e)+s;if(30<o){var r=s-s%5;o=(n&(1<<r)-1).toString(32),n>>=r,s-=r,$s=1<<32-re(e)+s|i<<s|n,Js=o+t}else $s=1<<o|i<<s|n,Js=t}function to(t){null!==t.return&&(Zs(t,1),Qs(t,1,0))}function eo(t){for(;t===Ys;)Ys=Ks[--Gs],Ks[Gs]=null,qs=Ks[--Gs],Ks[Gs]=null;for(;t===Ws;)Ws=Hs[--_s],Hs[_s]=null,Js=Hs[--_s],Hs[_s]=null,$s=Hs[--_s],Hs[_s]=null}var io=null,no=null,so=!1,oo=null;function ro(t,e){var i=Dh(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,null===(e=t.deletions)?(t.deletions=[i],t.flags|=16):e.push(i)}function ao(t,e){switch(t.tag){case 5:var i=t.type;return null!==(e=1!==e.nodeType||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,io=t,no=hs(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,io=t,no=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(i=null!==Ws?{id:$s,overflow:Js}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},(i=Dh(18,null,null,0)).stateNode=e,i.return=t,t.child=i,io=t,no=null,!0);default:return!1}}function lo(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ho(t){if(so){var e=no;if(e){var i=e;if(!ao(t,e)){if(lo(t))throw Error(o(418));e=hs(i.nextSibling);var n=io;e&&ao(t,e)?ro(n,i):(t.flags=-4097&t.flags|2,so=!1,io=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,so=!1,io=t}}}function uo(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;io=t}function co(t){if(t!==io)return!1;if(!so)return uo(t),so=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!is(t.type,t.memoizedProps)),e&&(e=no)){if(lo(t))throw fo(),Error(o(418));for(;e;)ro(t,e),e=hs(e.nextSibling)}if(uo(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var i=t.data;if("/$"===i){if(0===e){no=hs(t.nextSibling);break t}e--}else"$"!==i&&"$!"!==i&&"$?"!==i||e++}t=t.nextSibling}no=null}}else no=io?hs(t.stateNode.nextSibling):null;return!0}function fo(){for(var t=no;t;)t=hs(t.nextSibling)}function go(){no=io=null,so=!1}function po(t){null===oo?oo=[t]:oo.push(t)}var mo=b.ReactCurrentBatchConfig;function yo(t,e,i){if(null!==(t=i.ref)&&"function"!==typeof t&&"object"!==typeof t){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(o(309));var n=i.stateNode}if(!n)throw Error(o(147,t));var s=n,r=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===r?e.ref:(e=function(t){var e=s.refs;null===t?delete e[r]:e[r]=t},e._stringRef=r,e)}if("string"!==typeof t)throw Error(o(284));if(!i._owner)throw Error(o(290,t))}return t}function xo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vo(t){return(0,t._init)(t._payload)}function bo(t){function e(e,i){if(t){var n=e.deletions;null===n?(e.deletions=[i],e.flags|=16):n.push(i)}}function i(i,n){if(!t)return null;for(;null!==n;)e(i,n),n=n.sibling;return null}function n(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function s(t,e){return(t=Oh(t,e)).index=0,t.sibling=null,t}function r(e,i,n){return e.index=n,t?null!==(n=e.alternate)?(n=n.index)<i?(e.flags|=2,i):n:(e.flags|=2,i):(e.flags|=1048576,i)}function a(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,i,n){return null===e||6!==e.tag?((e=Ih(i,t.mode,n)).return=t,e):((e=s(e,i)).return=t,e)}function h(t,e,i,n){var o=i.type;return o===S?c(t,e,i.props.children,n,i.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===F&&vo(o)===e.type)?((n=s(e,i.props)).ref=yo(t,e,i),n.return=t,n):((n=Eh(i.type,i.key,i.props,null,t.mode,n)).ref=yo(t,e,i),n.return=t,n)}function u(t,e,i,n){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=zh(i,t.mode,n)).return=t,e):((e=s(e,i.children||[])).return=t,e)}function c(t,e,i,n,o){return null===e||7!==e.tag?((e=Rh(i,t.mode,n,o)).return=t,e):((e=s(e,i)).return=t,e)}function d(t,e,i){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Ih(""+e,t.mode,i)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(i=Eh(e.type,e.key,e.props,null,t.mode,i)).ref=yo(t,null,e),i.return=t,i;case k:return(e=zh(e,t.mode,i)).return=t,e;case F:return d(t,(0,e._init)(e._payload),i)}if(et(e)||R(e))return(e=Rh(e,t.mode,i,null)).return=t,e;xo(t,e)}return null}function f(t,e,i,n){var s=null!==e?e.key:null;if("string"===typeof i&&""!==i||"number"===typeof i)return null!==s?null:l(t,e,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return i.key===s?h(t,e,i,n):null;case k:return i.key===s?u(t,e,i,n):null;case F:return f(t,e,(s=i._init)(i._payload),n)}if(et(i)||R(i))return null!==s?null:c(t,e,i,n,null);xo(t,i)}return null}function g(t,e,i,n,s){if("string"===typeof n&&""!==n||"number"===typeof n)return l(e,t=t.get(i)||null,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return h(e,t=t.get(null===n.key?i:n.key)||null,n,s);case k:return u(e,t=t.get(null===n.key?i:n.key)||null,n,s);case F:return g(t,e,i,(0,n._init)(n._payload),s)}if(et(n)||R(n))return c(e,t=t.get(i)||null,n,s,null);xo(e,n)}return null}function p(s,o,a,l){for(var h=null,u=null,c=o,p=o=0,m=null;null!==c&&p<a.length;p++){c.index>p?(m=c,c=null):m=c.sibling;var y=f(s,c,a[p],l);if(null===y){null===c&&(c=m);break}t&&c&&null===y.alternate&&e(s,c),o=r(y,o,p),null===u?h=y:u.sibling=y,u=y,c=m}if(p===a.length)return i(s,c),so&&Zs(s,p),h;if(null===c){for(;p<a.length;p++)null!==(c=d(s,a[p],l))&&(o=r(c,o,p),null===u?h=c:u.sibling=c,u=c);return so&&Zs(s,p),h}for(c=n(s,c);p<a.length;p++)null!==(m=g(c,s,p,a[p],l))&&(t&&null!==m.alternate&&c.delete(null===m.key?p:m.key),o=r(m,o,p),null===u?h=m:u.sibling=m,u=m);return t&&c.forEach((function(t){return e(s,t)})),so&&Zs(s,p),h}function m(s,a,l,h){var u=R(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var c=u=null,p=a,m=a=0,y=null,x=l.next();null!==p&&!x.done;m++,x=l.next()){p.index>m?(y=p,p=null):y=p.sibling;var v=f(s,p,x.value,h);if(null===v){null===p&&(p=y);break}t&&p&&null===v.alternate&&e(s,p),a=r(v,a,m),null===c?u=v:c.sibling=v,c=v,p=y}if(x.done)return i(s,p),so&&Zs(s,m),u;if(null===p){for(;!x.done;m++,x=l.next())null!==(x=d(s,x.value,h))&&(a=r(x,a,m),null===c?u=x:c.sibling=x,c=x);return so&&Zs(s,m),u}for(p=n(s,p);!x.done;m++,x=l.next())null!==(x=g(p,s,m,x.value,h))&&(t&&null!==x.alternate&&p.delete(null===x.key?m:x.key),a=r(x,a,m),null===c?u=x:c.sibling=x,c=x);return t&&p.forEach((function(t){return e(s,t)})),so&&Zs(s,m),u}return function t(n,o,r,l){if("object"===typeof r&&null!==r&&r.type===S&&null===r.key&&(r=r.props.children),"object"===typeof r&&null!==r){switch(r.$$typeof){case w:t:{for(var h=r.key,u=o;null!==u;){if(u.key===h){if((h=r.type)===S){if(7===u.tag){i(n,u.sibling),(o=s(u,r.props.children)).return=n,n=o;break t}}else if(u.elementType===h||"object"===typeof h&&null!==h&&h.$$typeof===F&&vo(h)===u.type){i(n,u.sibling),(o=s(u,r.props)).ref=yo(n,u,r),o.return=n,n=o;break t}i(n,u);break}e(n,u),u=u.sibling}r.type===S?((o=Rh(r.props.children,n.mode,l,r.key)).return=n,n=o):((l=Eh(r.type,r.key,r.props,null,n.mode,l)).ref=yo(n,o,r),l.return=n,n=l)}return a(n);case k:t:{for(u=r.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===r.containerInfo&&o.stateNode.implementation===r.implementation){i(n,o.sibling),(o=s(o,r.children||[])).return=n,n=o;break t}i(n,o);break}e(n,o),o=o.sibling}(o=zh(r,n.mode,l)).return=n,n=o}return a(n);case F:return t(n,o,(u=r._init)(r._payload),l)}if(et(r))return p(n,o,r,l);if(R(r))return m(n,o,r,l);xo(n,r)}return"string"===typeof r&&""!==r||"number"===typeof r?(r=""+r,null!==o&&6===o.tag?(i(n,o.sibling),(o=s(o,r)).return=n,n=o):(i(n,o),(o=Ih(r,n.mode,l)).return=n,n=o),a(n)):i(n,o)}}var wo=bo(!0),ko=bo(!1),So=Ps(null),Po=null,Mo=null,Co=null;function No(){Co=Mo=Po=null}function To(t){var e=So.current;Ms(So),t._currentValue=e}function Lo(t,e,i){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==n&&(n.childLanes|=e)):null!==n&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===i)break;t=t.return}}function Ao(t,e){Po=t,Co=Mo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(va=!0),t.firstContext=null)}function Do(t){var e=t._currentValue;if(Co!==t)if(t={context:t,memoizedValue:e,next:null},null===Mo){if(null===Po)throw Error(o(308));Mo=t,Po.dependencies={lanes:0,firstContext:t}}else Mo=Mo.next=t;return e}var Fo=null;function Oo(t){null===Fo?Fo=[t]:Fo.push(t)}function Eo(t,e,i,n){var s=e.interleaved;return null===s?(i.next=i,Oo(e)):(i.next=s.next,s.next=i),e.interleaved=i,Ro(t,n)}function Ro(t,e){t.lanes|=e;var i=t.alternate;for(null!==i&&(i.lanes|=e),i=t,t=t.return;null!==t;)t.childLanes|=e,null!==(i=t.alternate)&&(i.childLanes|=e),i=t,t=t.return;return 3===i.tag?i.stateNode:null}var Bo=!1;function Io(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function jo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vo(t,e,i){var n=t.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Tl)){var s=n.pending;return null===s?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Ro(t,i)}return null===(s=n.interleaved)?(e.next=e,Oo(n)):(e.next=s.next,s.next=e),n.interleaved=e,Ro(t,i)}function Uo(t,e,i){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&i))){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,xe(t,i)}}function Xo(t,e){var i=t.updateQueue,n=t.alternate;if(null!==n&&i===(n=n.updateQueue)){var s=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var r={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===o?s=o=r:o=o.next=r,i=i.next}while(null!==i);null===o?s=o=e:o=o.next=e}else s=o=e;return i={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function Ko(t,e,i,n){var s=t.updateQueue;Bo=!1;var o=s.firstBaseUpdate,r=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,h=l.next;l.next=null,null===r?o=h:r.next=h,r=l;var u=t.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==r&&(null===a?u.firstBaseUpdate=h:a.next=h,u.lastBaseUpdate=l))}if(null!==o){var c=s.baseState;for(r=0,u=h=l=null,a=o;;){var d=a.lane,f=a.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var g=t,p=a;switch(d=e,f=i,p.tag){case 1:if("function"===typeof(g=p.payload)){c=g.call(f,c,d);break t}c=g;break t;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(d="function"===typeof(g=p.payload)?g.call(f,c,d):g)||void 0===d)break t;c=I({},c,d);break t;case 2:Bo=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(d=s.effects)?s.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(h=u=f,l=c):u=u.next=f,r|=d;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(d=a).next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}if(null===u&&(l=c),s.baseState=l,s.firstBaseUpdate=h,s.lastBaseUpdate=u,null!==(e=s.shared.interleaved)){s=e;do{r|=s.lane,s=s.next}while(s!==e)}else null===o&&(s.shared.lanes=0);Bl|=r,t.lanes=r,t.memoizedState=c}}function Go(t,e,i){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(null!==s){if(n.callback=null,n=i,"function"!==typeof s)throw Error(o(191,s));s.call(n)}}}var Yo={},qo=Ps(Yo),Ho=Ps(Yo),_o=Ps(Yo);function Wo(t){if(t===Yo)throw Error(o(174));return t}function $o(t,e){switch(Cs(_o,e),Cs(Ho,t),Cs(qo,Yo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ms(qo),Cs(qo,e)}function Jo(){Ms(qo),Ms(Ho),Ms(_o)}function Zo(t){Wo(_o.current);var e=Wo(qo.current),i=lt(e,t.type);e!==i&&(Cs(Ho,t),Cs(qo,i))}function Qo(t){Ho.current===t&&(Ms(qo),Ms(Ho))}var tr=Ps(0);function er(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ir=[];function nr(){for(var t=0;t<ir.length;t++)ir[t]._workInProgressVersionPrimary=null;ir.length=0}var sr=b.ReactCurrentDispatcher,or=b.ReactCurrentBatchConfig,rr=0,ar=null,lr=null,hr=null,ur=!1,cr=!1,dr=0,fr=0;function gr(){throw Error(o(321))}function pr(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!an(t[i],e[i]))return!1;return!0}function mr(t,e,i,n,s,r){if(rr=r,ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sr.current=null===t||null===t.memoizedState?Qr:ta,t=i(n,s),cr){r=0;do{if(cr=!1,dr=0,25<=r)throw Error(o(301));r+=1,hr=lr=null,e.updateQueue=null,sr.current=ea,t=i(n,s)}while(cr)}if(sr.current=Zr,e=null!==lr&&null!==lr.next,rr=0,hr=lr=ar=null,ur=!1,e)throw Error(o(300));return t}function yr(){var t=0!==dr;return dr=0,t}function xr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===hr?ar.memoizedState=hr=t:hr=hr.next=t,hr}function vr(){if(null===lr){var t=ar.alternate;t=null!==t?t.memoizedState:null}else t=lr.next;var e=null===hr?ar.memoizedState:hr.next;if(null!==e)hr=e,lr=t;else{if(null===t)throw Error(o(310));t={memoizedState:(lr=t).memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},null===hr?ar.memoizedState=hr=t:hr=hr.next=t}return hr}function br(t,e){return"function"===typeof e?e(t):e}function wr(t){var e=vr(),i=e.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=t;var n=lr,s=n.baseQueue,r=i.pending;if(null!==r){if(null!==s){var a=s.next;s.next=r.next,r.next=a}n.baseQueue=s=r,i.pending=null}if(null!==s){r=s.next,n=n.baseState;var l=a=null,h=null,u=r;do{var c=u.lane;if((rr&c)===c)null!==h&&(h=h.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===h?(l=h=d,a=n):h=h.next=d,ar.lanes|=c,Bl|=c}u=u.next}while(null!==u&&u!==r);null===h?a=n:h.next=l,an(n,e.memoizedState)||(va=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=h,i.lastRenderedState=n}if(null!==(t=i.interleaved)){s=t;do{r=s.lane,ar.lanes|=r,Bl|=r,s=s.next}while(s!==t)}else null===s&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function kr(t){var e=vr(),i=e.queue;if(null===i)throw Error(o(311));i.lastRenderedReducer=t;var n=i.dispatch,s=i.pending,r=e.memoizedState;if(null!==s){i.pending=null;var a=s=s.next;do{r=t(r,a.action),a=a.next}while(a!==s);an(r,e.memoizedState)||(va=!0),e.memoizedState=r,null===e.baseQueue&&(e.baseState=r),i.lastRenderedState=r}return[r,n]}function Sr(){}function Pr(t,e){var i=ar,n=vr(),s=e(),r=!an(n.memoizedState,s);if(r&&(n.memoizedState=s,va=!0),n=n.queue,Br(Nr.bind(null,i,n,t),[t]),n.getSnapshot!==e||r||null!==hr&&1&hr.memoizedState.tag){if(i.flags|=2048,Dr(9,Cr.bind(null,i,n,s,e),void 0,null),null===Ll)throw Error(o(349));0!==(30&rr)||Mr(i,e,s)}return s}function Mr(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},null===(e=ar.updateQueue)?(e={lastEffect:null,stores:null},ar.updateQueue=e,e.stores=[t]):null===(i=e.stores)?e.stores=[t]:i.push(t)}function Cr(t,e,i,n){e.value=i,e.getSnapshot=n,Tr(e)&&Lr(t)}function Nr(t,e,i){return i((function(){Tr(e)&&Lr(t)}))}function Tr(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!an(t,i)}catch(n){return!0}}function Lr(t){var e=Ro(t,1);null!==e&&ih(e,t,1,-1)}function Ar(t){var e=xr();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:br,lastRenderedState:t},e.queue=t,t=t.dispatch=_r.bind(null,ar,t),[e.memoizedState,t]}function Dr(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},null===(e=ar.updateQueue)?(e={lastEffect:null,stores:null},ar.updateQueue=e,e.lastEffect=t.next=t):null===(i=e.lastEffect)?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t),t}function Fr(){return vr().memoizedState}function Or(t,e,i,n){var s=xr();ar.flags|=t,s.memoizedState=Dr(1|e,i,void 0,void 0===n?null:n)}function Er(t,e,i,n){var s=vr();n=void 0===n?null:n;var o=void 0;if(null!==lr){var r=lr.memoizedState;if(o=r.destroy,null!==n&&pr(n,r.deps))return void(s.memoizedState=Dr(e,i,o,n))}ar.flags|=t,s.memoizedState=Dr(1|e,i,o,n)}function Rr(t,e){return Or(8390656,8,t,e)}function Br(t,e){return Er(2048,8,t,e)}function Ir(t,e){return Er(4,2,t,e)}function zr(t,e){return Er(4,4,t,e)}function jr(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Vr(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Er(4,4,jr.bind(null,e,t),i)}function Ur(){}function Xr(t,e){var i=vr();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&pr(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function Kr(t,e){var i=vr();e=void 0===e?null:e;var n=i.memoizedState;return null!==n&&null!==e&&pr(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function Gr(t,e,i){return 0===(21&rr)?(t.baseState&&(t.baseState=!1,va=!0),t.memoizedState=i):(an(i,e)||(i=pe(),ar.lanes|=i,Bl|=i,t.baseState=!0),e)}function Yr(t,e){var i=ve;ve=0!==i&&4>i?i:4,t(!0);var n=or.transition;or.transition={};try{t(!1),e()}finally{ve=i,or.transition=n}}function qr(){return vr().memoizedState}function Hr(t,e,i){var n=eh(t);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},Wr(t))$r(e,i);else if(null!==(i=Eo(t,e,i,n))){ih(i,t,n,th()),Jr(i,e,n)}}function _r(t,e,i){var n=eh(t),s={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(Wr(t))$r(e,s);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var r=e.lastRenderedState,a=o(r,i);if(s.hasEagerState=!0,s.eagerState=a,an(a,r)){var l=e.interleaved;return null===l?(s.next=s,Oo(e)):(s.next=l.next,l.next=s),void(e.interleaved=s)}}catch(h){}null!==(i=Eo(t,e,s,n))&&(ih(i,t,n,s=th()),Jr(i,e,n))}}function Wr(t){var e=t.alternate;return t===ar||null!==e&&e===ar}function $r(t,e){cr=ur=!0;var i=t.pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function Jr(t,e,i){if(0!==(4194240&i)){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,xe(t,i)}}var Zr={readContext:Do,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},Qr={readContext:Do,useCallback:function(t,e){return xr().memoizedState=[t,void 0===e?null:e],t},useContext:Do,useEffect:Rr,useImperativeHandle:function(t,e,i){return i=null!==i&&void 0!==i?i.concat([t]):null,Or(4194308,4,jr.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Or(4194308,4,t,e)},useInsertionEffect:function(t,e){return Or(4,2,t,e)},useMemo:function(t,e){var i=xr();return e=void 0===e?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=xr();return e=void 0!==i?i(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Hr.bind(null,ar,t),[n.memoizedState,t]},useRef:function(t){return t={current:t},xr().memoizedState=t},useState:Ar,useDebugValue:Ur,useDeferredValue:function(t){return xr().memoizedState=t},useTransition:function(){var t=Ar(!1),e=t[0];return t=Yr.bind(null,t[1]),xr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var n=ar,s=xr();if(so){if(void 0===i)throw Error(o(407));i=i()}else{if(i=e(),null===Ll)throw Error(o(349));0!==(30&rr)||Mr(n,e,i)}s.memoizedState=i;var r={value:i,getSnapshot:e};return s.queue=r,Rr(Nr.bind(null,n,r,t),[t]),n.flags|=2048,Dr(9,Cr.bind(null,n,r,i,e),void 0,null),i},useId:function(){var t=xr(),e=Ll.identifierPrefix;if(so){var i=Js;e=":"+e+"R"+(i=($s&~(1<<32-re($s)-1)).toString(32)+i),0<(i=dr++)&&(e+="H"+i.toString(32)),e+=":"}else e=":"+e+"r"+(i=fr++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ta={readContext:Do,useCallback:Xr,useContext:Do,useEffect:Br,useImperativeHandle:Vr,useInsertionEffect:Ir,useLayoutEffect:zr,useMemo:Kr,useReducer:wr,useRef:Fr,useState:function(){return wr(br)},useDebugValue:Ur,useDeferredValue:function(t){return Gr(vr(),lr.memoizedState,t)},useTransition:function(){return[wr(br)[0],vr().memoizedState]},useMutableSource:Sr,useSyncExternalStore:Pr,useId:qr,unstable_isNewReconciler:!1},ea={readContext:Do,useCallback:Xr,useContext:Do,useEffect:Br,useImperativeHandle:Vr,useInsertionEffect:Ir,useLayoutEffect:zr,useMemo:Kr,useReducer:kr,useRef:Fr,useState:function(){return kr(br)},useDebugValue:Ur,useDeferredValue:function(t){var e=vr();return null===lr?e.memoizedState=t:Gr(e,lr.memoizedState,t)},useTransition:function(){return[kr(br)[0],vr().memoizedState]},useMutableSource:Sr,useSyncExternalStore:Pr,useId:qr,unstable_isNewReconciler:!1};function ia(t,e){if(t&&t.defaultProps){for(var i in e=I({},e),t=t.defaultProps)void 0===e[i]&&(e[i]=t[i]);return e}return e}function na(t,e,i,n){i=null===(i=i(n,e=t.memoizedState))||void 0===i?e:I({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}var sa={isMounted:function(t){return!!(t=t._reactInternals)&&Xt(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=th(),s=eh(t),o=jo(n,s);o.payload=e,void 0!==i&&null!==i&&(o.callback=i),null!==(e=Vo(t,o,s))&&(ih(e,t,s,n),Uo(e,t,s))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=th(),s=eh(t),o=jo(n,s);o.tag=1,o.payload=e,void 0!==i&&null!==i&&(o.callback=i),null!==(e=Vo(t,o,s))&&(ih(e,t,s,n),Uo(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=th(),n=eh(t),s=jo(i,n);s.tag=2,void 0!==e&&null!==e&&(s.callback=e),null!==(e=Vo(t,s,n))&&(ih(e,t,n,i),Uo(e,t,n))}};function oa(t,e,i,n,s,o,r){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(n,o,r):!e.prototype||!e.prototype.isPureReactComponent||(!ln(i,n)||!ln(s,o))}function ra(t,e,i){var n=!1,s=Ns,o=e.contextType;return"object"===typeof o&&null!==o?o=Do(o):(s=Fs(e)?As:Ts.current,o=(n=null!==(n=e.contextTypes)&&void 0!==n)?Ds(t,s):Ns),e=new e(i,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=sa,t.stateNode=e,e._reactInternals=t,n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function aa(t,e,i,n){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,n),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&sa.enqueueReplaceState(e,e.state,null)}function la(t,e,i,n){var s=t.stateNode;s.props=i,s.state=t.memoizedState,s.refs={},Io(t);var o=e.contextType;"object"===typeof o&&null!==o?s.context=Do(o):(o=Fs(e)?As:Ts.current,s.context=Ds(t,o)),s.state=t.memoizedState,"function"===typeof(o=e.getDerivedStateFromProps)&&(na(t,e,o,i),s.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(e=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),e!==s.state&&sa.enqueueReplaceState(s,s.state,null),Ko(t,i,s,n),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308)}function ha(t,e){try{var i="",n=e;do{i+=U(n),n=n.return}while(n);var s=i}catch(o){s="\nError generating stack: "+o.message+"\n"+o.stack}return{value:t,source:e,stack:s,digest:null}}function ua(t,e,i){return{value:t,source:null,stack:null!=i?i:null,digest:null!=e?e:null}}function ca(t,e){try{console.error(e.value)}catch(i){setTimeout((function(){throw i}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(t,e,i){(i=jo(-1,i)).tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){Gl||(Gl=!0,Yl=n),ca(0,e)},i}function ga(t,e,i){(i=jo(-1,i)).tag=3;var n=t.type.getDerivedStateFromError;if("function"===typeof n){var s=e.value;i.payload=function(){return n(s)},i.callback=function(){ca(0,e)}}var o=t.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(i.callback=function(){ca(0,e),"function"!==typeof n&&(null===ql?ql=new Set([this]):ql.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),i}function pa(t,e,i){var n=t.pingCache;if(null===n){n=t.pingCache=new da;var s=new Set;n.set(e,s)}else void 0===(s=n.get(e))&&(s=new Set,n.set(e,s));s.has(i)||(s.add(i),t=Mh.bind(null,t,e,i),e.then(t,t))}function ma(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ya(t,e,i,n,s){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((e=jo(-1,1)).tag=2,Vo(i,e,1))),i.lanes|=1),t):(t.flags|=65536,t.lanes=s,t)}var xa=b.ReactCurrentOwner,va=!1;function ba(t,e,i,n){e.child=null===t?ko(e,null,i,n):wo(e,t.child,i,n)}function wa(t,e,i,n,s){i=i.render;var o=e.ref;return Ao(e,s),n=mr(t,e,i,n,o,s),i=yr(),null===t||va?(so&&i&&to(e),e.flags|=1,ba(t,e,n,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ga(t,e,s))}function ka(t,e,i,n,s){if(null===t){var o=i.type;return"function"!==typeof o||Fh(o)||void 0!==o.defaultProps||null!==i.compare||void 0!==i.defaultProps?((t=Eh(i.type,null,n,e,e.mode,s)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Sa(t,e,o,n,s))}if(o=t.child,0===(t.lanes&s)){var r=o.memoizedProps;if((i=null!==(i=i.compare)?i:ln)(r,n)&&t.ref===e.ref)return Ga(t,e,s)}return e.flags|=1,(t=Oh(o,n)).ref=e.ref,t.return=e,e.child=t}function Sa(t,e,i,n,s){if(null!==t){var o=t.memoizedProps;if(ln(o,n)&&t.ref===e.ref){if(va=!1,e.pendingProps=n=o,0===(t.lanes&s))return e.lanes=t.lanes,Ga(t,e,s);0!==(131072&t.flags)&&(va=!0)}}return Ca(t,e,i,n,s)}function Pa(t,e,i){var n=e.pendingProps,s=n.children,o=null!==t?t.memoizedState:null;if("hidden"===n.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cs(Ol,Fl),Fl|=i;else{if(0===(1073741824&i))return t=null!==o?o.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Cs(Ol,Fl),Fl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:i,Cs(Ol,Fl),Fl|=n}else null!==o?(n=o.baseLanes|i,e.memoizedState=null):n=i,Cs(Ol,Fl),Fl|=n;return ba(t,e,s,i),e.child}function Ma(t,e){var i=e.ref;(null===t&&null!==i||null!==t&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function Ca(t,e,i,n,s){var o=Fs(i)?As:Ts.current;return o=Ds(e,o),Ao(e,s),i=mr(t,e,i,n,o,s),n=yr(),null===t||va?(so&&n&&to(e),e.flags|=1,ba(t,e,i,s),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ga(t,e,s))}function Na(t,e,i,n,s){if(Fs(i)){var o=!0;Bs(e)}else o=!1;if(Ao(e,s),null===e.stateNode)Ka(t,e),ra(e,i,n),la(e,i,n,s),n=!0;else if(null===t){var r=e.stateNode,a=e.memoizedProps;r.props=a;var l=r.context,h=i.contextType;"object"===typeof h&&null!==h?h=Do(h):h=Ds(e,h=Fs(i)?As:Ts.current);var u=i.getDerivedStateFromProps,c="function"===typeof u||"function"===typeof r.getSnapshotBeforeUpdate;c||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(a!==n||l!==h)&&aa(e,r,n,h),Bo=!1;var d=e.memoizedState;r.state=d,Ko(e,n,r,s),l=e.memoizedState,a!==n||d!==l||Ls.current||Bo?("function"===typeof u&&(na(e,i,u,n),l=e.memoizedState),(a=Bo||oa(e,i,a,n,d,l,h))?(c||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||("function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"===typeof r.componentDidMount&&(e.flags|=4194308)):("function"===typeof r.componentDidMount&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),r.props=n,r.state=l,r.context=h,n=a):("function"===typeof r.componentDidMount&&(e.flags|=4194308),n=!1)}else{r=e.stateNode,zo(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:ia(e.type,a),r.props=h,c=e.pendingProps,d=r.context,"object"===typeof(l=i.contextType)&&null!==l?l=Do(l):l=Ds(e,l=Fs(i)?As:Ts.current);var f=i.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof r.getSnapshotBeforeUpdate)||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(a!==c||d!==l)&&aa(e,r,n,l),Bo=!1,d=e.memoizedState,r.state=d,Ko(e,n,r,s);var g=e.memoizedState;a!==c||d!==g||Ls.current||Bo?("function"===typeof f&&(na(e,i,f,n),g=e.memoizedState),(h=Bo||oa(e,i,h,n,d,g,l)||!1)?(u||"function"!==typeof r.UNSAFE_componentWillUpdate&&"function"!==typeof r.componentWillUpdate||("function"===typeof r.componentWillUpdate&&r.componentWillUpdate(n,g,l),"function"===typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(n,g,l)),"function"===typeof r.componentDidUpdate&&(e.flags|=4),"function"===typeof r.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof r.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),r.props=n,r.state=g,r.context=l,n=h):("function"!==typeof r.componentDidUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Ta(t,e,i,n,o,s)}function Ta(t,e,i,n,s,o){Ma(t,e);var r=0!==(128&e.flags);if(!n&&!r)return s&&Is(e,i,!1),Ga(t,e,o);n=e.stateNode,xa.current=e;var a=r&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return e.flags|=1,null!==t&&r?(e.child=wo(e,t.child,null,o),e.child=wo(e,null,a,o)):ba(t,e,a,o),e.memoizedState=n.state,s&&Is(e,i,!0),e.child}function La(t){var e=t.stateNode;e.pendingContext?Es(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Es(0,e.context,!1),$o(t,e.containerInfo)}function Aa(t,e,i,n,s){return go(),po(s),e.flags|=256,ba(t,e,i,n),e.child}var Da,Fa,Oa,Ea,Ra={dehydrated:null,treeContext:null,retryLane:0};function Ba(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ia(t,e,i){var n,s=e.pendingProps,r=tr.current,a=!1,l=0!==(128&e.flags);if((n=l)||(n=(null===t||null!==t.memoizedState)&&0!==(2&r)),n?(a=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(r|=1),Cs(tr,1&r),null===t)return ho(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=s.children,t=s.fallback,a?(s=e.mode,a=e.child,l={mode:"hidden",children:l},0===(1&s)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Bh(l,s,0,null),t=Rh(t,s,i,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Ba(i),e.memoizedState=Ra,t):za(e,l));if(null!==(r=t.memoizedState)&&null!==(n=r.dehydrated))return function(t,e,i,n,s,r,a){if(i)return 256&e.flags?(e.flags&=-257,ja(t,e,a,n=ua(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(r=n.fallback,s=e.mode,n=Bh({mode:"visible",children:n.children},s,0,null),(r=Rh(r,s,a,null)).flags|=2,n.return=e,r.return=e,n.sibling=r,e.child=n,0!==(1&e.mode)&&wo(e,t.child,null,a),e.child.memoizedState=Ba(a),e.memoizedState=Ra,r);if(0===(1&e.mode))return ja(t,e,a,null);if("$!"===s.data){if(n=s.nextSibling&&s.nextSibling.dataset)var l=n.dgst;return n=l,ja(t,e,a,n=ua(r=Error(o(419)),n,void 0))}if(l=0!==(a&t.childLanes),va||l){if(null!==(n=Ll)){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(n.suspendedLanes|a))?0:s)&&s!==r.retryLane&&(r.retryLane=s,Ro(t,s),ih(n,t,s,-1))}return ph(),ja(t,e,a,n=ua(Error(o(421))))}return"$?"===s.data?(e.flags|=128,e.child=t.child,e=Nh.bind(null,t),s._reactRetry=e,null):(t=r.treeContext,no=hs(s.nextSibling),io=e,so=!0,oo=null,null!==t&&(Hs[_s++]=$s,Hs[_s++]=Js,Hs[_s++]=Ws,$s=t.id,Js=t.overflow,Ws=e),e=za(e,n.children),e.flags|=4096,e)}(t,e,l,s,n,r,i);if(a){a=s.fallback,l=e.mode,n=(r=t.child).sibling;var h={mode:"hidden",children:s.children};return 0===(1&l)&&e.child!==r?((s=e.child).childLanes=0,s.pendingProps=h,e.deletions=null):(s=Oh(r,h)).subtreeFlags=14680064&r.subtreeFlags,null!==n?a=Oh(n,a):(a=Rh(a,l,i,null)).flags|=2,a.return=e,s.return=e,s.sibling=a,e.child=s,s=a,a=e.child,l=null===(l=t.child.memoizedState)?Ba(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=t.childLanes&~i,e.memoizedState=Ra,s}return t=(a=t.child).sibling,s=Oh(a,{mode:"visible",children:s.children}),0===(1&e.mode)&&(s.lanes=i),s.return=e,s.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=s,e.memoizedState=null,s}function za(t,e){return(e=Bh({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function ja(t,e,i,n){return null!==n&&po(n),wo(e,t.child,null,i),(t=za(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Va(t,e,i){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),Lo(t.return,e,i)}function Ua(t,e,i,n,s){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailMode=s)}function Xa(t,e,i){var n=e.pendingProps,s=n.revealOrder,o=n.tail;if(ba(t,e,n.children,i),0!==(2&(n=tr.current)))n=1&n|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Va(t,i,e);else if(19===t.tag)Va(t,i,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Cs(tr,n),0===(1&e.mode))e.memoizedState=null;else switch(s){case"forwards":for(i=e.child,s=null;null!==i;)null!==(t=i.alternate)&&null===er(t)&&(s=i),i=i.sibling;null===(i=s)?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),Ua(e,!1,s,i,o);break;case"backwards":for(i=null,s=e.child,e.child=null;null!==s;){if(null!==(t=s.alternate)&&null===er(t)){e.child=s;break}t=s.sibling,s.sibling=i,i=s,s=t}Ua(e,!0,i,null,o);break;case"together":Ua(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ka(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ga(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),Bl|=e.lanes,0===(i&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(i=Oh(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Oh(t,t.pendingProps)).return=e;i.sibling=null}return e.child}function Ya(t,e){if(!so)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?e||null===t.tail?t.tail=null:t.tail.sibling=null:n.sibling=null}}function qa(t){var e=null!==t.alternate&&t.alternate.child===t.child,i=0,n=0;if(e)for(var s=t.child;null!==s;)i|=s.lanes|s.childLanes,n|=14680064&s.subtreeFlags,n|=14680064&s.flags,s.return=t,s=s.sibling;else for(s=t.child;null!==s;)i|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=i,e}function Ha(t,e,i){var n=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qa(e),null;case 1:case 17:return Fs(e.type)&&Os(),qa(e),null;case 3:return n=e.stateNode,Jo(),Ms(Ls),Ms(Ts),nr(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||(co(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==oo&&(rh(oo),oo=null))),Fa(t,e),qa(e),null;case 5:Qo(e);var s=Wo(_o.current);if(i=e.type,null!==t&&null!=e.stateNode)Oa(t,e,i,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(null===e.stateNode)throw Error(o(166));return qa(e),null}if(t=Wo(qo.current),co(e)){n=e.stateNode,i=e.type;var r=e.memoizedProps;switch(n[ds]=e,n[fs]=r,t=0!==(1&e.mode),i){case"dialog":jn("cancel",n),jn("close",n);break;case"iframe":case"object":case"embed":jn("load",n);break;case"video":case"audio":for(s=0;s<Rn.length;s++)jn(Rn[s],n);break;case"source":jn("error",n);break;case"img":case"image":case"link":jn("error",n),jn("load",n);break;case"details":jn("toggle",n);break;case"input":$(n,r),jn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!r.multiple},jn("invalid",n);break;case"textarea":st(n,r),jn("invalid",n)}for(var l in xt(i,r),s=null,r)if(r.hasOwnProperty(l)){var h=r[l];"children"===l?"string"===typeof h?n.textContent!==h&&(!0!==r.suppressHydrationWarning&&Zn(n.textContent,h,t),s=["children",h]):"number"===typeof h&&n.textContent!==""+h&&(!0!==r.suppressHydrationWarning&&Zn(n.textContent,h,t),s=["children",""+h]):a.hasOwnProperty(l)&&null!=h&&"onScroll"===l&&jn("scroll",n)}switch(i){case"input":q(n),Q(n,r,!0);break;case"textarea":q(n),rt(n);break;case"select":case"option":break;default:"function"===typeof r.onClick&&(n.onclick=Qn)}n=s,e.updateQueue=n,null!==n&&(e.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=at(i)),"http://www.w3.org/1999/xhtml"===t?"script"===i?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof n.is?t=l.createElement(i,{is:n.is}):(t=l.createElement(i),"select"===i&&(l=t,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):t=l.createElementNS(t,i),t[ds]=e,t[fs]=n,Da(t,e,!1,!1),e.stateNode=t;t:{switch(l=vt(i,n),i){case"dialog":jn("cancel",t),jn("close",t),s=n;break;case"iframe":case"object":case"embed":jn("load",t),s=n;break;case"video":case"audio":for(s=0;s<Rn.length;s++)jn(Rn[s],t);s=n;break;case"source":jn("error",t),s=n;break;case"img":case"image":case"link":jn("error",t),jn("load",t),s=n;break;case"details":jn("toggle",t),s=n;break;case"input":$(t,n),s=W(t,n),jn("invalid",t);break;case"option":default:s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=I({},n,{value:void 0}),jn("invalid",t);break;case"textarea":st(t,n),s=nt(t,n),jn("invalid",t)}for(r in xt(i,s),h=s)if(h.hasOwnProperty(r)){var u=h[r];"style"===r?mt(t,u):"dangerouslySetInnerHTML"===r?null!=(u=u?u.__html:void 0)&&ct(t,u):"children"===r?"string"===typeof u?("textarea"!==i||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(a.hasOwnProperty(r)?null!=u&&"onScroll"===r&&jn("scroll",t):null!=u&&v(t,r,u,l))}switch(i){case"input":q(t),Q(t,n,!1);break;case"textarea":q(t),rt(t);break;case"option":null!=n.value&&t.setAttribute("value",""+G(n.value));break;case"select":t.multiple=!!n.multiple,null!=(r=n.value)?it(t,!!n.multiple,r,!1):null!=n.defaultValue&&it(t,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof s.onClick&&(t.onclick=Qn)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break t;case"img":n=!0;break t;default:n=!1}}n&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return qa(e),null;case 6:if(t&&null!=e.stateNode)Ea(t,e,t.memoizedProps,n);else{if("string"!==typeof n&&null===e.stateNode)throw Error(o(166));if(i=Wo(_o.current),Wo(qo.current),co(e)){if(n=e.stateNode,i=e.memoizedProps,n[ds]=e,(r=n.nodeValue!==i)&&null!==(t=io))switch(t.tag){case 3:Zn(n.nodeValue,i,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Zn(n.nodeValue,i,0!==(1&t.mode))}r&&(e.flags|=4)}else(n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[ds]=e,e.stateNode=n}return qa(e),null;case 13:if(Ms(tr),n=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(so&&null!==no&&0!==(1&e.mode)&&0===(128&e.flags))fo(),go(),e.flags|=98560,r=!1;else if(r=co(e),null!==n&&null!==n.dehydrated){if(null===t){if(!r)throw Error(o(318));if(!(r=null!==(r=e.memoizedState)?r.dehydrated:null))throw Error(o(317));r[ds]=e}else go(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;qa(e),r=!1}else null!==oo&&(rh(oo),oo=null),r=!0;if(!r)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=i,e):((n=null!==n)!==(null!==t&&null!==t.memoizedState)&&n&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&tr.current)?0===El&&(El=3):ph())),null!==e.updateQueue&&(e.flags|=4),qa(e),null);case 4:return Jo(),Fa(t,e),null===t&&Xn(e.stateNode.containerInfo),qa(e),null;case 10:return To(e.type._context),qa(e),null;case 19:if(Ms(tr),null===(r=e.memoizedState))return qa(e),null;if(n=0!==(128&e.flags),null===(l=r.rendering))if(n)Ya(r,!1);else{if(0!==El||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=er(t))){for(e.flags|=128,Ya(r,!1),null!==(n=l.updateQueue)&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=i,i=e.child;null!==i;)t=n,(r=i).flags&=14680066,null===(l=r.alternate)?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,t=l.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Cs(tr,1&tr.current|2),e.child}t=t.sibling}null!==r.tail&&Jt()>Xl&&(e.flags|=128,n=!0,Ya(r,!1),e.lanes=4194304)}else{if(!n)if(null!==(t=er(l))){if(e.flags|=128,n=!0,null!==(i=t.updateQueue)&&(e.updateQueue=i,e.flags|=4),Ya(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!so)return qa(e),null}else 2*Jt()-r.renderingStartTime>Xl&&1073741824!==i&&(e.flags|=128,n=!0,Ya(r,!1),e.lanes=4194304);r.isBackwards?(l.sibling=e.child,e.child=l):(null!==(i=r.last)?i.sibling=l:e.child=l,r.last=l)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Jt(),e.sibling=null,i=tr.current,Cs(tr,n?1&i|2:1&i),e):(qa(e),null);case 22:case 23:return ch(),n=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==n&&(e.flags|=8192),n&&0!==(1&e.mode)?0!==(1073741824&Fl)&&(qa(e),6&e.subtreeFlags&&(e.flags|=8192)):qa(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function _a(t,e){switch(eo(e),e.tag){case 1:return Fs(e.type)&&Os(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Jo(),Ms(Ls),Ms(Ts),nr(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Qo(e),null;case 13:if(Ms(tr),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));go()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ms(tr),null;case 4:return Jo(),null;case 10:return To(e.type._context),null;case 22:case 23:return ch(),null;default:return null}}Da=function(t,e){for(var i=e.child;null!==i;){if(5===i.tag||6===i.tag)t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Fa=function(){},Oa=function(t,e,i,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Wo(qo.current);var o,r=null;switch(i){case"input":s=W(t,s),n=W(t,n),r=[];break;case"select":s=I({},s,{value:void 0}),n=I({},n,{value:void 0}),r=[];break;case"textarea":s=nt(t,s),n=nt(t,n),r=[];break;default:"function"!==typeof s.onClick&&"function"===typeof n.onClick&&(t.onclick=Qn)}for(u in xt(i,n),i=null,s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in n){var h=n[u];if(l=null!=s?s[u]:void 0,n.hasOwnProperty(u)&&h!==l&&(null!=h||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||h&&h.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in h)h.hasOwnProperty(o)&&l[o]!==h[o]&&(i||(i={}),i[o]=h[o])}else i||(r||(r=[]),r.push(u,i)),i=h;else"dangerouslySetInnerHTML"===u?(h=h?h.__html:void 0,l=l?l.__html:void 0,null!=h&&l!==h&&(r=r||[]).push(u,h)):"children"===u?"string"!==typeof h&&"number"!==typeof h||(r=r||[]).push(u,""+h):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=h&&"onScroll"===u&&jn("scroll",t),r||l===h||(r=[])):(r=r||[]).push(u,h))}i&&(r=r||[]).push("style",i);var u=r;(e.updateQueue=u)&&(e.flags|=4)}},Ea=function(t,e,i,n){i!==n&&(e.flags|=4)};var Wa=!1,$a=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Za=null;function Qa(t,e){var i=t.ref;if(null!==i)if("function"===typeof i)try{i(null)}catch(n){Ph(t,e,n)}else i.current=null}function tl(t,e,i){try{i()}catch(n){Ph(t,e,n)}}var el=!1;function il(t,e,i){var n=e.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var s=n=n.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,void 0!==o&&tl(e,i,o)}s=s.next}while(s!==n)}}function nl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function sl(t){var e=t.ref;if(null!==e){var i=t.stateNode;t.tag,t=i,"function"===typeof e?e(t):e.current=t}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[ds],delete e[fs],delete e[ps],delete e[ms],delete e[ys])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rl(t){return 5===t.tag||3===t.tag||4===t.tag}function al(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||rl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!==(i=i._reactRootContainer)&&void 0!==i||null!==e.onclick||(e.onclick=Qn));else if(4!==n&&null!==(t=t.child))for(ll(t,e,i),t=t.sibling;null!==t;)ll(t,e,i),t=t.sibling}function hl(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==n&&null!==(t=t.child))for(hl(t,e,i),t=t.sibling;null!==t;)hl(t,e,i),t=t.sibling}var ul=null,cl=!1;function dl(t,e,i){for(i=i.child;null!==i;)fl(t,e,i),i=i.sibling}function fl(t,e,i){if(oe&&"function"===typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(se,i)}catch(a){}switch(i.tag){case 5:$a||Qa(i,e);case 6:var n=ul,s=cl;ul=null,dl(t,e,i),cl=s,null!==(ul=n)&&(cl?(t=ul,i=i.stateNode,8===t.nodeType?t.parentNode.removeChild(i):t.removeChild(i)):ul.removeChild(i.stateNode));break;case 18:null!==ul&&(cl?(t=ul,i=i.stateNode,8===t.nodeType?ls(t.parentNode,i):1===t.nodeType&&ls(t,i),Xe(t)):ls(ul,i.stateNode));break;case 4:n=ul,s=cl,ul=i.stateNode.containerInfo,cl=!0,dl(t,e,i),ul=n,cl=s;break;case 0:case 11:case 14:case 15:if(!$a&&(null!==(n=i.updateQueue)&&null!==(n=n.lastEffect))){s=n=n.next;do{var o=s,r=o.destroy;o=o.tag,void 0!==r&&(0!==(2&o)||0!==(4&o))&&tl(i,e,r),s=s.next}while(s!==n)}dl(t,e,i);break;case 1:if(!$a&&(Qa(i,e),"function"===typeof(n=i.stateNode).componentWillUnmount))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(a){Ph(i,e,a)}dl(t,e,i);break;case 21:dl(t,e,i);break;case 22:1&i.mode?($a=(n=$a)||null!==i.memoizedState,dl(t,e,i),$a=n):dl(t,e,i);break;default:dl(t,e,i)}}function gl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var i=t.stateNode;null===i&&(i=t.stateNode=new Ja),e.forEach((function(e){var n=Th.bind(null,t,e);i.has(e)||(i.add(e),e.then(n,n))}))}}function pl(t,e){var i=e.deletions;if(null!==i)for(var n=0;n<i.length;n++){var s=i[n];try{var r=t,a=e,l=a;t:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,cl=!1;break t;case 3:case 4:ul=l.stateNode.containerInfo,cl=!0;break t}l=l.return}if(null===ul)throw Error(o(160));fl(r,a,s),ul=null,cl=!1;var h=s.alternate;null!==h&&(h.return=null),s.return=null}catch(u){Ph(s,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)ml(e,t),e=e.sibling}function ml(t,e){var i=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(pl(e,t),yl(t),4&n){try{il(3,t,t.return),nl(3,t)}catch(m){Ph(t,t.return,m)}try{il(5,t,t.return)}catch(m){Ph(t,t.return,m)}}break;case 1:pl(e,t),yl(t),512&n&&null!==i&&Qa(i,i.return);break;case 5:if(pl(e,t),yl(t),512&n&&null!==i&&Qa(i,i.return),32&t.flags){var s=t.stateNode;try{dt(s,"")}catch(m){Ph(t,t.return,m)}}if(4&n&&null!=(s=t.stateNode)){var r=t.memoizedProps,a=null!==i?i.memoizedProps:r,l=t.type,h=t.updateQueue;if(t.updateQueue=null,null!==h)try{"input"===l&&"radio"===r.type&&null!=r.name&&J(s,r),vt(l,a);var u=vt(l,r);for(a=0;a<h.length;a+=2){var c=h[a],d=h[a+1];"style"===c?mt(s,d):"dangerouslySetInnerHTML"===c?ct(s,d):"children"===c?dt(s,d):v(s,c,d,u)}switch(l){case"input":Z(s,r);break;case"textarea":ot(s,r);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var g=r.value;null!=g?it(s,!!r.multiple,g,!1):f!==!!r.multiple&&(null!=r.defaultValue?it(s,!!r.multiple,r.defaultValue,!0):it(s,!!r.multiple,r.multiple?[]:"",!1))}s[fs]=r}catch(m){Ph(t,t.return,m)}}break;case 6:if(pl(e,t),yl(t),4&n){if(null===t.stateNode)throw Error(o(162));s=t.stateNode,r=t.memoizedProps;try{s.nodeValue=r}catch(m){Ph(t,t.return,m)}}break;case 3:if(pl(e,t),yl(t),4&n&&null!==i&&i.memoizedState.isDehydrated)try{Xe(e.containerInfo)}catch(m){Ph(t,t.return,m)}break;case 4:default:pl(e,t),yl(t);break;case 13:pl(e,t),yl(t),8192&(s=t.child).flags&&(r=null!==s.memoizedState,s.stateNode.isHidden=r,!r||null!==s.alternate&&null!==s.alternate.memoizedState||(Ul=Jt())),4&n&&gl(t);break;case 22:if(c=null!==i&&null!==i.memoizedState,1&t.mode?($a=(u=$a)||c,pl(e,t),$a=u):pl(e,t),yl(t),8192&n){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!c&&0!==(1&t.mode))for(Za=t,c=t.child;null!==c;){for(d=Za=c;null!==Za;){switch(g=(f=Za).child,f.tag){case 0:case 11:case 14:case 15:il(4,f,f.return);break;case 1:Qa(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){n=f,i=f.return;try{e=n,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ph(n,i,m)}}break;case 5:Qa(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==g?(g.return=f,Za=g):wl(d)}c=c.sibling}t:for(c=null,d=t;;){if(5===d.tag){if(null===c){c=d;try{s=d.stateNode,u?"function"===typeof(r=s.style).setProperty?r.setProperty("display","none","important"):r.display="none":(l=d.stateNode,a=void 0!==(h=d.memoizedProps.style)&&null!==h&&h.hasOwnProperty("display")?h.display:null,l.style.display=pt("display",a))}catch(m){Ph(t,t.return,m)}}}else if(6===d.tag){if(null===c)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Ph(t,t.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(e,t),yl(t),4&n&&gl(t);case 21:}}function yl(t){var e=t.flags;if(2&e){try{t:{for(var i=t.return;null!==i;){if(rl(i)){var n=i;break t}i=i.return}throw Error(o(160))}switch(n.tag){case 5:var s=n.stateNode;32&n.flags&&(dt(s,""),n.flags&=-33),hl(t,al(t),s);break;case 3:case 4:var r=n.stateNode.containerInfo;ll(t,al(t),r);break;default:throw Error(o(161))}}catch(a){Ph(t,t.return,a)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function xl(t,e,i){Za=t,vl(t,e,i)}function vl(t,e,i){for(var n=0!==(1&t.mode);null!==Za;){var s=Za,o=s.child;if(22===s.tag&&n){var r=null!==s.memoizedState||Wa;if(!r){var a=s.alternate,l=null!==a&&null!==a.memoizedState||$a;a=Wa;var h=$a;if(Wa=r,($a=l)&&!h)for(Za=s;null!==Za;)l=(r=Za).child,22===r.tag&&null!==r.memoizedState?kl(s):null!==l?(l.return=r,Za=l):kl(s);for(;null!==o;)Za=o,vl(o,e,i),o=o.sibling;Za=s,Wa=a,$a=h}bl(t)}else 0!==(8772&s.subtreeFlags)&&null!==o?(o.return=s,Za=o):bl(t)}}function bl(t){for(;null!==Za;){var e=Za;if(0!==(8772&e.flags)){var i=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:$a||nl(5,e);break;case 1:var n=e.stateNode;if(4&e.flags&&!$a)if(null===i)n.componentDidMount();else{var s=e.elementType===e.type?i.memoizedProps:ia(e.type,i.memoizedProps);n.componentDidUpdate(s,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;null!==r&&Go(e,r,n);break;case 3:var a=e.updateQueue;if(null!==a){if(i=null,null!==e.child)switch(e.child.tag){case 5:case 1:i=e.child.stateNode}Go(e,a,i)}break;case 5:var l=e.stateNode;if(null===i&&4&e.flags){i=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&i.focus();break;case"img":h.src&&(i.src=h.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var c=u.memoizedState;if(null!==c){var d=c.dehydrated;null!==d&&Xe(d)}}}break;default:throw Error(o(163))}$a||512&e.flags&&sl(e)}catch(f){Ph(e,e.return,f)}}if(e===t){Za=null;break}if(null!==(i=e.sibling)){i.return=e.return,Za=i;break}Za=e.return}}function wl(t){for(;null!==Za;){var e=Za;if(e===t){Za=null;break}var i=e.sibling;if(null!==i){i.return=e.return,Za=i;break}Za=e.return}}function kl(t){for(;null!==Za;){var e=Za;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{nl(4,e)}catch(l){Ph(e,i,l)}break;case 1:var n=e.stateNode;if("function"===typeof n.componentDidMount){var s=e.return;try{n.componentDidMount()}catch(l){Ph(e,s,l)}}var o=e.return;try{sl(e)}catch(l){Ph(e,o,l)}break;case 5:var r=e.return;try{sl(e)}catch(l){Ph(e,r,l)}}}catch(l){Ph(e,e.return,l)}if(e===t){Za=null;break}var a=e.sibling;if(null!==a){a.return=e.return,Za=a;break}Za=e.return}}var Sl,Pl=Math.ceil,Ml=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,Nl=b.ReactCurrentBatchConfig,Tl=0,Ll=null,Al=null,Dl=0,Fl=0,Ol=Ps(0),El=0,Rl=null,Bl=0,Il=0,zl=0,jl=null,Vl=null,Ul=0,Xl=1/0,Kl=null,Gl=!1,Yl=null,ql=null,Hl=!1,_l=null,Wl=0,$l=0,Jl=null,Zl=-1,Ql=0;function th(){return 0!==(6&Tl)?Jt():-1!==Zl?Zl:Zl=Jt()}function eh(t){return 0===(1&t.mode)?1:0!==(2&Tl)&&0!==Dl?Dl&-Dl:null!==mo.transition?(0===Ql&&(Ql=pe()),Ql):0!==(t=ve)?t:t=void 0===(t=window.event)?16:$e(t.type)}function ih(t,e,i,n){if(50<$l)throw $l=0,Jl=null,Error(o(185));ye(t,i,n),0!==(2&Tl)&&t===Ll||(t===Ll&&(0===(2&Tl)&&(Il|=i),4===El&&ah(t,Dl)),nh(t,n),1===i&&0===Tl&&0===(1&e.mode)&&(Xl=Jt()+500,js&&Xs()))}function nh(t,e){var i=t.callbackNode;!function(t,e){for(var i=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var r=31-re(o),a=1<<r,l=s[r];-1===l?0!==(a&i)&&0===(a&n)||(s[r]=fe(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}(t,e);var n=de(t,t===Ll?Dl:0);if(0===n)null!==i&&_t(i),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(null!=i&&_t(i),1===e)0===t.tag?function(t){js=!0,Us(t)}(lh.bind(null,t)):Us(lh.bind(null,t)),rs((function(){0===(6&Tl)&&Xs()})),i=null;else{switch(be(n)){case 1:i=Qt;break;case 4:i=te;break;case 16:default:i=ee;break;case 536870912:i=ne}i=Lh(i,sh.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function sh(t,e){if(Zl=-1,Ql=0,0!==(6&Tl))throw Error(o(327));var i=t.callbackNode;if(kh()&&t.callbackNode!==i)return null;var n=de(t,t===Ll?Dl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&t.expiredLanes)||e)e=mh(t,n);else{e=n;var s=Tl;Tl|=2;var r=gh();for(Ll===t&&Dl===e||(Kl=null,Xl=Jt()+500,dh(t,e));;)try{xh();break}catch(l){fh(t,l)}No(),Ml.current=r,Tl=s,null!==Al?e=0:(Ll=null,Dl=0,e=El)}if(0!==e){if(2===e&&(0!==(s=ge(t))&&(n=s,e=oh(t,s))),1===e)throw i=Rl,dh(t,0),ah(t,n),nh(t,Jt()),i;if(6===e)ah(t,n);else{if(s=t.current.alternate,0===(30&n)&&!function(t){for(var e=t;;){if(16384&e.flags){var i=e.updateQueue;if(null!==i&&null!==(i=i.stores))for(var n=0;n<i.length;n++){var s=i[n],o=s.getSnapshot;s=s.value;try{if(!an(o(),s))return!1}catch(a){return!1}}}if(i=e.child,16384&e.subtreeFlags&&null!==i)i.return=e,e=i;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(s)&&(2===(e=mh(t,n))&&(0!==(r=ge(t))&&(n=r,e=oh(t,r))),1===e))throw i=Rl,dh(t,0),ah(t,n),nh(t,Jt()),i;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(o(345));case 2:case 5:wh(t,Vl,Kl);break;case 3:if(ah(t,n),(130023424&n)===n&&10<(e=Ul+500-Jt())){if(0!==de(t,0))break;if(((s=t.suspendedLanes)&n)!==n){th(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ns(wh.bind(null,t,Vl,Kl),e);break}wh(t,Vl,Kl);break;case 4:if(ah(t,n),(4194240&n)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-re(n);r=1<<a,(a=e[a])>s&&(s=a),n&=~r}if(n=s,10<(n=(120>(n=Jt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Pl(n/1960))-n)){t.timeoutHandle=ns(wh.bind(null,t,Vl,Kl),n);break}wh(t,Vl,Kl);break;default:throw Error(o(329))}}}return nh(t,Jt()),t.callbackNode===i?sh.bind(null,t):null}function oh(t,e){var i=jl;return t.current.memoizedState.isDehydrated&&(dh(t,e).flags|=256),2!==(t=mh(t,e))&&(e=Vl,Vl=i,null!==e&&rh(e)),t}function rh(t){null===Vl?Vl=t:Vl.push.apply(Vl,t)}function ah(t,e){for(e&=~zl,e&=~Il,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-re(e),n=1<<i;t[i]=-1,e&=~n}}function lh(t){if(0!==(6&Tl))throw Error(o(327));kh();var e=de(t,0);if(0===(1&e))return nh(t,Jt()),null;var i=mh(t,e);if(0!==t.tag&&2===i){var n=ge(t);0!==n&&(e=n,i=oh(t,n))}if(1===i)throw i=Rl,dh(t,0),ah(t,e),nh(t,Jt()),i;if(6===i)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wh(t,Vl,Kl),nh(t,Jt()),null}function hh(t,e){var i=Tl;Tl|=1;try{return t(e)}finally{0===(Tl=i)&&(Xl=Jt()+500,js&&Xs())}}function uh(t){null!==_l&&0===_l.tag&&0===(6&Tl)&&kh();var e=Tl;Tl|=1;var i=Nl.transition,n=ve;try{if(Nl.transition=null,ve=1,t)return t()}finally{ve=n,Nl.transition=i,0===(6&(Tl=e))&&Xs()}}function ch(){Fl=Ol.current,Ms(Ol)}function dh(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(-1!==i&&(t.timeoutHandle=-1,ss(i)),null!==Al)for(i=Al.return;null!==i;){var n=i;switch(eo(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Os();break;case 3:Jo(),Ms(Ls),Ms(Ts),nr();break;case 5:Qo(n);break;case 4:Jo();break;case 13:case 19:Ms(tr);break;case 10:To(n.type._context);break;case 22:case 23:ch()}i=i.return}if(Ll=t,Al=t=Oh(t.current,null),Dl=Fl=e,El=0,Rl=null,zl=Il=Bl=0,Vl=jl=null,null!==Fo){for(e=0;e<Fo.length;e++)if(null!==(n=(i=Fo[e]).interleaved)){i.interleaved=null;var s=n.next,o=i.pending;if(null!==o){var r=o.next;o.next=s,n.next=r}i.pending=n}Fo=null}return t}function fh(t,e){for(;;){var i=Al;try{if(No(),sr.current=Zr,ur){for(var n=ar.memoizedState;null!==n;){var s=n.queue;null!==s&&(s.pending=null),n=n.next}ur=!1}if(rr=0,hr=lr=ar=null,cr=!1,dr=0,Cl.current=null,null===i||null===i.return){El=1,Rl=e,Al=null;break}t:{var r=t,a=i.return,l=i,h=e;if(e=Dl,l.flags|=32768,null!==h&&"object"===typeof h&&"function"===typeof h.then){var u=h,c=l,d=c.tag;if(0===(1&c.mode)&&(0===d||11===d||15===d)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=ma(a);if(null!==g){g.flags&=-257,ya(g,a,l,0,e),1&g.mode&&pa(r,u,e),h=u;var p=(e=g).updateQueue;if(null===p){var m=new Set;m.add(h),e.updateQueue=m}else p.add(h);break t}if(0===(1&e)){pa(r,u,e),ph();break t}h=Error(o(426))}else if(so&&1&l.mode){var y=ma(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ya(y,a,l,0,e),po(ha(h,l));break t}}r=h=ha(h,l),4!==El&&(El=2),null===jl?jl=[r]:jl.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e,Xo(r,fa(0,h,e));break t;case 1:l=h;var x=r.type,v=r.stateNode;if(0===(128&r.flags)&&("function"===typeof x.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===ql||!ql.has(v)))){r.flags|=65536,e&=-e,r.lanes|=e,Xo(r,ga(r,l,e));break t}}r=r.return}while(null!==r)}bh(i)}catch(b){e=b,Al===i&&null!==i&&(Al=i=i.return);continue}break}}function gh(){var t=Ml.current;return Ml.current=Zr,null===t?Zr:t}function ph(){0!==El&&3!==El&&2!==El||(El=4),null===Ll||0===(268435455&Bl)&&0===(268435455&Il)||ah(Ll,Dl)}function mh(t,e){var i=Tl;Tl|=2;var n=gh();for(Ll===t&&Dl===e||(Kl=null,dh(t,e));;)try{yh();break}catch(s){fh(t,s)}if(No(),Tl=i,Ml.current=n,null!==Al)throw Error(o(261));return Ll=null,Dl=0,El}function yh(){for(;null!==Al;)vh(Al)}function xh(){for(;null!==Al&&!Wt();)vh(Al)}function vh(t){var e=Sl(t.alternate,t,Fl);t.memoizedProps=t.pendingProps,null===e?bh(t):Al=e,Cl.current=null}function bh(t){var e=t;do{var i=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(i=Ha(i,e,Fl)))return void(Al=i)}else{if(null!==(i=_a(i,e)))return i.flags&=32767,void(Al=i);if(null===t)return El=6,void(Al=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Al=e);Al=e=t}while(null!==e);0===El&&(El=5)}function wh(t,e,i){var n=ve,s=Nl.transition;try{Nl.transition=null,ve=1,function(t,e,i,n){do{kh()}while(null!==_l);if(0!==(6&Tl))throw Error(o(327));i=t.finishedWork;var s=t.finishedLanes;if(null===i)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var r=i.lanes|i.childLanes;if(function(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<i;){var s=31-re(i),o=1<<s;e[s]=0,n[s]=-1,t[s]=-1,i&=~o}}(t,r),t===Ll&&(Al=Ll=null,Dl=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||Hl||(Hl=!0,Lh(ee,(function(){return kh(),null}))),r=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||r){r=Nl.transition,Nl.transition=null;var a=ve;ve=1;var l=Tl;Tl|=4,Cl.current=null,function(t,e){if(ts=Ge,fn(t=dn())){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{var n=(i=(i=t.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var s=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{i.nodeType,r.nodeType}catch(w){i=null;break t}var a=0,l=-1,h=-1,u=0,c=0,d=t,f=null;e:for(;;){for(var g;d!==i||0!==s&&3!==d.nodeType||(l=a+s),d!==r||0!==n&&3!==d.nodeType||(h=a+n),3===d.nodeType&&(a+=d.nodeValue.length),null!==(g=d.firstChild);)f=d,d=g;for(;;){if(d===t)break e;if(f===i&&++u===s&&(l=a),f===r&&++c===n&&(h=a),null!==(g=d.nextSibling))break;f=(d=f).parentNode}d=g}i=-1===l||-1===h?null:{start:l,end:h}}else i=null}i=i||{start:0,end:0}}else i=null;for(es={focusedElem:t,selectionRange:i},Ge=!1,Za=e;null!==Za;)if(t=(e=Za).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Za=t;else for(;null!==Za;){e=Za;try{var p=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var m=p.memoizedProps,y=p.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?m:ia(e.type,m),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(w){Ph(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,Za=t;break}Za=e.return}p=el,el=!1}(t,i),ml(i,t),gn(es),Ge=!!ts,es=ts=null,t.current=i,xl(i,t,s),$t(),Tl=l,ve=a,Nl.transition=r}else t.current=i;if(Hl&&(Hl=!1,_l=t,Wl=s),r=t.pendingLanes,0===r&&(ql=null),function(t){if(oe&&"function"===typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(se,t,void 0,128===(128&t.current.flags))}catch(e){}}(i.stateNode),nh(t,Jt()),null!==e)for(n=t.onRecoverableError,i=0;i<e.length;i++)s=e[i],n(s.value,{componentStack:s.stack,digest:s.digest});if(Gl)throw Gl=!1,t=Yl,Yl=null,t;0!==(1&Wl)&&0!==t.tag&&kh(),r=t.pendingLanes,0!==(1&r)?t===Jl?$l++:($l=0,Jl=t):$l=0,Xs()}(t,e,i,n)}finally{Nl.transition=s,ve=n}return null}function kh(){if(null!==_l){var t=be(Wl),e=Nl.transition,i=ve;try{if(Nl.transition=null,ve=16>t?16:t,null===_l)var n=!1;else{if(t=_l,_l=null,Wl=0,0!==(6&Tl))throw Error(o(331));var s=Tl;for(Tl|=4,Za=t.current;null!==Za;){var r=Za,a=r.child;if(0!==(16&Za.flags)){var l=r.deletions;if(null!==l){for(var h=0;h<l.length;h++){var u=l[h];for(Za=u;null!==Za;){var c=Za;switch(c.tag){case 0:case 11:case 15:il(8,c,r)}var d=c.child;if(null!==d)d.return=c,Za=d;else for(;null!==Za;){var f=(c=Za).sibling,g=c.return;if(ol(c),c===u){Za=null;break}if(null!==f){f.return=g,Za=f;break}Za=g}}}var p=r.alternate;if(null!==p){var m=p.child;if(null!==m){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Za=r}}if(0!==(2064&r.subtreeFlags)&&null!==a)a.return=r,Za=a;else t:for(;null!==Za;){if(0!==(2048&(r=Za).flags))switch(r.tag){case 0:case 11:case 15:il(9,r,r.return)}var x=r.sibling;if(null!==x){x.return=r.return,Za=x;break t}Za=r.return}}var v=t.current;for(Za=v;null!==Za;){var b=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,Za=b;else t:for(a=v;null!==Za;){if(0!==(2048&(l=Za).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(k){Ph(l,l.return,k)}if(l===a){Za=null;break t}var w=l.sibling;if(null!==w){w.return=l.return,Za=w;break t}Za=l.return}}if(Tl=s,Xs(),oe&&"function"===typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(se,t)}catch(k){}n=!0}return n}finally{ve=i,Nl.transition=e}}return!1}function Sh(t,e,i){t=Vo(t,e=fa(0,e=ha(i,e),1),1),e=th(),null!==t&&(ye(t,1,e),nh(t,e))}function Ph(t,e,i){if(3===t.tag)Sh(t,t,i);else for(;null!==e;){if(3===e.tag){Sh(e,t,i);break}if(1===e.tag){var n=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===ql||!ql.has(n))){e=Vo(e,t=ga(e,t=ha(i,t),1),1),t=th(),null!==e&&(ye(e,1,t),nh(e,t));break}}e=e.return}}function Mh(t,e,i){var n=t.pingCache;null!==n&&n.delete(e),e=th(),t.pingedLanes|=t.suspendedLanes&i,Ll===t&&(Dl&i)===i&&(4===El||3===El&&(130023424&Dl)===Dl&&500>Jt()-Ul?dh(t,0):zl|=i),nh(t,e)}function Ch(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var i=th();null!==(t=Ro(t,e))&&(ye(t,e,i),nh(t,i))}function Nh(t){var e=t.memoizedState,i=0;null!==e&&(i=e.retryLane),Ch(t,i)}function Th(t,e){var i=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;null!==s&&(i=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(e),Ch(t,i)}function Lh(t,e){return Ht(t,e)}function Ah(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dh(t,e,i,n){return new Ah(t,e,i,n)}function Fh(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Oh(t,e){var i=t.alternate;return null===i?((i=Dh(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&t.flags,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function Eh(t,e,i,n,s,r){var a=2;if(n=t,"function"===typeof t)Fh(t)&&(a=1);else if("string"===typeof t)a=5;else t:switch(t){case S:return Rh(i.children,s,r,e);case P:a=8,s|=8;break;case M:return(t=Dh(12,i,e,2|s)).elementType=M,t.lanes=r,t;case L:return(t=Dh(13,i,e,s)).elementType=L,t.lanes=r,t;case A:return(t=Dh(19,i,e,s)).elementType=A,t.lanes=r,t;case O:return Bh(i,s,r,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:a=10;break t;case N:a=9;break t;case T:a=11;break t;case D:a=14;break t;case F:a=16,n=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Dh(a,i,e,s)).elementType=t,e.type=n,e.lanes=r,e}function Rh(t,e,i,n){return(t=Dh(7,t,n,e)).lanes=i,t}function Bh(t,e,i,n){return(t=Dh(22,t,n,e)).elementType=O,t.lanes=i,t.stateNode={isHidden:!1},t}function Ih(t,e,i){return(t=Dh(6,t,null,e)).lanes=i,t}function zh(t,e,i){return(e=Dh(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function jh(t,e,i,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vh(t,e,i,n,s,o,r,a,l){return t=new jh(t,e,i,a,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Dh(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Io(o),t}function Uh(t){if(!t)return Ns;t:{if(Xt(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Fs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var i=t.type;if(Fs(i))return Rs(t,i,e)}return e}function Xh(t,e,i,n,s,o,r,a,l){return(t=Vh(i,n,!0,t,0,o,0,a,l)).context=Uh(null),i=t.current,(o=jo(n=th(),s=eh(i))).callback=void 0!==e&&null!==e?e:null,Vo(i,o,s),t.current.lanes=s,ye(t,s,n),nh(t,n),t}function Kh(t,e,i,n){var s=e.current,o=th(),r=eh(s);return i=Uh(i),null===e.context?e.context=i:e.pendingContext=i,(e=jo(o,r)).payload={element:t},null!==(n=void 0===n?null:n)&&(e.callback=n),null!==(t=Vo(s,e,r))&&(ih(t,s,r,o),Uo(t,s,r)),r}function Gh(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Yh(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function qh(t,e){Yh(t,e),(t=t.alternate)&&Yh(t,e)}Sl=function(t,e,i){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ls.current)va=!0;else{if(0===(t.lanes&i)&&0===(128&e.flags))return va=!1,function(t,e,i){switch(e.tag){case 3:La(e),go();break;case 5:Zo(e);break;case 1:Fs(e.type)&&Bs(e);break;case 4:$o(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Cs(So,n._currentValue),n._currentValue=s;break;case 13:if(null!==(n=e.memoizedState))return null!==n.dehydrated?(Cs(tr,1&tr.current),e.flags|=128,null):0!==(i&e.child.childLanes)?Ia(t,e,i):(Cs(tr,1&tr.current),null!==(t=Ga(t,e,i))?t.sibling:null);Cs(tr,1&tr.current);break;case 19:if(n=0!==(i&e.childLanes),0!==(128&t.flags)){if(n)return Xa(t,e,i);e.flags|=128}if(null!==(s=e.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cs(tr,tr.current),n)break;return null;case 22:case 23:return e.lanes=0,Pa(t,e,i)}return Ga(t,e,i)}(t,e,i);va=0!==(131072&t.flags)}else va=!1,so&&0!==(1048576&e.flags)&&Qs(e,qs,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Ka(t,e),t=e.pendingProps;var s=Ds(e,Ts.current);Ao(e,i),s=mr(null,e,n,t,s,i);var r=yr();return e.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fs(n)?(r=!0,Bs(e)):r=!1,e.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Io(e),s.updater=sa,e.stateNode=s,s._reactInternals=e,la(e,n,t,i),e=Ta(null,e,n,!0,r,i)):(e.tag=0,so&&r&&to(e),ba(null,e,s,i),e=e.child),e;case 16:n=e.elementType;t:{switch(Ka(t,e),t=e.pendingProps,n=(s=n._init)(n._payload),e.type=n,s=e.tag=function(t){if("function"===typeof t)return Fh(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===T)return 11;if(t===D)return 14}return 2}(n),t=ia(n,t),s){case 0:e=Ca(null,e,n,t,i);break t;case 1:e=Na(null,e,n,t,i);break t;case 11:e=wa(null,e,n,t,i);break t;case 14:e=ka(null,e,n,ia(n.type,t),i);break t}throw Error(o(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,Ca(t,e,n,s=e.elementType===n?s:ia(n,s),i);case 1:return n=e.type,s=e.pendingProps,Na(t,e,n,s=e.elementType===n?s:ia(n,s),i);case 3:t:{if(La(e),null===t)throw Error(o(387));n=e.pendingProps,s=(r=e.memoizedState).element,zo(t,e),Ko(e,n,null,i);var a=e.memoizedState;if(n=a.element,r.isDehydrated){if(r={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,256&e.flags){e=Aa(t,e,n,i,s=ha(Error(o(423)),e));break t}if(n!==s){e=Aa(t,e,n,i,s=ha(Error(o(424)),e));break t}for(no=hs(e.stateNode.containerInfo.firstChild),io=e,so=!0,oo=null,i=ko(e,null,n,i),e.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(go(),n===s){e=Ga(t,e,i);break t}ba(t,e,n,i)}e=e.child}return e;case 5:return Zo(e),null===t&&ho(e),n=e.type,s=e.pendingProps,r=null!==t?t.memoizedProps:null,a=s.children,is(n,s)?a=null:null!==r&&is(n,r)&&(e.flags|=32),Ma(t,e),ba(t,e,a,i),e.child;case 6:return null===t&&ho(e),null;case 13:return Ia(t,e,i);case 4:return $o(e,e.stateNode.containerInfo),n=e.pendingProps,null===t?e.child=wo(e,null,n,i):ba(t,e,n,i),e.child;case 11:return n=e.type,s=e.pendingProps,wa(t,e,n,s=e.elementType===n?s:ia(n,s),i);case 7:return ba(t,e,e.pendingProps,i),e.child;case 8:case 12:return ba(t,e,e.pendingProps.children,i),e.child;case 10:t:{if(n=e.type._context,s=e.pendingProps,r=e.memoizedProps,a=s.value,Cs(So,n._currentValue),n._currentValue=a,null!==r)if(an(r.value,a)){if(r.children===s.children&&!Ls.current){e=Ga(t,e,i);break t}}else for(null!==(r=e.child)&&(r.return=e);null!==r;){var l=r.dependencies;if(null!==l){a=r.child;for(var h=l.firstContext;null!==h;){if(h.context===n){if(1===r.tag){(h=jo(-1,i&-i)).tag=2;var u=r.updateQueue;if(null!==u){var c=(u=u.shared).pending;null===c?h.next=h:(h.next=c.next,c.next=h),u.pending=h}}r.lanes|=i,null!==(h=r.alternate)&&(h.lanes|=i),Lo(r.return,i,e),l.lanes|=i;break}h=h.next}}else if(10===r.tag)a=r.type===e.type?null:r.child;else if(18===r.tag){if(null===(a=r.return))throw Error(o(341));a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),Lo(a,i,e),a=r.sibling}else a=r.child;if(null!==a)a.return=r;else for(a=r;null!==a;){if(a===e){a=null;break}if(null!==(r=a.sibling)){r.return=a.return,a=r;break}a=a.return}r=a}ba(t,e,s.children,i),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Ao(e,i),n=n(s=Do(s)),e.flags|=1,ba(t,e,n,i),e.child;case 14:return s=ia(n=e.type,e.pendingProps),ka(t,e,n,s=ia(n.type,s),i);case 15:return Sa(t,e,e.type,e.pendingProps,i);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ia(n,s),Ka(t,e),e.tag=1,Fs(n)?(t=!0,Bs(e)):t=!1,Ao(e,i),ra(e,n,s),la(e,n,s,i),Ta(null,e,n,!0,t,i);case 19:return Xa(t,e,i);case 22:return Pa(t,e,i)}throw Error(o(156,e.tag))};var Hh="function"===typeof reportError?reportError:function(t){console.error(t)};function _h(t){this._internalRoot=t}function Wh(t){this._internalRoot=t}function $h(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jh(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Zh(){}function Qh(t,e,i,n,s){var o=i._reactRootContainer;if(o){var r=o;if("function"===typeof s){var a=s;s=function(){var t=Gh(r);a.call(t)}}Kh(e,r,t,s)}else r=function(t,e,i,n,s){if(s){if("function"===typeof n){var o=n;n=function(){var t=Gh(r);o.call(t)}}var r=Xh(e,n,t,0,null,!1,0,"",Zh);return t._reactRootContainer=r,t[gs]=r.current,Xn(8===t.nodeType?t.parentNode:t),uh(),r}for(;s=t.lastChild;)t.removeChild(s);if("function"===typeof n){var a=n;n=function(){var t=Gh(l);a.call(t)}}var l=Vh(t,0,!1,null,0,!1,0,"",Zh);return t._reactRootContainer=l,t[gs]=l.current,Xn(8===t.nodeType?t.parentNode:t),uh((function(){Kh(e,l,i,n)})),l}(i,e,t,s,n);return Gh(r)}Wh.prototype.render=_h.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Kh(t,e,null,null)},Wh.prototype.unmount=_h.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;uh((function(){Kh(null,t,null,null)})),e[gs]=null}},Wh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Pe();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Oe.length&&0!==e&&e<Oe[i].priority;i++);Oe.splice(i,0,t),0===i&&Ie(t)}},we=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=ce(e.pendingLanes);0!==i&&(xe(e,1|i),nh(e,Jt()),0===(6&Tl)&&(Xl=Jt()+500,Xs()))}break;case 13:uh((function(){var e=Ro(t,1);if(null!==e){var i=th();ih(e,t,1,i)}})),qh(t,1)}},ke=function(t){if(13===t.tag){var e=Ro(t,134217728);if(null!==e)ih(e,t,134217728,th());qh(t,134217728)}},Se=function(t){if(13===t.tag){var e=eh(t),i=Ro(t,e);if(null!==i)ih(i,t,e,th());qh(t,e)}},Pe=function(){return ve},Me=function(t,e){var i=ve;try{return ve=t,e()}finally{ve=i}},kt=function(t,e,i){switch(e){case"input":if(Z(t,i),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var s=ws(n);if(!s)throw Error(o(90));H(n),Z(n,s)}}}break;case"textarea":ot(t,i);break;case"select":null!=(e=i.value)&&it(t,!!i.multiple,e,!1)}},Tt=hh,Lt=uh;var tu={usingClientEntryPoint:!1,Events:[vs,bs,ws,Ct,Nt,hh]},eu={findFiberByHostInstance:xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Yt(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{se=nu.inject(iu),oe=nu}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$h(e))throw Error(o(200));return function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==n?null:""+n,children:t,containerInfo:e,implementation:i}}(t,e,null,i)},e.createRoot=function(t,e){if(!$h(t))throw Error(o(299));var i=!1,n="",s=Hh;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(i=!0),void 0!==e.identifierPrefix&&(n=e.identifierPrefix),void 0!==e.onRecoverableError&&(s=e.onRecoverableError)),e=Vh(t,1,!1,null,0,i,0,n,s),t[gs]=e.current,Xn(8===t.nodeType?t.parentNode:t),new _h(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return t=null===(t=Yt(e))?null:t.stateNode},e.flushSync=function(t){return uh(t)},e.hydrate=function(t,e,i){if(!Jh(e))throw Error(o(200));return Qh(null,t,e,!0,i)},e.hydrateRoot=function(t,e,i){if(!$h(t))throw Error(o(405));var n=null!=i&&i.hydratedSources||null,s=!1,r="",a=Hh;if(null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(s=!0),void 0!==i.identifierPrefix&&(r=i.identifierPrefix),void 0!==i.onRecoverableError&&(a=i.onRecoverableError)),e=Xh(e,null,t,1,null!=i?i:null,s,0,r,a),t[gs]=e.current,Xn(t),n)for(t=0;t<n.length;t++)s=(s=(i=n[t])._getVersion)(i._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[i,s]:e.mutableSourceEagerHydrationData.push(i,s);return new Wh(e)},e.render=function(t,e,i){if(!Jh(e))throw Error(o(200));return Qh(null,t,e,!1,i)},e.unmountComponentAtNode=function(t){if(!Jh(t))throw Error(o(40));return!!t._reactRootContainer&&(uh((function(){Qh(null,null,t,!1,(function(){t._reactRootContainer=null,t[gs]=null}))})),!0)},e.unstable_batchedUpdates=hh,e.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!Jh(i))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return Qh(t,e,i,!1,n)},e.version="18.3.1-next-f1338f8080-20240426"},853:(t,e,i)=>{"use strict";t.exports=i(234)},950:(t,e,i)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=i(730)}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=i(43),e=i(950),n=i(613),s=i.n(n),o=i(579);class r extends t.Component{render(){return(0,o.jsxs)("div",{className:this.props.className,children:[" ",this.props.value]})}}class a extends t.Component{render(){return(0,o.jsx)("div",{className:"selectionButton",children:(0,o.jsx)("button",{className:"btn btn-Tab",onClick:this.props.onClick,children:this.props.value})})}}class l extends t.Component{render(){return(0,o.jsx)("div",{className:"mapSquare",onClick:this.props.onClick,children:(0,o.jsxs)("button",{className:"btnMap",children:[this.props.value,(0,o.jsx)("div",{className:"",id:this.props.idPrefix+this.props.i+this.props.j})]})})}}class h extends t.Component{renderSquare(t,e){return(0,o.jsx)(l,{value:this.props.squares[t][e][0],i:t,j:e,idPrefix:this.props.idPrefix,onClick:this.props.readOnly?null:()=>this.props.onClick(t,e)},t+e)}generateMapRow(t){const e=this.props.typeMap;let i=[],n=e;3===e&&(n=4);for(let s=0;s<n;s++)i.push(this.renderSquare(t,s));return i}renderMapRow(t){return(0,o.jsx)("div",{className:"board-row",children:this.generateMapRow(t)},t)}renderMap(){const t=this.props.typeMap;let e=[],i=t;3===t&&(i=2);for(let n=0;n<i;n++)e.push(this.renderMapRow(n));return e}renderMapHead(t,e,i){const n=this.props.typeMap;if(t)return(0,o.jsx)(r,{value:e,className:i},e);{let t=[],e=["A","B","C","D"],s=!1,a=0;for(;a<n;a++)(2!==n&&2===a||2===n&&1===a)&&(t.push((0,o.jsx)("hr",{},"hr")),s=!0),s?t.push((0,o.jsx)("div",{className:"mapVariableBot",children:e[a]},a)):t.push((0,o.jsx)("div",{className:"mapVariableTop",children:e[a]},a));return(0,o.jsx)(r,{value:t,className:i},++a)}}renderHeader(){const t=this.props.typeMap;let e=["00","01","11","10"],i=t,n=[];3===t&&(i=4),2===t&&(e=["0","1"]),n.push(this.renderMapHead(0,"","headerSquare"));for(let s=0;s<i;s++)n.push(this.renderMapHead(1,e[s],"headerSquare"));return n}renderMapHeaderRow(t){return(0,o.jsxs)("div",{className:"board-row",children:[" ",this.renderHeader()," "]},t)}renderCol(){const t=this.props.typeMap;let e=["00","01","11","10"],i=t,n=[];2!==t&&3!==t||(e=["0","1"],i=2);for(let s=0;s<i;s++)n.push(this.renderMapHead(1,e[s],"headerSquare"));return n}rendeMapReaderCol(t){return(0,o.jsxs)("div",{className:"map-col",children:[" ",this.renderCol()," "]},t)}render(){let t=0;return(0,o.jsxs)("div",{children:[this.renderMapHeaderRow(t++),this.rendeMapReaderCol(t++),(0,o.jsx)("div",{className:"map",children:this.renderMap()})]},t++)}}class u extends t.Component{render(){const t=this.props.squares,e=this.props.typeMap,i=this.props.perm;let n=0;return(0,o.jsxs)("div",{children:[(0,o.jsx)(d,{typeMap:e},n++),(0,o.jsxs)("div",{className:"bodyTruthTable",children:[(0,o.jsx)(c,{typeMap:e,perm:i},n++),(0,o.jsx)(f,{squares:t,typeMap:e,perm:i,onClick:(t,e)=>this.props.onClick(t,e),setRowOrColCell:(t,e,i,n)=>this.props.setRowOrColCell(t,e,i,n)},n++)]},n++)]},n++)}}class c extends t.Component{renderTableSquare(t,e){return(0,o.jsx)(r,{value:t,className:"square tableFont"},e)}renderTableCol2(t,e){const i=this.props.typeMap;var n=[];let s=Math.pow(2,i);for(let o=0;o<s;o++)n.push(this.renderTableSquare(e[o][t],o));return n}renderTableCol(t,e){return(0,o.jsx)("div",{className:"table-col",children:this.renderTableCol2(t,e)},t)}renderTablePermutation(t){const e=this.props.typeMap;var i=[];for(let n=0;n<e;n++)i.push(this.renderTableCol(n,t));return i}render(){const t=this.props.perm;return this.renderTablePermutation(t)}}class d extends t.Component{renderTableHead(t,e){return(0,o.jsx)(r,{value:t,k:e,className:"square tableFont"},e)}renderTableRow(){const t=this.props.typeMap;let e=["A","B","C","D"],i=[],n=0;for(;n<t;n++)i.push(this.renderTableHead(e[n],n));return i.push(this.renderTableHead("f",n+1)),i}render(){return(0,o.jsxs)("div",{className:"tableHead",children:[" ",this.renderTableRow()," "]},-1)}}class f extends t.Component{renderSelectionButton(t,e,i){return(0,o.jsx)(a,{value:this.props.squares[t][e][0]},i)}renderTableCol(){const t=this.props.typeMap;this.props.squares;let e=[],i=t,n=t;3===t&&(n=4,i=2);let s=0;const o=[[0,2,6,4],[1,3,7,5],[9,11,15,13],[8,10,14,12]];if(4===t)for(let r=0;r<=15;r++)for(let t=0;t<4;t++)for(let i=0;i<4;i++){o[t][i]===r&&e.push(this.renderSelectionButton(t,i,s++))}else for(let r=0;r<n;r++){let t;t=2===r?3:3===r?2:r;for(let n=0;n<i;n++){let o;o=n%i===2?3:n%i===3?2:n,e.push(this.renderSelectionButton(o,t,s++))}}return e}render(){return(0,o.jsxs)("div",{className:"table-col-selButton",children:[" ",this.renderTableCol()," "]})}}class g extends t.Component{render(){return(0,o.jsx)("div",{children:(0,o.jsx)("div",{className:"optionChoice",children:(0,o.jsxs)("div",{className:"mapType",children:[(0,o.jsx)("p",{children:" Vyberte po\u010det prom\u011bnn\xfdch:"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"buttonType",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setTypeMap(2),children:"2"})}),(0,o.jsx)("div",{className:"buttonType",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setTypeMap(3),children:"3"})}),(0,o.jsx)("div",{className:"buttonType",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setTypeMap(4),children:"4"})})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:"Funkce"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"KonDis",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setEquationType("Dis"),children:"Disjunktn\xed"})}),(0,o.jsx)("div",{className:"KonDis",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setEquationType("Kon"),children:"Konjunktn\xed"})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:"Nastavit mapu na v\u0161echny: "}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"buttonSettings",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setMatrixSquare(0),children:" 0"})}),(0,o.jsx)("div",{className:"buttonSettings",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setMatrixSquare(1),children:" 1"})}),(0,o.jsx)("div",{className:"buttonSettings",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setMatrixSquare("X"),children:" X"})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("p",{children:["Tvar: ",this.props.typeSol]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"KonDis",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setTypeSol("SOP"),children:"Sou\u010dtov\xfd"})}),(0,o.jsx)("div",{className:"KonDis",children:(0,o.jsx)("button",{className:"btn-type",onClick:()=>this.props.setTypeSol("POS"),children:"Sou\u010dinov\xfd"})})]})]}),(0,o.jsx)("p",{children:"V\xfdsledek: "}),(0,o.jsx)("div",{children:(0,o.jsx)("div",{className:"elaborate",children:(0,o.jsx)("button",{className:"btn-elaborate",id:"elabora",onClick:t=>this.props.onClick(t),children:"Zpracuj"})})})]})]})})})}}!function(){const t="object"==typeof globalThis&&globalThis||"object"==typeof global&&global.global===global&&global||"object"==typeof self&&self.self===self&&self||{};void 0===t.requestAnimationFrame&&(void 0===t.setImmediate?t.requestAnimationFrame=e=>t.setTimeout(e,0):t.requestAnimationFrame=t.setImmediate);class e{static _o=(()=>void 0!==t.navigator&&void 0!==t.navigator.platform&&null!==t.navigator.platform.match(/(iPhone|iPod|iPad|Mac)/i))();static Fk(t,i,n){let s=-1;return function(){const o=this,r=arguments;-1!==s&&e.Tg(s),s=e.tr((()=>{s=-1,n||t.apply(o,r)}),i),n&&!s&&t.apply(o,r)}}static tr(e,i){return t.setTimeout(e,i)}static Tg(e){t.clearTimeout(e)}static hs(e){return t.document.createElement(e)}static o(t){throw new Error(t)}static L(t,i){let n="The object is frozen, so its properties cannot be set: "+t.toString();void 0!==i&&(n+="  to value: "+i),e.o(n)}static uE(t,e,i,n){}static s(t,e,i,n){}static dE(t,e,i){}static ec(t,i,n){if(null===t||"object"!=typeof t){let s=e.fC(i);void 0!==n&&(s+="."+n),e.Zi(t,"object",s)}}static k(t,i,n){e.s(t,"function",i,n)}static gE(t,e,i){}static Zi(t,e,i,n){}static W(t,i,n,s){let o=e.fC(n);void 0!==s&&(o+="."+s),e.o(o+" is not in the range "+i+": "+t)}static Re(t){}static ir(t,e){}static ni(e){t.console&&t.console.log(e)}static K(t){return null!==t&&"object"==typeof t}static it(t){return"function"==typeof t}static Rk=[];static et(){const t=e.Rk.pop();return void 0===t?[]:t}static J(t){t.length=0,e.Rk.push(t)}static mE=(()=>Object.freeze([]))();static fC(t){return null===t?"*":"string"==typeof t?t:e.it(t)?t.name:""}static Dn(t){return e.it(t)?t.className?t.className:t.name:e.K(t)&&t.constructor?e.Dn(t.constructor):typeof t}static Eh(t,i){return null==i||""===i?null:e.K(t)&&i in t||t[i]?t[i]:null}static toString(t){let i=t;return e.K(t)&&(t.text?i=t.text:t.name?i=t.name:void 0!==t.key?i=t.key:void 0!==t.id?i=t.id:t.constructor===Object&&(t.Text?i=t.Text:t.Name?i=t.Name:void 0!==t.Key?i=t.Key:void 0!==t.Id?i=t.Id:void 0!==t.ID&&(i=t.ID))),void 0===i?"undefined":null===i?"null":i.toString()}static uw(t,e){if(t.hasOwnProperty(e))return!0;let i=Object.getPrototypeOf(t);for(;i&&i!==Function;){if(i.hasOwnProperty(e))return!0;const t=i.pE;if(t&&t[e])return!0;i=Object.getPrototypeOf(i)}return!1}static qD(t){const e=[];let i=0;for(i=0;i<256;i++)e[i]=i;let n=0,s=0;for(i=0;i<256;i++)n=(n+e[i]+119)%256,s=e[i],e[i]=e[n],e[n]=s;i=0,n=0;let o="";for(let r=0;r<t.length;r++)i=(i+1)%256,n=(n+e[i])%256,s=e[i],e[i]=e[n],e[n]=s,o+=String.fromCharCode(t.charCodeAt(r)^e[(e[i]+e[n])%256]);return o}static WD(t){const e="0123456789abcdef",i=[];for(let r=0;r<256;r++)i[e.charAt(r>>4)+e.charAt(15&r)]=String.fromCharCode(r);t.length%2&&(t="0"+t);const n=[];let s=0;for(let r=0;r<t.length;r+=2)n[s++]=i[t.substring(r,r+2)];const o=n.join("");return""===o?"0":o}static Ts(t){return e.qD(e.WD(t))}static color1="@COLOR1";static color2="@COLOR2";static dw="32ab5ff3b26f42dc0ed90f21412913b5"}e.vfo="29e646fdb167";class i{vk;constructor(){this.vk=[]}toString(){return this.vk.join("")}add(t){""!==t&&this.vk.push(t)}}class n{}class s{g;constructor(){this.g=[]}[Symbol.iterator](){return this.g.values()}key;value;get iterator(){return this}reset(){}next(){return!1}hasNext(){return!1}first(){return null}any(){return!1}all(){return!0}each(){return this}map(t){return this}filter(){return this}get count(){return 0}fl(){}toString(){return"EmptyIterator"}static instance=(()=>new s)()}class o{constructor(t){this.key=-1,this.value=t}[Symbol.iterator](){return[this.value].values()}key;value;get iterator(){return this}reset(){this.key=-1}next(){return-1===this.key&&(this.key=0,!0)}hasNext(){return this.next()}first(){return this.key=0,this.value}any(t){return this.key=-1,t(this.value)}all(t){return this.key=-1,t(this.value)}each(t){return this.key=-1,t(this.value),this}map(t){return new o(t(this.value))}filter(t){return t(this.value)?new o(this.value):s.instance}get count(){return 1}fl(){this.value=null}toString(){return"SingletonIterator("+this.value+")"}}class r{qt;Ds;Kt;At;constructor(t){this.qt=t,this.Ds=null,t.er=null,this.Kt=t.nt,this.At=-1}[Symbol.iterator](){return null===this.Ds?this.qt.r.values():this.qt.r.filter(this.Ds).values()}key;value;get iterator(){return this}get predicate(){return this.Ds}set predicate(t){this.Ds=t}reset(){const t=this.qt;t.er=null,this.Kt=t.nt,this.At=-1}next(){const t=this.qt;if(t.nt!==this.Kt){if(this.key<0)return!1;e.Re(t)}const i=t.r,n=i.length;let s=++this.At;const o=this.Ds;if(null!==o)for(;s<n;){const t=i[s];if(o(t))return this.At=s,this.key=s,this.value=t,!0;s++}else{if(s<n)return this.key=s,this.value=i[s],!0;this.fl()}return!1}hasNext(){return this.next()}first(){const t=this.qt;this.Kt=t.nt,this.At=0;const e=t.r,i=e.length,n=this.Ds;if(null!==n){let t=0;for(;t<i;){const i=e[t];if(n(i))return this.At=t,this.key=t,this.value=i,i;t++}return null}if(i>0){const t=e[0];return this.key=0,this.value=t,t}return null}any(t){const i=this.qt;i.er=null;const n=i.nt;this.At=-1;const s=i.r,o=s.length,r=this.Ds;for(let a=0;a<o;a++){const o=s[a];if(null===r||r(o)){if(t(o))return!0;i.nt!==n&&e.Re(i)}}return!1}all(t){const i=this.qt;i.er=null;const n=i.nt;this.At=-1;const s=i.r,o=s.length,r=this.Ds;for(let a=0;a<o;a++){const o=s[a];if(null===r||r(o)){if(!t(o))return!1;i.nt!==n&&e.Re(i)}}return!0}each(t){const i=this.qt;i.er=null;const n=i.nt;this.At=-1;const s=i.r,o=s.length,r=this.Ds;for(let a=0;a<o;a++){const o=s[a];null!==r&&!r(o)||(t(o),i.nt!==n&&e.Re(i))}return this}map(t){const i=this.qt;i.er=null;const n=i.nt;this.At=-1;const s=[],o=i.r,r=o.length,a=this.Ds;for(let l=0;l<r;l++){const r=o[l];null!==a&&!a(r)||(s.push(t(r)),i.nt!==n&&e.Re(i))}const h=new l;return h.r=s,h.ve(),h.iterator}filter(t){const i=this.qt;i.er=null;const n=i.nt;this.At=-1;const s=[],o=i.r,r=o.length,a=this.Ds;for(let l=0;l<r;l++){const r=o[l];null!==a&&!a(r)||(t(r)&&s.push(r),i.nt!==n&&e.Re(i))}const h=new l;return h.r=s,h.ve(),h.iterator}get count(){const t=this.Ds;if(null!==t){let e=0;const i=this.qt.r,n=i.length;for(let s=0;s<n;s++)t(i[s])&&e++;return e}return this.qt.r.length}fl(){this.key=-1,this.value=null,this.Kt=-1,this.Ds=null,this.qt.er=this}toString(){return"ListIterator@"+this.At+"/"+this.qt.count}}class a{qt;Kt;At;constructor(t){this.qt=t,t.sr=null,this.Kt=t.nt,this.At=t.r.length}[Symbol.iterator](){return this.qt.r.reverse().values()}key;value;get iterator(){return this}reset(){const t=this.qt;t.sr=null,this.Kt=t.nt,this.At=t.r.length}next(){const t=this.qt;if(t.nt!==this.Kt){if(this.key<0)return!1;e.Re(t)}const i=--this.At;return i>=0?(this.key=i,this.value=t.r[i],!0):(this.fl(),!1)}hasNext(){return this.next()}first(){const t=this.qt;this.Kt=t.nt;const e=t.r,i=e.length-1;if(this.At=i,i>=0){const t=e[i];return this.key=i,this.value=t,t}return null}any(t){const i=this.qt;i.sr=null;const n=i.nt,s=i.r,o=s.length;this.At=o;for(let r=o-1;r>=0;r--){if(t(s[r]))return!0;i.nt!==n&&e.Re(i)}return!1}all(t){const i=this.qt;i.sr=null;const n=i.nt,s=i.r,o=s.length;this.At=o;for(let r=o-1;r>=0;r--){if(!t(s[r]))return!1;i.nt!==n&&e.Re(i)}return!0}each(t){const i=this.qt;i.sr=null;const n=i.nt,s=i.r,o=s.length;this.At=o;for(let r=o-1;r>=0;r--){t(s[r]),i.nt!==n&&e.Re(i)}return this}map(t){const i=this.qt;i.sr=null;const n=i.nt,s=[],o=i.r,r=o.length;this.At=r;for(let l=r-1;l>=0;l--){const r=o[l];s.push(t(r)),i.nt!==n&&e.Re(i)}const a=new l;return a.r=s,a.ve(),a.iterator}filter(t){const i=this.qt;i.sr=null;const n=i.nt,s=[],o=i.r,r=o.length;this.At=r;for(let l=r-1;l>=0;l--){const r=o[l];t(r)&&s.push(r),i.nt!==n&&e.Re(i)}const a=new l;return a.r=s,a.ve(),a.iterator}get count(){return this.qt.r.length}fl(){this.key=-1,this.value=null,this.Kt=-1,this.qt.sr=this}toString(){return"ListIteratorBackwards("+this.At+"/"+this.qt.count+")"}}class l{h;r;nt;er;sr;constructor(t){u.Gi(this),this.h=!1,this.r=[],this.nt=0,this.er=null,this.sr=null,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.r.values()}ve(){let t=this.nt;t++,t>999999999&&(t=0),this.nt=t}u(){return this.h=!0,this}Nt(){return this.h=!1,this}toString(){return"List()#"+u.as(this)}add(t){return this.h&&e.L(this,t),this.r.push(t),this.ve(),this}push(t){this.add(t)}addAll(t){if(null===t)return this;this.h&&e.L(this);const i=this.r;if(Array.isArray(t)){const e=t.length;for(let n=0;n<e;n++){const e=t[n];i.push(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;i.push(t)}}return this.ve(),this}clear(){this.h&&e.L(this),this.r.length=0,this.ve()}contains(t){return this.has(t)}has(t){return null!==t&&-1!==this.r.indexOf(t)}indexOf(t){return null===t?-1:this.r.indexOf(t)}elt(t){const i=this.r;return(t<0||t>=i.length)&&e.W(t,"0 <= i < length",l,"elt:i"),i[t]}get(t){return this.elt(t)}setElt(t,i){const n=this.r;(t<0||t>=n.length)&&e.W(t,"0 <= i < length",l,"setElt:i"),this.h&&e.L(this,t),n[t]=i}set(t,e){this.setElt(t,e)}first(){const t=this.r;return 0===t.length?null:t[0]}last(){const t=this.r,e=t.length;return e>0?t[e-1]:null}pop(){this.h&&e.L(this);const t=this.r;return t.length>0?t.pop():null}any(t){const i=this.r,n=this.nt,s=i.length;for(let o=0;o<s;o++){if(t(i[o]))return!0;this.nt!==n&&e.Re(this)}return!1}all(t){const i=this.r,n=this.nt,s=i.length;for(let o=0;o<s;o++){if(!t(i[o]))return!1;this.nt!==n&&e.Re(this)}return!0}each(t){const i=this.r,n=this.nt,s=i.length;for(let o=0;o<s;o++)t(i[o]),this.nt!==n&&e.Re(this);return this}map(t){const i=new l,n=[],s=this.r,o=this.nt,r=s.length;for(let a=0;a<r;a++)n.push(t(s[a])),this.nt!==o&&e.Re(this);return i.r=n,i.ve(),i}filter(t){const i=new l,n=[],s=this.r,o=this.nt,r=s.length;for(let a=0;a<r;a++){const i=s[a];t(i)&&n.push(i),this.nt!==o&&e.Re(this)}return i.r=n,i.ve(),i}insertAt(t,i){t<0&&e.W(t,">= 0",l,"insertAt:i"),this.h&&e.L(this,t);const n=this.r;t>=n.length?n.push(i):n.splice(t,0,i),this.ve()}remove(t){return this.delete(t)}delete(t){if(null===t)return!1;this.h&&e.L(this,t);const i=this.r,n=i.indexOf(t);return-1!==n&&(n===i.length-1?i.pop():i.splice(n,1),this.ve(),!0)}removeAt(t){const i=this.r;(t<0||t>=i.length)&&e.W(t,"0 <= i < length",l,"removeAt:i"),this.h&&e.L(this,t),t===i.length-1?i.pop():i.splice(t,1),this.ve()}removeRange(t,i){const n=this.r,s=n.length;if(t<0)t=0;else if(t>=s)return this;if(i<0)return this;if(i>=s&&(i=s-1),t>i)return this;this.h&&e.L(this);let o=t,r=i+1;for(;r<s;)n[o++]=n[r++];return n.length=s-(i-t+1),this.ve(),this}copy(){const t=new l,e=this.r;return e.length>0&&(t.r=Array.prototype.slice.call(e)),t}toArray(){const t=this.r,e=this.count,i=new Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}get uC(){return this.r}toSet(){const t=new u,e=this.r,i=this.count;for(let n=0;n<i;n++)t.add(e[n]);return t}sort(t){return this.h&&e.L(this),this.r.sort(t),this.ve(),this}sortRange(t,i,n){const s=this.r,o=s.length;void 0===i&&(i=0),void 0===n&&(n=o),this.h&&e.L(this);const r=n-i;if(r<=1)return this;if((i<0||i>=o-1)&&e.W(i,"0 <= from < length",l,"sortRange:from"),2===r){const e=s[i],n=s[i+1];return t(e,n)>0&&(s[i]=n,s[i+1]=e,this.ve()),this}if(0===i)if(n>=o)s.sort(t);else{const e=s.slice(0,n);e.sort(t);for(let t=0;t<n;t++)s[t]=e[t]}else if(n>=o){const e=s.slice(i);e.sort(t);for(let t=i;t<o;t++)s[t]=e[t-i]}else{const e=s.slice(i,n);e.sort(t);for(let t=i;t<n;t++)s[t]=e[t-i]}return this.ve(),this}reverse(){return this.h&&e.L(this),this.r.reverse(),this.ve(),this}get count(){return this.r.length}get size(){return this.r.length}get length(){return this.r.length}get iterator(){if(this.r.length<=0)return s.instance;const t=this.er;return null!==t?(t.reset(),t):new r(this)}get iteratorBackwards(){if(this.r.length<=0)return s.instance;const t=this.sr;return null!==t?(t.reset(),t):new a(this)}}class h{yo;ii;constructor(t){this.yo=t,this.ii=t.g.values()}[Symbol.iterator](){return this.yo.g.values()}key;value;get iterator(){return this}reset(){const t=this.yo;this.ii=t.g.values()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.yo.g.size?null:(this.ii=this.yo.g.values(),this.ii.next().value)}any(t){return this.yo.any(t)}all(t){return this.yo.all(t)}each(t){return this.yo.each(t),this}map(t){const e=new l;return this.yo.g.forEach((i=>e.add(t(i)))),e.iterator}filter(t){const e=new l;return this.yo.g.forEach((i=>{t(i)&&e.add(i)})),e.iterator}get count(){return this.yo.count}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"SetIterator"}}class u{h;g;constructor(t){this.h=!1,this.g=new Set,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.g.values()}values(){return this.g.values()}u(){return this.h=!0,this}Nt(){return this.h=!1,this}toString(){return"Set()#"+u.as(this)}add(t){return null===t||this.g.add(t),this}addAll(t){if(null===t)return this;if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];null!==e&&this.g.add(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;null!==t&&this.g.add(t)}}return this}has(t){return this.g.has(t)}contains(t){return this.has(t)}containsAll(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(!this.has(e.value))return!1;return!0}containsAny(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(this.has(e.value))return!0;return!1}first(){return 0===this.g.size?null:this.g.values().next().value}any(t){for(const e of this.g)if(t(e))return!0;return!1}all(t){for(const e of this.g)if(!t(e))return!1;return!0}each(t){for(const e of this.g)t(e);return this}map(t){const e=new u;for(const i of this.g)e.add(t(i));return e}filter(t){const e=new u;for(const i of this.g)t(i)&&e.add(i);return e}delete(t){return this.h&&e.L(this),this.g.delete(t)}remove(t){return this.delete(t)}removeAll(t){if(null===t)return this;if(this.h&&e.L(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.delete(t[i])}else{const e=t.iterator;for(;e.next();)this.delete(e.value)}return this}retainAll(t){if(null===t)return this;if(0===this.count)return this;this.h&&e.L(this);const i=new u;i.addAll(t);const n=[],s=this.iterator;for(;s.next();){const t=s.value;i.has(t)||n.push(t)}return this.removeAll(n),this}clear(){this.h&&e.L(this),this.g.clear()}copy(){const t=new u;return this.g.forEach((e=>t.add(e))),t}toArray(){return Array.from(this.g)}toList(){const t=new l;return this.g.forEach((e=>t.add(e))),t}get count(){return this.g.size}get size(){return this.g.size}get iterator(){return this.g.size<=0?s.instance:new h(this)}entries(){return this.g.entries()}keys(){return this.g.keys()}forEach(t,e){return this.g.forEach(t,e)}static gw=1;static Gi(t){t.__gohashid=u.gw++}static as(t){return t.__gohashid}}class c{q;ii;constructor(t){this.q=t,this.ii=t.g.keys()}[Symbol.iterator](){return this.q.g.keys()}key;value;get iterator(){return this}reset(){const t=this.q;this.ii=t.g.keys()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.q.g.size?null:(this.ii=this.q.g.keys(),this.ii.next().value)}any(t){for(const e of this.q.g)if(t(e[0]))return!0;return!1}all(t){for(const e of this.q.g)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.q.g)t(e[0]);return this}map(t){const e=this.q,i=new l;for(const n of e.g)i.add(t(n[0]));return i.iterator}filter(t){const e=this.q,i=new l;for(const n of e.g){const e=n[0];t(e)&&i.add(e)}return i.iterator}get count(){return this.q.size}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapKeySetIterator"}}class d extends u{q;constructor(t){super(),u.Gi(this),this.h=!0,this.q=t}[Symbol.iterator](){return this.g.keys()}values(){return this.g.keys()}u(){return this}Nt(){return this}toString(){return"MapKeySet("+this.q.toString()+")"}add(t){e.o("This Set is read-only: "+this.toString())}has(t){return this.q.has(t)}contains(t){return this.has(t)}delete(t){e.o("This Set is read-only: "+this.toString())}remove(t){return this.delete(t)}clear(){e.o("This Set is read-only: "+this.toString())}first(){return 0===this.q.g.size?null:this.q.g.keys().next().value}any(t){for(const e of this.q.g)if(t(e[0]))return!0;return!1}all(t){for(const e of this.q.g)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.q.g)t(e[0]);return this}map(t){const e=new u;for(const i of this.q.g)e.add(t(i[0]));return e}filter(t){const e=new u;for(const i of this.q.g){const n=i[0];t(n)&&e.add(n)}return e}copy(){return new d(this.q)}toSet(){const t=new u,e=this.q.g;for(const i of e)t.add(i[0]);return t}toArray(){const t=this.q.g,e=new Array(t.size);let i=0;for(const n of t)e[i]=n[0],i++;return e}toList(){const t=new l,e=this.q.g;for(const i of e)t.add(i[0]);return t}get count(){return this.q.size}get size(){return this.q.size}get iterator(){return this.q.size<=0?s.instance:new c(this.q)}}class f{q;ii;constructor(t){this.q=t,this.ii=t.g.values()}[Symbol.iterator](){return this.q.g.values()}key;value;get iterator(){return this}reset(){const t=this.q;this.ii=t.g.values()}next(){const t=this.ii.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.q.g.size?null:(this.ii=this.q.g.values(),this.ii.next().value)}any(t){for(const e of this.q.g)if(t(e[1]))return!0;return!1}all(t){for(const e of this.q.g)if(!t(e[1]))return!1;return!0}each(t){for(const e of this.q.g)t(e[1]);return this}map(t){const e=this.q,i=new l;for(const n of e.g)i.add(t(n[1]));return i.iterator}filter(t){const e=this.q,i=new l;for(const n of e.g){const e=n[1];t(e)&&i.add(e)}return i.iterator}get count(){return this.q.size}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapValueSetIterator"}}class g{constructor(t,e){this.key=t,this.value=e}toString(){return"{"+this.key+":"+this.value+"}"}key;value}class p{q;ii;constructor(t){this.q=t,this.ii=t.g.entries()}[Symbol.iterator](){return this.q.g.entries()}key;value;get iterator(){return this}reset(){const t=this.q;this.ii=t.g.entries()}next(){const t=this.ii.next();return t.done?(this.key=null,this.value=null,!1):(this.key=t.value[0],this.value=t.value[1],!0)}hasNext(){return this.next()}first(){if(0===this.q.g.size)return null;this.ii=this.q.g.entries();const t=this.ii.next().value;return this.key=t[0],this.value=t[1],new g(t[0],t[1])}any(t){return this.q.any(t)}all(t){return this.q.all(t)}each(t){return this.q.each(t),this}map(t){const e=new l;let i=null;return this.q.g.forEach(((n,s)=>{null===i?i=new g(s,n):(i.key=s,i.value=n),e.add(t(i))})),e.iterator}filter(t){const e=new l;let i=null;return this.q.g.forEach(((n,s)=>{null===i?i=new g(s,n):(i.key=s,i.value=n),t(i)&&(e.add(i),i=null)})),e.iterator}get count(){return this.q.size}fl(){this.key=null,this.value=null,this.ii=null}toString(){return"MapIterator"}}class m{h;g;constructor(t){u.Gi(this),this.h=!1,this.g=new Map,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.g.entries()}entries(){return this.g.entries()}u(){return this.h=!0,this}Nt(){return this.h=!1,this}toString(){return"Map()#"+u.as(this)}set(t,i){return this.h&&e.L(this,t),this.g.set(t,i),this}add(t,e){return this.set(t,e)}addAll(t){if(null===t)return this;if(this.h&&e.L(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];this.set(e.key,e.value)}}else if(t instanceof m){const e=t.iterator;for(;e.next();)this.set(e.key,e.value)}else{const e=t.iterator;for(;e.next();){const t=e.value;this.set(t.key,t.value)}}return this}first(){if(0===this.g.size)return null;const t=this.g.entries().next().value;return new g(t[0],t[1])}any(t){let e=null;for(const[i,n]of this.g)if(null===e?e=new g(i,n):(e.key=i,e.value=n),t(e))return!0;return!1}all(t){let e=null;for(const[i,n]of this.g)if(null===e?e=new g(i,n):(e.key=i,e.value=n),!t(e))return!1;return!0}each(t){let e=null;for(const[i,n]of this.g)null===e?e=new g(i,n):(e.key=i,e.value=n),t(e);return this}map(t){const e=new m;let i=null;for(const[n,s]of this.g)null===i?i=new g(n,s):(i.key=n,i.value=s),e.set(n,t(i));return e}filter(t){const e=new m;let i=null;for(const[n,s]of this.g)null===i?i=new g(n,s):(i.key=n,i.value=s),t(i)&&e.set(n,s);return e}has(t){return this.g.has(t)}contains(t){return this.has(t)}get(t){const e=this.g.get(t);return void 0===e?null:e}getValue(t){return this.get(t)}delete(t){return null!==t&&(this.h&&e.L(this,t),this.g.delete(t))}remove(t){return this.delete(t)}clear(){this.h&&e.L(this),this.g.clear()}copy(){const t=new m;return t.g=new Map(this.g),t}toArray(){const t=this.g,e=new Array(t.size);let i=0;for(const n of t)e[i]=new g(n[0],n[1]),i++;return e}toKeySet(){return new d(this)}get count(){return this.g.size}get size(){return this.g.size}get iterator(){return this.g.size<=0?s.instance:new p(this)}get iteratorKeys(){return this.count<=0?s.instance:new c(this)}keys(){return this.g.keys()}get iteratorValues(){return this.count<=0?s.instance:new f(this)}values(){return this.g.values()}forEach(t,e){return this.g.forEach(t,e)}}class y{px;py;h;constructor(t,i){void 0===t?(this.px=0,this.py=0):"number"==typeof t&&"number"==typeof i?(this.px=t,this.py=i):e.o("Invalid arguments to Point constructor: "+t+", "+i),this.h=!1}a(t){return this.px=t.px,this.py=t.py,this}i(t,e){return this.px=t,this.py=e,this}setTo(t,e){return this.px=t,this.py=e,this}set(t){return this.px=t.px,this.py=t.py,this}copy(){const t=new y;return t.px=this.px,t.py=this.py,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;return s=e[i++],s&&(o=parseFloat(s)),new y(n,o)}return new y}static stringify(t){return t.x.toString()+" "+t.y.toString()}static stringifyFixed(t){return e.s(t,"number",y,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)}toString(){return"Point("+this.x+","+this.y+")"}equals(t){return t instanceof y&&(this.px===t.x&&this.py===t.y)}equalTo(t,e){return this.px===t&&this.py===e}equalsApprox(t){return S.f(this.px,t.x)&&S.f(this.py,t.y)}add(t){return this.px+=t.x,this.py+=t.y,this}subtract(t){return this.px-=t.x,this.py-=t.y,this}offset(t,e){return this.px+=t,this.py+=e,this}rotate(t){if(0===t)return this;const e=this.px,i=this.py;if(0===e&&0===i)return this;let n=0,s=0;if(t>=360?t-=360:t<0&&(t+=360),90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}return this.px=n*e-s*i,this.py=s*e+n*i,this}scale(t,e){return this.px*=t,this.py*=e,this}distanceSquaredPoint(t){const e=t.x-this.px,i=t.y-this.py;return e*e+i*i}distanceSquared(t,e){const i=t-this.px,n=e-this.py;return i*i+n*n}normalize(){const t=this.px,e=this.py,i=Math.sqrt(t*t+e*e);return i>0&&(this.px=t/i,this.py=e/i),this}directionPoint(t){return this.dC(t.x-this.px,t.y-this.py)}direction(t,e){return this.dC(t-this.px,e-this.py)}dC(t,e){if(0===t)return e>0?90:e<0?270:0;if(0===e)return t>0?0:180;{if(isNaN(t)||isNaN(e))return 0;let i=180*Math.atan(Math.abs(e/t))/Math.PI;return t<0?e<0?i+=180:i=180-i:e<0&&(i=360-i),i}}static compareWithLineSegment(t,e,i,n,s,o){return S.eu(t,e,i,n,s,o)}compareWithLineSegmentPoint(t,e){return S.eu(t.x,t.y,e.x,e.y,this.x,this.y)}static intersectingLineSegments(t,e,i,n,s,o,r,a){return S.su(t,e,i,n,s,o,r,a)}projectOntoLineSegment(t,e,i,n){return S.ul(t,e,i,n,this.px,this.py,this),this}projectOntoLineSegmentPoint(t,e){return S.ul(t.x,t.y,e.x,e.y,this.px,this.py,this),this}snapToGrid(t,e,i,n){return S.Dg(this.px,this.py,t,e,i,n,this),this}snapToGridPoint(t,e){return S.Dg(this.px,this.py,t.x,t.y,e.width,e.height,this),this}setRectSpot(t,e){return this.px=t.x+e.x*t.width+e.offsetX,this.py=t.y+e.y*t.height+e.offsetY,this}setSpot(t,e,i,n,s){return this.px=t+s.x*i+s.offsetX,this.py=e+s.y*n+s.offsetY,this}T(t){return t.gt(this),this}Oe(t){return t.$e(this),this}static distanceLineSegmentSquared(t,e,i,n,s,o){let r=s-i,a=o-n;const l=r*r+a*a,h=i-t,u=n-e,c=-h*r-u*a;if(c<=0||c>=l)return r=s-t,a=o-e,Math.min(h*h+u*u,r*r+a*a);{const t=r*u-a*h;return t*t/l}}static distanceSquared(t,e,i,n){const s=i-t,o=n-e;return s*s+o*o}static direction(t,e,i,n){const s=i-t,o=n-e;if(0===s)return o>0?90:o<0?270:0;if(0===o)return s>0?0:180;{if(isNaN(s)||isNaN(o))return 0;let t=180*Math.atan(Math.abs(o/s))/Math.PI;return s<0?o<0?t+=180:t=180-t:o<0&&(t=360-t),t}}get x(){return this.px}set x(t){this.px=t}get y(){return this.py}set y(t){this.py=t}isReal(){return isFinite(this.x)&&isFinite(this.y)}static wo=(()=>new y(0,0).$())();static gC=(()=>new y(-1/0,-1/0).$())();static mC=(()=>new y(1/0,1/0).$())();static pC=(()=>new y(6,6).$())();static Ok=(()=>new y(NaN,NaN).$())();static Ik=[];static l(){const t=y.Ik.pop();return void 0===t?new y:t}static V(t,e){const i=y.Ik.pop();return void 0===i?new y(t,e):(i.x=t,i.y=e,i)}static e(t){y.Ik.push(t)}}class x{sw;sh;h;constructor(t,i){void 0===t?(this.sw=0,this.sh=0):"number"==typeof t&&(t>=0||isNaN(t))&&"number"==typeof i&&(i>=0||isNaN(i))?(this.sw=t,this.sh=i):e.o("Invalid arguments to Size constructor: "+t+", "+i),this.h=!1}a(t){return this.sw=t.sw,this.sh=t.sh,this}i(t,e){return this.sw=t,this.sh=e,this}setTo(t,e){return this.sw=t,this.sh=e,this}set(t){return this.sw=t.sw,this.sh=t.sh,this}copy(){const t=new x;return t.sw=this.sw,t.sh=this.sh,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;return s=e[i++],s&&(o=parseFloat(s)),new x(n,o)}return new x}static stringify(t){return t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return e.s(t,"number",x,"stringifyFixed:digits"),e=>e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Size("+this.width+","+this.height+")"}equals(t){return t instanceof x&&(this.sw===t.width&&this.sh===t.height)}equalTo(t,e){return this.sw===t&&this.sh===e}equalsApprox(t){return S.f(this.sw,t.width)&&S.f(this.sh,t.height)}inflate(t,e){const i=this.width+t;this.sw=i>=0?i:0;const n=this.height+e;return this.sh=n>=0?n:0,this}get width(){return this.sw}set width(t){t<0&&e.W(t,">= 0",x,"width"),this.sw=t}get height(){return this.sh}set height(t){t<0&&e.W(t,">= 0",x,"height"),this.sh=t}isReal(){return isFinite(this.width)&&isFinite(this.height)}static sc=(()=>new x(0,0).$())();static Ek=(()=>new x(1,1).$())();static yC=(()=>new x(6,6).$())();static nu=(()=>new x(8,8).$())();static wC=(()=>new x(10,10).$())();static Bk=(()=>new x(1/0,1/0).$())();static pw=(()=>new x(NaN,NaN).$())();static xC=[];static l(){const t=x.xC.pop();return void 0===t?new x:t}static e(t){x.xC.push(t)}}class v{rx;ry;rw;rh;h;constructor(t,i,n,s){if(void 0===t)this.rx=0,this.ry=0,this.rw=0,this.rh=0;else if("number"==typeof t&&"number"==typeof i&&"number"==typeof n&&(n>=0||isNaN(n))&&"number"==typeof s&&(s>=0||isNaN(s)))this.rx=t,this.ry=i,this.rw=n,this.rh=s;else if(t instanceof y){const n=t.x,s=t.y;if(i instanceof y){const t=i.x,e=i.y;this.rx=Math.min(n,t),this.ry=Math.min(s,e),this.rw=Math.abs(n-t),this.rh=Math.abs(s-e)}else i instanceof x?(this.rx=n,this.ry=s,this.rw=i.width,this.rh=i.height):e.o("Incorrect second argument supplied to Rect constructor "+i)}else e.o("Invalid arguments to Rect constructor: "+t+", "+i+", "+n+", "+s);this.h=!1}a(t){return this.rx=t.rx,this.ry=t.ry,this.rw=t.rw,this.rh=t.rh,this}i(t,e,i,n){return this.rx=t,this.ry=e,this.rw=i,this.rh=n,this}Fn(t,e){return this.rw=t,this.rh=e,this}setTo(t,e,i,n){return this.rx=t,this.ry=e,this.rw=i,this.rh=n,this}set(t){return this.rx=t.rx,this.ry=t.ry,this.rw=t.rw,this.rh=t.rh,this}setPoint(t){return this.rx=t.x,this.ry=t.y,this}setSize(t){return this.rw=t.width,this.rh=t.height,this}copy(){const t=new v;return t.rx=this.rx,t.ry=this.ry,t.rw=this.rw,t.rh=this.rh,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;s=e[i++],s&&(o=parseFloat(s));let r=0;for(;""===e[i];)i++;s=e[i++],s&&(r=parseFloat(s));let a=0;for(;""===e[i];)i++;return s=e[i++],s&&(a=parseFloat(s)),new v(n,o,r,a)}return new v}static stringify(t){return t.x.toString()+" "+t.y.toString()+" "+t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return e.s(t,"number",v,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"}equals(t){return t instanceof v&&(this.rx===t.x&&this.ry===t.y&&this.rw===t.width&&this.rh===t.height)}equalTo(t,e,i,n){return this.rx===t&&this.ry===e&&this.rw===i&&this.rh===n}equalsApprox(t){return S.f(this.rx,t.x)&&S.f(this.ry,t.y)&&S.f(this.rw,t.width)&&S.f(this.rh,t.height)}equalsApproxTo(t,e,i,n){return S.f(this.rx,t)&&S.f(this.ry,e)&&S.f(this.rw,i)&&S.f(this.rh,n)}equalsApproxClose(t){return S.z(this.rx,t.x)&&S.z(this.ry,t.y)&&S.z(this.rw,t.width)&&S.z(this.rh,t.height)}containsPoint(t){return this.rx<=t.x&&this.rx+this.rw>=t.x&&this.ry<=t.y&&this.ry+this.rh>=t.y}containsRect(t){return this.rx<=t.x&&t.x+t.width<=this.rx+this.rw&&this.ry<=t.y&&t.y+t.height<=this.ry+this.rh}contains(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.rx<=t&&t+i<=this.rx+this.rw&&this.ry<=e&&e+n<=this.ry+this.rh}offset(t,e){return this.rx+=t,this.ry+=e,this}inflate(t,e){return this.yw(e,t,e,t)}addMargin(t){return this.yw(t.top,t.right,t.bottom,t.left)}subtractMargin(t){return this.yw(-t.top,-t.right,-t.bottom,-t.left)}grow(t,e,i,n){return this.yw(t,e,i,n)}yw(t,e,i,n){const s=this.rw;e+n<=-s?(this.rx+=s/2,this.rw=0):(this.rx-=n,this.rw+=e+n);const o=this.rh;return t+i<=-o?(this.ry+=o/2,this.rh=0):(this.ry-=t,this.rh+=t+i),this}intersectRect(t){return this.bC(t.x,t.y,t.width,t.height)}intersect(t,e,i,n){return this.bC(t,e,i,n)}bC(t,e,i,n){const s=Math.max(this.rx,t),o=Math.max(this.ry,e),r=Math.min(this.rx+this.rw,t+i),a=Math.min(this.ry+this.rh,e+n);return this.rx=s,this.ry=o,this.rw=Math.max(0,r-s),this.rh=Math.max(0,a-o),this}intersectsRect(t){return this.intersects(t.x,t.y,t.width,t.height)}intersects(t,e,i,n){let s=this.rw;const o=this.rx;if(s!==1/0&&i!==1/0&&(s+=o,i+=t,isNaN(i)||isNaN(s)||o>i||t>s))return!1;let r=this.rh;const a=this.ry;return!(r!==1/0&&n!==1/0&&(r+=a,n+=e,isNaN(n)||isNaN(r)||a>n||e>r))}intersectsRectPlus(t,e){let i=this.rw,n=t.width+e+e;const s=this.rx,o=t.x-e;if(i+=s,n+=o,s>n||o>i)return!1;let r=this.rh,a=t.height+e+e;const l=this.ry,h=t.y-e;return r+=l,a+=h,!(l>a||h>r)}unionPoint(t){return this.unionNoCheck(t.x,t.y,0,0)}unionRect(t){return this.unionNoCheck(t.rx,t.ry,t.rw,t.rh)}union(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.unionNoCheck(t,e,i,n)}unionNoCheck(t,e,i,n){const s=Math.min(this.rx,t),o=Math.min(this.ry,e),r=Math.max(this.rx+this.rw,t+i),a=Math.max(this.ry+this.rh,e+n);return this.rx=s,this.ry=o,this.rw=r-s,this.rh=a-o,this}setSpot(t,e,i){return this.rx=t-i.offsetX-i.x*this.rw,this.ry=e-i.offsetY-i.y*this.rh,this}static contains(t,e,i,n,s,o,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t<=s&&s+r<=t+i&&e<=o&&o+a<=e+n}static intersects(t,e,i,n,s,o,r,a){let l=i,h=r;if(l+=t,h+=s,t>h||s>l)return!1;let u=n,c=a;return u+=e,c+=o,!(e>c||o>u)}static intersectsLineSegment(t,e,i,n,s,o,r,a){return S.kC(t,e,i,n,s,o,r,a)}get x(){return this.rx}set x(t){this.rx=t}get y(){return this.ry}set y(t){this.ry=t}get width(){return this.rw}set width(t){t<0&&e.W(t,">= 0",v,"width"),this.rw=t}get height(){return this.rh}set height(t){t<0&&e.W(t,">= 0",v,"height"),this.rh=t}get left(){return this.rx}set left(t){this.rx=t}get top(){return this.ry}set top(t){this.ry=t}get right(){return this.rx+this.rw}set right(t){this.rx+=t-(this.rx+this.rw)}get bottom(){return this.ry+this.rh}set bottom(t){this.ry+=t-(this.ry+this.rh)}get position(){return new y(this.rx,this.ry)}set position(t){this.rx=t.x,this.ry=t.y}get size(){return new x(this.rw,this.rh)}set size(t){this.rw=t.width,this.rh=t.height}get center(){return new y(this.rx+this.rw/2,this.ry+this.rh/2)}set center(t){this.rx=t.x-this.rw/2,this.ry=t.y-this.rh/2}get centerX(){return this.rx+this.rw/2}set centerX(t){this.rx=t-this.rw/2}get centerY(){return this.ry+this.rh/2}set centerY(t){this.ry=t-this.rh/2}isReal(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)}isEmpty(){return 0===this.width&&0===this.height}static Fg=(()=>new v(0,0,0,0).$())();static JD=(()=>new v(NaN,NaN,NaN,NaN).$())();static Uk=[];static l(){const t=v.Uk.pop();return void 0===t?new v:t}static V(t,e,i,n){const s=v.Uk.pop();return void 0===s?new v(t,e,i,n):s.i(t,e,i,n)}static e(t){v.Uk.push(t)}}class b{mt;mr;mb;ml;h;constructor(t,i,n,s){void 0===t?(this.mt=0,this.mr=0,this.mb=0,this.ml=0):void 0===i?(i=t,n=t,s=t,this.mt=t,this.mr=i,this.mb=n,this.ml=s):void 0===n?(n=t,s=i,this.mt=t,this.mr=i,this.mb=n,this.ml=s):void 0!==s?(this.mt=t,this.mr=i,this.mb=n,this.ml=s):e.o("Invalid arguments to Margin constructor: "+t+", "+i+", "+n+", "+s),this.h=!1}a(t){return this.mt=t.mt,this.mr=t.mr,this.mb=t.mb,this.ml=t.ml,this}setTo(t,e,i,n){return this.mt=t,this.mr=e,this.mb=i,this.ml=n,this}set(t){return this.mt=t.mt,this.mr=t.mr,this.mb=t.mb,this.ml=t.ml,this}copy(){const t=new b;return t.mt=this.mt,t.mr=this.mr,t.mb=this.mb,t.ml=this.ml,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=NaN;for(;""===e[i];)i++;let s=e[i++];if(s&&(n=parseFloat(s)),isNaN(n))return new b;let o=NaN;for(;""===e[i];)i++;if(s=e[i++],s&&(o=parseFloat(s)),isNaN(o))return new b(n);let r=NaN;for(;""===e[i];)i++;if(s=e[i++],s&&(r=parseFloat(s)),isNaN(r))return new b(n,o);let a=NaN;for(;""===e[i];)i++;return s=e[i++],s&&(a=parseFloat(s)),isNaN(a)?new b(n,o):new b(n,o,r,a)}return new b}static stringify(t){return t.top.toString()+" "+t.right.toString()+" "+t.bottom.toString()+" "+t.left.toString()}static stringifyFixed(t){return e.s(t,"number",b,"stringifyFixed:digits"),e=>e.top.toFixed(t)+" "+e.right.toFixed(t)+" "+e.bottom.toFixed(t)+" "+e.left.toFixed(t)}toString(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"}equals(t){return t instanceof b&&(this.mt===t.top&&this.mr===t.right&&this.mb===t.bottom&&this.ml===t.left)}equalTo(t,e,i,n){return this.mt===t&&this.mr===e&&this.mb===i&&this.ml===n}equalsApprox(t){return S.f(this.mt,t.top)&&S.f(this.mr,t.right)&&S.f(this.mb,t.bottom)&&S.f(this.ml,t.left)}get top(){return this.mt}set top(t){this.mt=t}get right(){return this.mr}set right(t){this.mr=t}get bottom(){return this.mb}set bottom(t){this.mb=t}get left(){return this.ml}set left(t){this.ml=t}isReal(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)}static Rg=(()=>new b(0,0,0,0).$())();static PC=(()=>new b(2,2,2,2).$())();static SC=[];static l(){const t=b.SC.pop();return void 0===t?new b:t}static e(t){b.SC.push(t)}}class w{sx;sy;ox;oy;h;constructor(t,e,i,n){void 0===t?(this.sx=0,this.sy=0,this.ox=0,this.oy=0):(void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.sx=t,this.sy=e,this.ox=i,this.oy=n),this.h=!1}a(t){return this.sx=t.sx,this.sy=t.sy,this.ox=t.ox,this.oy=t.oy,this}setTo(t,e,i,n){return this.sx=t,this.sy=e,this.ox=i,this.oy=n,this}set(t){return this.sx=t.sx,this.sy=t.sy,this.ox=t.ox,this.oy=t.oy,this}copy(){const t=new w;return t.sx=this.sx,t.sy=this.sy,t.ox=this.ox,t.oy=this.oy,t}$(){return this.h=!0,Object.freeze(this),this}P(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}Nt(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}mw(t){}Ie(t){return this.sx=NaN,this.sy=NaN,this.ox=t,this}yE(t,i){(isNaN(t)||t>1||t<0)&&e.W(t,"0 <= "+i+" <= 1",w,i)}wE(t,i){(isNaN(t)||t===1/0||t===-1/0)&&e.W(t,"real number, not NaN or Infinity",w,i)}static parse(t){if("string"==typeof t){if("None"===(t=t.trim()))return w.None;if("TopLeft"===t)return w.TopLeft;if("Top"===t||"TopCenter"===t||"MiddleTop"===t)return w.TopCenter;if("TopRight"===t)return w.TopRight;if("Left"===t||"LeftCenter"===t||"MiddleLeft"===t)return w.LeftCenter;if("Center"===t)return w.Center;if("Right"===t||"RightCenter"===t||"MiddleRight"===t)return w.RightCenter;if("BottomLeft"===t)return w.BottomLeft;if("Bottom"===t||"BottomCenter"===t||"MiddleBottom"===t)return w.BottomCenter;if("BottomRight"===t)return w.BottomRight;if("TopSide"===t)return w.TopSide;if("LeftSide"===t)return w.LeftSide;if("RightSide"===t)return w.RightSide;if("BottomSide"===t)return w.BottomSide;if("TopBottomSides"===t)return w.TopBottomSides;if("LeftRightSides"===t)return w.LeftRightSides;if("TopLeftSides"===t)return w.TopLeftSides;if("TopRightSides"===t)return w.TopRightSides;if("BottomLeftSides"===t)return w.BottomLeftSides;if("BottomRightSides"===t)return w.BottomRightSides;if("NotTopSide"===t)return w.NotTopSide;if("NotLeftSide"===t)return w.NotLeftSide;if("NotRightSide"===t)return w.NotRightSide;if("NotBottomSide"===t)return w.NotBottomSide;if("AllSides"===t)return w.AllSides;if("Default"===t)return w.Default;const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];void 0!==s&&s.length>0&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;s=e[i++],void 0!==s&&s.length>0&&(o=parseFloat(s));let r=0;for(;""===e[i];)i++;s=e[i++],void 0!==s&&s.length>0&&(r=parseFloat(s));let a=0;for(;""===e[i];)i++;return s=e[i++],void 0!==s&&s.length>0&&(a=parseFloat(s)),new w(n,o,r,a)}return new w}static stringify(t){return t.isSpot()?t.x.toString()+" "+t.y.toString()+" "+t.offsetX.toString()+" "+t.offsetY.toString():t.toString()}static stringifyFixed(t){return e.s(t,"number",w,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.offsetX.toFixed(t)+" "+e.offsetY.toFixed(t)}toString(){return this.isSpot()?0===this.ox&&0===this.oy?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.equals(w.None)?"None":this.equals(w.TopLeft)?"TopLeft":this.equals(w.TopCenter)?"Top":this.equals(w.TopRight)?"TopRight":this.equals(w.LeftCenter)?"Left":this.equals(w.Center)?"Center":this.equals(w.RightCenter)?"Right":this.equals(w.BottomLeft)?"BottomLeft":this.equals(w.BottomCenter)?"Bottom":this.equals(w.BottomRight)?"BottomRight":this.equals(w.TopSide)?"TopSide":this.equals(w.LeftSide)?"LeftSide":this.equals(w.RightSide)?"RightSide":this.equals(w.BottomSide)?"BottomSide":this.equals(w.TopBottomSides)?"TopBottomSides":this.equals(w.LeftRightSides)?"LeftRightSides":this.equals(w.TopLeftSides)?"TopLeftSides":this.equals(w.TopRightSides)?"TopRightSides":this.equals(w.BottomLeftSides)?"BottomLeftSides":this.equals(w.BottomRightSides)?"BottomRightSides":this.equals(w.NotTopSide)?"NotTopSide":this.equals(w.NotLeftSide)?"NotLeftSide":this.equals(w.NotRightSide)?"NotRightSide":this.equals(w.NotBottomSide)?"NotBottomSide":this.equals(w.AllSides)?"AllSides":this.equals(w.Default)?"Default":"None"}equals(t){return t instanceof w&&((this.sx===t.x||isNaN(this.sx)&&isNaN(t.x))&&(this.sy===t.y||isNaN(this.sy)&&isNaN(t.y))&&this.ox===t.offsetX&&this.oy===t.offsetY)}opposite(){return new w(.5-(this.sx-.5),.5-(this.sy-.5),-this.ox,-this.oy)}includesSide(t){if(!this.isSide())return!1;if(!t.isSide())if(t.equals(w.Left))t=w.LeftSide;else if(t.equals(w.Right))t=w.RightSide;else if(t.equals(w.Top))t=w.TopSide;else{if(!t.equals(w.Bottom))return!1;t=w.BottomSide}const e=this.oy,i=t.offsetY;return(e&i)===i}get x(){return this.sx}set x(t){this.sx=t}get y(){return this.sy}set y(t){this.sy=t}get offsetX(){return this.ox}set offsetX(t){this.ox=t}get offsetY(){return this.oy}set offsetY(t){this.oy=t}isSpot(){return!isNaN(this.x)&&!isNaN(this.y)}isNoSpot(){return isNaN(this.x)||isNaN(this.y)}isSide(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY}isNone(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY}isDefault(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY}static None=(()=>new w(0,0,0,0).Ie(0).$())();static Default=(()=>new w(0,0,-1,0).Ie(-1).$())();static TopLeft=(()=>new w(0,0,0,0).$())();static TopCenter=(()=>new w(.5,0,0,0).$())();static TopRight=(()=>new w(1,0,0,0).$())();static LeftCenter=(()=>new w(0,.5,0,0).$())();static Center=(()=>new w(.5,.5,0,0).$())();static RightCenter=(()=>new w(1,.5,0,0).$())();static BottomLeft=(()=>new w(0,1,0,0).$())();static BottomCenter=(()=>new w(.5,1,0,0).$())();static BottomRight=(()=>new w(1,1,0,0).$())();static MiddleTop=(()=>w.TopCenter)();static MiddleLeft=(()=>w.LeftCenter)();static MiddleRight=(()=>w.RightCenter)();static MiddleBottom=(()=>w.BottomCenter)();static Top=(()=>w.TopCenter)();static Left=(()=>w.LeftCenter)();static Right=(()=>w.RightCenter)();static Bottom=(()=>w.BottomCenter)();static TopSide=(()=>new w(0,0,1,1).Ie(1).$())();static LeftSide=(()=>new w(0,0,1,2).Ie(1).$())();static RightSide=(()=>new w(0,0,1,4).Ie(1).$())();static BottomSide=(()=>new w(0,0,1,8).Ie(1).$())();static TopBottomSides=(()=>new w(0,0,1,9).Ie(1).$())();static LeftRightSides=(()=>new w(0,0,1,6).Ie(1).$())();static TopLeftSides=(()=>new w(0,0,1,3).Ie(1).$())();static TopRightSides=(()=>new w(0,0,1,5).Ie(1).$())();static BottomLeftSides=(()=>new w(0,0,1,10).Ie(1).$())();static BottomRightSides=(()=>new w(0,0,1,12).Ie(1).$())();static NotTopSide=(()=>new w(0,0,1,14).Ie(1).$())();static NotLeftSide=(()=>new w(0,0,1,13).Ie(1).$())();static NotRightSide=(()=>new w(0,0,1,11).Ie(1).$())();static NotBottomSide=(()=>new w(0,0,1,7).Ie(1).$())();static AllSides=(()=>new w(0,0,1,15).Ie(1).$())();static Vk=(()=>new w(.156,.156).$())();static zk=(()=>new w(.844,.844).$())();static MC=[];static l(){const t=w.MC.pop();return void 0===t?new w:t}static e(t){w.MC.push(t)}}class k{m11;m12;m21;m22;dx;dy;constructor(){this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0}set(t){return this.m11=t.m11,this.m12=t.m12,this.m21=t.m21,this.m22=t.m22,this.dx=t.dx,this.dy=t.dy,this}setTo(t,e,i,n,s,o){return this.m11=t,this.m12=e,this.m21=i,this.m22=n,this.dx=s,this.dy=o,this}copy(){const t=new k;return t.m11=this.m11,t.m12=this.m12,t.m21=this.m21,t.m22=this.m22,t.dx=this.dx,t.dy=this.dy,t}toString(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"}equals(t){return this.m11===t.m11&&this.m12===t.m12&&this.m21===t.m21&&this.m22===t.m22&&this.dx===t.dx&&this.dy===t.dy}Xk(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22}Ri(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0,this}nc(t){const e=this.m11*t.m11+this.m21*t.m12,i=this.m12*t.m11+this.m22*t.m12,n=this.m11*t.m21+this.m21*t.m22,s=this.m12*t.m21+this.m22*t.m22;return this.dx=this.m11*t.dx+this.m21*t.dy+this.dx,this.dy=this.m12*t.dx+this.m22*t.dy+this.dy,this.m11=e,this.m12=i,this.m21=n,this.m22=s,this}NC(t){const e=1/(t.m11*t.m22-t.m12*t.m21),i=t.m22*e,n=-t.m12*e,s=-t.m21*e,o=t.m11*e,r=e*(t.m21*t.dy-t.m22*t.dx),a=e*(t.m12*t.dx-t.m11*t.dy),l=this.m11*i+this.m21*n,h=this.m12*i+this.m22*n,u=this.m11*s+this.m21*o,c=this.m12*s+this.m22*o;return this.dx=this.m11*r+this.m21*a+this.dx,this.dy=this.m12*r+this.m22*a+this.dy,this.m11=l,this.m12=h,this.m21=u,this.m22=c,this}ww(){const t=1/(this.m11*this.m22-this.m12*this.m21),e=this.m22*t,i=-this.m12*t,n=-this.m21*t,s=this.m11*t,o=t*(this.m21*this.dy-this.m22*this.dx),r=t*(this.m12*this.dx-this.m11*this.dy);return this.m11=e,this.m12=i,this.m21=n,this.m22=s,this.dx=o,this.dy=r,this}cs(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return this;this.Fs(e,i);let n=0,s=0;if(90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}const o=this.m11*n+this.m21*s,r=this.m12*n+this.m22*s,a=this.m11*-s+this.m21*n,l=this.m12*-s+this.m22*n;return this.m11=o,this.m12=r,this.m21=a,this.m22=l,this.Fs(-e,-i),this}Fs(t,e){return this.dx+=this.m11*t+this.m21*e,this.dy+=this.m12*t+this.m22*e,this}tt(t,e){return void 0===e&&(e=t),this.m11*=t,this.m12*=t,this.m21*=e,this.m22*=e,this}$D(){if(1===this.m11&&0===this.m12)return 0;let t=180*Math.atan2(this.m12,this.m11)/Math.PI;return t<0&&(t+=360),t}gt(t){const e=t.x,i=t.y;return t.i(e*this.m11+i*this.m21+this.dx,e*this.m12+i*this.m22+this.dy)}$e(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,n=-this.m12*e,s=-this.m21*e,o=this.m11*e,r=t.x-this.dx,a=t.y-this.dy;return t.i(r*i+a*s,r*n+a*o)}xw(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,n=-this.m12*e,s=-this.m21*e,o=this.m11*e,r=e*(this.m21*this.dy-this.m22*this.dx),a=e*(this.m12*this.dx-this.m11*this.dy),l=1.25*t.x,h=1.2*t.y;return t.i(l*i+h*s+r,l*n+h*o+a)}vg(t){const e=t.x,i=t.y,n=e+t.width,s=i+t.height,o=this.m11,r=this.m12,a=this.m21,l=this.m22,h=this.dx,u=this.dy,c=e*o+i*a+h,d=e*r+i*l+u,f=n*o+i*a+h,g=n*r+i*l+u,p=e*o+s*a+h,m=e*r+s*l+u,y=n*o+s*a+h,x=n*r+s*l+u;let v=c,b=c,w=d,k=d;return v=Math.min(v,f),b=Math.max(b,f),w=Math.min(w,g),k=Math.max(k,g),v=Math.min(v,p),b=Math.max(b,p),w=Math.min(w,m),k=Math.max(k,m),v=Math.min(v,y),b=Math.max(b,y),w=Math.min(w,x),k=Math.max(k,x),t.i(v,w,b-v,k-w),t}static CC=[];static l(){const t=k.CC.pop();return void 0===t?new k:t}static e(t){k.CC.push(t)}static Yk="54a702f3e53909c447824c6706603faf4c"}const S={ZD:"7da71ca0ad381e90",Rn:(Math.sqrt(2)-1)/3*4,LC:null,bw:t=>{if(t<=0)return 0;let e=S.LC;if(null===e){e=[];for(let t=0;t<=2e3;t++)e[t]=Math.sqrt(t);S.LC=e}if(t<1){const i=1/t;return i<=2e3?1/e[0|i]:Math.sqrt(t)}return t<=2e3?e[0|t]:Math.sqrt(t)},f:(t,e)=>{const i=t-e;return i<.5&&i>-.5},z:(t,e)=>{const i=t-e;return i<5e-8&&i>-5e-8},vi:(t,e,i,n,s,o,r)=>{s<=0&&(s=1e-6);let a=0,l=0,h=0,u=0;if(t<i?(l=t,a=i):(l=i,a=t),e<n?(u=e,h=n):(u=n,h=e),t===i)return u<=r&&r<=h&&t-s<=o&&o<=t+s;if(e===n)return l<=o&&o<=a&&e-s<=r&&r<=e+s;const c=a+s,d=l-s;if(d<=o&&o<=c){const a=h+s,l=u-s;if(l<=r&&r<=a)if(c-d>a-l){if(!(t-i>s||i-t>s))return!0;{const a=(n-e)/(i-t)*(o-t)+e;if(a-s<=r&&r<=a+s)return!0}}else{if(!(e-n>s||n-e>s))return!0;{const a=(i-t)/(n-e)*(r-e)+t;if(a-s<=o&&o<=a+s)return!0}}}return!1},kw:(t,e,i,n,s,o,r,a,l,h,u,c)=>{if(S.vi(t,e,r,a,c,i,n)&&S.vi(t,e,r,a,c,s,o))return S.vi(t,e,r,a,c,h,u);{const d=(t+i)/2,f=(e+n)/2,g=(i+s)/2,p=(n+o)/2,m=(s+r)/2,y=(o+a)/2,x=(d+g)/2,v=(f+p)/2,b=(g+m)/2,w=(p+y)/2,k=(x+b)/2,P=(v+w)/2;return S.kw(t,e,d,f,x,v,k,P,l,h,u,c)||S.kw(k,P,b,w,m,y,r,a,l,h,u,c)}},AC:(t,e,i,n,s,o,r,a,l)=>{const h=(i+s)/2,u=(n+o)/2,c=((t+i)/2+h)/2,d=((e+n)/2+u)/2,f=(h+(s+r)/2)/2,g=(u+(o+a)/2)/2;return l.i((c+f)/2,(d+g)/2),l},QD:(t,e,i,n,s,o,r,a)=>{const l=(i+s)/2,h=(n+o)/2,u=((t+i)/2+l)/2,c=((e+n)/2+h)/2,d=(l+(s+r)/2)/2,f=(h+(o+a)/2)/2;return y.direction(u,c,d,f)},ou:(t,e,i,n,s,o,r,a,l,h)=>{if(S.vi(t,e,r,a,l,i,n)&&S.vi(t,e,r,a,l,s,o))h.unionNoCheck(t,e,0,0),h.unionNoCheck(r,a,0,0);else{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(s+r)/2,p=(o+a)/2,m=(u+d)/2,y=(c+f)/2,x=(d+g)/2,v=(f+p)/2,b=(m+x)/2,w=(y+v)/2;S.ou(t,e,u,c,m,y,b,w,l,h),S.ou(b,w,x,v,g,p,r,a,l,h)}return h},vn:(t,e,i,n,s,o,r,a,l,h)=>{if(S.vi(t,e,r,a,l,i,n)&&S.vi(t,e,r,a,l,s,o))0===h.length&&(h.push(t),h.push(e)),h.push(r),h.push(a);else{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(s+r)/2,p=(o+a)/2,m=(u+d)/2,y=(c+f)/2,x=(d+g)/2,v=(f+p)/2,b=(m+x)/2,w=(y+v)/2;S.vn(t,e,u,c,m,y,b,w,l,h),S.vn(b,w,x,v,g,p,r,a,l,h)}return h},Kk:(t,e,i,n,s,o,r,a,l,h)=>{if(S.vi(t,e,s,o,h,i,n))return S.vi(t,e,s,o,h,a,l);{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(u+d)/2,p=(c+f)/2;return S.Kk(t,e,u,c,g,p,r,a,l,h)||S.Kk(g,p,d,f,s,o,r,a,l,h)}},xE:(t,e,i,n,s,o,r)=>{const a=(t+i)/2,l=(e+n)/2,h=(i+s)/2,u=(n+o)/2;return r.i((a+h)/2,(l+u)/2),r},Gk:(t,e,i,n,s,o,r,a)=>{if(S.vi(t,e,s,o,r,i,n))a.unionNoCheck(t,e,0,0),a.unionNoCheck(s,o,0,0);else{const l=(t+i)/2,h=(e+n)/2,u=(i+s)/2,c=(n+o)/2,d=(l+u)/2,f=(h+c)/2;S.Gk(t,e,l,h,d,f,r,a),S.Gk(d,f,u,c,s,o,r,a)}return a},Og:(t,e,i,n,s,o,r,a)=>{if(S.vi(t,e,s,o,r,i,n))0===a.length&&(a.push(t),a.push(e)),a.push(s),a.push(o);else{const l=(t+i)/2,h=(e+n)/2,u=(i+s)/2,c=(n+o)/2,d=(l+u)/2,f=(h+c)/2;S.Og(t,e,l,h,d,f,r,a),S.Og(d,f,u,c,s,o,r,a)}return a},Ig:(t,e,i,n,s,o,r,a,l,h,u,c,d,f)=>{if(S.vi(t,e,r,a,d,i,n)&&S.vi(t,e,r,a,d,s,o)){if(!S.su(t,e,r,a,l,h,u,c))return!1;const i=(t-r)*(h-c)-(e-a)*(l-u);if(0===i)return!1;const n=((t*a-e*r)*(l-u)-(t-r)*(l*c-h*u))/i,s=((t*a-e*r)*(h-c)-(e-a)*(l*c-h*u))/i;return f.i(n,s),!0}{const g=(t+i)/2,p=(e+n)/2,m=(i+s)/2,y=(n+o)/2,x=(s+r)/2,v=(o+a)/2,b=(g+m)/2,w=(p+y)/2,k=(m+x)/2,P=(y+v)/2,M=(b+k)/2,C=(w+P)/2;let N=1/0,T=!1,L=0,A=0;if(S.Ig(t,e,g,p,b,w,M,C,l,h,u,c,d,f)){const t=(f.x-l)**2+(f.y-h)**2;t<N&&(N=t,T=!0,L=f.x,A=f.y)}if(S.Ig(M,C,k,P,x,v,r,a,l,h,u,c,d,f)){const t=(f.x-l)**2+(f.y-h)**2;t<N&&(N=t,T=!0,L=f.x,A=f.y)}return T&&(f.x=L,f.y=A),T}},Eg:(t,e,i,n,s,o,r,a,l,h,u,c,d)=>{let f=0;if(S.vi(t,e,r,a,d,i,n)&&S.vi(t,e,r,a,d,s,o)){const i=(t-r)*(h-c)-(e-a)*(l-u);if(0===i)return f;const n=((t*a-e*r)*(l-u)-(t-r)*(l*c-h*u))/i,s=((t*a-e*r)*(h-c)-(e-a)*(l*c-h*u))/i;if(n>=u)return f;let o=0,d=0;if((l>u?l-u:u-l)<(h>c?h-c:c-h)){if(e<a?(o=e,d=a):(o=a,d=e),s<o||s>d)return f}else if(t<r?(o=t,d=r):(o=r,d=t),n<o||n>d)return f;i>0?f++:i<0&&f--}else{const g=(t+i)/2,p=(e+n)/2,m=(i+s)/2,y=(n+o)/2,x=(s+r)/2,v=(o+a)/2,b=(g+m)/2,w=(p+y)/2,k=(m+x)/2,P=(y+v)/2,M=(b+k)/2,C=(w+P)/2;f+=S.Eg(t,e,g,p,b,w,M,C,l,h,u,c,d),f+=S.Eg(M,C,k,P,x,v,r,a,l,h,u,c,d)}return f},ul:(t,e,i,n,s,o,r)=>{if(S.z(t,i)){let i=0,s=0;e<n?(i=e,s=n):(i=n,s=e);const a=o;return a<i?(r.i(t,i),!1):a>s?(r.i(t,s),!1):(r.i(t,a),!0)}if(S.z(e,n)){let n=0,o=0;t<i?(n=t,o=i):(n=i,o=t);const a=s;return a<n?(r.i(n,e),!1):a>o?(r.i(o,e),!1):(r.i(a,e),!0)}{const a=((t-s)*(t-i)+(e-o)*(e-n))/((i-t)**2+(n-e)**2);if(a<-5e-6)return r.i(t,e),!1;if(a>1.000005)return r.i(i,n),!1;{const s=t+a*(i-t),o=e+a*(n-e);return r.i(s,o),!0}}},On:(t,e,i,n,s,o,r,a,l)=>{if(S.f(t,i)&&S.f(e,n))return l.i(t,e),!1;if(S.z(s,r)){if(S.z(t,i))return S.ul(t,e,i,n,s,o,l),!1;{const o=(n-e)/(i-t)*(s-t)+e;return S.ul(t,e,i,n,s,o,l)}}{const h=(a-o)/(r-s);if(S.z(t,i)){const i=h*(t-s)+o;let r=0,a=0;return e<n?(r=e,a=n):(r=n,a=e),i<r?(l.i(t,r),!1):i>a?(l.i(t,a),!1):(l.i(t,i),!0)}{const r=(n-e)/(i-t);if(S.z(h,r))return S.ul(t,e,i,n,s,o,l),!1;{const a=(r*t-h*s+o-e)/(r-h);if(S.z(r,0)){let n=0,s=0;return t<i?(n=t,s=i):(n=i,s=t),a<n?(l.i(n,e),!1):a>s?(l.i(s,e),!1):(l.i(a,e),!0)}{const s=r*(a-t)+e;return S.ul(t,e,i,n,a,s,l)}}}}},bE:(t,e,i,n,s)=>S.On(i.x,i.y,n.x,n.y,t.x,t.y,e.x,e.y,s),kE:(t,e,i,n,s,o,r,a,l,h)=>{let u=1/0;function c(i,n){const s=(i-t)**2+(n-e)**2;s<u&&(u=s,l.i(i,n))}c(l.x,l.y);let d=0,f=0,g=0,p=0;s<r?(d=s,f=r):(d=r,f=s),o<a?(g=s,p=r):(g=r,p=s);const m=(f-d)/2+h,y=(p-g)/2+h,x=(s+r)/2,v=(o+a)/2;if(0===m||0===y)return l;if(S.f(t,i)){const t=1-(i-x)**2/(m*m);if(t<0)return l;const e=Math.sqrt(t),n=-y*e+v;c(i,y*e+v),c(i,n)}else{const s=(n-e)/(i-t),o=1/(m*m)+s*s/(y*y),r=2*s*(e-s*t)/(y*y)-2*s*v/(y*y)-2*x/(m*m),a=r*r-4*o*(2*s*t*v/(y*y)-2*e*v/(y*y)+v*v/(y*y)+x*x/(m*m)-1+(e-s*t)*(e-s*t)/(y*y));if(a<0)return l;const h=Math.sqrt(a),u=(-r+h)/(2*o);c(u,s*u-s*t+e);const d=(-r-h)/(2*o);c(d,s*d-s*t+e)}return l},dl:(t,e,i,n,s,o,r,a,l)=>{let h=1e21,u=t,c=e;if(S.On(t,e,t,n,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}if(S.On(i,e,i,n,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}if(S.On(t,e,i,e,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}if(S.On(t,n,i,n,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}return l.i(u,c),h<1e21},Pw:(t,e,i)=>S.kC(t.x,t.y,t.width,t.height,e.x,e.y,i.x,i.y),kC:(t,e,i,n,s,o,r,a)=>{const l=t,h=t+i,u=e,c=e+n;if(s===r){let t=0,e=0;return o<a?(t=o,e=a):(t=a,e=o),l<=s&&s<=h&&t<=c&&e>=u}if(o===a){let t=0,e=0;return s<r?(t=s,e=r):(t=r,e=s),u<=o&&o<=c&&t<=h&&e>=l}return!!(v.contains(t,e,i,n,s,o)||v.contains(t,e,i,n,r,a)||S.su(l,u,h,u,s,o,r,a)||S.su(h,u,h,c,s,o,r,a)||S.su(h,c,l,c,s,o,r,a)||S.su(l,c,l,u,s,o,r,a))},su:(t,e,i,n,s,o,r,a)=>t===i&&e===n&&s===r&&o===a?t===s&&e===o:S.eu(t,e,i,n,s,o)*S.eu(t,e,i,n,r,a)<=0&&S.eu(s,o,r,a,t,e)*S.eu(s,o,r,a,i,n)<=0,eu:(t,e,i,n,s,o)=>{const r=i-t,a=n-e;let l=s-t,h=o-e,u=l*a-h*r;return 0===u&&(u=l*r+h*a,u>0&&(l-=r,h-=a,u=l*r+h*a,u<0&&(u=0))),u},Bg:t=>(t<0&&(t+=360),t>=360&&(t-=360),t),TC:(t,e,i,n,s,o)=>{const r=Math.PI;o||(n*=r/180,s*=r/180);const a=n>s?-1:1,l=1e-5,h=2*r,u=[],c=r/2;let d=n,f=Math.min(h,Math.abs(s-n));if(f<l){const n=d+a*Math.min(f,c),s=t+i*Math.cos(d),o=e+i*Math.sin(d),r=t+i*Math.cos(n),l=e+i*Math.sin(n),h=(s+r)/2,g=(o+l)/2;return u.push([s,o,h,g,h,g,r,l]),u}for(;f>l;){const n=d+a*Math.min(f,c);u.push(S._D(i,d,n,t,e)),f-=Math.abs(n-d),d=n}return u},_D:(t,e,i,n,s)=>{const o=(i-e)/2,r=t*Math.cos(o),a=t*Math.sin(o),l=r,h=-a,u=l*l+h*h,c=u+l*r+h*a,d=4/3*(Math.sqrt(2*u*c)-c)/(l*a-h*r),f=l-d*h,g=h+d*l,p=f,m=-g,y=o+e,x=Math.cos(y),v=Math.sin(y);return[n+t*Math.cos(e),s+t*Math.sin(e),n+f*x-g*v,s+f*v+g*x,n+p*x-m*v,s+p*v+m*x,n+t*Math.cos(i),s+t*Math.sin(i)]},Dg:(t,e,i,n,s,o,r)=>{const a=s,l=o,h=Math.floor((t-i)/a)*a+i,u=Math.floor((e-n)/l)*l+n;let c=h;h+a-t<a/2&&(c=h+a);let d=u;return u+l-e<l/2&&(d=u+l),r.i(c,d),r},DC:(t,e)=>{let i=Math.max(t,e),n=Math.min(t,e),s=1,o=1;do{s=i%n,o=n,i=n,n=s}while(s>0);return o},tF:(t,e,i,n)=>{const s=i<0,o=n<0;let r=0,a=0,l=0;t<e?(a=1,l=0):(a=0,l=1);let h=0,u=0,c=0,d=0;return r=a,h=0===r?t:e,c=0===r?i:n,(0===r?s:o)&&(c=-c),r=l,u=0===r?t:e,d=0===r?i:n,(0===r?s:o)&&(d=-d),S.iF(h,u,c,d,0,0)},iF:(t,e,i,n,s,o)=>{let r=0;if(n>0)if(i>0){const a=t*t,l=e*e,h=t*i,u=e*n;let c=-l+u,d=-l+Math.sqrt(h*h+u*u),f=c;const g=9999999999;for(let t=0;t<g&&(f=.5*(c+d),f!==c&&f!==d);++t){const t=h/(f+a),e=u/(f+l),i=t*t+e*e-1;if(i>0)c=f;else{if(!(i<0))break;d=f}}const p=(s=a*i/(f+a))-i,m=(o=l*n/(f+l))-n;r=Math.sqrt(p*p+m*m)}else s=0,o=e,r=Math.abs(n-e);else{const n=t*t-e*e,a=t*i;if(a<n){const l=a/n,h=l*l;s=t*l,o=e*Math.sqrt(Math.abs(1-h));const u=s-i;r=Math.sqrt(u*u+o*o)}else s=t,o=0,r=Math.abs(i-t)}return r},In:new n,Ug:new n,nr:new n,or:0,Vg:100};S.za=S.ZD;var P,M=((P=M||{})[P.Line=1]="Line",P[P.Rectangle=2]="Rectangle",P[P.Ellipse=3]="Ellipse",P[P.Path=4]="Path",P),C=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t))(C||{});class N{n;zg;Xg;oc;ru;lu;En;Bn;Un;j;we;xe;Qi;_i;Rs;rc;lc;constructor(t){u.Gi(this),this.n=2,void 0===t&&(t=4),this.j=t,this.we=0,this.xe=0,this.Qi=0,this._i=0,this.Rs=4===t?new l:N.Sw,this.zg=this.Rs.nt,this.Xg=(new v).u(),this.oc=null,this.ru=null,this.lu=NaN,this.En=w.TopLeft,this.Bn=w.BottomRight,this.rc=NaN,this.lc=NaN,this.Un=2}copy(){const t=new N;if(t.n=-2&this.n,t.j=this.j,t.we=this.we,t.xe=this.xe,t.Qi=this.Qi,t._i=this._i,4===this.j){const e=this.Rs.r,i=t.Rs;for(let t=0;t<e.length;t++){const n=e[t];i.add(n.copy())}t.Rs=i}else t.Rs=this.Rs;return t.zg=this.zg,t.Xg.a(this.Xg),t.oc=this.oc,t.ru=this.ru,t.lu=this.lu,t.En=this.En.P(),t.Bn=this.Bn.P(),t.rc=this.rc,t.lc=this.lc,t.Un=this.Un,t}static Line=1;static Rectangle=2;static Ellipse=3;static Path=4;static Sw=(()=>(new l).u())();get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get wt(){return 0!==(2&this.n)}set wt(t){t?this.n|=2:this.n&=-3}u(){if(this.h=!0,4!==this.type)return this;const t=this.figures;t.u();for(const e of t)e.u();return this}equalsApprox(t){if(!(t instanceof N))return!1;if(this.type!==t.type)return 1===this.type&&4===t.type?this.FC(t):1===t.type&&4===this.type&&t.FC(this);if(4===this.type){const e=this.figures.r,i=t.figures.r,n=e.length;if(n!==i.length)return!1;for(let t=0;t<n;t++){const n=e[t],s=i[t];if(!n.equalsApprox(s))return!1}return!0}return S.f(this.startX,t.startX)&&S.f(this.startY,t.startY)&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)}FC(t){if(1!==this.type||4!==t.type)return!1;if(1===t.figures.count){const e=t.figures.elt(0);if(1===e.segments.count&&S.f(this.startX,e.startX)&&S.f(this.startY,e.startY)){const t=e.segments.elt(0);if(2===t.type&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY))return!0}}return!1}static stringify(t){return t.toString()}static stringifyFixed(t){return e.s(t,"number",N,"stringifyFixed:digits"),e=>e.toString(t)}oi(t){t in M?this.type=t:e.ir(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i;switch(this.type){case 1:return t<0?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.startX)+" "+e(this.startY)+"L"+e(this.endX)+" "+e(this.endY);case 2:return i=new v(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0?"M"+i.x.toString()+" "+i.y.toString()+"H"+i.right.toString()+"V"+i.bottom.toString()+"H"+i.left.toString()+"z":"M"+e(i.x)+" "+e(i.y)+"H"+e(i.right)+"V"+e(i.bottom)+"H"+e(i.left)+"z";case 3:if(i=new v(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0){const t=i.left.toString()+" "+(i.y+i.height/2).toString(),e=i.right.toString()+" "+(i.y+i.height/2).toString();return"M"+t+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+e+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+t}{const t=e(i.left)+" "+e(i.y+i.height/2),n=e(i.right)+" "+e(i.y+i.height/2);return"M"+t+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+n+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+t}case 4:let n="";const s=this.figures.r,o=s.length;for(let e=0;e<o;e++){const i=s[e];e>0&&(n+=" x "),i.isFilled&&(n+="F "),n+=i.toString(t)}return n;default:return M[this.type]}}static fillPath(t){"string"!=typeof t&&e.Zi(t,"string",N,"fillPath:str");const i=t.split(/[Xx]/),n=i.length;let s="";for(let e=0;e<n;e++){const t=i[e];null===t.match(/[Ff]/)?s+=(0===e?"":"X ")+"F"+(" "===t[0]?"":" ")+t:s+=0===e?t:"X"+(" "===t[0]?"":" ")+t}return s}static Yg="UuBbMmZzLlHhVvCcSsQqTtAaFfXx";static parse(t,i){void 0===i&&(i=!1),"string"!=typeof t&&e.Zi(t,"string",N,"parse:str");const n=new RegExp("(["+N.Yg+"])(["+N.Yg+"])","gm"),s=new RegExp("(["+N.Yg+"])([^s])","gm"),o=new RegExp("([^s])(["+N.Yg+"])","gm"),r=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/,/gm," ")).replace(n,"$1 $2")).replace(n,"$1 $2")).replace(s,"$1 $2")).replace(o,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/[\s\r\t\n]+/gm," ")).replace(/^\s+|\s+$/g,"")).split(" ");for(let y=0;y<r.length;y++){const t=r[y];if(null!==t.match(/(\.[0-9]*)(\.)/gm)){const i=e.et();let n="",s=!1;for(let e=0;e<t.length;e++){const o=t[e];"."!==o||s?"."===o?(i.push(n),n="."):n+=o:(s=!0,n+=o)}i.push(n),r.splice(y,1);for(let t=0;t<i.length;t++)r.splice(y+t,0,i[t]);y+=i.length-1,e.J(i)}}let a=-1,l="",h="";const u=new y(0,0),c=new y(0,0),d=new y(0,0);let f=!0;function g(){return a>=w-1||null!==r[a+1].match(T)||(f=!1,!1)}function p(){return a++,r[a]}function m(t){let e=parseFloat(p()),i=parseFloat(p());l===l.toLowerCase()&&(e=d.x+e,i=d.y+i),t.i(e,i)}function x(){return m(d),d}function v(){return m(c),c}function b(){const t=h.toLowerCase();return"c"===t||"s"===t||"q"===t||"t"===t?new y(2*d.x-c.x,2*d.y-c.y):new y(d.x,d.y)}const w=r.length,k=he.RC(null);let S=!1,P=!1,M=!1,C=!0;const T=new RegExp("["+N.Yg+"]");for(;!(a>=w-1);){if(h=l,l=p(),""===l)continue;f=!0;let i=!1;switch(l.toUpperCase()){case"X":C=!0,S=!1,P=!1;break;case"M":const t=x();for(null===k.bi||!0===C?(k.hu(t.x,t.y,S,!1,!P,M),C=!1):k.eF(t.x,t.y),u.a(d);!g();){const t=x();k.rr(t.x,t.y)}break;case"L":for(;!g();){const t=x();k.rr(t.x,t.y)}f&&(i=!0);break;case"H":for(;!g();)d.i((l===l.toLowerCase()?d.x:0)+parseFloat(p()),d.y),k.rr(d.x,d.y);break;case"V":for(;!g();)d.i(d.x,(l===l.toLowerCase()?d.y:0)+parseFloat(p())),k.rr(d.x,d.y);f&&(i=!0);break;case"C":for(;!g();){const t=new y;m(t);const e=v(),i=x();k.lr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(i=!0);break;case"S":for(;!g();){const t=b(),e=v(),i=x();k.lr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(i=!0);break;case"Q":for(;!g();){const t=v(),e=x();k.Mw(t.x,t.y,e.x,e.y)}f&&(i=!0);break;case"T":for(;!g();){const t=b();c.a(t);const e=x();k.Mw(t.x,t.y,e.x,e.y),c.a(e)}f&&(i=!0);break;case"B":for(;!g();){const t=parseFloat(p()),e=parseFloat(p());let i=parseFloat(p()),n=parseFloat(p());const s=parseFloat(p());let o=s,r=!1;g()||(o=parseFloat(p()),g()||(r=0!==parseFloat(p()))),l===l.toLowerCase()&&(i+=d.x,n+=d.y),k.sF(t,e,i,n,s,o,r)}f&&(i=!0);break;case"A":for(;!g();){const t=Math.abs(parseFloat(p())),e=Math.abs(parseFloat(p())),i=parseFloat(p());let n=!1,s=!1,o=0,r=0;const a=p();1===a.length?(n=!!parseFloat(a),s=!!parseFloat(p()),o=parseFloat(p()),r=parseFloat(p())):2===a.length?(n=!!parseFloat(a[0]),s=!!parseFloat(a[1]),o=parseFloat(p()),r=parseFloat(p())):(n=!!parseFloat(a[0]),s=!!parseFloat(a[1]),o=parseFloat(a.slice(2)),r=parseFloat(p())),l===l.toLowerCase()&&(o=d.x+o,r=d.y+r),d.i(o,r),k.nF(t,e,i,n,s,o,r)}f&&(i=!0);break;case"Z":k.oF(),d.a(u);break;case"F":{let t="",e=1;for(;r[a+e];)if("0"!==r[a+e])if(null===r[a+e].match(/[Uu]/)){if(null!==r[a+e].match(T)){t=r[a+e];break}e++}else e++;else M=!0,e++;t.match(/[Mm]/)?S=!0:k.rF();break}case"U":{let t="",e=1;for(;r[a+e];)if(null===r[a+e].match(/[Ff]/)){if(null!==r[a+e].match(T)){t=r[a+e];break}e++}else e++;t.match(/[Mm]/)?P=!0:k.lF(!1);break}default:if("0"===l||"1"===l)break;e.ni("Unknown geometry command: "+l)}if(i){e.ni(`Bad geometry command: ${l}, next token: ${p()},\nstring: ${t}`);break}}const L=k.Kg;if(he.vC(k),i){const t=L.figures.iterator;for(;t.next();){t.value.isFilled=!0}}return L}static OC(t,e){const i=t.length,n=y.l();for(let s=0;s<i;s++){const i=t[s];n.x=i[0],n.y=i[1],e.gt(n),i[0]=n.x,i[1]=n.y,n.x=i[2],n.y=i[3],e.gt(n),i[2]=n.x,i[3]=n.y,n.x=i[4],n.y=i[5],e.gt(n),i[4]=n.x,i[5]=n.y,n.x=i[6],n.y=i[7],e.gt(n),i[6]=n.x,i[7]=n.y}y.e(n)}Hk(){if(this.wt)return!0;if(4===this.type){const t=this.figures;if(this.zg!==t.nt)return!0;const e=this.figures.r,i=e.length;for(let n=0;n<i;n++)if(e[n].Hk())return!0}return!1}Nw(){if(this.wt=!1,this.oc=null,this.ru=null,this.lu=NaN,4===this.type){const t=this.figures;this.zg=t.nt;const e=this.figures.r,i=e.length;for(let n=0;n<i;n++)e[n].hF()}const t=this.Xg;t.Nt(),isNaN(this.rc)||isNaN(this.lc)?t.i(0,0,0,0):t.i(0,0,this.rc,this.lc),this.IC(t,!1),t.unionNoCheck(0,0,0,0),t.u()}computeBoundsWithoutOrigin(){const t=new v;return this.IC(t,!0),t}IC(t,i){switch(this.type){case 1:case 2:case 3:i?t.i(this.we,this.xe,0,0):t.unionNoCheck(this.we,this.xe,0,0),t.unionNoCheck(this.Qi,this._i,0,0);break;case 4:const n=this.figures,s=n.r,o=n.length;for(let r=0;r<o;r++){const n=s[r];i&&0===r?t.i(n.startX,n.startY,0,0):t.unionNoCheck(n.startX,n.startY,0,0);const o=n.segments.r,a=o.length;let l=n.startX,h=n.startY;for(let i=0;i<a;i++){const s=o[i];switch(s.type){case 2:case 1:l=s.endX,h=s.endY,t.unionNoCheck(l,h,0,0);break;case 3:S.ou(l,h,s.point1X,s.point1Y,s.point2X,s.point2Y,s.endX,s.endY,.5,t),l=s.endX,h=s.endY;break;case 4:S.Gk(l,h,s.point1X,s.point1Y,s.endX,s.endY,.5,t),l=s.endX,h=s.endY;break;case 5:case 6:const i=5===s.type?s.xo(n):s.Bh(n,l,h),o=i.length;if(0===o){l=5===s.type?s.centerX:s.endX,h=5===s.type?s.centerY:s.endY,t.unionNoCheck(l,h,0,0);break}let r=null;for(let e=0;e<o;e++)r=i[e],S.ou(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],.5,t);null!==r&&(l=r[6],h=r[7]);break;default:e.o("Unknown Segment type: "+s.type)}}}break;default:e.o("Unknown Geometry type: "+this.type)}}aF(t,e){const i=this.bounds;let n=t/i.width,s=e/i.height;return isFinite(n)||(n=1),isFinite(s)||(s=1),1===n&&1===s?this:this.copy().scale(n,s)}normalize(){this.h&&e.L(this);const t=this.computeBoundsWithoutOrigin();return this.offset(-t.x,-t.y),new y(-t.x,-t.y)}offset(t,i){return this.h&&e.L(this),this.T(1,0,0,1,t,i),this}scale(t,i){return this.h&&e.L(this),this.T(t,0,0,i,0,0),this}rotate(t,i,n){this.h&&e.L(this),void 0===i&&(i=0),void 0===n&&(n=0);const s=k.l();return s.Ri(),s.cs(t,i,n),this.T(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),k.e(s),this}T(t,i,n,s,o,r){let a=0,l=0;switch(this.type){case 1:case 2:case 3:a=this.we,l=this.xe,this.we=a*t+l*n+o,this.xe=a*i+l*s+r,a=this.Qi,l=this._i,this.Qi=a*t+l*n+o,this._i=a*i+l*s+r;break;case 4:const h=this.figures.r,u=h.length;for(let c=0;c<u;c++){const u=h[c];a=u.startX,l=u.startY,u.startX=a*t+l*n+o,u.startY=a*i+l*s+r;const d=u.segments.r,f=d.length;for(let h=0;h<f;h++){const u=d[h];switch(u.type){case 2:case 1:a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r;break;case 3:a=u.point1X,l=u.point1Y,u.point1X=a*t+l*n+o,u.point1Y=a*i+l*s+r,a=u.point2X,l=u.point2Y,u.point2X=a*t+l*n+o,u.point2Y=a*i+l*s+r,a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r;break;case 4:a=u.point1X,l=u.point1Y,u.point1X=a*t+l*n+o,u.point1Y=a*i+l*s+r,a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r;break;case 5:if(a=u.centerX,l=u.centerY,u.centerX=a*t+l*n+o,u.centerY=a*i+l*s+r,0!==i){let e=180*Math.atan2(i,t)/Math.PI;e<0&&(e+=360),u.startAngle+=e}t<0&&(u.startAngle=180-u.startAngle,u.sweepAngle=-u.sweepAngle),s<0&&(u.startAngle=-u.startAngle,u.sweepAngle=-u.sweepAngle),u.radiusX*=Math.sqrt(t*t+n*n),void 0!==u.radiusY&&(u.radiusY*=Math.sqrt(i*i+s*s));break;case 6:if(a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r,0===u.radiusX||0===u.radiusY)break;if(0!==i){let e=180*Math.atan2(i,t)/Math.PI;e<0&&(e+=360),u.xAxisRotation+=e}t<0&&(u.xAxisRotation=180-u.xAxisRotation,u.isClockwiseArc=!u.isClockwiseArc),s<0&&(u.xAxisRotation=-u.xAxisRotation,u.isClockwiseArc=!u.isClockwiseArc),u.radiusX*=Math.sqrt(t*t+n*n),u.radiusY*=Math.sqrt(i*i+s*s);break;default:e.o("Unknown Segment type: "+u.type)}}}}return this.wt=!0,this}containsPoint(t,e){void 0===e&&(e=0);const i=this.we,n=this.xe,s=this.Qi,o=this._i;switch(this.type){case 1:return S.vi(i,n,s,o,e,t.x,t.y);case 2:{const r=Math.min(i,s)-e,a=Math.min(n,o)-e,l=Math.abs(s-i)+2*e,h=Math.abs(o-n)+2*e,u=v.V(r,a,l,h),c=u.containsPoint(t);return v.e(u),c}case 3:{let r=Math.min(i,s)-e,a=Math.min(n,o)-e;const l=(Math.abs(s-i)+2*e)/2,h=(Math.abs(o-n)+2*e)/2;return!(l<=0||h<=0)&&(r=t.x-(r+l),a=t.y-(a+h),r*r/(l*l)+a*a/(h*h)<=1)}case 4:return this.jk(t,e,!0,!1);default:return!1}}jk(t,i,n,s){const o=t.x,r=t.y,a=this.bounds.x-20,l=r;let h=0,u=0,c=0,d=0,f=0,g=0;const p=this.figures.r,m=p.length;for(let y=0;y<m;y++){const t=p[y],m=!t.isEvenOdd;if(!t.isFilled){if(t.qk(o,r,s?i:i+2))return!0;continue}if(n&&t.qk(o,r,i))return!0;const x=t.segments;u=t.startX,c=t.startY;let v=u,b=c;const w=x.r;for(let i=0;i<=x.length;i++){let n,s;switch(i!==x.length?(n=w[i],s=n.type,f=n.endX,g=n.endY):(s=2,f=v,g=b),s){case 1:{const t=this.Cw(o,r,a,l,u,c,v,b);if(isNaN(t))return!0;h+=t,v=f,b=g;break}case 2:{const t=this.Cw(o,r,a,l,u,c,f,g);if(isNaN(t))return!0;h+=t;break}case 3:d=S.Eg(u,c,n.point1X,n.point1Y,n.point2X,n.point2Y,f,g,a,l,o,r,.5),h+=d;break;case 4:{const t=(u+2*n.point1X)/3,e=(c+2*n.point1Y)/3,i=(2*n.point1X+f)/3,s=(2*n.point1Y+g)/3;d=S.Eg(u,c,t,e,i,s,f,g,a,l,o,r,.5),h+=d;break}case 5:case 6:{const e=5===n.type?n.xo(t):n.Bh(t,u,c),i=e.length;if(0===i){const t=this.Cw(o,r,a,l,u,c,5===n.type?n.centerX:n.endX,5===n.type?n.centerY:n.endY);if(isNaN(t))return!0;h+=t;break}let s=null;for(let t=0;t<i;t++){if(s=e[t],0===t){const t=this.Cw(o,r,a,l,u,c,s[0],s[1]);if(isNaN(t))return!0;h+=t}d=S.Eg(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],a,l,o,r,.5),h+=d}null!==s&&(f=s[6],g=s[7]);break}default:e.o("Unknown Segment type: "+n.type)}u=f,c=g}if(m){if(0!==h)return!0}else if(h%2!==0)return!0;h=0}return!1}Cw(t,e,i,n,s,o,r,a){if(S.vi(s,o,r,a,.05,t,e))return NaN;const l=(t-i)*(o-a);if(0===l)return 0;const h=((t*n-e*i)*(s-r)-(t-i)*(s*a-o*r))/l,u=(t*n-e*i)*(o-a)/l;if(h>=t)return 0;if((s>r?s-r:r-s)<(o>a?o-a:a-o)){if(o<a){if(u<o||u>a)return 0}else if(u<a||u>o)return 0}else if(s<r){if(h<s||h>r)return 0}else if(h<r||h>s)return 0;return l>0?1:-1}EC(t,e,i){const n=this.figures.r,s=n.length;for(let o=0;o<s;o++)if(n[o].qk(t,e,i))return!0;return!1}getPointAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=new y),1===this.type)return e.i(this.startX+t*(this.endX-this.startX),this.startY+t*(this.endY-this.startY)),e;const i=this.flattenedSegments,n=this.flattenedLengths,s=this.flattenedTotalLength,o=i.length,r=s*t;let a=0;for(let l=0;l<o;l++){const t=n[l],s=t.length;for(let n=0;n<s;n++){const s=t[n];if(a+s>=r){const t=0===s?0:(r-a)/s,o=i[l],h=o[2*n],u=o[2*n+1],c=o[2*n+2],d=o[2*n+3];return e.i(h+(c-h)*t,u+(d-u)*t),e}a+=s}}return e}getAngleAlongPath(t){if(t<0?t=0:t>1&&(t=1),1===this.type)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;const e=this.flattenedSegments,i=this.flattenedLengths,n=this.flattenedTotalLength,s=e.length,o=n*t;let r=0;for(let a=0;a<s;a++){const t=i[a],n=t.length;for(let i=0;i<n;i++){const n=t[i];if(r+n>=o){const t=e[a],n=t[2*i],s=t[2*i+1],o=t[2*i+2],r=t[2*i+3];return Math.abs(o-n)<1&&Math.abs(r-s)<1?0:Math.abs(o-n)<1?r-s>=0?90:270:Math.abs(r-s)<1?o-n>=0?0:180:180*Math.atan2(r-s,o-n)/Math.PI}r+=n}}return NaN}getPointAndAngleAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=[]),e.length=3,1===this.type)return e[0]=this.startX+t*(this.endX-this.startX),e[1]=this.startY+t*(this.endY-this.startY),e[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,e;const i=this.flattenedSegments,n=this.flattenedLengths,s=this.flattenedTotalLength,o=i.length,r=s*t;let a=0;for(let l=0;l<o;l++){const t=n[l],s=t.length;for(let n=0;n<s;n++){const s=t[n];if(a+s>=r){const t=0===s?0:(r-a)/s,o=i[l],h=o[2*n],u=o[2*n+1],c=o[2*n+2],d=o[2*n+3];let f;return e[0]=h+(c-h)*t,e[1]=u+(d-u)*t,f=Math.abs(c-h)<1&&Math.abs(d-u)<1?0:Math.abs(c-h)<1?d-u>=0?90:270:Math.abs(d-u)<1?c-h>=0?0:180:180*Math.atan2(d-u,c-h)/Math.PI,e[2]=f,e}a+=s}}return e}getFractionForPoint(t){if(1===this.type){const e=this.startX,i=this.startY,n=this.endX,s=this.endY;if(e===n&&i===s)return 0;{const o=t.x,r=t.y;let a=0,l=0;if(e===n)return i<s?(a=i,l=s):(a=s,l=i),r<=a?a===i?0:1:r>=l?l===i?0:1:Math.abs(r-i)/(l-a);if(i===s)return e<n?(a=e,l=n):(a=n,l=e),o<=a?a===e?0:1:o>=l?l===e?0:1:Math.abs(o-e)/(l-a);{const t=(n-e)**2+(s-i)**2,a=y.l();S.ul(e,i,n,s,o,r,a);const l=a.x,h=a.y;return y.e(a),Math.sqrt(((l-e)**2+(h-i)**2)/t)}}}if(2!==this.type){const e=this.flattenedSegments,i=this.flattenedLengths,n=this.flattenedTotalLength,s=y.l();let o=1/0,r=0,a=0;const l=e.length;let h=0,u=0;for(let d=0;d<l;d++){const n=e[d],l=i[d],c=n.length;for(let e=0;e<c;e+=2){const i=n[e],c=n[e+1];if(0===e){h=i,u=c;continue}S.ul(h,u,i,c,t.x,t.y,s);const d=(s.x-t.x)**2+(s.y-t.y)**2;d<o&&(o=d,r=a,r+=Math.sqrt((s.x-h)**2+(s.y-u)**2)),a+=l[(e-2)/2],h=i,u=c}}y.e(s);const c=r/n;return c<0?0:c>1?1:c}{const e=this.startX,i=this.startY,n=this.endX,s=this.endY;if(e===n&&i===s)return 0;{const o=n-e,r=s-i,a=2*o+2*r;let l=t.x,h=t.y;l=Math.min(Math.max(l,e),n),h=Math.min(Math.max(h,i),s);const u=Math.abs(l-e),c=Math.abs(l-n),d=Math.abs(h-i),f=Math.abs(h-s),g=Math.min(u,c,d,f);if(g===d)return l/a;if(g===c)return(o+h)/a;if(g===f)return(2*o+r-l)/a;if(g===u)return(2*o+2*r-h)/a}}return 0}get flattenedSegments(){return this.BC(),this.oc}BC(){if(null===this.oc){const t=this.oc=[],e=this.ru=[];this.cF(t,e)}}get flattenedLengths(){return this.BC(),this.ru}get flattenedTotalLength(){let t=this.lu;if(isNaN(t)){if(1===this.type){const e=Math.abs(this.endX-this.startX),i=Math.abs(this.endY-this.startY);t=Math.sqrt(e*e+i*i)}else if(2===this.type){t=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-this.startY)}else{const e=this.flattenedLengths,i=e.length;t=0;for(let n=0;n<i;n++){const i=e[n],s=i.length;for(let e=0;e<s;e++)t+=i[e]}}this.lu=t}return t}Wk(t){const e=[];let i=0,n=0;const s=t.length;for(let o=0;o<s;o+=2){const s=t[o],r=t[o+1];if(0===o){i=s,n=r;continue}const a=Math.sqrt(y.distanceSquared(i,n,s,r));e.push(a),i=s,n=r}return e}cF(t,i){let n=[];const s=[];if(1===this.type)n.push(this.startX),n.push(this.startY),n.push(this.endX),n.push(this.endY),t.push(n),s.push(Math.sqrt((this.startX-this.endX)**2+(this.startY-this.endY)**2)),i.push(s);else if(2===this.type)n.push(this.startX),n.push(this.startY),n.push(this.endX),n.push(this.startY),n.push(this.endX),n.push(this.endY),n.push(this.startX),n.push(this.endY),n.push(this.startX),n.push(this.startY),t.push(n),s.push(Math.abs(this.startX-this.endX)),s.push(Math.abs(this.startY-this.endY)),s.push(Math.abs(this.startX-this.endX)),s.push(Math.abs(this.startY-this.endY)),i.push(s);else if(3===this.type){const e=new T;e.startX=this.endX,e.startY=(this.startY+this.endY)/2;const s=new A(5);s.startAngle=0,s.sweepAngle=360,s.centerX=(this.startX+this.endX)/2,s.centerY=(this.startY+this.endY)/2,s.radiusX=Math.abs(this.startX-this.endX)/2,s.radiusY=Math.abs(this.startY-this.endY)/2,e.add(s);const o=s.xo(e),r=o.length;if(0===r)n.push(s.centerX),n.push(s.centerY);else{let t=e.startX,i=e.startY;for(let e=0;e<r;e++){const s=o[e];S.vn(t,i,s[2],s[3],s[4],s[5],s[6],s[7],.5,n),t=s[6],i=s[7]}}t.push(n),i.push(this.Wk(n))}else{const s=this.figures.iterator;for(;s.next();){const o=s.value;n=[],n.push(o.startX),n.push(o.startY);let r=o.startX,a=o.startY,l=r,h=a;const u=o.segments.r,c=u.length;for(let s=0;s<c;s++){const c=u[s];switch(c.type){case 1:n.length>=4&&(t.push(n),i.push(this.Wk(n))),n=[],n.push(c.endX),n.push(c.endY),r=c.endX,a=c.endY,l=r,h=a;break;case 2:n.push(c.endX),n.push(c.endY),r=c.endX,a=c.endY;break;case 3:S.vn(r,a,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,n),r=c.endX,a=c.endY;break;case 4:S.Og(r,a,c.point1X,c.point1Y,c.endX,c.endY,.5,n),r=c.endX,a=c.endY;break;case 5:{const t=c.xo(o),e=t.length;if(0===e){n.push(c.centerX),n.push(c.centerY),r=c.centerX,a=c.centerY;break}for(let i=0;i<e;i++){const e=t[i];S.vn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,n),r=e[6],a=e[7]}break}case 6:{const t=c.Bh(o,r,a),e=t.length,i=c.endX,s=c.endY;if(0===e){n.push(i),n.push(s),r=i,a=s;break}for(let o=0;o<e;o++){const e=t[o];S.vn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,n),r=e[6],a=e[7]}break}default:e.o("Segment not of valid type: "+c.type)}c.isClosed&&(n.push(l),n.push(h))}n.length>=4&&(t.push(n),i.push(this.Wk(n)))}}}get type(){return this.j}set type(t){this.j!==t&&(this.h&&e.L(this,t),this.j=t,4===t?this.Rs=new l:(null===N.Sw&&(N.Sw=(new l).u()),this.Rs=N.Sw),this.wt=!0)}get startX(){return this.we}set startX(t){this.we!==t&&(this.h&&e.L(this,t),this.we=t,this.wt=!0)}get startY(){return this.xe}set startY(t){this.xe!==t&&(this.h&&e.L(this,t),this.xe=t,this.wt=!0)}get endX(){return this.Qi}set endX(t){this.Qi!==t&&(this.h&&e.L(this,t),this.Qi=t,this.wt=!0)}get endY(){return this._i}set endY(t){this._i!==t&&(this.h&&e.L(this,t),this._i=t,this.wt=!0)}get figures(){return this.Rs}set figures(t){this.Rs!==t&&(this.h&&e.L(this,t),this.Rs=t,this.wt=!0)}add(t){return this.Rs.add(t),this}setSpots(t,i,n,s,o,r,a,l){return this.h&&e.L(this),this.En=new w(t,i,o,r).u(),this.Bn=new w(n,s,a,l).u(),this}get spot1(){return this.En}set spot1(t){this.h&&e.L(this,t),this.En=t.P()}get spot2(){return this.Bn}set spot2(t){this.h&&e.L(this,t),this.Bn=t.P()}get defaultStretch(){return this.Un}set defaultStretch(t){this.Un=t}get bounds(){return this.Hk()&&this.Nw(),this.Xg}}N.stringify=N.stringify,N.stringifyFixed=N.stringifyFixed,N.fillPath=N.fillPath,N.parse=N.parse;class T{n;we;xe;hc;Gg;Ee;constructor(t,e,i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!1),this.n=2|(i?4:0)|(n?8:0)|(s?16:0),this.we=void 0!==t?t:0,this.xe=void 0!==e?e:0,this.hc=new l,this.Gg=this.hc.nt,this.Ee=null}copy(){const t=new T;t.n=-2&this.n,t.we=this.we,t.xe=this.xe;const e=this.hc.r,i=e.length,n=t.hc;for(let s=0;s<i;s++){const t=e[s].copy();n.add(t)}return t.Gg=this.Gg,t.Ee=this.Ee,t}equalsApprox(t){if(!(t instanceof T)||!S.f(this.startX,t.startX)||!S.f(this.startY,t.startY))return!1;const e=this.segments.r,i=t.segments.r,n=e.length;if(n!==i.length)return!1;for(let s=0;s<n;s++){const t=e[s],n=i[s];if(!t.equalsApprox(n))return!1}return!0}toString(t){void 0===t&&(t=-1);let e="";if(t<0)e="M"+this.startX.toString()+" "+this.startY.toString();else{const i=e=>0===e?"0":e.toFixed(t);e="M"+i(this.startX)+" "+i(this.startY)}const i=this.segments.r,n=i.length;for(let s=0;s<n;s++){e+=" "+i[s].toString(t)}return e}get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get wt(){return 0!==(2&this.n)}set wt(t){t?this.n|=2:this.n&=-3}u(){this.h=!0;const t=this.segments;t.u();const e=t.r,i=t.length;for(let n=0;n<i;n++)e[n].u();return this}Hk(){if(this.wt)return!0;const t=this.segments;if(this.Gg!==t.nt)return!0;for(const e of t)if(e.wt)return!0;return!1}hF(){this.wt=!1,this.Ee=null;const t=this.segments;this.Gg=t.nt;for(const e of t)e.wt=!1,e.vs=null}get isFilled(){return 0!==(4&this.n)}set isFilled(t){this.h&&e.L(this,t),t?this.n|=4:this.n&=-5}get isShadowed(){return 0!==(8&this.n)}set isShadowed(t){this.h&&e.L(this,t),t?this.n|=8:this.n&=-9}get isEvenOdd(){return 0!==(16&this.n)}set isEvenOdd(t){this.h&&e.L(this,t),t?this.n|=16:this.n&=-17}get startX(){return this.we}set startX(t){this.h&&e.L(this,t),this.we=t,this.Ee=null,this.wt=!0}get startY(){return this.xe}set startY(t){this.h&&e.L(this,t),this.xe=t,this.Ee=null,this.wt=!0}get segments(){return this.hc}set segments(t){this.h&&e.L(this,t),this.hc=t,this.Ee=null,this.wt=!0}add(t){return this.hc.add(t),this.Ee=null,this}qk(t,i,n){const s=this;let o=s.startX,r=s.startY,a=o,l=r;const h=s.segments.r,u=h.length;for(let c=0;c<u;c++){const u=h[c];switch(u.type){case 1:a=u.endX,l=u.endY,o=u.endX,r=u.endY;break;case 2:if(S.vi(o,r,u.endX,u.endY,n,t,i))return!0;o=u.endX,r=u.endY;break;case 3:if(S.kw(o,r,u.point1X,u.point1Y,u.point2X,u.point2Y,u.endX,u.endY,.5,t,i,n))return!0;o=u.endX,r=u.endY;break;case 4:if(S.Kk(o,r,u.point1X,u.point1Y,u.endX,u.endY,.5,t,i,n))return!0;o=u.endX,r=u.endY;break;case 5:case 6:const h=5===u.type?u.xo(s):u.Bh(s,o,r),c=h.length,d=5===u.type?u.centerX:u.endX,f=5===u.type?u.centerY:u.endY;if(0===c){if(S.vi(o,r,d,f,n,t,i))return!0;o=d,r=f;break}let g=null;for(let e=0;e<c;e++)if(g=h[e],0===e&&S.vi(o,r,g[0],g[1],n,t,i)||S.kw(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],.5,t,i,n))return!0;null!==g&&(o=g[6],r=g[7]);break;default:e.o("Unknown Segment type: "+u.type)}if(u.isClosed&&(o!==a||r!==l)&&S.vi(o,r,a,l,n,t,i))return!0}return!1}}var L=(t=>(t[t.Move=1]="Move",t[t.Line=2]="Line",t[t.Bezier=3]="Bezier",t[t.QuadraticBezier=4]="QuadraticBezier",t[t.Arc=5]="Arc",t[t.SvgArc=6]="SvgArc",t))(L||{});class A{j;n;Qi;_i;tn;gl;pl;hr;vs;constructor(t,e,i,n,s,o,r,a){if(u.Gi(this),void 0===t&&(t=2),this.j=t,this.n=2,this.Qi=void 0!==e?e:0,this._i=void 0!==i?i:0,void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===r&&(r=0),6===t){let t=o;t%=360,t<0&&(t+=360),this.tn=t,this.gl=0,this.pl=Math.max(n,0),this.hr=Math.max(s,0),"boolean"==typeof r?r&&(this.isLargeArc=!0):"number"==typeof r&&r&&(this.isLargeArc=!0),a&&(this.isClockwiseArc=!0)}else this.tn=n,this.gl=s,5===t&&(o=Math.max(o,0)),this.pl=o,"number"==typeof r?(5===t&&(r=Math.max(r,0)),this.hr=r):this.hr=0;this.vs=null}copy(){const t=new A;return t.j=this.j,t.n=-2&this.n,t.Qi=this.Qi,t._i=this._i,t.tn=this.tn,t.gl=this.gl,t.pl=this.pl,t.hr=this.hr,t}equalsApprox(t){if(!(t instanceof A)||this.type!==t.type||this.isClosed!==t.isClosed)return!1;switch(this.type){case 1:case 2:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY);case 3:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.point1X,t.point1X)&&S.f(this.point1Y,t.point1Y)&&S.f(this.point2X,t.point2X)&&S.f(this.point2Y,t.point2Y);case 4:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.point1X,t.point1X)&&S.f(this.point1Y,t.point1Y);case 5:return S.f(this.startAngle,t.startAngle)&&S.f(this.sweepAngle,t.sweepAngle)&&S.f(this.centerX,t.centerX)&&S.f(this.centerY,t.centerY)&&S.f(this.radiusX,t.radiusX)&&S.f(this.radiusY,t.radiusY);case 6:return this.isClockwiseArc===t.isClockwiseArc&&this.isLargeArc===t.isLargeArc&&S.f(this.xAxisRotation,t.xAxisRotation)&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.radiusX,t.radiusX)&&S.f(this.radiusY,t.radiusY);default:return!1}}oi(t){t in L?this.type=t:e.ir(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i="";switch(this.type){case 1:i=t<0?"M"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.endX)+" "+e(this.endY);break;case 2:i=t<0?"L"+this.endX.toString()+" "+this.endY.toString():"L"+e(this.endX)+" "+e(this.endY);break;case 3:i=t<0?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.point2X)+" "+e(this.point2Y)+" "+e(this.endX)+" "+e(this.endY);break;case 4:i=t<0?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.endX)+" "+e(this.endY);break;case 5:i=t<0?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+e(this.startAngle)+" "+e(this.sweepAngle)+" "+e(this.centerX)+" "+e(this.centerY)+" "+e(this.radiusX)+" "+e(this.radiusY);break;case 6:i=t<0?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+e(this.radiusX)+" "+e(this.radiusY)+" "+e(this.xAxisRotation)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+e(this.endX)+" "+e(this.endY);break;default:i=L[this.type]}return i+(this.isClosed?"z":"")}static Move=1;static Line=2;static Bezier=3;static QuadraticBezier=4;static Arc=5;static SvgArc=6;get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get wt(){return 0!==(2&this.n)}set wt(t){t?this.n|=2:this.n&=-3}u(){return this.h=!0,this}close(){return this.isClosed=!0,this}xo(t){if(null!==this.vs&&!1===t.wt)return this.vs;const e=this.radiusX;let i=this.radiusY;if(void 0===i&&(i=e),0===e||0===i)return this.vs=[],this.vs;const n=this.tn,s=this.gl,o=S.TC(0,0,e<i?e:i,this.startAngle,this.startAngle+this.sweepAngle,!1);if(e!==i){const t=k.l();t.Ri(),e<i?t.tt(1,i/e):t.tt(e/i,1),N.OC(o,t),k.e(t)}const r=o.length;for(let a=0;a<r;a++){const t=o[a];t[0]+=n,t[1]+=s,t[2]+=n,t[3]+=s,t[4]+=n,t[5]+=s,t[6]+=n,t[7]+=s}return this.vs=o,this.vs}Bh(t,e,i){if(null!==this.vs&&!1===t.wt)return this.vs;if(0===this.radiusX||0===this.radiusY)return this.vs=[],this.vs;const n=e,s=i;let o=this.pl,r=this.hr;0===o&&(o=1e-4),0===r&&(r=1e-4);const a=this.tn*(Math.PI/180),l=this.isLargeArc,h=this.isClockwiseArc,u=this.Qi,c=this._i,d=Math.cos(a),f=Math.sin(a),g=d*(n-u)/2+f*(s-c)/2,p=-f*(n-u)/2+d*(s-c)/2,m=g*g/(o*o)+p*p/(r*r);m>1&&(o*=Math.sqrt(m),r*=Math.sqrt(m));let y=(l===h?-1:1)*Math.sqrt((o*o*r*r-o*o*p*p-r*r*g*g)/(o*o*p*p+r*r*g*g));isNaN(y)&&(y=0);let x=y*o*p/r,v=y*-r*g/o;isNaN(x)&&(x=0),isNaN(v)&&(v=0);const b=(n+u)/2+d*x-f*v,w=(s+c)/2+f*x+d*v,P=(t,e)=>Math.sqrt(t*t+e*e),M=(t,e,i,n)=>(t*i+e*n)/(P(t,e)*P(i,n)),C=(t,e,i,n)=>(t*n<e*i?-1:1)*Math.acos(M(t,e,i,n)),T=C(1,0,(g-x)/o,(p-v)/r),L=(g-x)/o,A=(p-v)/r,D=(-g-x)/o,F=(-p-v)/r;let O=C(L,A,D,F);const E=M(L,A,D,F);E<=-1?O=Math.PI:E>=1&&(O=0),!h&&O>0&&(O-=2*Math.PI),h&&O<0&&(O+=2*Math.PI);const R=o>r?o:r,B=o>r?1:o/r,I=o>r?r/o:1,z=S.TC(0,0,R,T,T+O,!0),j=k.l();return j.Ri(),j.Fs(b,w),j.cs(this.tn,0,0),j.tt(B,I),N.OC(z,j),k.e(j),this.vs=z,this.vs}get isClosed(){return 0!==(8&this.n)}set isClosed(t){this.isClosed!==t&&(t?this.n|=8:this.n&=-9,this.wt=!0)}get type(){return this.j}set type(t){this.h&&e.L(this,t),this.j=t,this.wt=!0}get endX(){return this.Qi}set endX(t){this.h&&e.L(this,t),this.Qi=t,this.wt=!0}get endY(){return this._i}set endY(t){this.h&&e.L(this,t),this._i=t,this.wt=!0}get point1X(){return this.tn}set point1X(t){this.h&&e.L(this,t),this.tn=t,this.wt=!0}get point1Y(){return this.gl}set point1Y(t){this.h&&e.L(this,t),this.gl=t,this.wt=!0}get point2X(){return this.pl}set point2X(t){this.h&&e.L(this,t),this.pl=t,this.wt=!0}get point2Y(){return this.hr}set point2Y(t){this.h&&e.L(this,t),this.hr=t,this.wt=!0}get centerX(){return this.tn}set centerX(t){this.h&&e.L(this,t),this.tn=t,this.wt=!0}get centerY(){return this.gl}set centerY(t){this.h&&e.L(this,t),this.gl=t,this.wt=!0}get radiusX(){return this.pl}set radiusX(t){t<0&&e.W(t,">= zero",A,"radiusX"),this.h&&e.L(this,t),this.pl=t,this.wt=!0}get radiusY(){return this.hr}set radiusY(t){t<0&&e.W(t,">= zero",A,"radiusY"),this.h&&e.L(this,t),this.hr=t,this.wt=!0}get startAngle(){return this.Qi}set startAngle(t){this.h&&e.L(this,t),(t%=360)<0&&(t+=360),this.Qi=t,this.wt=!0}get sweepAngle(){return this._i}set sweepAngle(t){this.h&&e.L(this,t),t>360&&(t=360),t<-360&&(t=-360),this._i=t,this.wt=!0}get isClockwiseArc(){return 0!==(4&this.n)}set isClockwiseArc(t){this.h&&e.L(this,t),t?this.n|=4:this.n&=-5,this.wt=!0}get isLargeArc(){return 0!==(16&this.n)}set isLargeArc(t){this.h&&e.L(this,t),t?this.n|=16:this.n&=-17,this.wt=!0}get xAxisRotation(){return this.tn}set xAxisRotation(t){this.h&&e.L(this,t),(t%=360)<0&&(t+=360),this.tn=t,this.wt=!0}}class D{N;Lw;Aw;Hg;jg;qg;Wg;Jg;$g;Zg;Qg;_g;tm;im;bo;em;sm;nm;be;constructor(){this.N=null,this.Lw=new y(0,0).u(),this.Aw=new y(0,0).u(),this.Hg=0,this.jg=0,this.qg=1,this.Wg="",this.Jg="",this.$g=!1,this.Zg=!1,this.Qg=0,this._g=0,this.tm=!1,this.im=!1,this.bo=!1,this.em=null,this.sm=0,this.nm=null,this.be=null}copy(){const t=new D;return this.clone(t)}clone(t){return t.N=this.N,t.Lw.a(this.viewPoint),t.Aw.a(this.documentPoint),t.Hg=this.Hg,t.jg=this.jg,t.qg=this.qg,t.Wg=this.Wg,t.Jg=this.Jg,t.$g=this.$g,t.Zg=this.Zg,t.Qg=this.Qg,t._g=this._g,t.tm=this.tm,t.im=this.im,t.bo=this.bo,t.em=this.em,t.sm=this.sm,t.nm=this.nm,t.be=this.be,t}toString(){let t="^";return 0!==this.modifiers&&(t+="M:"+this.modifiers),0!==this.button&&(t+="B:"+this.button),""!==this.key&&(t+="K:"+this.key),0!==this.clickCount&&(t+="C:"+this.clickCount),0!==this.delta&&(t+="D:"+this.delta),this.handled&&(t+="h"),this.bubbles&&(t+="b"),null!==this.documentPoint&&(t+="@"+this.documentPoint.toString()),t}get diagram(){return this.N}set diagram(t){this.N=t}get viewPoint(){return this.Lw}set viewPoint(t){this.Lw.a(t)}get documentPoint(){return this.Aw}set documentPoint(t){this.Aw.a(t)}getMultiTouchViewPoint(t,e){const i=this.diagram;return null===i||i.UC(this.event,t,e),e}getMultiTouchDocumentPoint(t,e){const i=this.diagram;return null===i||(i.UC(this.event,t,e),e.a(i.transformViewToDoc(e))),e}get modifiers(){return this.Hg}set modifiers(t){this.Hg=t}get button(){return this.jg}set button(t){if(this.jg=t,null===this.event)switch(t){case 0:return void(this.buttons=1);case 1:return void(this.buttons=4);case 2:return void(this.buttons=2)}}get buttons(){return this.qg}set buttons(t){this.qg=t}get key(){return this.Wg}set key(t){this.Wg=t}get code(){return this.Jg}set code(t){this.Jg=t}get down(){return this.$g}set down(t){this.$g=t}get up(){return this.Zg}set up(t){this.Zg=t}get clickCount(){return this.Qg}set clickCount(t){this.Qg=t}get delta(){return this._g}set delta(t){this._g=t}get isMultiTouch(){return this.tm}set isMultiTouch(t){this.tm=t}get handled(){return this.im}set handled(t){this.im=t}get bubbles(){return this.bo}set bubbles(t){this.bo=t}get event(){return this.em}set event(t){this.em=t}get isTouchEvent(){const t=this.event;return null!==t&&("touch"===t.pointerType||"pen"===t.pointerType)}get timestamp(){return this.sm}set timestamp(t){this.sm=t}get targetDiagram(){return this.nm}set targetDiagram(t){this.nm=t}get targetObject(){return this.be}set targetObject(t){this.be=t}get control(){return 0!==(1&this.modifiers)}set control(t){this.modifiers=t?1|this.modifiers:-2&this.modifiers}get shift(){return 0!==(4&this.modifiers)}set shift(t){this.modifiers=t?4|this.modifiers:-5&this.modifiers}get alt(){return 0!==(2&this.modifiers)}set alt(t){this.modifiers=t?2|this.modifiers:-3&this.modifiers}get meta(){return 0!==(8&this.modifiers)}set meta(t){this.modifiers=t?8|this.modifiers:-9&this.modifiers}get left(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(1&this.buttons):0===this.button}set left(t){t?this.buttons|=1:this.buttons&=-2}get right(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(2&this.buttons):2===this.button}set right(t){t?this.buttons|=2:this.buttons&=-3}get middle(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(4&this.buttons):1===this.button}set middle(t){t?this.buttons|=4:this.buttons&=-5}get commandKey(){const t=this.code,e=this.key;return"cxvyzagCXVYZAG".includes(e)?e.toLowerCase():"KeyC"===t?"c":"KeyX"===t?"x":"KeyV"===t?"v":"KeyY"===t?"y":"KeyZ"===t?"z":"KeyA"===t?"a":"KeyG"===t?"g":""!==t?t:e}}class F{N;Pt;om;rm;constructor(){this.N=null,this.Pt="",this.om=null,this.rm=null}copy(){const t=new F;return t.N=this.N,t.Pt=this.Pt,t.om=this.om,t.rm=this.rm,t}toString(){let t="*"+this.name;return null!==this.subject&&(t+=":"+this.subject.toString()),null!==this.parameter&&(t+="("+this.parameter.toString()+")"),t}get diagram(){return this.N}set diagram(t){this.N=t}get name(){return this.Pt}set name(t){this.Pt=t}get subject(){return this.om}set subject(t){this.om=t}get parameter(){return this.rm}set parameter(t){this.rm=t}}var O=(t=>(t[t.Transaction=1]="Transaction",t[t.Property=2]="Property",t[t.Insert=3]="Insert",t[t.Remove=4]="Remove",t))(O||{});class E{au;lm;en;ki;N;cu;ac;cc;fc;uc;constructor(){this.au=2,this.lm="",this.en="",this.ki=null,this.N=null,this.cu=null,this.ac=null,this.cc=null,this.fc=null,this.uc=null}static Transaction=1;static Property=2;static Insert=3;static Remove=4;clear(){this.ki=null,this.N=null,this.cu=null,this.ac=null,this.cc=null,this.fc=null,this.uc=null}copy(){const t=new E;t.au=this.au,t.lm=this.lm,t.en=this.en,t.ki=this.ki,t.N=this.N,t.cu=this.cu;let i=this.ac;return e.K(i)&&e.it(i.copyFrozen)?t.ac=i.copyFrozen():t.ac=i,i=this.cc,e.K(i)&&e.it(i.copyFrozen)?t.cc=i.copyFrozen():t.cc=i,i=this.fc,e.K(i)&&e.it(i.copyFrozen)?t.fc=i.copyFrozen():t.fc=i,i=this.uc,e.K(i)&&e.it(i.copyFrozen)?t.uc=i.copyFrozen():t.uc=i,t}oi(t){t in O?this.change=t:e.ir(this,t)}toString(){let t="";return 1===this.change?t+="* ":2===this.change?t+=null!==this.model?"!m":"!d":t+=(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(t+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(t+=" "+this.modelChange),t+=": ",1===this.change?null!==this.oldValue&&(t+=" "+this.oldValue):(null!==this.object&&(t+=e.toString(this.object)),null!==this.oldValue&&(t+="  old: "+e.toString(this.oldValue)),null!==this.oldParam&&(t+=" "+this.oldParam),null!==this.newValue&&(t+="  new: "+e.toString(this.newValue)),null!==this.newParam&&(t+=" "+this.newParam)),t}getValue(t){return t?this.oldValue:this.newValue}getParam(t){return t?this.oldParam:this.newParam}canUndo(){return null!==this.model||null!==this.diagram}undo(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.VC(this,!0))}canRedo(){return null!==this.model||null!==this.diagram}redo(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.VC(this,!1))}get model(){return this.ki}set model(t){this.ki=t}get diagram(){return this.N}set diagram(t){this.N=t}get change(){return this.au}set change(t){this.au=t}get modelChange(){return this.lm}set modelChange(t){this.lm=t}get propertyName(){return this.en}set propertyName(t){this.en=t}get isTransactionFinished(){return 1===this.au&&("CommittedTransaction"===this.en||"FinishedUndo"===this.en||"FinishedRedo"===this.en)}get object(){return this.cu}set object(t){this.cu=t}get oldValue(){return this.ac}set oldValue(t){this.ac=t}get oldParam(){return this.cc}set oldParam(t){this.cc=t}get newValue(){return this.fc}set newValue(t){this.fc=t}get newParam(){return this.uc}set newParam(t){this.uc=t}}class R{zC;Pt;Jk;constructor(){this.zC=(new l).u(),this.Pt="",this.Jk=!1}toString(t){let e="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==t&&t>0){const t=this.changes.count;for(let i=0;i<t;i++){const t=this.changes.elt(i);null!==t&&(e+="\n  "+t.toString())}}return e}clear(){const t=this.changes;t.Nt();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),t.u()}canUndo(){return this.isComplete}undo(){if(this.canUndo())for(let t=this.changes.count-1;t>=0;t--){const e=this.changes.elt(t);null!==e&&e.undo()}}canRedo(){return this.isComplete}redo(){if(!this.canRedo())return;const t=this.changes.count;for(let e=0;e<t;e++){const t=this.changes.elt(e);null!==t&&t.redo()}}fF(t){const e=this.changes;for(let i=e.count-1;i>=t;i--){const t=e.elt(i);null!==t&&t.undo(),e.Nt(),e.removeAt(i)}e.u()}optimize(){if(!this.isComplete)return;const t=this.changes;t.Nt();const e=new m;for(let n=0;n<t.count;n++){const i=t.elt(n);if(null===i||2!==i.change||!i.object)continue;let s=e.get(i.object);s||(s=new m,e.set(i.object,s));const o=s.get(i.propertyName);null===o?s.set(i.propertyName,-1):(o>0&&t.setElt(o,null),s.set(i.propertyName,n))}let i=0;for(let n=0;n<t.count;n++){const e=t.elt(n);null!==e&&(n>i&&t.setElt(i,e),i++)}for(;t.length>i;)t.pop();t.u()}get changes(){return this.zC}get name(){return this.Pt}set name(t){this.Pt=t}get isComplete(){return this.Jk}set isComplete(t){this.Jk=t}}class B{Tw;Oi;XC;Os;$k;hm;Vn;Zk;Qk;sn;dc;Dw;Is;Fw;Rw;am;vw;constructor(t){this.Tw=new u,this.Oi=!1,this.XC=(new l).u(),this.Os=-1,this.$k=999,this.Is=!1,this.hm=null,this.Vn=0,this.Zk=!1,this.Qk=23,this.sn=(new l).u(),this.dc=new l,this.Dw=!0,this.Fw=!1,this.Rw=!1,this.am=!1,this.vw=!1,t&&Object.assign(this,t)}toString(t){let e="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;e+="[";let i=this.nestedTransactionNames.count;for(let n=0;n<i;n++)n>0&&(e+=" "),e+=this.nestedTransactionNames.elt(n);if(e+="]",void 0!==t&&t>0){i=this.history.count;for(let n=0;n<i;n++)e+="\n "+this.history.elt(n).toString(t-1)}return e}clear(){const t=this.history;t.Nt();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),this.Os=-1,t.u(),this.Is=!1,this.hm=null,this.Vn=0,this.sn.Nt(),this.sn.clear(),this.sn.u(),this.dc.clear(),this.Fw=!1,this.Rw=!1,this.am=!1,this.vw=!1}copyProperties(t){this.isEnabled=t.isEnabled,this.maxHistoryLength=t.maxHistoryLength,this.cm=t.cm}addModel(t){this.Tw.add(t)}removeModel(t){this.Tw.delete(t)}startTransaction(t){if(void 0===t&&(t=""),null===t&&(t=""),this.isUndoingRedoing)return!1;!0===this.Dw&&(this.Dw=!1,this.Vn++,this.yl||this.wl("StartingFirstTransaction",t,this.currentTransaction),this.Vn>0&&this.Vn--),this.isEnabled&&(this.sn.Nt(),this.sn.add(t),this.sn.u(),null===this.currentTransaction?this.dc.add(0):this.dc.add(this.currentTransaction.changes.count)),this.Vn++;const e=1===this.transactionLevel;return e&&(this.yl||this.wl("StartedTransaction",t,this.currentTransaction)),e}commitTransaction(t){return void 0===t&&(t=""),this.YC(!0,t)}rollbackTransaction(){return this.YC(!1,"")}YC(t,i){if(this.isUndoingRedoing)return!1;this.cm&&this.transactionLevel<1&&e.ni("Ending transaction without having started a transaction: "+i);const n=1===this.transactionLevel;let s=this.currentTransaction;n&&t&&(this.yl||this.wl("CommittingTransaction",i,s));let o=0;if(this.transactionLevel>0&&(this.Vn--,this.isEnabled)){const t=this.sn.count;t>0&&(""===i&&(i=this.sn.elt(0)),this.sn.Nt(),this.sn.removeAt(t-1),this.sn.u());const e=this.dc.count;e>0&&(o=this.dc.elt(e-1),this.dc.removeAt(e-1))}if(n){if(t){if(this.am=!1,null===s&&""!==i&&(s=this.currentTransaction),this.isEnabled&&null!==s){const t=s;t.isComplete||(t.isComplete=!0,t.name=i),this.discardHistoryAfterIndex();const e=this.history;e.Nt();const n=this.maxHistoryLength;if(n>=0)if(0===n)e.clear();else if(e.count>=n){const t=e.elt(0);null!==t&&t.clear(),e.removeAt(0),this.Os--}0!==n&&(0===e.count||e.get(e.count-1)!==t)&&(e.add(t),this.Os++),e.u(),s=t}this.yl||this.wl("CommittedTransaction",i,s)}else{this.Is=!0;try{this.isEnabled&&null!==s&&(s.isComplete=!0,s.undo())}finally{this.yl||this.wl("RolledBackTransaction",i,s),this.Is=!1}null!==s&&s.clear()}return this.hm=null,this.Ow&&this.clear(),this.Ow=!1,this.Iw=!1,!0}return this.isEnabled&&!t&&null!==s&&s.fF(o),!1}discardHistoryAfterIndex(){if(this.isUndoingRedoing||!this.canRedo())return;const t=this.history;t.Nt();for(let e=t.count-1;e>this.historyIndex;e--){const i=t.elt(e);null!==i&&i.clear(),t.removeAt(e),this.am=!0}t.u()}PE(t){this.Vn+=t,this.Vn<0&&(this.Vn=0)}canUndo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToUndo;return!(null===t||!t.canUndo())}undo(){if(!this.canUndo())return;const t=this.transactionToUndo;try{this.Is=!0,this.wl("StartingUndo","Undo",t),this.Os--,t.undo()}catch(i){e.ni("undo error: "+i.toString())}finally{this.wl("FinishedUndo","Undo",t),this.Is=!1}}canRedo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToRedo;return!(null===t||!t.canRedo())}redo(){if(!this.canRedo())return;const t=this.transactionToRedo;try{this.Is=!0,this.wl("StartingRedo","Redo",t),this.Os++,t.redo()}catch(i){e.ni("redo error: "+i.toString())}finally{this.wl("FinishedRedo","Redo",t),this.Is=!1}}wl(t,e,i){void 0===i&&(i=null);const n=new E;n.change=1,n.propertyName=t,n.object=i,n.oldValue=e;const s=this.models;for(;s.next();){const t=s.value;n.model=t,t.uF(n)}}handleChanged(t){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(t)){let i=this.currentTransaction;null===i&&(i=new R,this.hm=i);const n=t.copy(),s=i.changes;if(s.Nt(),s.add(n),s.u(),this.cm&&this.Qk>0&&this.transactionLevel<=0&&!this.Dw){const i=t.diagram;if(null!==i&&!1===i.Uh)return;e.ni("Change not within a transaction: "+n.toString()),this.Qk--}}}skipsEvent(t){if(null===t||1===t.change)return!0;const e=t.object;if(null===e)return!1;if(void 0!==e.layer){const t=e.layer;if(null!==t&&t.isTemporary)return!0}else if(e.isTemporary)return!0;return!1}get models(){return this.Tw.iterator}get isEnabled(){return this.Oi}set isEnabled(t){this.Oi=t}get transactionToUndo(){return this.historyIndex>=0&&this.historyIndex<=this.history.count-1?this.history.elt(this.historyIndex):null}get transactionToRedo(){return this.historyIndex<this.history.count-1?this.history.elt(this.historyIndex+1):null}get isUndoingRedoing(){return this.Is}get history(){return this.XC}get maxHistoryLength(){return this.$k}set maxHistoryLength(t){this.$k=t}get historyIndex(){return this.Os}get currentTransaction(){return this.hm}get transactionLevel(){return this.Vn}get isInTransaction(){return this.Vn>0}get cm(){return this.Zk}set cm(t){this.Zk=t}get nestedTransactionNames(){return this.sn}get Ow(){return this.Fw}set Ow(t){this.Fw=t}get Iw(){return this.Rw}set Iw(t){this.Rw=t}get yl(){return this.vw}set yl(t){this.vw=t}get isJustDiscarded(){return this.am}}class I{N;Pt;Oi;_k;tP;fm;KC;constructor(){u.Gi(this),this.N=vt.um(),this.Pt="",this.Oi=!0,this._k=!1,this.tP=null,this.KC=new D,this.fm=-1}get diagram(){return this.N}set diagram(t){t instanceof vt&&(this.N=t)}toString(){return""!==this.name?this.name+" Tool":e.Dn(this.constructor)}updateAdornments(t){}canStart(){return this.isEnabled}doStart(){}doActivate(){this.isActive=!0}doDeactivate(){this.isActive=!1}doStop(){}doCancel(){this.transactionResult=null,this.stopTool()}stopTool(){const t=this.diagram;t.currentTool===this&&(t.currentTool=null,t.currentCursor="")}doMouseDown(){!this.isActive&&this.canStart()&&this.doActivate()}doMouseMove(){}doMouseUp(){this.stopTool()}doMouseWheel(){}canStartMultiTouch(){return!0}standardPinchZoomStart(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,y.V(NaN,NaN)),n=e.getMultiTouchViewPoint(1,y.V(NaN,NaN));if(!i.isReal()||!n.isReal())return y.e(i),void y.e(n);if(this.doCancel(),t.getInputOption("hasGestureZoom")){t.iP=t.scale;const s=n.x-i.x,o=n.y-i.y,r=Math.sqrt(s*s+o*o);t.eP=r,e.bubbles=!1}y.e(i),y.e(n)}standardPinchZoomMove(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,y.V(NaN,NaN)),n=e.getMultiTouchViewPoint(1,y.V(NaN,NaN));if(!i.isReal()||!n.isReal())return y.e(i),void y.e(n);if(this.doCancel(),t.getInputOption("hasGestureZoom")){const s=n.x-i.x,o=n.y-i.y,r=Math.sqrt(s*s+o*o)/t.eP,a=new y((Math.min(n.x,i.x)+Math.max(n.x,i.x))/2,(Math.min(n.y,i.y)+Math.max(n.y,i.y))/2),l=t.iP*r,h=t.commandHandler;if(l!==t.scale&&h.canResetZoom(l)){const e=t.zoomPoint;t.zoomPoint=a,h.resetZoom(l),t.zoomPoint=e}e.bubbles=!1}y.e(i),y.e(n)}doKeyDown(){"Escape"===this.diagram.lastInput.code&&this.doCancel()}doKeyUp(){}startTransaction(t){return void 0===t&&(t=this.name),this.transactionResult=null,this.diagram.startTransaction(t)}stopTransaction(){const t=this.diagram;return null===this.transactionResult?t.rollbackTransaction():t.commitTransaction(this.transactionResult)}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;const i=t.lastInput,n=t.findPartAt(i.documentPoint,!1);if(null!==n){if(e._o?i.meta:i.control){t.D("ChangingSelection",t.selection);let e=n;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!e.isSelected),t.D("ChangedSelection",t.selection)}else if(i.shift){if(!n.isSelected){t.D("ChangingSelection",t.selection);let e=n;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!0),t.D("ChangedSelection",t.selection)}}else if(!n.isSelected){let e=n;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&t.select(e)}}else i.left&&!(e._o?i.meta:i.control)&&!i.shift&&t.clearSelection()}standardMouseClick(t,e){void 0===t&&(t=null),void 0===e&&(e=t=>!t.layer?.isTemporary);const i=this.diagram,n=i.lastInput,s=i.findObjectAt(n.documentPoint,t,e);return n.targetObject=s,this.dF(s,n,i),n.handled}dF(t,e,i){if(e.handled=!1,null!==t&&!t.isEnabledObject())return;let n=0;e.left?n=1===e.clickCount?1:2===e.clickCount?2:1:e.right&&1===e.clickCount&&(n=3);let s="ObjectSingleClicked";if(null!==t){switch(n){case 1:s="ObjectSingleClicked";break;case 2:s="ObjectDoubleClicked";break;case 3:s="ObjectContextClicked"}0!==n&&i.D(s,t)}else{switch(n){case 1:s="BackgroundSingleClicked";break;case 2:s="BackgroundDoubleClicked";break;case 3:s="BackgroundContextClicked"}0!==n&&i.D(s)}if(null!==t)for(;null!==t;){let i=null;switch(n){case 1:i=t.click;break;case 2:i=t.doubleClick?t.doubleClick:t.click;break;case 3:i=t.contextClick}if(null!==i&&(i(e,t),e.handled))break;t=t.panel}else{let t=null;switch(n){case 1:t=i.click;break;case 2:t=i.doubleClick?i.doubleClick:i.click;break;case 3:t=i.contextClick}null!==t&&t(e)}}standardMouseOver(){const t=this.diagram,e=t.lastInput;if(!0===t.animationManager.pi)return;const i=t.skipsUndoManager;t.skipsUndoManager=!0;let n=t.viewportBounds.containsPoint(e.documentPoint)?t.findObjectAt(e.documentPoint,null,null):null;e.event&&("pointercancel"===e.event.type||"pointerout"===e.event.type)&&(n=null),e.targetObject=n;let s=!1;if(n!==t.gc){let i=t.gc;const o=i;for(t.gc=n,this.doCurrentObjectChanged(i,n),e.handled=!1;null!==i;){const t=i.mouseLeave;if(null!==t&&(n===i||null!==n&&n.isContainedBy(i)||(t(e,i,n),s=!0,e.handled)))break;i=i.panel}for(i=o,e.handled=!1;null!==n;){const t=n.mouseEnter;if(null!==t&&(i===n||null!==i&&i.isContainedBy(n)||(t(e,n,i),s=!0,e.handled)))break;n=n.panel}n=t.gc}if(null!==n){let i=n,o="";for(;null!==i&&(o=i.cursor,""===o);)i=i.panel;for(t.currentCursor=o,e.handled=!1,i=n;null!==i;){const t=i.mouseOver;if(null!==t&&(t(e,i),s=!0,e.handled))break;i=i.panel}}else{this.doUpdateCursor(null);const i=t.mouseOver;null!==i&&(i(e),s=!0)}s&&t.requestUpdate(),t.skipsUndoManager=i}doUpdateCursor(t){const e=this.diagram;e&&(e.currentCursor="")}doCurrentObjectChanged(t,e){}standardMouseWheel(){const t=this.diagram,e=t.lastInput;let i=e.delta;if(0===i||!t.documentBounds.isReal())return;const n=t.commandHandler,s=t.toolManager.mouseWheelBehavior;if(null!==n&&(2===s&&!e.shift||1===s&&e.control)){if(i>0?n.canIncreaseZoom():n.canDecreaseZoom()){const s=t.zoomPoint;t.zoomPoint=e.viewPoint,i>0?n.increaseZoom():n.decreaseZoom(),t.zoomPoint=s}e.bubbles=!1}else if(2===s&&e.shift||1===s&&!e.control){const n=t.position.copy(),s=e.event,o=s.deltaMode;let r=s.deltaX,a=s.deltaY,l="pixel";if(0===r&&0===a||e.shift)!e.shift&&t.allowVerticalScroll?(i=3*i*t.scrollVerticalLineChange,t.scroll(l,i>0?"up":"down",Math.abs(i))):e.shift&&t.allowHorizontalScroll&&(i=3*i*t.scrollHorizontalLineChange,t.scroll(l,i>0?"left":"right",Math.abs(i)));else{switch(o){case 0:l="pixel";break;case 1:l="line";break;case 2:l="page"}if(0!==r&&t.allowHorizontalScroll){r*=t.scrollHorizontalLineChange/16,t.scroll(l,r>0?"right":"left",Math.abs(r))}if(0!==a&&t.allowVerticalScroll){a*=t.scrollVerticalLineChange/16,t.scroll(l,a>0?"down":"up",Math.abs(a))}}this.doWheelChange(t,n,e)}}doWheelChange(t,e,i){(!t.position.equals(e)||0!==i.event.wheelDeltaX)&&(i.bubbles=!1)}standardWaitAfter(t,i){void 0===i&&(i=this.diagram.lastInput),this.cancelWaitAfter();const n=this,s=i.clone(this.KC);this.fm=e.tr((()=>n.doWaitAfter(s)),t)}cancelWaitAfter(){-1!==this.fm&&e.Tg(this.fm),this.fm=-1}doWaitAfter(t){}findToolHandleAt(t,e){const i=this.diagram.findObjectAt(t,(t=>{for(;null!==t&&!(t.panel instanceof fe);)t=t.panel;return t}));return null===i?null:i.part.category===e?i:null}isBeyondDragSize(t,e){const i=this.diagram;void 0===t&&(t=i.firstInput.viewPoint),void 0===e&&(e=i.lastInput.viewPoint);const n=i.toolManager.dragSize;let s=n.width,o=n.height;return i.firstInput.isTouchEvent&&(s+=6,o+=6),Math.abs(e.x-t.x)>s||Math.abs(e.y-t.y)>o}get name(){return this.Pt}set name(t){e.s(t,"string",I,"name"),this.Pt=t}get isEnabled(){return this.Oi}set isEnabled(t){e.s(t,"boolean",I,"isEnabled"),this.Oi=t}get isActive(){return this._k}set isActive(t){e.s(t,"boolean",I,"isActive"),this._k=t}get transactionResult(){return this.tP}set transactionResult(t){null!==t&&e.s(t,"string",I,"transactionResult"),this.tP=t}}var z=(t=>(t[t.Scroll=1]="Scroll",t[t.Zoom=2]="Zoom",t[t.None=3]="None",t))(z||{}),j=(t=>(t[t.Zoom=1]="Zoom",t[t.Cancel=2]="Cancel",t[t.None=3]="None",t))(j||{});class V extends I{GC;HC;jC;sP;nP;oP;rP;lP;hP;aP;dm;Vh;constructor(t){super(),this.name="ToolManager",this.GC=new l,this.HC=new l,this.jC=new l,this.sP=850,this.nP=850,this.oP=new x(2,2).$(),this.rP=5e3,this.lP=1,this.hP=1,this.aP=null,this.dm=null,this.Vh=-1,t&&Object.assign(this,t)}static WheelScroll=1;static WheelZoom=2;static WheelNone=3;static GestureZoom=1;static GestureCancel=2;static GestureNone=3;get mouseWheelBehavior(){return this.lP}set mouseWheelBehavior(t){this.lP=t}get gestureBehavior(){return this.hP}set gestureBehavior(t){this.hP=t}initializeStandardTools(){}updateAdornments(t){const e=this.currentToolTip;if(e instanceof fe&&this.dm===t){const i=e.adornedObject;(null!==t?null!==i&&i.part===t:null===i)?this.showToolTip(e,i):this.hideToolTip()}}doMouseDown(){const t=this.diagram,e=t.lastInput;if(e.isTouchEvent&&2===this.gestureBehavior&&(e.bubbles=!1),e.isMultiTouch){if(this.cancelWaitAfter(),3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomStart()}t.undoManager;const i=this.mouseDownTools.length;for(let n=0;n<i;n++){const e=this.mouseDownTools.elt(n);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseDown()))}1===t.lastInput.button&&(1===this.mouseWheelBehavior?this.mouseWheelBehavior=2:2===this.mouseWheelBehavior&&(this.mouseWheelBehavior=1)),this.doActivate(),this.standardWaitAfter(this.holdDelay,e)}doMouseMove(){const t=this.diagram,e=t.lastInput;if(e.isMultiTouch){if(3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomMove()}if(this.isActive){const e=this.mouseMoveTools.length;for(let i=0;i<e;i++){const e=this.mouseMoveTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseMove()))}}this.standardMouseActivity(t);const i=e.event;null!==i&&("pointermove"===i.type||!i.cancelable)&&(e.bubbles=!0)}standardMouseActivity(t){this.standardMouseOver(),this.isBeyondDragSize()&&this.standardWaitAfter(this.isActive?this.holdDelay:this.hoverDelay,t.lastInput)}doCurrentObjectChanged(t,e){const i=this.currentToolTip;null!==i&&(null!==e&&i instanceof fe&&(e===i||e.isContainedBy(i))||this.hideToolTip())}doWaitAfter(t){const e=this.diagram;if(e.gF()&&(this.doMouseHover(),this.isActive||this.doToolTip(),t.isTouchEvent&&!e.lastInput.handled)){const i=t.copy();return i.button=2,e.lastInput=i,e.Ew=!0,void e.doMouseUp()}}doMouseHover(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i)for(e.handled=!1;null!==i;){const t=this.isActive?i.mouseHold:i.mouseHover;if(null!==t&&(t(e,i),e.handled))break;i=i.panel}else{const i=this.isActive?t.mouseHold:t.mouseHover;null!==i&&i(e)}}doToolTip(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i){const t=this.currentToolTip;if(t instanceof fe&&(i===t||i.isContainedBy(t)))return;for(;null!==i;){const t=i.toolTip;if(null!==t)return void this.showToolTip(t,i);i=i.panel}this.hideToolTip()}else{const e=t.toolTip;null!==e?this.showToolTip(e,null):this.hideToolTip()}}showToolTip(t,i){const n=this.diagram;if(t!==this.currentToolTip&&this.hideToolTip(),t instanceof fe){t.layerName="Tool",t.selectable=!1,t.scale=1/n.scale,t.category="ToolTip",t.hasPlaceholder()&&(t.placeholder.scale=n.scale);const e=t.diagram;null!==e&&e!==n&&e.remove(t),n.add(t),null!==i?t.adornedObject=i:t.data=n.model,t.ensureBounds(),this.positionToolTip(t,i)}else t instanceof et&&t!==this.currentToolTip&&null!==t.show&&t.show(i,n,this);this.currentToolTip=t,-1!==this.Vh&&(e.Tg(this.Vh),this.Vh=-1);const s=this.toolTipDuration;if(s>0&&s!==1/0){const t=this;this.Vh=e.tr((()=>t.hideToolTip()),s)}}positionToolTip(t,e){if(t.hasPlaceholder())return;const i=t,n=this.diagram,s=n.lastInput.documentPoint.copy(),o=i.measuredBounds,r=n.viewportBounds;n.lastInput.isTouchEvent&&(s.x-=o.width),s.x+o.width>r.right&&(s.x-=o.width+5/n.scale),s.x<r.x&&(s.x=r.x),s.y+20/n.scale+o.height>r.bottom?s.y-=o.height+5/n.scale:s.y+=20/n.scale,s.y<r.y&&(s.y=r.y),i.position=s}hideToolTip(){-1!==this.Vh&&(e.Tg(this.Vh),this.Vh=-1);const t=this.diagram,i=this.currentToolTip;null!==i&&(i instanceof fe?(t.remove(i),null!==this.dm&&this.dm.removeAdornment(i.category),i.data=null,i.adornedObject=null):i instanceof et&&null!==i.hide&&i.hide(t,this),this.currentToolTip=null)}get currentToolTip(){return this.aP}set currentToolTip(t){this.aP=t,this.dm=null!==t&&t instanceof fe?t.adornedPart:null}doMouseUp(){this.cancelWaitAfter();const t=this.diagram;if(this.isActive){const e=this.mouseUpTools.length;for(let i=0;i<e;i++){const e=this.mouseUpTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}}t.doFocus(),this.doDeactivate()}doMouseWheel(){this.standardMouseWheel()}doKeyDown(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyDown()}doKeyUp(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyUp()}findTool(t){e.s(t,"string",V,"findTool:name");let i=this.mouseDownTools.length;for(let e=0;e<i;e++){const i=this.mouseDownTools.elt(e);if(i.name===t)return i}i=this.mouseMoveTools.length;for(let e=0;e<i;e++){const i=this.mouseMoveTools.elt(e);if(i.name===t)return i}i=this.mouseUpTools.length;for(let e=0;e<i;e++){const i=this.mouseUpTools.elt(e);if(i.name===t)return i}return null}replaceTool(t,i){e.s(t,"string",V,"replaceTool:name"),null!==i&&(i.diagram=this.diagram);let n=this.mouseDownTools.length;for(let e=0;e<n;e++){const n=this.mouseDownTools.elt(e);if(n.name===t)return null!==i?this.mouseDownTools.setElt(e,i):this.mouseDownTools.removeAt(e),n}n=this.mouseMoveTools.length;for(let e=0;e<n;e++){const n=this.mouseMoveTools.elt(e);if(n.name===t)return null!==i?this.mouseMoveTools.setElt(e,i):this.mouseMoveTools.removeAt(e),n}n=this.mouseUpTools.length;for(let e=0;e<n;e++){const n=this.mouseUpTools.elt(e);if(n.name===t)return null!==i?this.mouseUpTools.setElt(e,i):this.mouseUpTools.removeAt(e),n}return null}replaceStandardTool(t,e,i){this.Jt(t,e,i)}Jt(t,i,n){e.s(t,"string",V,"replaceStandardTool:name"),null!==i&&(i.name=t,i.diagram=this.diagram),this.findTool(t)?this.replaceTool(t,i):null!==i&&n.add(i)}get mouseDownTools(){return this.GC}get mouseMoveTools(){return this.HC}get mouseUpTools(){return this.jC}get hoverDelay(){return this.sP}set hoverDelay(t){e.s(t,"number",V,"hoverDelay"),this.sP=t}get holdDelay(){return this.nP}set holdDelay(t){e.s(t,"number",V,"holdDelay"),this.nP=t}get dragSize(){return this.oP}set dragSize(t){this.oP=t.P()}get toolTipDuration(){return this.rP}set toolTipDuration(t){e.s(t,"number",V,"toolTipDuration"),this.rP=t}get actionTool(){return this.findTool("Action")}set actionTool(t){this.Jt("Action",t,this.mouseDownTools)}get relinkingTool(){return this.findTool("Relinking")}set relinkingTool(t){this.Jt("Relinking",t,this.mouseDownTools)}get linkReshapingTool(){return this.findTool("LinkReshaping")}set linkReshapingTool(t){this.Jt("LinkReshaping",t,this.mouseDownTools)}get resizingTool(){return this.findTool("Resizing")}set resizingTool(t){this.Jt("Resizing",t,this.mouseDownTools)}get rotatingTool(){return this.findTool("Rotating")}set rotatingTool(t){this.Jt("Rotating",t,this.mouseDownTools)}get linkingTool(){return this.findTool("Linking")}set linkingTool(t){this.Jt("Linking",t,this.mouseMoveTools)}get draggingTool(){return this.findTool("Dragging")}set draggingTool(t){this.Jt("Dragging",t,this.mouseMoveTools)}get dragSelectingTool(){return this.findTool("DragSelecting")}set dragSelectingTool(t){this.Jt("DragSelecting",t,this.mouseMoveTools)}get panningTool(){return this.findTool("Panning")}set panningTool(t){this.Jt("Panning",t,this.mouseMoveTools)}get contextMenuTool(){return this.findTool("ContextMenu")}set contextMenuTool(t){this.Jt("ContextMenu",t,this.mouseUpTools)}get textEditingTool(){return this.findTool("TextEditing")}set textEditingTool(t){this.Jt("TextEditing",t,this.mouseUpTools)}get clickCreatingTool(){return this.findTool("ClickCreating")}set clickCreatingTool(t){this.Jt("ClickCreating",t,this.mouseUpTools)}get clickSelectingTool(){return this.findTool("ClickSelecting")}set clickSelectingTool(t){this.Jt("ClickSelecting",t,this.mouseUpTools)}}class U extends I{cP;fP;nn;uP;dP;gP;mP;mc;gm;pP;zh;ar;qC;yP;fu;uu;wP;xP;bP;kP;constructor(t){super(),this.name="Dragging",this.cP=!0,this.kP=!0,this.fP=!0,this.nn=null,this.uP=null,this.dP=null,this.gP=null,this.mP=!1,this.fu=!1,this.mc=new y(NaN,NaN),this.gm=new y,this.pP=!0,this.zh=100,this.ar=[],this.qC=(new u).u(),this.yP=new St,this.uu=null,this.wP="copy",this.xP="",this.bP="no-drop",t&&Object.assign(this,t)}get isCopyEnabled(){return this.cP}set isCopyEnabled(t){e.s(t,"boolean",U,"isCopyEnabled"),this.cP=t}get copiesEffectiveCollection(){return this.fP}set copiesEffectiveCollection(t){e.s(t,"boolean",U,"copiesEffectiveCollection"),this.fP=t}get dragOptions(){return this.yP}set dragOptions(t){this.yP=t}get isGridSnapEnabled(){return this.dragOptions.isGridSnapEnabled}set isGridSnapEnabled(t){e.s(t,"boolean",U,"isGridSnapEnabled"),this.dragOptions.isGridSnapEnabled=t}get isComplexRoutingRealtime(){return this.pP}set isComplexRoutingRealtime(t){this.pP=t;const e=this.diagram.findRouter("AvoidsLinks");null!==e&&(e.isRealtime=t)}get isGridSnapRealtime(){return this.dragOptions.isGridSnapRealtime}set isGridSnapRealtime(t){e.s(t,"boolean",U,"isGridSnapRealtime"),this.dragOptions.isGridSnapRealtime=t}get gridSnapCellSize(){return this.dragOptions.gridSnapCellSize}set gridSnapCellSize(t){this.dragOptions.gridSnapCellSize.equals(t)||(t=t.P(),this.dragOptions.gridSnapCellSize=t)}get gridSnapCellSpot(){return this.dragOptions.gridSnapCellSpot}set gridSnapCellSpot(t){this.dragOptions.gridSnapCellSpot.equals(t)||(t=t.P(),this.dragOptions.gridSnapCellSpot=t)}get gridSnapOrigin(){return this.dragOptions.gridSnapOrigin}set gridSnapOrigin(t){this.dragOptions.gridSnapOrigin.equals(t)||(t=t.P(),this.dragOptions.gridSnapOrigin=t)}get dragsLink(){return this.dragOptions.dragsLink}set dragsLink(t){e.s(t,"boolean",U,"dragsLink"),this.dragOptions.dragsLink=t}get dragsTree(){return this.dragOptions.dragsTree}set dragsTree(t){e.s(t,"boolean",U,"dragsTree"),this.dragOptions.dragsTree=t}get copyCursor(){return this.wP}set copyCursor(t){this.wP=t}get moveCursor(){return this.xP}set moveCursor(t){this.xP=t}get nodropCursor(){return this.bP}set nodropCursor(t){this.bP=t}get currentPart(){return this.uP}set currentPart(t){this.uP=t}get copiedParts(){return this.gP}set copiedParts(t){this.gP=t}get draggedParts(){return this.dP}set draggedParts(t){this.dP=t}get draggingParts(){return null!==this.copiedParts?this.copiedParts.toKeySet():null!==this.draggedParts?this.draggedParts.toKeySet():this.qC}get draggedLink(){return this.diagram.draggedLink}set draggedLink(t){this.diagram.draggedLink=t}get isDragOutStarted(){return this.mP}set isDragOutStarted(t){this.mP=t}get startPoint(){return this.gm}set startPoint(t){this.gm.equals(t)||this.gm.a(t)}get delay(){return this.zh}set delay(t){e.s(t,"number",U,"delay"),this.zh=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly&&!t.allowDragOut||!t.allowMove&&!t.allowCopy&&!t.allowDragOut||!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.isTouchEvent&&e.timestamp-t.firstInput.timestamp<this.zh))&&null!==this.findDraggablePart()}findDraggablePart(){const t=this.diagram;let e=t.findPartAt(t.firstInput.documentPoint,!1);if(null===e)return null;for(;null!==e&&!e.canSelect();)e=e.containingGroup;return null!==e&&(e.canMove()||e.canCopy())?e:null}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;let i=t.findPartAt(t.firstInput.documentPoint,!1);if(null!==i){for(;null!==i&&!i.canSelect();)i=i.containingGroup;if(this.currentPart=i,null!==this.currentPart&&!this.currentPart.isSelected){t.D("ChangingSelection",t.selection);const i=t.lastInput;!(e._o?i.meta:i.control)&&!i.shift&&t.clearSelection(!0),this.currentPart.isSelected=!0,t.D("ChangedSelection",t.selection)}}}doActivate(){const t=this.diagram;this.uu=null,null===this.currentPart&&this.standardMouseSelect();const e=this.currentPart;if(null===e||!e.canMove()&&!e.canCopy())return;t.cacheGroupExternalLinks(!0),U.dt=null,this.isActive=!0,this.mc.set(t.position),this.PP(t.selection),this.ar.length=0,t.animationManager.stopAnimation();const i=this.computeEffectiveCollection(t.selection,this.dragOptions);this.draggedParts=i,this.kP=!!this.diagram.layout.isRealtime,this.diagram.layout.isRealtime=!1,t.du=!0,!0===t.getRenderingHint("temporaryPixelRatio")&&t.avgSpf>30&&t.Bw(),t.WC(this.draggedParts),t.gu=!0,this.startTransaction("Drag"),this.startPoint=t.firstInput.documentPoint,t.isMouseCaptured=!0,t.allowDragOut&&this.mF()}PP(t){if(!this.dragsLink)return;const e=this.diagram,i=e.model.mm(),n=t.first();i&&1===t.count&&n instanceof be&&this.mayDragLink(n)?(this.draggedLink=n,this.draggedLink.canRelinkFrom()&&this.draggedLink.canRelinkTo()&&this.draggedLink.clearAdornments(),this.nn=e.toolManager.findTool("Relinking"),null===this.nn&&(this.nn=new Y,this.nn.diagram=e),this.nn.originalLink=this.draggedLink):(this.draggedLink=null,this.nn=null)}mayDragLink(t){const e=this.diagram;return null!==e&&e.allowRelink}computeEffectiveCollection(t,e){return this.diagram.commandHandler.computeEffectiveCollection(t,e)}Es(t){return void 0===t?new wt(y.wo):this.isGridSnapEnabled?new wt(new y(Math.round(1e3*t.x)/1e3,Math.round(1e3*t.y)/1e3)):new wt(t.copy())}doDeactivate(){this.isActive=!1;const t=this.diagram;this.diagram.layout.isRealtime=this.kP,t.gu=!1,t.xl=!0,t.cacheGroupExternalLinks(!1),t.stopAutoScroll(),this.SP(),t.MP(this.draggedParts),this.uu=null,this.currentPart=null,this.draggedParts=null,this.isDragOutStarted=!1,this.fu=!1,U.pF(),this.JC(),this.mc.i(NaN,NaN),null!==U.Xh&&(U.Xh.currentCursor=""),U.Xh=null,U.dt=null,this.bl(),t.isMouseCaptured=!1,t.currentCursor="",t.du=!1,this.stopTransaction(),t.NP(!0)}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}SP(){const t=this.diagram,e=t.skipsUndoManager;t.skipsUndoManager=!0;const i=t.lastInput;this.$C(i,null),t.skipsUndoManager=e,this.ar.length=0}ZC(){this.bl(),this.CP();const t=this.diagram;this.mc.isReal()&&(t.position=this.mc),t.stopAutoScroll()}doCancel(){this.bl(),this.CP();const t=this.diagram;this.mc.isReal()&&(t.position=this.mc),this.stopTool()}doKeyDown(){const t=this.diagram;if(!this.isActive)return;const e=t.lastInput,i=t.previousInput;"Escape"===e.code?this.doCancel():(e.code!==i.code||e.modifiers!==i.modifiers)&&this.doMouseMove()}doKeyUp(){this.isActive&&this.doMouseMove()}yF(t,e){let i=1/0,n=1/0,s=-1/0,o=-1/0;const r=t.iterator;for(;r.next();){const t=r.value;if(!t.isVisible())continue;const e=t.location,a=e.x,l=e.y;isNaN(a)||isNaN(l)||(a<i&&(i=a),l<n&&(n=l),a>s&&(s=a),l>o&&(o=l))}return i===1/0?e.i(0,0,0,0):e.i(i,n,s-i,o-n),e}LP(t){if(null!==this.copiedParts)return;const e=this.diagram;if(t&&(e.isReadOnly||e.isModelReadOnly)||null===this.draggedParts)return;const i=e.undoManager;i.isEnabled&&i.isInTransaction?null!==i.currentTransaction&&i.currentTransaction.changes.count>0&&(e.undoManager.rollbackTransaction(),e.startTransaction("Drag")):this.CP(),e.skipsUndoManager=!t,e.partManager.addsToTemporaryLayer=!t,this.startPoint=e.firstInput.documentPoint;const n=this.copiesEffectiveCollection?this.draggedParts.toKeySet():e.selection,s=e.copyParts(n,e,!0),o=new m,r=this.draggedParts.iterator;for(;r.next();){const t=r.key;if(t.ke()&&t.canCopy()){const e=s.get(t);if(null===e)continue;e.location=t.location,e.ensureBounds(),o.set(e,this.Es(e.location))}}const a=s.iterator;for(;a.next();){const t=a.value;t instanceof be&&t.canCopy()&&o.set(t,this.Es())}if(this.copiedParts=o,this.PP(o.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.cr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}bl(){const t=this.diagram;if(null!==this.copiedParts){if(t.removeParts(this.copiedParts.toKeySet(),!1),this.copiedParts=null,null!==this.draggedParts){const t=this.draggedParts.iterator;for(;t.next();)if(t.key instanceof be){t.value.point=new y(0,0)}}this.doUpdateCursor(null)}t.skipsUndoManager=!1,t.partManager.addsToTemporaryLayer=!1,this.startPoint=t.firstInput.documentPoint}JC(){null!==this.draggedLink&&(this.dragsLink&&null!==this.nn&&(this.nn.stopDraggingMouseMove(),this.nn.originalLink=null),this.draggedLink=null,this.nn=null)}pc(t,e){if(null===t)return;const i=this.diagram,n=this.startPoint,s=y.l();s.a(i.lastInput.documentPoint),this.moveParts(t,s.subtract(n),e),y.e(s),!0===i.getRenderingHint("temporaryPixelRatio")&&null===i.kl&&i.avgSpf>30&&(i.Bw(),i.mu())}moveParts(t,e,i){void 0===i&&(i=!1);const n=this.diagram;null!==n&&n.AP(t,e,this.dragOptions,i)}CP(){if(null===this.draggedParts)return;const t=this.diagram;let e=this.draggedParts.iterator;for(;e.next();){const t=e.key;t.ke()&&(t.location=e.value.point)}for(e=this.draggedParts.iterator;e.next();){const t=e.key;if(t instanceof be&&t.suspendsRouting){const i=e.value.point;this.draggedParts.set(t,this.Es()),t.cr(-i.x,-i.y)}}t.maybeUpdate()}wF(t){if(null===t)return!0;const e=t.part;return!!(null===e||e instanceof fe||e.layer?.isTemporary||this.draggedParts&&this.draggedParts.has(e)||this.copiedParts&&this.copiedParts.has(e))}TP(t){const e=this.diagram;this.dragsLink&&(null!==this.draggedLink&&(this.draggedLink.fromNode=null,this.draggedLink.toNode=null),this.QC(!1));const i=this.findDragOverObject(t),n=e.lastInput;n.targetObject=i,this.doUpdateCursor(i);const s=e.skipsUndoManager;let o=!1;try{if(e.skipsUndoManager=!0,o=this.$C(n,i),!this.isActive&&null===U.dt)return;const s=null!==i?i.part:null;if(null===s||e.handlesDragDropForTopLevelParts&&s.isTopLevel&&!(s instanceof Ne)){const t=e.mouseDragOver;null!==t&&(t(n),o=!0)}if(!this.isActive&&null===U.dt||(this.doDragOver(t,i),!this.isActive&&null===U.dt))return}finally{e.skipsUndoManager=s,o&&e.maybeUpdate()}this.uu=i,!e.isReadOnly&&(e.allowMove||e.allowCopy)&&(e.allowHorizontalScroll||e.allowVerticalScroll)&&e.doAutoScroll(n.viewPoint)}findDragOverObject(t){return this.diagram.DP(t,null,(t=>!this.wF(t)))}doUpdateCursor(t){const e=this.diagram;(null===t||this.uu!==t)&&(!this.diagram.currentTool.isActive||this.mayCopy()?e.currentCursor=this.copyCursor:this.mayMove()?e.currentCursor=this.moveCursor:this.mayDragOut()&&(e.currentCursor=this.nodropCursor))}$C(t,e){let i=!1,n=this.ar.length;const s=n>0?this.ar[0]:null;if(e===s)return!1;t.handled=!1;for(let r=0;r<n;r++){const n=this.ar[r],s=n.mouseDragLeave;if(null!==s&&(s(t,n,e),i=!0,t.handled))break}if(this.ar.length=0,!this.isActive&&null===U.dt||null===e)return i;t.handled=!1;let o=e;for(;null!==o;)this.ar.push(o),o=this._C(o);n=this.ar.length;for(let r=0;r<n;r++){const e=this.ar[r],n=e.mouseDragEnter;if(null!==n&&(n(t,e,s),i=!0,t.handled))break}return i}SE(t,e){return null!==t&&!!(t===e||t.isContainedBy(e)||e instanceof Ne&&!(t instanceof Ne)&&e.handlesDragDropForMembers&&t.part?.isMemberOf(e))}_C(t){const e=t.panel;if(null!==e)return e;if(t instanceof ce&&!(t instanceof Ne)){const e=t.containingGroup;if(null!==e&&e.handlesDragDropForMembers)return e}return null}tL(t,e){const i=this.diagram,n=this.nn;if(null===n)return null;const s=n.portGravity,o=i.findObjectsNear(t,s,(t=>n.findValidLinkablePort(t,e))),r=y.l();let a=1/0,l=null;for(const h=o.iterator;h.next();){const e=h.value;if(null===e.part)continue;const i=e.getDocumentPoint(w.Center,r),n=t.distanceSquaredPoint(i);n<a&&(l=e,a=n)}return y.e(r),l}QC(t){const e=this.draggedLink;if(null!==e){if(e.pointsCount<2)return;const i=this.diagram;if(i.isReadOnly)return;const n=this.nn;if(null===n)return;let s=null,o=null;null===e.fromNode&&(s=this.tL(e.getPoint(0),!1),null!==s&&(o=s.part));let r=null,a=null;null===e.toNode&&(r=this.tL(e.getPoint(e.pointsCount-1),!0),null!==r&&(a=r.part)),n.isValidLink(o,s,a,r)?t?(e.defaultFromPoint=e.getPoint(0),e.defaultToPoint=e.getPoint(e.pointsCount-1),e.suspendsRouting=!1,e.fromNode=o,null!==s&&(e.fromPortId=s.portId),e.toNode=a,null!==r&&(e.toPortId=r.portId),e.fromPort!==i.FP&&i.D("LinkRelinked",e,i.FP),e.toPort!==i.RP&&i.D("LinkRelinked",e,i.RP)):n.doDraggingMouseMove(o,s,a,r):n.doDraggingMouseMove(null,null,null,null)}}doDragOver(t,e){}iL(t){const e=this.diagram;this.dragsLink&&this.QC(!0),this.SP();const i=this.findDragOverObject(t),n=e.lastInput;if(n.targetObject=i,null!==i){n.handled=!1;let t=i;for(;null!==t;){const e=t.mouseDrop;if(null!==e&&(e(n,t),n.handled))break;this.xF(n,t),t=this._C(t)}}else{const t=e.mouseDrop;null!==t&&t(n)}if(!this.isActive&&null===U.dt)return;const s=this.copiedParts||this.draggedParts;if(null!==s){const t=s.iterator;for(;t.next();){const e=t.key;e instanceof pe&&e.linksConnected.each((t=>t.suspendsRouting=!1))}}if(this.doDropOnto(t,i),!this.isActive&&null===U.dt)return;const o=v.l(),r=e.selection.iterator;for(;r.next();){const t=r.value;t instanceof pe&&this.bF(e,t,o)}v.e(o)}xF(t,e){const i=this.diagram,n=e.part;if(i.handlesDragDropForTopLevelParts&&null!==n&&n.isTopLevel&&!(n instanceof Ne)){const e=i.mouseDrop;null!==e&&e(t)}}bF(t,e,i){if(!e.canAvoid())return;let n=!1;i=e.getAvoidableRect(i),t.viewportBounds.containsRect(i)&&(n=!0);const s=this.copiedParts||this.draggedParts;if(null===s)return;const o=t.vP(i,(t=>t.part),(t=>t instanceof be),!0,(t=>t instanceof be),n);if(0===o.count)return;const r=o.iterator;for(;r.next();){const t=r.value;s.has(t)&&s.has(e)||!t.isMemberOf(e)&&t.isAvoiding&&t.invalidateRoute()}}doDropOnto(t,e){}doMouseMove(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;this.simulatedMouseMove(e.event,e.documentPoint,e.targetDiagram)||null!==this.currentPart&&null!==this.draggedParts&&(this.mayCopy()?(this.LP(!1),this.pc(this.copiedParts,!1)):this.mayMove()?(this.bl(),this.pc(this.draggedParts,!0)):this.mayDragOut()?(this.LP(!1),this.pc(this.copiedParts,!1)):this.bl(),this.TP(t.lastInput.documentPoint))}doMouseUp(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;if(this.simulatedMouseUp(e.event,e.documentPoint,e.targetDiagram))return;let i=!1;const n=this.mayCopy();if(n&&null!==this.copiedParts?(this.bl(),this.LP(!0),this.pc(this.copiedParts,!1),null!==this.copiedParts&&(t.D("ChangingSelection",t.selection),t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0})))):(i=!0,this.bl(),this.mayMove()&&(this.pc(this.draggedParts,!0),this.TP(t.lastInput.documentPoint))),this.fu=!0,this.iL(t.lastInput.documentPoint),this.isActive){const e=n&&this.copiedParts,s=e?this.copiedParts?.toKeySet():this.draggedParts?this.draggedParts.toKeySet():null;this.copiedParts=null,i&&this.kF(),t.invalidateDocumentBounds(),t.MP(this.draggedParts),this.transactionResult=e?"Copy":"Move",t.D(e?"SelectionCopied":"SelectionMoved",s)}this.stopTool(),n&&t.D("ChangedSelection",t.selection)}simulatedMouseMove(t,e,i){if(null===U.dt)return!1;const n=U.dt.diagram;i instanceof vt||(i=null);const s=U.Xh;if(i!==s){if(null!==s&&s!==n){s.stopAutoScroll(),U.dt.isDragOutStarted=!1;const t=s.toolManager.findTool("Dragging");null!==t&&t.doSimulatedDragLeave()}if(U.Xh=i,null!==i&&i!==n){U.dt.ZC();const t=i.toolManager.findTool("Dragging");null!==t&&(t.eL(),t.doSimulatedDragEnter())}this.doUpdateCursor(null)}if(null===i||i===n||!i.allowDrop||i.isReadOnly||!i.allowInsert)return!1;const o=i.toolManager.findTool("Dragging");if(null!==o){let n=e;null!==t&&(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),n=i.getMouse(t)),i.lastInput.documentPoint=n,i.lastInput.viewPoint=i.transformDocToView(n),i.lastInput.down=!1,i.lastInput.up=!1,o.doSimulatedDragOver()}return!0}simulatedMouseUp(t,e,i){if(null===U.dt)return!1;const n=U.Xh,s=U.dt.diagram;if(null===i)return U.dt.doCancel(),!0;if(i!==n){if(null!==n){const t=n.toolManager.findTool("Dragging");if(null!==n&&n!==s&&null!==t)return n.stopAutoScroll(),U.dt.isDragOutStarted=!1,t.doSimulatedDragLeave(),!1}U.Xh=i;const t=i.toolManager.findTool("Dragging");null!==t&&(U.dt.ZC(),t.eL(),t.doSimulatedDragEnter())}if(i!==this.diagram){let n=e;null!==t?(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),n=i.getMouse(t)):null===n&&(n=new y),i.lastInput.documentPoint=n,i.lastInput.viewPoint=i.transformDocToView(n),i.lastInput.down=!1,i.lastInput.up=!0;const s=i.toolManager.findTool("Dragging");null!==s&&s.doSimulatedDrop();const o=U.dt;if(null!==o){const t=o.mayCopy();o.transactionResult=t?"Copy":"Move",o.stopTool()}return!0}return!1}kF(){if(null===this.draggedParts)return;const t=this.draggedParts.iterator;for(;t.next();){const e=t.key;if(e instanceof pe){const t=e.containingGroup;null!==t&&t.hasPlaceholder()&&!this.draggedParts.has(t)&&t.placeholder.c()}}}mayCopy(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowCopy||!(e._o?t.lastInput.alt:t.lastInput.control))return!1;const i=t.selection.iterator;for(;i.next();)if(i.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayDragOut(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(!t.allowDragOut||!t.allowCopy||t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayMove(){const t=this.diagram;if(t.isReadOnly||!t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canMove())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())}eL(){U.Uw.has(this)||U.Uw.add(this)}static pF(){if(U.Uw.count>0){const t=U.Uw,e=t.length;for(let i=0;i<e;i++){const e=t.elt(i);e.JC(),e.bl(),e.SP(),e.diagram.stopAutoScroll()}t.clear()}}computeBorder(t,e,i){return this.fu||null===this.draggedParts||this.draggedParts.has(t)?null:i.a(e)}getDraggingSource(){return U.dt}mayDragIn(){const t=this.diagram;if(!t.allowDrop||t.isReadOnly||t.isModelReadOnly||!t.allowInsert)return!1;const e=U.dt;return!(null===e||e.diagram.model.dataFormat!==t.model.dataFormat)}doSimulatedDragEnter(){if(!this.mayDragIn())return;const t=this.diagram;t.animationManager.stopAnimation(),t.fr(),t.animationManager.stopAnimation();const e=U.dt;null!==e&&(this.diagram.du=!0,null===t.lastInput.event&&(t.lastInput.event=e.diagram.lastInput.event)),this.doUpdateCursor(null)}doSimulatedDragLeave(){const t=U.dt;null!==t&&t.doSimulatedDragOut(),this.diagram.du=!1,this.doCancel()}doSimulatedDragOver(){const t=this.diagram;t.animationManager.pu=!0;const e=U.dt;if(null!==e&&null!==e.draggedParts){if(!this.mayDragIn())return;this.sL(e.draggedParts.toKeySet(),!1,t.firstInput),this.pc(this.copiedParts,!1),this.TP(t.lastInput.documentPoint)}t.animationManager.pu=!1}doSimulatedDrop(){const t=this.diagram,e=U.dt;if(null!==e){const i=e.diagram;if(e.fu=!0,this.bl(),null===e.draggedParts||!this.mayDragIn())return;t.animationManager.pu=!0,t.D("ChangingSelection",t.selection),this.startTransaction("Drop"),this.sL(e.draggedParts.toKeySet(),!0,t.lastInput),this.pc(this.copiedParts,!1);const n=new u;null!==this.copiedParts&&(t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0,n.add(t)}))),this.iL(t.lastInput.documentPoint),t.invalidateDocumentBounds(),null!==this.copiedParts&&(this.transactionResult="ExternalCopy"),this.copiedParts=null,t.doFocus(),t.du=!1,t.D("ExternalObjectsDropped",n,i),this.stopTransaction(),t.D("ChangedSelection",t.selection)}t.animationManager.pu=!1}sL(t,e,i){if(null!==this.copiedParts)return;const n=this.diagram;if(n.isReadOnly||n.isModelReadOnly)return;n.skipsUndoManager=!e,n.partManager.addsToTemporaryLayer=!e,this.startPoint=i.documentPoint;const s=n.copyParts(t,n,!0),o=v.l();this.yF(t,o);const r=o.x+o.width/2,a=o.y+o.height/2;v.e(o);const l=this.gm,h=new m,u=y.l(),c=t.iterator;for(;c.next();){const t=c.value;if(t instanceof be&&t.canCopy()){const e=s.get(t);if(null===e)continue;e.points=t.points,e.cr(l.x-r,l.y-a),e.suspendsRouting=!0,h.set(e,this.Es())}}const d=t.iterator;for(;d.next();){const t=d.value;if(t.ke()&&t.canCopy()){const e=s.get(t);if(null===e)continue;const i=t.location;u.i(l.x-(r-i.x),l.y-(a-i.y)),e.location=u,e.ensureBounds(),h.set(e,this.Es(u))}}if(y.e(u),this.copiedParts=h,this.PP(h.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.cr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}mF(){this.isDragOutStarted=!0,this.fu=!1,U.dt=this,U.Xh=this.diagram,this.doSimulatedDragOut()}doSimulatedDragOut(){const t=this.diagram;this.mayCopy()||this.mayMove()?t.currentCursor="":t.currentCursor=this.nodropCursor,this.uu=null}computeMove(t,e,i,n){const s=this.diagram;return null!==s?s.computeMove(t,e,this.dragOptions,n):new y}static Uw=(()=>new l)();static dt=null;static Xh=null}V.prototype.doCancel=function(){null!==U.dt&&U.dt.doCancel(),I.prototype.doCancel.call(this)};class X extends I{OP;IP;Pl;EP;BP;Yh;UP;Kh;VP;zP;XP;YP;KP;GP;nL;HP;Sl;jP;constructor(){super(),this.OP=100,this.IP=!1,this.Pl="pointer",this.EP=new be({layerName:"Tool"}).add(new Jt({isPanelMain:!0,stroke:"blue"}).theme("stroke","tempLink"),new Jt({toArrow:"Standard",fill:"blue",stroke:"blue"}).theme("fill","tempLink").theme("stroke","tempLink")).Et(),this.Yh=new Jt("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:x.Ek}).theme("stroke","tempPort"),this.BP=new pe({selectable:!1,layerName:"Tool"}).add(this.Yh).Et(),this.Kh=new Jt("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:x.Ek}).theme("stroke","tempPort"),this.UP=new pe({selectable:!1,layerName:"Tool"}).add(this.Kh).Et(),this.VP=null,this.zP=null,this.XP=null,this.YP=null,this.KP=null,this.GP=!0,this.nL=new m,this.HP=null,this.Sl=null,this.jP=null}doStop(){this.diagram.stopAutoScroll(),this.originalLink=null,this.originalFromNode=null,this.originalFromPort=null,this.originalToNode=null,this.originalToPort=null,this.validPortsCache.clear(),this.targetPort=null}get portGravity(){return this.OP}set portGravity(t){e.s(t,"number",X,"portGravity"),t>=0&&(this.OP=t)}get isUnconnectedLinkValid(){return this.IP}set isUnconnectedLinkValid(t){e.s(t,"boolean",X,"isUnconnectedLinkValid"),this.IP=t}get linkingCursor(){return this.Pl}set linkingCursor(t){this.Pl=t}get temporaryLink(){return this.EP}set temporaryLink(t){t.Et(),this.EP=t}get temporaryFromNode(){return this.BP}set temporaryFromNode(t){t.Et(),this.BP=t,t&&(this.Yh=t.port)}get temporaryFromPort(){return this.Yh}set temporaryFromPort(t){if(null!==this.Yh){const e=this.Yh.panel;if(null!==e){const i=e.C.indexOf(this.Yh);e.removeAt(i),e.insertAt(i,t)}}this.Yh=t}get temporaryToNode(){return this.UP}set temporaryToNode(t){t.Et(),this.UP=t,t&&(this.Kh=t.port)}get temporaryToPort(){return this.Kh}set temporaryToPort(t){if(null!==this.Kh){const e=this.Kh.panel;if(null!==e){const i=e.C.indexOf(this.Kh);e.removeAt(i),e.insertAt(i,t)}}this.Kh=t}get originalLink(){return this.VP}set originalLink(t){this.VP=t}get originalFromNode(){return this.zP}set originalFromNode(t){this.zP=t}get originalFromPort(){return this.XP}set originalFromPort(t){this.XP=t}get originalToNode(){return this.YP}set originalToNode(t){this.YP=t}get originalToPort(){return this.KP}set originalToPort(t){this.KP=t}get isForwards(){return this.GP}set isForwards(t){this.GP=t}get validPortsCache(){return this.nL}get targetPort(){return this.HP}set targetPort(t){this.HP=t}copyPortProperties(t,e,i,n,s){if(null===t||null===e||null===i||null===n)return;const o=e.getDocumentScale(),r=x.l();r.width=e.naturalBounds.width*o,r.height=e.naturalBounds.height*o,n.desiredSize=r,x.e(r),s?(n.toSpot=e.toSpot,n.toEndSegmentLength=e.toEndSegmentLength):(n.fromSpot=e.fromSpot,n.fromEndSegmentLength=e.fromEndSegmentLength),i.locationSpot=w.Center;const a=y.l();i.location=e.getDocumentPoint(w.Center,a),y.e(a),n.angle=e.getDocumentAngle(),null!==this.portTargeted&&this.portTargeted(t,e,i,n,s)}setNoTargetPortProperties(t,e,i){null!==e&&(e.desiredSize=x.Ek,e.fromSpot=w.None,e.toSpot=w.None),null!==t&&(t.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,t,e,i)}doMouseDown(){this.isActive&&this.doMouseMove()}doMouseMove(){if(this.isActive){const t=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof pe){const t=this.targetPort.part;this.isForwards?this.copyPortProperties(t,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(t,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}findValidLinkablePort(t,e){if(null===t)return null;const i=t.part;if(!(i instanceof pe))return null;for(;null!==t;){const n=e?t.toLinkable:t.fromLinkable;if(!0===n&&(null!==t.portId||t instanceof pe)&&(e?this.isValidTo(i,t):this.isValidFrom(i,t)))return t;if(!1===n)return null;t=t.panel}return null}findTargetPort(t){const e=this.diagram,i=e.lastInput.documentPoint;let n=this.portGravity;let s=1/0,o=null;const r=e.findObjectsNear(i,n,(e=>this.findValidLinkablePort(e,t)),null,!0).iterator;for(;r.next();){const e=r.value,n=e.part;if(!(n instanceof pe))continue;const a=e.getDocumentPoint(w.Center,y.l()),l=i.x-a.x,h=i.y-a.y;y.e(a);const u=l*l+h*h;if(u<s){const i=this.validPortsCache.get(e);null!==i?i&&(o=e,s=u):t&&this.isValidLink(this.originalFromNode,this.originalFromPort,n,e)||!t&&this.isValidLink(n,e,this.originalToNode,this.originalToPort)?(this.validPortsCache.set(e,!0),o=e,s=u):this.validPortsCache.set(e,!1)}}if(null!==o){const t=o.part;if(t instanceof pe&&(null===t.layer||t.layer.allowLink))return o}return null}isValidFrom(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.fromLinkable))return!1;const i=e.fromMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalFromNode&&e===this.originalFromPort)return!0;let n=e.portId;if(null===n&&(n=""),t.findLinksOutOf(n).count>=i)return!1}return!0}isValidTo(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.toLinkable))return!1;const i=e.toMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalToNode&&e===this.originalToPort)return!0;let n=e.portId;if(null===n&&(n=""),t.findLinksInto(n).count>=i)return!1}return!0}isInSameNode(t,e){if(null===t||null===e)return!1;if(t===e)return!0;const i=t.part,n=e.part;return null!==i&&i===n}isLinked(t,e){if(null===t||null===e)return!1;const i=t.part;if(!(i instanceof pe))return!1;let n=t.portId;null===n&&(n="");const s=e.part;if(!(s instanceof pe))return!1;let o=e.portId;null===o&&(o="");const r=s.findLinksInto(o);for(;r.next();){const t=r.value;if(t.fromNode===i&&t.fromPortId===n)return!0}return!1}isValidLink(t,e,i,n){if(!this.isValidFrom(t,e)||!this.isValidTo(i,n)||null!==e&&null!==n&&((!e.fromLinkableSelfNode||!n.toLinkableSelfNode)&&this.isInSameNode(e,n)||(!e.fromLinkableDuplicates||!n.toLinkableDuplicates)&&this.isLinked(e,n))||null!==this.originalLink&&(null!==t&&this.isLabelDependentOnLink(t,this.originalLink)||null!==i&&this.isLabelDependentOnLink(i,this.originalLink))||null!==t&&null!==i&&(null===t.data&&null!==i.data||null!==t.data&&null===i.data)||!this.isValidCycle(t,i,this.originalLink))return!1;let s;return!(null!==t&&null!==e&&(s=t.linkValidation,null!==s&&!s(t,e,i,n,this.originalLink))||null!==i&&null!==n&&(s=i.linkValidation,null!==s&&!s(t,e,i,n,this.originalLink)))&&(s=this.linkValidation,null===s||s(t,e,i,n,this.originalLink))}isLabelDependentOnLink(t,e){if(null===t)return!1;const i=t.labeledLink;if(null===i)return!1;if(i===e)return!0;const n=new u;return n.add(t),this.qP(i,e,n)}qP(t,e,i){if(t===e)return!0;const n=t.fromNode;if(null!==n&&n.labeledLink&&(i.add(n),this.qP(n.labeledLink,e,i)))return!0;const s=t.toNode;return!(null===s||!s.labeledLink||(i.add(s),!this.qP(s.labeledLink,e,i)))}isValidCycle(t,e,i){if(void 0===i&&(i=null),null===t||null===e)return this.isUnconnectedLinkValid;const n=this.diagram;let s=1;if(n&&(s=n.model.pm()?n.isTreePathToChildren?5:6:n.validCycle),1===s)return!0;if(5===s){const n=i||this.temporaryLink;if(null!==n&&!n.isTreeLink)return!0;const s=e.linksConnected;for(;s.next();){const t=s.value;if(t!==i&&t.isTreeLink&&t.toNode===e)return!1}return!this.yu(t,e,i,!0)}if(6===s){const n=i||this.temporaryLink;if(null!==n&&!n.isTreeLink)return!0;const s=t.linksConnected;for(;s.next();){const e=s.value;if(e!==i&&e.isTreeLink&&e.fromNode===t)return!1}return!this.yu(t,e,i,!0)}return 2===s?!this.PF(t,e,i):3===s?!this.yu(t,e,i,!1):4!==s||!this.SF(t,e,i)}yu(t,e,i,n){if(t===e)return!0;if(null===t||null===e)return!1;const s=t.linksConnected;for(;s.next();){const o=s.value;if(o===i||n&&!o.isTreeLink||o.toNode!==t)continue;const r=o.fromNode;if(r!==t&&null!==r&&this.yu(r,e,i,n))return!0}return!1}PF(t,e,i){if(t===e)return!0;const n=new u;return n.add(e),this.oL(n,t,e,i)}oL(t,e,i,n){if(e===i)return!0;if(null===e||null===i||t.has(e))return!1;t.add(e);const s=e.linksConnected;for(;s.next();){const o=s.value;if(o===n||o.toNode!==e)continue;const r=o.fromNode;if(r!==e&&null!==r&&this.oL(t,r,i,n))return!0}return!1}SF(t,e,i){if(t===e)return!0;const n=new u;return n.add(e),this.rL(n,t,e,i)}rL(t,e,i,n){if(e===i)return!0;if(null===e||null===i||t.has(e))return!1;t.add(e);const s=e.linksConnected;for(;s.next();){const o=s.value;if(o===n)continue;const r=o.fromNode,a=o.toNode,l=r===e?a:r;if(l!==e&&null!==l&&this.rL(t,l,i,n))return!0}return!1}get linkValidation(){return this.Sl}set linkValidation(t){null!==t&&e.k(t,X,"linkValidation"),this.Sl=t}get portTargeted(){return this.jP}set portTargeted(t){null!==t&&e.k(t,X,"portTargeted"),this.jP=t}}var K=(t=>(t[t.Either=1]="Either",t[t.ForwardsOnly=2]="ForwardsOnly",t[t.BackwardsOnly=3]="BackwardsOnly",t))(K||{});class G extends X{WP;JP;b;$P;constructor(t){super(),this.name="Linking",this.WP={},this.JP=null,this.b=1,this.$P=null,t&&Object.assign(this,t)}static Either=1;static ForwardsOnly=2;static BackwardsOnly=3;get archetypeLinkData(){return this.WP}set archetypeLinkData(t){null!==t&&e.ec(t,G,"archetypeLinkData"),this.WP=t}get archetypeLabelNodeData(){return this.JP}set archetypeLabelNodeData(t){null!==t&&e.ec(t,G,"archetypeLabelNodeData"),this.JP=t}get direction(){return this.b}set direction(t){this.b=t}get startObject(){return this.$P}set startObject(t){this.$P=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowLink||!t.model.Vw()||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()}findLinkablePort(){const t=this.diagram;let e=this.startObject;if(null===e&&(e=t.findObjectAt(t.firstInput.documentPoint,null,null)),null===e)return null;const i=e.part;if(!(i instanceof pe))return null;const n=this.direction;if(1===n||2===n){const t=this.findValidLinkablePort(e,!1);if(null!==t)return this.isForwards=!0,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!1))return this.isForwards=!0,t}}if(1===n||3===n){const t=this.findValidLinkablePort(e,!0);if(null!==t)return this.isForwards=!1,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!0))return this.isForwards=!1,t}}return null}doActivate(){const t=this.diagram,e=this.findLinkablePort();if(null!==e){if(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.isForwards){null!==this.temporaryToNode&&(this.temporaryToNode.location=t.lastInput.documentPoint),this.originalFromPort=e;const i=this.originalFromPort.part;i instanceof pe&&(this.originalFromNode=i),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else{null!==this.temporaryFromNode&&(this.temporaryFromNode.location=t.lastInput.documentPoint),this.originalToPort=e;const i=this.originalToPort.part;i instanceof pe&&(this.originalToNode=i),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)}t.add(this.temporaryFromNode),this.temporaryFromNode&&this.temporaryFromNode.ensureBounds(),t.add(this.temporaryToNode),this.temporaryToNode&&this.temporaryToNode.ensureBounds(),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0}else this.stopTool()}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.startObject=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=null,i=null,n=null,s=null,o=null;try{this.targetPort=this.findTargetPort(this.isForwards);const r=this.targetPort;if(null!==r){const t=r.part;t instanceof pe&&(this.isForwards?(null!==this.originalFromNode&&(e=this.originalFromNode,i=this.originalFromPort),n=t,s=r):(e=t,i=r,null!==this.originalToNode&&(n=this.originalToNode,s=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(e=this.originalFromNode,i=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(n=this.originalToNode,s=this.originalToPort);null!==e||null!==n?(o=this.insertLink(e,i,n,s),null!==o?(null===r&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint),t.allowSelect&&(t.D("ChangingSelection",t.selection),t.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,t.D("LinkDrawn",o)):this.doNoLink(e,i,n,s)):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&t.allowSelect&&t.D("ChangedSelection",t.selection)}}}isNewTreeLink(){const t=this.archetypeLinkData;if(null===t)return!0;if(t instanceof be)return t.isTreeLink;const e=this.diagram;if(null===e)return!0;const i=e.partManager.getLinkCategoryForData(t),n=e.partManager.findLinkTemplateForCategory(i);return null===n||n.isTreeLink}insertLink(t,e,i,n){return this.diagram.partManager.insertLink(t,e,i,n)}doNoLink(t,e,i,n){}}class Y extends X{lL=null;hL=null;ZP=null;QP=null;fs;_P;constructor(t){super(),this.name="Relinking",this.fromHandleArchetype=new Jt("Diamond",{desiredSize:x.nu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:0}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.toHandleArchetype=new Jt("Diamond",{desiredSize:x.nu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:-1}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.fs=null,this._P=new v,t&&Object.assign(this,t)}updateAdornments(t){if(null===t||!(t instanceof be))return;let e="RelinkFrom",i=null;if(t.isSelected&&!this.diagram.isReadOnly){const n=t.selectionObject;null!==n&&t.canRelinkFrom()&&t.actualBounds.isReal()&&t.isVisible()&&n.actualBounds.isReal()&&n.isVisibleObject()&&(i=t.findAdornment(e),null===i&&(i=this.makeAdornment(n,!1),t.addAdornment(e,i)))}if(null===i&&t.removeAdornment(e),e="RelinkTo",i=null,t.isSelected&&!this.diagram.isReadOnly){const n=t.selectionObject;null!==n&&t.canRelinkTo()&&t.actualBounds.isReal()&&t.isVisible()&&n.actualBounds.isReal()&&n.isVisibleObject()&&(i=t.findAdornment(e),null===i?(i=this.makeAdornment(n,!0),t.addAdornment(e,i)):i.c())}null===i&&t.removeAdornment(e)}makeAdornment(t,e){let i=e?this.QP:this.ZP;return i&&(i=i.copy(),i.adornedObject=t),i}get fromHandleArchetype(){return this.lL}set fromHandleArchetype(t){this.lL=t,this.ZP=null!==t?new fe(Yt.Link).add(t).Et():null}get toHandleArchetype(){return this.hL}set toHandleArchetype(t){this.hL=t,this.QP=null!==t?new fe(Yt.Link).add(t).Et():null}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowRelink||!t.model.Vw()||!t.lastInput.left)return!1;let e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom");return null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo")),null!==e}doActivate(){const t=this.diagram;if(null===this.originalLink){let e=this.handle;if(null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom"),null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo"))),null===e)return;const i=e.part;if(!(i instanceof fe)||!(i.adornedPart instanceof be))return;this.handle=e,this.isForwards=null===i||"RelinkTo"===i.category,this.originalLink=i.adornedPart}const e=this.originalLink;null!==e&&(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.originalFromPort=e.fromPort,this.originalFromNode=e.fromNode,this.originalToPort=e.toPort,this.originalToNode=e.toNode,this._P.set(e.actualBounds),e.pointsCount>0&&(null===e.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=x.sc),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=e.getPoint(0))),null===e.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=x.sc),null!==this.temporaryToNode&&(this.temporaryToNode.location=e.getPoint(e.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),t.add(this.temporaryFromNode),t.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(e,this.temporaryLink),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0)}copyLinkProperties(t,e){if(null===t||null===e)return;e.adjusting=t.adjusting,e.corner=t.corner;let i=t.curve;(11===i||10===i)&&(i=0),e.curve=i,e.curviness=t.curviness,e.isTreeLink=t.isTreeLink,e.points=t.points,e.routing=t.routing,e.smoothness=t.smoothness,e.fromSpot=t.fromSpot,e.fromEndSegmentLength=t.fromEndSegmentLength,e.fromShortLength=t.fromShortLength,e.toSpot=t.toSpot,e.toEndSegmentLength=t.toEndSegmentLength,e.toShortLength=t.toShortLength}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.handle=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=this.originalFromNode,i=this.originalFromPort,n=this.originalToNode,s=this.originalToPort,o=this.originalLink;try{if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){const t=this.targetPort.part;t instanceof pe&&(this.isForwards?(n=t,s=this.targetPort):(e=t,i=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?(n=null,s=null):(e=null,i=null):o=null;null!==o?(this.reconnectLink(o,this.isForwards?n:e,this.isForwards?s:i,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint,o.invalidateRoute()),this.transactionResult=this.name,t.D("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):null!==this.originalLink&&this.doNoRelink(this.originalLink,this.isForwards),null!==this.originalLink&&this.originalLink.invalidateOtherJumpOvers(this._P)}finally{this.stopTool()}}}reconnectLink(t,e,i,n){const s=null!==i&&null!==i.portId?i.portId:"";return n?(t.toNode=e,t.toPortId=s):(t.fromNode=e,t.fromPortId=s),!0}doNoRelink(t,e){}doDraggingMouseMove(t,e,i,n){null!==t?(this.copyPortProperties(t,e,this.temporaryFromNode,this.temporaryFromPort,!1),this.diagram.add(this.temporaryFromNode)):this.diagram.remove(this.temporaryFromNode),null!==i?(this.copyPortProperties(i,n,this.temporaryToNode,this.temporaryToPort,!0),this.diagram.add(this.temporaryToNode)):this.diagram.remove(this.temporaryToNode)}stopDraggingMouseMove(){this.diagram.remove(this.temporaryFromNode),this.diagram.remove(this.temporaryToNode)}}var q=(t=>(t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.All=3]="All",t))(q||{});class H extends I{ur;tS;iS;fs;zw;eS;ym;constructor(t){super(),this.name="LinkReshaping",this.ur=new Jt("Rectangle",{desiredSize:x.yC,fill:"lightblue",stroke:"dodgerblue"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.tS=new Jt("Diamond",{desiredSize:x.nu,fill:"lightblue",stroke:"dodgerblue",cursor:"move"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.iS=3,this.fs=null,this.zw=null,this.eS=new y,this.ym=new l,t&&Object.assign(this,t)}static None=0;static Horizontal=1;static Vertical=2;static All=3;getReshapingBehavior(t){return t?t.dr:0}setReshapingBehavior(t,e){t.dr=e}updateAdornments(t){if(null===t||!(t instanceof be))return;let e=null;if(t.isSelected&&!this.diagram.isReadOnly){const i=t.path;null!==i&&t.canReshape()&&t.actualBounds.isReal()&&t.isVisible()&&i.actualBounds.isReal()&&i.isVisibleObject()&&(e=t.findAdornment(this.name),(null===e||e.sS!==t.pointsCount||e.nS!==t.resegmentable)&&(e=this.makeAdornment(i),null!==e&&(e.sS=t.pointsCount,e.nS=t.resegmentable,t.addAdornment(this.name,e))))}null===e&&t.removeAdornment(this.name)}makeAdornment(t){const e=t.part,i=e.points,n=e.pointsCount,s=e.isOrthogonal;let o=null;if(null!==i&&n>1){o=new fe,o.type=Yt.Link;const i=e.firstPickIndex,n=e.lastPickIndex,r=s?1:0;if(e.resegmentable&&9!==e.computeCurve())for(let e=i+r;e<n-r;e++){const i=this.makeResegmentHandle(t,e);null!==i&&(i.segmentIndex=e,i.segmentFraction=.5,i.fromMaxLinks=999,o.add(i))}for(let a=i+1;a<n;a++){const r=this.makeHandle(t,a);if(null!==r){if(r.segmentIndex=a,a!==i)if(a===i+1&&s){const t=e.getPoint(i);let n=e.getPoint(i+1);S.f(t.x,n.x)&&S.f(t.y,n.y)?(n=e.getPoint(i-1),S.f(t.x,n.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,n.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):S.f(t.x,n.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,n.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else if(a===n-1&&s){let t=e.getPoint(n-1);const i=e.getPoint(n);S.f(t.x,i.x)&&S.f(t.y,i.y)?(t=e.getPoint(n+1),S.f(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):S.f(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else a===n||(this.setReshapingBehavior(r,3),r.cursor="move");o.add(r)}}o.adornedObject=t}return o}makeHandle(t,e){const i=this.handleArchetype;return null===i?null:i.copy().oS()}get handleArchetype(){return this.ur}set handleArchetype(t){this.ur=t}makeResegmentHandle(t,e){const i=this.midHandleArchetype;return null===i?null:i.copy().oS()}get midHandleArchetype(){return this.tS}set midHandleArchetype(t){this.tS=t}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}get adornedLink(){return this.zw}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowReshape||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;const e=this.handle.part.adornedPart;if(e instanceof be){if(this.zw=e,t.isMouseCaptured=!0,this.startTransaction(this.name),e.resegmentable&&999===this.handle.fromMaxLinks){const i=e.points.copy(),n=this.getResegmentingPoint();if(i.insertAt(this.handle.segmentIndex+1,n),e.isOrthogonal&&i.insertAt(this.handle.segmentIndex+1,n),e.points=i,e.invalidateAdornments(),e.updateAdornments(),this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.eS=e.getPoint(this.handle.segmentIndex),this.ym=e.points.copy(),this.isActive=!0}}doDeactivate(){this.stopTransaction(),this.handle=null,this.zw=null;this.diagram.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){const t=this.adornedLink;null!==t&&(t.points=this.ym),this.stopTool()}getResegmentingPoint(){return null===this.handle?this.diagram.lastInput.documentPoint:this.handle.getDocumentPoint(w.Center)}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e);const i=this.adornedLink;if(null!==i&&i.resegmentable&&null!==this.handle){const t=this.handle.segmentIndex,e=i.getPoint(t-1),n=i.getPoint(t),s=i.getPoint(t+1);if(i.isOrthogonal){if(t>i.firstPickIndex+1&&t<i.lastPickIndex-1){let o=i.getPoint(t-2);if(this.isWithinResegmentingDistance(e,n)&&(this.isInLineOrtho(o,e,n,s,!0)||this.isInLineOrtho(o,e,n,s,!1))){const r=i.points.copy();this.isInLineOrtho(o,e,n,s,!0)?(r.setElt(t-2,new y(o.x,(s.y+o.y)/2)),r.setElt(t+1,new y(s.x,(s.y+o.y)/2))):(r.setElt(t-2,new y((s.x+o.x)/2,o.y)),r.setElt(t+1,new y((s.x+o.x)/2,s.y))),r.removeAt(t),r.removeAt(t-1),i.points=r,i.invalidateAdornments()}else if(o=i.getPoint(t+2),this.isWithinResegmentingDistance(n,s)&&(this.isInLineOrtho(e,n,s,o,!0)||this.isInLineOrtho(e,n,s,o,!1))){const r=i.points.copy();this.isInLineOrtho(e,n,s,o,!0)?(r.setElt(t-1,new y(e.x,(e.y+o.y)/2)),r.setElt(t+2,new y(o.x,(e.y+o.y)/2))):(r.setElt(t-1,new y((e.x+o.x)/2,e.y)),r.setElt(t+2,new y((e.x+o.x)/2,o.y))),r.removeAt(t+1),r.removeAt(t),i.points=r,i.invalidateAdornments()}}}else{const o=y.l();if(S.ul(e.x,e.y,s.x,s.y,n.x,n.y,o)&&o.distanceSquaredPoint(n)<this.resegmentingDistance*this.resegmentingDistance){const e=i.points.copy();e.removeAt(t),i.points=e,i.invalidateAdornments()}y.e(o)}}t.invalidateDocumentBounds(),this.transactionResult=this.name,t.D("LinkReshaped",this.adornedLink,this.ym)}this.stopTool()}isWithinResegmentingDistance(t,e){return Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(t.y-e.y)<this.resegmentingDistance}isInLineOrtho(t,e,i,n,s){return s?Math.abs(t.y-e.y)<this.resegmentingDistance&&Math.abs(e.y-i.y)<this.resegmentingDistance&&Math.abs(i.y-n.y)<this.resegmentingDistance:Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(e.x-i.x)<this.resegmentingDistance&&Math.abs(i.x-n.x)<this.resegmentingDistance}get resegmentingDistance(){return this.iS}set resegmentingDistance(t){e.s(t,"number",H,"resegmentingDistance"),this.iS=t}reshape(t){const e=this.adornedLink;if(null===e)return;const i=this.handle;if(null===i)return;e.startRoute();let n=i.segmentIndex;const s=this.getReshapingBehavior(i);if(e.isOrthogonal)if(n===e.firstPickIndex+1){const i=e.firstPickIndex+1;2===s?(e.setPointAt(i,e.getPoint(i-1).x,t.y),e.setPointAt(i+1,e.getPoint(i+2).x,t.y)):1===s&&(e.setPointAt(i,t.x,e.getPoint(i-1).y),e.setPointAt(i+1,t.x,e.getPoint(i+2).y))}else if(n===e.lastPickIndex-1){const i=e.lastPickIndex-1;2===s?(e.setPointAt(i-1,e.getPoint(i-2).x,t.y),e.setPointAt(i,e.getPoint(i+1).x,t.y)):1===s&&(e.setPointAt(i-1,t.x,e.getPoint(i-2).y),e.setPointAt(i,t.x,e.getPoint(i+1).y))}else{let i=n;const s=e.getPoint(i),o=e.getPoint(i-1),r=e.getPoint(i+1);S.f(o.x,s.x)&&S.f(s.y,r.y)?(S.f(o.x,e.getPoint(i-2).x)&&!S.f(o.y,e.getPoint(i-2).y)?(e.insertPointAt(i,t.x,o.y),n++,i++):e.setPointAt(i-1,t.x,o.y),S.f(r.y,e.getPoint(i+2).y)&&!S.f(r.x,e.getPoint(i+2).x)?e.insertPointAt(i+1,r.x,t.y):e.setPointAt(i+1,r.x,t.y)):S.f(o.y,s.y)&&S.f(s.x,r.x)?(S.f(o.y,e.getPoint(i-2).y)&&!S.f(o.x,e.getPoint(i-2).x)?(e.insertPointAt(i,o.x,t.y),n++,i++):e.setPointAt(i-1,o.x,t.y),S.f(r.x,e.getPoint(i+2).x)&&!S.f(r.y,e.getPoint(i+2).y)?e.insertPointAt(i+1,t.x,r.y):e.setPointAt(i+1,t.x,r.y)):S.f(o.x,s.x)&&S.f(s.x,r.x)?(S.f(o.x,e.getPoint(i-2).x)&&!S.f(o.y,e.getPoint(i-2).y)?(e.insertPointAt(i,t.x,o.y),n++,i++):e.setPointAt(i-1,t.x,o.y),S.f(r.x,e.getPoint(i+2).x)&&!S.f(r.y,e.getPoint(i+2).y)?e.insertPointAt(i+1,t.x,r.y):e.setPointAt(i+1,t.x,r.y)):S.f(o.y,s.y)&&S.f(s.y,r.y)&&(S.f(o.y,e.getPoint(i-2).y)&&!S.f(o.x,e.getPoint(i-2).x)?(e.insertPointAt(i,o.x,t.y),n++,i++):e.setPointAt(i-1,o.x,t.y),S.f(r.y,e.getPoint(i+2).y)&&!S.f(r.x,e.getPoint(i+2).x)?e.insertPointAt(i+1,r.x,t.y):e.setPointAt(i+1,r.x,t.y)),e.setPointAt(n,t.x,t.y)}else{e.setPointAt(n,t.x,t.y);let i=e.fromNode,s=e.fromPort;if(null!==i){const t=i.findVisibleNode();null!==t&&t!==i&&(i=t,s=i.port)}if(1===n&&null!==s&&e.computeSpot(!0,s).isNoSpot()){const n=s.getDocumentPoint(w.Center,y.l()),o=e.getLinkPointFromPoint(i,s,n,t,!0,y.l());e.setPointAt(0,o.x,o.y),y.e(n),y.e(o)}let o=e.toNode,r=e.toPort;if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,r=o.port)}if(n===e.pointsCount-2&&null!==r&&e.computeSpot(!1,r).isNoSpot()){const i=r.getDocumentPoint(w.Center,y.l()),n=e.getLinkPointFromPoint(o,r,i,t,!1,y.l());e.setPointAt(e.pointsCount-1,n.x,n.y),y.e(i),y.e(n)}}e.commitRoute()}computeReshape(t){const e=this.adornedLink;if(null===e)return t;const i=this.handle;if(null===i)return t;const n=i.segmentIndex;switch(this.getReshapingBehavior(i)){case 3:return t;case 2:{const i=e.getPoint(n);return new y(i.x,t.y)}case 1:{const i=e.getPoint(n);return new y(t.x,i.y)}default:return e.getPoint(n)}}get originalPoint(){return this.eS}get originalPoints(){return this.ym}}class _ extends I{gr;pr;ko;yc;rS;us;ur;fs;wm;lS;wc;Xw;Yw;Kw;constructor(t){super(),this.name="Resizing",this.gr=new x(1,1).u(),this.pr=new x(9999,9999).u(),this.ko=new x(NaN,NaN).u(),this.yc=!1,this.rS=!0,this.us=null,this.ur=new Jt("Rectangle",{alignmentFocus:w.Center,desiredSize:x.yC,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.fs=null,this.wm=new y,this.lS=new x,this.wc=new y,this.Xw=new x(0,0),this.Yw=new x(1/0,1/0),this.Kw=new x(1,1),t&&Object.assign(this,t)}updateAdornments(t){if(!(null===t||t instanceof be)){if(t.isSelected&&!this.diagram.isReadOnly){const e=t.resizeObject;let i=t.findAdornment(this.name);if(null!==e&&t.canResize()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()&&((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)){const n=e.getDocumentAngle();return t.Ml()&&this.updateResizeHandles(i,n),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part?.resizeAdornmentTemplate;if(i){if(e=i.copy(),null===e)return null}else{e=new fe,e.type=Yt.Spot,e.locationSpot=w.Center;const i=new Te;i.isPanelMain=!0,e.add(i);let n=this.makeHandle(t,w.TopLeft);null!==n&&e.add(n),n=this.makeHandle(t,w.TopRight),null!==n&&e.add(n),n=this.makeHandle(t,w.BottomRight),null!==n&&e.add(n),n=this.makeHandle(t,w.BottomLeft),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleTop),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleRight),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleBottom),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleLeft),null!==n&&e.add(n)}return e.adornedObject=t,e}makeHandle(t,e){const i=this.handleArchetype;if(null===i)return null;const n=i.copy().oS();return n.alignment=e,n}updateResizeHandles(t,e){if(null!==t)if(!t.alignment.isDefault()&&("pointer"===t.cursor||t.cursor.indexOf("resize")>0))this.MF(t,e);else if(t instanceof Yt){const i=t.elements;for(;i.next();){const t=i.value;this.updateResizeHandles(t,e)}}}MF(t,e){let i=t.alignment;i.isNoSpot()&&(i=w.Center);let n=e;if(i.x<=0)i.y<=0?n+=225:i.y>=1?n+=135:n+=180;else if(i.x>=1)i.y<=0?n+=315:i.y>=1&&(n+=45);else if(i.y<=0)n+=270;else{if(!(i.y>=1))return;n+=90}n<0?n+=360:n>=360&&(n-=360),t.cursor=n<22.5?"e-resize":n<67.5?"se-resize":n<112.5?"s-resize":n<157.5?"sw-resize":n<202.5?"w-resize":n<247.5?"nw-resize":n<292.5?"n-resize":n<337.5?"ne-resize":"e-resize"}get handleArchetype(){return this.ur}set handleArchetype(t){this.ur=t}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}get adornedObject(){return this.us}set adornedObject(t){null!==t&&t.part instanceof fe&&e.o("new handle must not be in an Adornment: "+t),this.us=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowResize||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&null!==this.adornedObject.part&&(t.isMouseCaptured=!0,t.animationManager.stopAnimation(),t.gu=!0,this.startTransaction(this.name),this.wm.set(this.adornedObject.getDocumentPoint(this.handle.alignment.opposite())),this.wc.set(this.adornedObject.part.location),this.lS.set(this.adornedObject.desiredSize),this.Kw=this.computeCellSize(),this.Xw=this.computeMinSize(),this.Yw=this.computeMaxSize(),this.isActive=!0))}doDeactivate(){const t=this.diagram;t.gu=!1,t.xl=!0,this.stopTransaction(),this.handle=null,this.us=null,t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){null!==this.adornedObject&&null!==this.adornedObject.part&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()}doMouseMove(){const t=this.diagram;if(!this.isActive||null===this.adornedObject||null===this.handle)return;const e=this.Xw,i=this.Yw,n=this.Kw,s=t.lastInput.documentPoint,o=this.adornedObject.getLocalPoint(s,y.l()),r=this.computeReshape(),a=this.computeResize(o,this.handle.alignment,e,i,n,r);this.resize(a),t.maybeUpdate(),y.e(o)}doMouseUp(){const t=this.diagram;if(this.isActive&&null!==this.adornedObject&&null!==this.handle){const e=this.Xw,i=this.Yw,n=this.Kw,s=this.adornedObject.getLocalPoint(t.lastInput.documentPoint,y.l()),o=this.computeReshape(),r=this.computeResize(s,this.handle.alignment,e,i,n,o);this.resize(r),y.e(s),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.D("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()}resize(t){const e=this.diagram,i=this.adornedObject;if(null===i)return;i.desiredSize=t.size;const n=i.part;if(null===n||null===this.handle)return;n.ensureBounds();const s=i.getDocumentPoint(this.handle.alignment.opposite());if(n instanceof Ne){const t=new l;let i;t.add(n),!this.dragsMembers&&!n.hasPlaceholder()&&(i=new St,i.dragsMembers=!1),e.moveParts(t,this.oppositePoint.copy().subtract(s),!0,i)}else n.location=n.location.copy().subtract(s).add(this.oppositePoint);e.maybeUpdate()}computeResize(t,e,i,n,s,o){if(null===this.adornedObject)return v.Fg;e.isNoSpot()&&(e=w.Center);const r=this.adornedObject.naturalBounds,a=r.x,l=r.y,h=r.x+r.width,u=r.y+r.height;let c=1;if(!o){let t=r.width,e=r.height;t<=0&&(t=1),e<=0&&(e=1),c=e/t}const d=y.l();S.Dg(t.x,t.y,a,l,s.width,s.height,d);const f=r.copy();return e.x<=0?e.y<=0?(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=Math.max(h-f.x,i.width),f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.x=h-f.width,f.y=u-f.height)):e.y>=1?(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=Math.max(h-f.x,i.width),f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.x=h-f.width)):(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=h-f.x,o||(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c,f.y=l+.5*(u-l-f.height))):e.x>=1?e.y<=0?(f.width=Math.max(Math.min(d.x-a,n.width),i.width),f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.y=u-f.height)):e.y>=1?(f.width=Math.max(Math.min(d.x-a,n.width),i.width),f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width))):(f.width=Math.max(Math.min(d.x-a,n.width),i.width),o||(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c,f.y=l+.5*(u-l-f.height))):e.y<=0?(f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=u-f.y,o||(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width,f.x=a+.5*(h-a-f.width))):e.y>=1&&(f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width,f.x=a+.5*(h-a-f.width))),y.e(d),f}computeReshape(){let t=0;return this.adornedObject instanceof Jt&&(t=this.adornedObject.hS()),!(6===t||this.diagram.lastInput.shift)}computeMinSize(){if(null===this.adornedObject)return x.sc;const t=this.adornedObject.minSize.copy(),e=this.minSize;return!isNaN(e.width)&&e.width>t.width&&(t.width=e.width),!isNaN(e.height)&&e.height>t.height&&(t.height=e.height),t}computeMaxSize(){if(null===this.adornedObject)return x.Bk;const t=this.adornedObject.maxSize.copy(),e=this.maxSize;return!isNaN(e.width)&&e.width<t.width&&(t.width=e.width),!isNaN(e.height)&&e.height<t.height&&(t.height=e.height),t}computeCellSize(){const t=new x(NaN,NaN),e=this.adornedObject?.part;if(e){const i=e.resizeCellSize;!isNaN(i.width)&&i.width>0&&(t.width=i.width),!isNaN(i.height)&&i.height>0&&(t.height=i.height)}let i=this.cellSize;isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height);const n=this.diagram;if((isNaN(t.width)||isNaN(t.height))&&n){const e=n.grid;null!==e&&e.visible&&this.isGridSnapEnabled&&(i=e.gridCellSize,isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height))}return(isNaN(t.width)||0===t.width||t.width===1/0)&&(t.width=1),(isNaN(t.height)||0===t.height||t.height===1/0)&&(t.height=1),t}get minSize(){return this.gr}set minSize(t){if(!this.gr.equals(t)){let e=t.width;isNaN(e)&&(e=0);let i=t.height;isNaN(i)&&(i=0),this.gr.i(e,i)}}get maxSize(){return this.pr}set maxSize(t){if(!this.pr.equals(t)){let e=t.width;isNaN(e)&&(e=1/0);let i=t.height;isNaN(i)&&(i=1/0),this.pr.i(e,i)}}get cellSize(){return this.ko}set cellSize(t){this.ko.equals(t)||this.ko.a(t)}get isGridSnapEnabled(){return this.yc}set isGridSnapEnabled(t){e.s(t,"boolean",_,"isGridSnapEnabled"),this.yc=t}get dragsMembers(){return this.rS}set dragsMembers(t){e.s(t,"boolean",_,"dragsMembers"),this.rS=t}get oppositePoint(){return this.wm}set oppositePoint(t){this.wm.equals(t)||this.wm.a(t)}get originalDesiredSize(){return this.lS}get originalLocation(){return this.wc}}class W extends I{aS;cS;us=null;ur=null;Gw=null;fs=null;fS;xm;wc;uS;dS;constructor(t){super(),this.name="Rotating",this.aS=45,this.cS=2,this.wc=new y,this.us=null,this.handleArchetype=new Jt("Ellipse",{desiredSize:x.nu,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.fs=null,this.fS=0,this.xm=new y(NaN,NaN),this.uS=0,this.dS=50,t&&Object.assign(this,t)}updateAdornments(t){if(null!==t){if(t.Nl()){const e=t.rotateObject;if(e===t||e===t.path||e.isPanelMain)return}if(t.isSelected&&!this.diagram.isReadOnly){const e=t.rotateObject;if(null!==e&&t.canRotate()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()){let i=t.findAdornment(this.name);if((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)return i.angle=e.getDocumentAngle(),i.hasPlaceholder()||(i.location=this.computeAdornmentLocation(e)),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part?.rotateAdornmentTemplate;return i?e=i.copy():null!==this.Gw&&(e=this.Gw.copy()),null===e?null:(e.adornedObject=t,e)}get handleArchetype(){return this.ur}set handleArchetype(t){this.ur=t,this.Gw=null!==t?new fe(Yt.Position,{locationSpot:w.Center}).add(t).Et():null}get handle(){return this.fs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.fs=t}get adornedObject(){return this.us}set adornedObject(t){null!==t&&t.part instanceof fe&&e.o("new handle must not be in an Adornment: "+t),this.us=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowRotate||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null===this.adornedObject||null===this.adornedObject.part||(t.isMouseCaptured=!0,t.delaysLayout=!0,this.startTransaction(this.name),this.fS=this.adornedObject.angle,this.xm=this.computeRotationPoint(this.adornedObject),this.wc=this.adornedObject.part.location.copy(),this.isActive=!0)}computeRotationPoint(t){const e=t.part;if(null!==e){const i=e.locationObject;if(e.rotationSpot.isSpot())return t.getDocumentPoint(e.rotationSpot);if(t===e||t===i)return i.getDocumentPoint(e.locationSpot)}return t.getDocumentPoint(w.Center)}computeAdornmentLocation(t){let e=this.rotationPoint;e.isReal()||(e=this.computeRotationPoint(t));const i=t.getLocalPoint(e);let n=this.handleAngle;n<0?n+=360:n>=360&&(n-=360),n=Math.round(45*Math.round(n/45));const s=this.handleDistance;return 0===n?i.x=t.naturalBounds.width+s:45===n?(i.x=t.naturalBounds.width+s,i.y=t.naturalBounds.height+s):90===n?i.y=t.naturalBounds.height+s:135===n?(i.x=-s,i.y=t.naturalBounds.height+s):180===n?i.x=-s:225===n?(i.x=-s,i.y=-s):270===n?i.y=-s:315===n&&(i.x=t.naturalBounds.width+s,i.y=-s),t.getDocumentPoint(i)}doDeactivate(){const t=this.diagram;this.stopTransaction(),this.handle=null,this.us=null,this.xm=new y(NaN,NaN),t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){this.diagram.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){t.delaysLayout=!1;const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.D("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()}rotate(t){const e=this.adornedObject;if(null===e||null===e.part)return;e.angle=t;const i=e.part;i.ensureBounds();const n=i.locationObject,s=i.rotateObject;if(n===s||n.isContainedBy(s)){const e=this.wc.copy();i.location=e.subtract(this.rotationPoint).rotate(t-this.originalAngle).add(this.rotationPoint)}this.diagram.maybeUpdate()}computeRotate(t){let e=this.rotationPoint.directionPoint(t)-this.handleAngle;const i=this.adornedObject?.panel;i&&(e-=i.getDocumentAngle()),e>=360?e-=360:e<0&&(e+=360);const n=Math.min(Math.abs(this.snapAngleMultiple),180),s=Math.min(Math.abs(this.snapAngleEpsilon),n/2);return!this.diagram.lastInput.shift&&n>0&&s>0&&(e%n<s?e=Math.floor(e/n)*n:e%n>n-s&&(e=(Math.floor(e/n)+1)*n)),e>=360?e-=360:e<0&&(e+=360),e}get snapAngleMultiple(){return this.aS}set snapAngleMultiple(t){e.s(t,"number",W,"snapAngleMultiple"),this.aS=t}get snapAngleEpsilon(){return this.cS}set snapAngleEpsilon(t){e.s(t,"number",W,"snapAngleEpsilon"),this.cS=t}get originalAngle(){return this.fS}get rotationPoint(){return this.xm}set rotationPoint(t){this.xm=t.copy()}get handleAngle(){return this.uS}set handleAngle(t){e.s(t,"number",W,"handleAngle"),this.uS=t}get handleDistance(){return this.dS}set handleDistance(t){e.s(t,"number",W,"handleDistance"),this.dS=t}}class $ extends I{constructor(t){super(),this.name="ClickSelecting",t&&Object.assign(this,t)}canStart(){return!(!this.isEnabled||this.isBeyondDragSize())}doMouseUp(){this.isActive&&(this.standardMouseSelect(),this.standardMouseClick()||this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()}}class J extends I{xc;constructor(t){super(),this.name="Action",this.xc=null,t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram,e=t.lastInput,i=t.findObjectAt(e.documentPoint,(t=>{for(;null!==t.panel;){if(t.isActionable)return t;t=t.panel}return t}));return!(null===i||!i.isActionable)&&(this.xc=i,t.gc=t.findObjectAt(e.documentPoint,null,null),!0)}doMouseDown(){if(this.isActive){const t=this.diagram.lastInput,e=this.xc;if(null===e)return;t.targetObject=e,null!==e.actionDown&&e.actionDown(t,e)}else this.canStart()&&this.doActivate()}doMouseMove(){if(this.isActive){const t=this.diagram.lastInput,e=this.xc;if(null===e)return;t.targetObject=e,null!==e.actionMove&&e.actionMove(t,e)}}doMouseUp(){if(this.isActive){const t=this.diagram.lastInput,e=this.xc;if(null===e)return;t.targetObject=e,null!==e.actionUp&&e.actionUp(t,e),this.standardMouseClick((t=>{for(;null!==t.panel;){if(t.isActionable&&t===e)return t;t=t.panel}return t}),(t=>t===e))}this.stopTool()}doCancel(){const t=this.diagram.lastInput,e=this.xc;null!==e&&(t.targetObject=e,null!==e.actionCancel&&e.actionCancel(t,e),this.stopTool())}doStop(){this.xc=null}}class Z extends I{Cl;gS;yc;mS;constructor(t){super(),this.name="ClickCreating",this.Cl=null,this.gS=!0,this.yc=!1,this.mS=new y(0,0),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===t.lastInput.clickCount&&(this.mS=t.lastInput.viewPoint.copy()),2!==t.lastInput.clickCount||this.isBeyondDragSize(this.mS))return!1}else if(1!==t.lastInput.clickCount)return!1;return!(t.currentTool!==this&&null!==t.findPartAt(t.lastInput.documentPoint,!0))}doMouseUp(){const t=this.diagram;this.isActive&&this.insertPart(t.lastInput.documentPoint),this.stopTool()}insertPart(t){const i=this.diagram,n=this.archetypeNodeData;if(null===n)return null;let s=null;try{if(i.D("ChangingSelection",i.selection),this.startTransaction(this.name),n instanceof ce)n.ke()&&(n.Et(),s=n.copy(),null!==s&&i.add(s));else if(null!==n){const t=i.model.copyNodeData(n);e.K(t)&&(i.model.addNodeData(t),s=i.findPartForData(t))}if(null!==s){const e=y.V(t.x,t.y);this.isGridSnapEnabled&&this.diagram.pS(s,t,e),s.location=e,i.allowSelect&&(i.clearSelection(!0),s.isSelected=!0),y.e(e)}i.invalidateDocumentBounds(),this.transactionResult=this.name,i.D("PartCreated",s)}finally{this.stopTransaction(),i.D("ChangedSelection",i.selection)}return s}get archetypeNodeData(){return this.Cl}set archetypeNodeData(t){null!==t&&e.ec(t,Z,"archetypeNodeData"),this.Cl=t}get isDoubleClick(){return this.gS}set isDoubleClick(t){e.s(t,"boolean",Z,"isDoubleClick"),this.gS=t}get isGridSnapEnabled(){return this.yc}set isGridSnapEnabled(t){e.s(t,"boolean",Z,"isGridSnapEnabled"),this.yc=t}}class Q extends I{zh;yS;Ll;constructor(t){super(),this.name="DragSelecting",this.zh=175,this.yS=!1,this.Ll=new ce({layerName:"Tool",selectable:!1}).add(new Jt("Rectangle",{name:"SHAPE",fill:null,stroke:"magenta"}).theme("stroke","dragSelect")).Et(),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.timestamp-t.firstInput.timestamp<this.delay||null!==t.findPartAt(e.documentPoint,!0)))}doActivate(){const t=this.diagram;this.isActive=!0,t.isMouseCaptured=!0,t.skipsUndoManager=!0,this.box&&t.add(this.box),this.doMouseMove()}doDeactivate(){const t=this.diagram;t.stopAutoScroll(),this.box&&t.remove(this.box),t.skipsUndoManager=!1,t.isMouseCaptured=!1,this.isActive=!1}doMouseMove(){const t=this.diagram;if(this.isActive&&null!==this.box){const e=this.computeBoxBounds();let i=this.box.findObject("SHAPE");null===i&&(i=this.box.findMainElement());const n=x.l().i(e.width,e.height);null!==i&&(i.desiredSize=n),this.box.bc(e.x,e.y,!1),x.e(n),(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}doMouseUp(){if(this.isActive){const t=this.diagram;this.box&&t.remove(this.box);try{t.currentCursor="wait",t.D("ChangingSelection",t.selection),this.selectInRect(this.computeBoxBounds()),t.D("ChangedSelection",t.selection)}finally{t.currentCursor=""}}this.stopTool()}computeBoxBounds(){const t=this.diagram;return new v(t.firstInput.documentPoint,t.lastInput.documentPoint)}selectInRect(t){const i=this.diagram,n=i.lastInput,s=i.findPartsIn(t,this.isPartialInclusion);if(e._o?n.meta:n.control)if(n.shift){const t=s.iterator;for(;t.next();){const e=t.value;e.isSelected&&(e.isSelected=!1)}}else{const t=s.iterator;for(;t.next();){const e=t.value;e.isSelected=!e.isSelected}}else if(n.shift){const t=s.iterator;for(;t.next();){const e=t.value;e.isSelected||(e.isSelected=!0)}}else{const t=new l,e=i.selection.iterator;for(;e.next();){const i=e.value;s.has(i)||t.add(i)}const n=t.iterator;for(;n.next();){n.value.isSelected=!1}const o=s.iterator;for(;o.next();){const t=o.value;t.isSelected||(t.isSelected=!0)}}}get delay(){return this.zh}set delay(t){e.s(t,"number",Q,"delay"),this.zh=t}get isPartialInclusion(){return this.yS}set isPartialInclusion(t){e.s(t,"boolean",Q,"isPartialInclusion"),this.yS=t}get box(){return this.Ll}set box(t){null!==t&&t.Et(),this.Ll=t}}class tt extends I{Hw;aL;bo;wS;constructor(e){super(),this.name="Panning",this.Hw=new y,this.aL=new y,this.bo=!1;const i=this;this.wS=()=>{const e=i.diagram;null!==e&&e.Pi(t.document,"scroll",i.wS,!1),i.stopTool()},e&&Object.assign(this,e)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(!t.allowHorizontalScroll&&!t.allowVerticalScroll||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())}doActivate(){const e=this.diagram;this.bo?(e.lastInput.bubbles=!0,e.Bt(t.document,"scroll",this.wS,!1)):(e.currentCursor="move",e.isMouseCaptured=!0,this.Hw.a(e.position)),this.isActive=!0}doDeactivate(){const t=this.diagram;t.currentCursor="",t.isMouseCaptured=!1,this.isActive=!1}doCancel(){const t=this.diagram;t.position=this.Hw,t.isMouseCaptured=!1,this.stopTool()}doMouseMove(){this.cL()}doMouseUp(){this.cL(),this.stopTool()}cL(){const t=this.diagram;if(this.isActive&&t){if(this.bo)return void(t.lastInput.bubbles=!0);const e=t.position,i=t.firstInput.documentPoint,n=t.lastInput.documentPoint;let s=e.x+i.x-n.x,o=e.y+i.y-n.y;t.allowHorizontalScroll||(s=e.x),t.allowVerticalScroll||(o=e.y),t.position=this.aL.i(s,o)}}get bubbles(){return this.bo}set bubbles(t){e.s(t,"boolean",tt,"bubbles"),this.bo=t}get originalPosition(){return this.Hw}}class et{jw;qw;xS;bS;constructor(t){this.jw=null,this.qw=null,this.xS=null,this.bS=null,t&&Object.assign(this,t)}get mainElement(){return this.xS}set mainElement(t){this.xS=t}get show(){return this.jw}set show(t){this.jw!==t&&(null!==t&&e.k(t,et,"show"),this.jw=t)}get hide(){return this.qw}set hide(t){this.qw!==t&&(null!==t&&e.k(t,et,"hide"),this.qw=t)}get valueFunction(){return this.bS}set valueFunction(t){this.bS=t}}class it{ri;Ww;kc;constructor(t,e,i){this.ri=t,this.Ww=e,this.kc=i}}class nt extends I{kS;Jw;PS;SS;$w;Zw;bm;constructor(t){super(),this.name="ContextMenu",this.kS=null,this.Jw=null,this.PS=null,this.SS=new y,this.$w=null,this.bm=!1;const e=this;this.Zw=()=>e.stopTool(),t&&Object.assign(this,t)}NF(){const i=new et;i.show=(t,e,i)=>i.showDefaultContextMenu(),i.hide=(t,e)=>e.hideDefaultContextMenu(),nt.wu=i;const n=this;this.Zw=()=>n.stopTool();const s=e.hs("div"),o=e.hs("div");s.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",o.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";const r=e.hs("style");t.document.getElementsByTagName("head")[0].appendChild(r),r.sheet.insertRule(".goCXul { list-style: none; }",0),r.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),r.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);const a=this.diagram;null!==a&&(a.Bt(s,"contextmenu",nt.Gh,!1),a.Bt(s,"selectstart",nt.Gh,!1),a.Bt(o,"contextmenu",nt.Gh,!1)),s.className="goCXforeground",o.className="goCXbackground",t.document.body&&(t.document.body.appendChild(s),t.document.body.appendChild(o)),nt.km=s,nt.Pm=o,nt.MS=!0}static wu=null;static MS=!1;static Pm;static km;static Gh(t){return t.preventDefault(),!1}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(this.isBeyondDragSize()||!t.lastInput.right||t.lastInput.clickCount>1)&&!!(t.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())}doStart(){const t=this.diagram;this.SS.set(t.firstInput.documentPoint)}doStop(){this.hideContextMenu(),this.currentObject=null,this.bm=!1}findObjectWithContextMenu(t){void 0===t&&(t=null);const e=this.diagram,i=e.lastInput;let n=null;if(t instanceof vt||(n=t instanceof At?t:e.findObjectAt(i.documentPoint,null,(t=>!t.layer?.isTemporary))),null!==n){let t=n;for(;null!==t;){if(null!==t.contextMenu)return t;t=t.panel}if(e.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return n.part}else if(null!==e.contextMenu)return e;return null}doActivate(){}doMouseDown(){if(super.doMouseDown(),this.isActive&&this.currentContextMenu instanceof fe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doMouseDown(),t.doDeactivate())}this.diagram.toolManager.mouseDownTools.has(this)&&this.doContextClick()}doMouseUp(){if(this.isActive&&this.currentContextMenu instanceof fe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doCancel(),t.doDeactivate())}this.doContextClick()}doContextClick(){const t=this.diagram;if(this.isActive){const e=this.currentContextMenu;if(null===e)return;let i=null;e instanceof et||(i=t.findObjectAt(t.lastInput.documentPoint,null,null),null!==i&&i.isContainedBy(e)&&this.standardMouseClick(null,null)),this.maybeStopTool(i)}else this.canStart()&&(this.openMenu(!0),this.isActive||this.stopTool())}maybeStopTool(t){this.stopTool(),this.canStart()&&(this.diagram.currentTool=this,this.doMouseUp())}openMenu(t,e){if(void 0===e&&(e=null),this.bm)return;this.bm=!0,t&&this.standardMouseSelect();const i=this.standardMouseClick();if(this.bm=!1,!i){this.isActive=!0;const t=nt.wu;if(null===e&&(e=this.findObjectWithContextMenu()),null!==e){const i=e.contextMenu;null!==i?(this.currentObject=e instanceof At?e:null,this.showContextMenu(i,this.currentObject)):null!==t&&this.showContextMenu(t,this.currentObject)}else null!==t&&this.showContextMenu(t,null);this.currentContextMenu instanceof fe&&!this.currentContextMenu.visible&&this.stopTool()}}doMouseMove(){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()}showContextMenu(t,e){const i=this.diagram;if(t!==this.currentContextMenu&&this.hideContextMenu(),t instanceof fe){const n=t;n.layerName="Tool",n.selectable=!1,n.scale=1/i.scale,n.category=this.name,n.hasPlaceholder()&&(n.placeholder.scale=i.scale);const s=n.diagram;null!==s&&s!==i&&s.remove(n),i.add(n),null!==e?n.adornedObject=e:n.data=i.model,n.ensureBounds(),this.positionContextMenu(n,e)}else t instanceof et&&null!==t.show&&t.show(e,i,this);this.currentContextMenu=t}positionContextMenu(t,e){if(t.hasPlaceholder())return;const i=t,n=this.diagram,s=n.lastInput.documentPoint.copy(),o=i.measuredBounds,r=n.viewportBounds;n.lastInput.isTouchEvent&&(s.x-=o.width),s.x+o.width>r.right&&(s.x-=o.width+5/n.scale),s.x<r.x&&(s.x=r.x),s.y+o.height>r.bottom&&(s.y-=o.height+5/n.scale),s.y<r.y&&(s.y=r.y),i.position=s}hideContextMenu(){const t=this.diagram,e=this.currentContextMenu;null!==e&&(e instanceof fe?(t.remove(e),null!==this.Jw&&this.Jw.removeAdornment(e.category),e.data=null,e.adornedObject=null):e instanceof et&&(null!==e.hide?e.hide(t,this):null!==e.mainElement&&(e.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())}CF(){const t=this,e=new l;return e.add(new it("Copy",(t=>t.commandHandler.copySelection()),(t=>t.commandHandler.canCopySelection()))),e.add(new it("Cut",(t=>t.commandHandler.cutSelection()),(t=>t.commandHandler.canCutSelection()))),e.add(new it("Delete",(t=>t.commandHandler.deleteSelection()),(t=>t.commandHandler.canDeleteSelection()))),e.add(new it("Paste",(e=>e.commandHandler.pasteSelection(t.mouseDownPoint)),(e=>e.commandHandler.canPasteSelection(t.mouseDownPoint)))),e.add(new it("Select All",(t=>t.commandHandler.selectAll()),(t=>t.commandHandler.canSelectAll()))),e.add(new it("Undo",(t=>t.commandHandler.undo()),(t=>t.commandHandler.canUndo()))),e.add(new it("Redo",(t=>t.commandHandler.redo()),(t=>t.commandHandler.canRedo()))),e.add(new it("Scroll To Part",(t=>t.commandHandler.scrollToPart()),(t=>t.commandHandler.canScrollToPart()))),e.add(new it("Zoom To Fit",(t=>t.commandHandler.zoomToFit()),(t=>t.commandHandler.canZoomToFit()))),e.add(new it("Reset Zoom",(t=>t.commandHandler.resetZoom()),(t=>t.commandHandler.canResetZoom()))),e.add(new it("Group Selection",(t=>t.commandHandler.groupSelection()),(t=>t.commandHandler.canGroupSelection()))),e.add(new it("Ungroup Selection",(t=>t.commandHandler.ungroupSelection()),(t=>t.commandHandler.canUngroupSelection()))),e.add(new it("Edit Text",(t=>t.commandHandler.editTextBlock()),(t=>t.commandHandler.canEditTextBlock()))),e}showDefaultContextMenu(){const t=this.diagram;null===this.$w&&(this.$w=this.CF()),nt.km.innerHTML="",nt.Pm.addEventListener("pointerdown",this.Zw,!1);const i=this,n=e.hs("ul");n.className="goCXul",nt.km.appendChild(n),n.innerHTML="";const s=this.$w.iterator;for(;s.next();){const o=s.value,r=o.Ww,a=o.kc;if(!e.it(r)||e.it(a)&&!a(t))continue;const l=e.hs("li");l.className="goCXli";const h=e.hs("a");h.className="goCXa",h.href="#",h.Ww=r,h.addEventListener("pointerdown",(function(e){return this.Ww(t),i.stopTool(),e.preventDefault(),!1}),!1),h.textContent=o.ri,l.appendChild(h),n.appendChild(l)}nt.km.style.display="block",nt.Pm.style.display="block"}hideDefaultContextMenu(){if(null===this.currentContextMenu||this.currentContextMenu!==nt.wu)return;nt.km.style.display="none",nt.Pm.style.display="none";const t=this.diagram;null!==t&&t.Pi(nt.Pm,"pointerdown",this.Zw,!1),this.currentContextMenu=null}get currentContextMenu(){return this.kS}set currentContextMenu(t){this.kS=t,this.Jw=t instanceof fe?t.adornedPart:null}get defaultTouchContextMenu(){return!1===nt.MS&&null===nt.wu&&vt.isUsingDOM()&&this.NF(),nt.wu}set defaultTouchContextMenu(t){null===t&&(nt.MS=!0),nt.wu=t}get currentObject(){return this.PS}set currentObject(t){this.PS=t}get mouseDownPoint(){return this.SS}}var st=(t=>(t[t.LostFocus=1]="LostFocus",t[t.MouseDown=2]="MouseDown",t[t.Tab=3]="Tab",t[t.Enter=4]="Enter",t))(st||{}),ot=(t=>(t[t.SingleClick=1]="SingleClick",t[t.SingleClickSelected=2]="SingleClickSelected",t[t.DoubleClick=3]="DoubleClick",t))(ot||{}),rt=(t=>(t[t.None=1]="None",t[t.Active=2]="Active",t[t.Editing=3]="Editing",t[t.Validating=4]="Validating",t[t.Invalid=5]="Invalid",t[t.Validated=6]="Validated",t))(rt||{});class at extends I{Pe;NS;CS;Al;Kt;LS;AS;TS;Qw;DS;constructor(t){super(),this.name="TextEditing",this.Pe=new ie,this.NS=null,this.CS=2,this.Al=null,this.Kt=1,this.LS=1,this.AS=!0,this.TS=null,this.Qw=new et,this.LF(this.Qw),t&&Object.assign(this,t)}static LostFocus=1;static MouseDown=2;static Tab=3;static Enter=4;static SingleClick=1;static SingleClickSelected=2;static DoubleClick=3;static StateNone=1;static StateActive=2;static StateEditing=3;static StateValidating=4;static StateInvalid=5;static StateValidated=6;LF(t){if(!vt.isUsingDOM())return;const i=e.hs("textarea");this.DS=i;const n=this;i.addEventListener("input",(function(t){if(null===n.textBlock)return;const e=n.measureTemporaryTextBlock(this.value),i=this.textScale;this.style.width=20+Math.max(n.textBlock.measuredBounds.width,e.measuredBounds.width)*i+"px",this.rows=Math.max(n.textBlock.lineCount,e.lineCount)}),!1),i.addEventListener("keydown",(function(t){if(t.isComposing||null===n.textBlock)return;const e=t.key;return"Enter"===e?(!1===n.textBlock.isMultiline&&t.preventDefault(),void n.acceptText(4)):"Tab"===e?(n.acceptText(3),void t.preventDefault()):void("Escape"===e&&(n.doCancel(),null!==n.diagram&&n.diagram.doFocus()))}),!1),i.addEventListener("focus",(function(t){n.AF(t)}),!1),i.addEventListener("blur",(function(t){n.TF(t)}),!1),t.valueFunction=()=>i.value,t.mainElement=i,t.show=(t,e,n)=>{if(!(t instanceof ie)||!e||!e.div||!(n instanceof at))return;if(5===n.state)return i.style.border="3px solid red",void i.focus();const s=t.getDocumentPoint(w.Center),o=e.position,r=e.scale;let a=t.getDocumentScale()*r;a<n.minimumEditorScale&&(a=n.minimumEditorScale);const l=t.naturalBounds.width*a+6,h=t.naturalBounds.height*a+2,u=(s.x-o.x)*r,c=(s.y-o.y)*r,d=t.verticalAlignment,f=(t.lineHeight+t.spacingAbove+t.spacingBelow)*t.lineCount*a,g=.5*h-.5*f,p=d.y*h-d.y*f+d.offsetY-g-f/2;i.value=t.text,e.div.style.font=t.font;i.style.position="absolute",i.style.zIndex="100",i.style.font="inherit",i.style.fontSize=100*a+"%",i.style.lineHeight="normal",i.style.width=l+"px",i.style.left=(u-l/2|0)-1+"px",i.style.top=(c+p|0)-1+"px",i.style.textAlign=t.textAlign,i.style.margin="0",i.style.padding="1px",i.style.border="0",i.style.outline="none",i.style.whiteSpace="pre-wrap",i.style.overflow="hidden",i.rows=t.lineCount,i.textScale=a,i.className="goTXarea",e.div.appendChild(i),i.focus(),n.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))},t.hide=(t,e)=>{t.div&&t.div.removeChild(i)}}get textBlock(){return this.NS}set textBlock(t){this.NS=t}get currentTextEditor(){return this.TS}set currentTextEditor(t){this.TS=t}get defaultTextEditor(){return this.Qw}set defaultTextEditor(t){this.Qw=t}get starting(){return this.CS}set starting(t){this.CS=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly||at.Pc&&at.Pc!==this&&(at.Pc.acceptText(2),at.Pc&&at.Pc!==this)||!t.lastInput.left||this.isBeyondDragSize())return!1;const e=t.lastInput.documentPoint,i=t.findObjectAt(e);if(null===i||!(i instanceof ie)||!i.editable||null===i.part||!i.part.canEdit())return!1;const n=i.part;return!(null===n||2===this.starting&&!n.isSelected||3===this.starting&&t.lastInput.clickCount<2)}doStart(){at.Pc=this,null!==this.textBlock&&this.doActivate()}doActivate(){if(this.isActive)return;const t=this.diagram;if(null===t)return;let e=this.textBlock;if(null===e&&(e=t.findObjectAt(t.lastInput.documentPoint)),null===e||!(e instanceof ie)||(this.textBlock=e,null===e.part))return;t.animationManager.stopAnimation(),this.isActive=!0,this.Kt=2;let i=this.defaultTextEditor;null!==e.textEditor&&(i=e.textEditor),this.Pe=this.textBlock.copy();const n=new v(this.textBlock.getDocumentPoint(w.TopLeft),this.textBlock.getDocumentPoint(w.BottomRight));t.scrollToRect(n),null!==i&&null!==i.show&&i.show(e,t,this),this.currentTextEditor=i}doCancel(){this.stopTool()}doMouseUp(){this.canStart()&&this.doActivate()}doMouseDown(){this.isActive&&this.acceptText(2)}acceptText(t){switch(t){case 2:6===this.Kt?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():(2===this.Kt||5===this.Kt||3===this.Kt)&&(this.Kt=4,this.fL());break;case 1:case 4:case 3:if(4===t&&null!==this.textBlock&&!0===this.textBlock.isMultiline)return;(2===this.Kt||5===this.Kt||3===this.Kt)&&(this.Kt=4,this.fL())}}fL(){const t=this.textBlock,e=this.diagram,i=this.currentTextEditor;if(null!==t&&null!==i){const n=t.text;let s="";if(null!==i.valueFunction&&(s=i.valueFunction()),!this.isValidText(t,n,s))return this.Kt=5,void this.doError(n,s);this.startTransaction(this.name),this.Kt=6,this.transactionResult=this.name,t.text=s,this.doSuccess(n,s),null!==e&&e.D("TextEdited",t,n),this.stopTransaction(),this.stopTool(),null!==e&&e.doFocus()}}doError(t,e){const i=this.textBlock;if(null===i)return;null!==i.errorFunction&&i.errorFunction(this,t,e);const n=this.currentTextEditor;null!==n&&null!==n.show&&n.show(i,this.diagram,this)}doSuccess(t,e){const i=this.textBlock;null!==i&&null!==i.textEdited&&i.textEdited(i,t,e)}doDeactivate(){const t=this.diagram;if(null!==t){if(this.Kt=1,null!==this.currentTextEditor){const e=this.currentTextEditor;null!==e&&null!==e.hide&&e.hide(t,this)}this.textBlock=null,this.isActive=!1}}doStop(){at.Pc=null}AF(t){if(null===this.currentTextEditor||1===this.state)return;const i=this.DS;2===this.Kt&&(this.Kt=3),e.it(i.select)&&this.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))}TF(t){if(null===this.currentTextEditor||1===this.state)return;const i=this.DS;e.it(i.focus)&&i.focus(),e.it(i.select)&&this.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))}isValidText(t,e,i){const n=this.textValidation;if(null!==n&&!n(t,e,i))return!1;const s=t.textValidation;return!(null!==s&&!s(t,e,i))}get textValidation(){return this.Al}set textValidation(t){null!==t&&e.k(t,at,"textValidation"),this.Al=t}get minimumEditorScale(){return this.LS}set minimumEditorScale(t){null!==t&&e.s(t,"number",at,"minimumEditorScale"),this.LS=t}get selectsTextOnActivate(){return this.AS}set selectsTextOnActivate(t){null!==t&&e.s(t,"boolean",at,"selectsTextOnActivate"),this.AS=t}get state(){return this.Kt}set state(t){this.Kt!==t&&(this.Kt=t)}measureTemporaryTextBlock(t){const e=this.Pe;return e.text=t,null!==this.textBlock&&e.ht(this.textBlock.Tl,1/0),e}static Pc=null}var lt=(t=>(t[t.Default=1]="Default",t[t.AnimateLocations=2]="AnimateLocations",t[t.None=3]="None",t))(lt||{});class ht{N;Si;Oi;yr;zn;Po;FS;RS;Sm;pi;Sc;on;Mm;Hh;_w;Nm;tx;Mc;pu;Cm;constructor(t){this.N=vt.um(),this.Si=!1,this.Sm=!1,this.pi=!1,this.Sc=!1,this.tx=!0,this.Mc=1,this.pu=!1,this.Oi=!0,this.yr=!0,this.Po=600,this.FS=!1,this.RS=!1,this.zn=new u,this.on=new ut,this.Mm=new ut,this.on.ds=this,this.Hh=new u,this._w=new u,this.Nm=new u,this.Cm=new u,t&&Object.assign(this,t)}So(t){this.N=t}ME(){return this.N}canStart(t){return!0}Dl(t){return!(!this.Oi||!this.canStart(t))&&(this.zn.add(t),this.defaultAnimation.isAnimating&&this.stopAnimation(),this.N.Mi(),this.pi=!0,!0)}getBundleAnimation(){return this.Mm}vS(){if(!this.Oi||(this.Mm.ce.count>0&&this.Mm.start(),!this.pi))return;const e=this.on,i=this.N,n=this.zn.has("Model");if(n&&(this.Sc=!0,1===this.Mc?(e.isViewportUnconstrained=!0,e.ce.clear(),e.add(i,"position",i.position.copy().offset(0,-200),i.position),e.add(i,"opacity",0,1)):3===this.Mc&&e.ce.clear(),2===this.Mc&&i.ix.equals(i.at)?this.tx=!0:this.tx=!1,i.D("InitialAnimationStarting",this)),n&&!this.yr||0===e.ce.count)return this.zn.clear(),this.pi=!1,e.ce.clear(),e.ex(i),this.Sc=!1,void i.S();this.zn.clear(),i.wr=!1;const s=e.ce.get(i);1!==i.autoScale&&null!==s&&(delete s.ei.scale,delete s.gs.scale);const o=this;t.requestAnimationFrame((()=>{!1===o.pi||e.Si||(i.getRenderingHint("temporaryPixelRatio")&&i.Bw(),i.OS(),o.pi=!1,e.start(),e.Si&&(o.xu(),i.invalidateDocumentBounds(),e.uL(0),i.fr(!0),o.bu(),i.D("AnimationStarting",o)))}))}IS(){return this.zn.has("Trigger")&&1===this.zn.count}dL(t,e,i,n){this.isTicking||this.IS()||t instanceof be&&(null!==t.fromNode||null!==t.toNode)||this.on.add(t,"position",e,i,n)}nx(t){return this.on.nx(t)}ES(t){return this.on.ES(t)}DF(e){const i=this.Hh,n=this;function s(){if(n.Nm.count>0&&(i.addAll(n.Nm),n.Nm.clear(),n.Si=!0),!1===n.Si||0===i.count)return;n._w.addAll(i);const e=n._w.iterator;for(;e.next();){const t=e.value;!1!==t.Si&&(t.FF()?t.gL(!1):t.Nc=!0)}n._w.clear(),!1!==n.Si?(n.xu(),n.N.fr(),n.bu(),t.requestAnimationFrame(s)):t.requestAnimationFrame(s)}this.Si?this.RF(e):(this.Si=!0,i.add(e),t.requestAnimationFrame((()=>s())))}RF(t){this.Nm.add(t)}vF(){const t=this.Hh.iterator;for(;t.next();)t.value.Nc=!1}xu(){if(this.Sm)return;const t=this.N;this.FS=t.skipsUndoManager,this.RS=t.fe,t.skipsUndoManager=!0,t.fe=!0,this.Sm=!0}bu(){const t=this.N;t.skipsUndoManager=this.FS,t.fe=this.RS,this.Sm=!1}stopAnimation(t){const e=this.on;if(!0===this.pi&&(this.pi=!1,this.Sc=!1,this.zn.clear(),e.OF()&&this.N.requestUpdate()),!this.Si)return e.ce.clear(),void e.ex(this.N);if(e.ku(!0),e.ex(null),!0===t){const t=this.Hh.toArray();for(let e=0;e<t.length;e++)t[e].ku(!0)}}ku(t){this.Hh.delete(t),0===this.Hh.count&&(this.Si=!1,this.N.requestUpdate()),t===this.defaultAnimation&&this.N.D("AnimationFinished",this)}Cc(t,e){this.pi&&(!this.zn.has("Expand Tree")&&!this.zn.has("Expand SubGraph")||(this.on.Cc(t,e),this.mL(t)))}Lc(t,e){this.pi&&(!this.zn.has("Collapse Tree")&&!this.zn.has("Collapse SubGraph")||(this.on.Lc(t,e),this.on.BS(e,"position",e.position,e.position),this.mL(t)))}pL(t,e){!this.pi||t.equals(e)||this.IS()||(this.N.Uh||(t=e.copy()),this.on.BS(this.N,"position",t,e))}yL(t,e){this.pi&&(this.IS()||this.on.add(this.N,"scale",t,e))}US(t,e){t.Se&&(t.xr=e,this.Cm.add(t))}mL(t){const e=t.findLinksConnected();for(;e.next();){const t=e.value;t.Se&&(t.xr=t.points.copy(),this.Cm.add(t))}}get isEnabled(){return this.Oi}set isEnabled(t){e.s(t,"boolean",ht,"isEnabled"),this.Oi=t,t&&this.Hh.each((t=>{!t.isAnimating&&t.runCount===1/0&&t.start()}))}get duration(){return this.Po}set duration(t){e.s(t,"number",ht,"duration"),t<1&&e.W(t,">= 1",ht,"duration"),this.Po=t}get isAnimating(){return this.Si}get isTicking(){return this.Sm}get isInitial(){return this.yr}set isInitial(t){e.s(t,"boolean",ht,"isInitial"),this.yr=t}get defaultAnimation(){return this.on}get activeAnimations(){return this.Hh}get initialAnimationStyle(){return this.Mc}set initialAnimationStyle(t){this.Mc=t}static lx=(()=>new m)();static defineAnimationEffect(t,e){ht.lx.set(t,e)}static VS(t,e,i,n,s){null===t&&(t=[0,0,0,0]),null===e&&(e=[0,0,0,0]);let o=t[0],r=t[1];const a=t[2],l=t[3];let h=e[0],u=e[1];const c=e[2],d=e[3];0===a||100===a?(o=h,r=u):(0===c||100===c)&&(h=o,u=r),Math.abs(h-o)>180&&(h>o?o+=360:h+=360);return"hsla("+s(i,o,h-o,n)%360+", "+s(i,r,u-r,n)+"%, "+s(i,a,c-a,n)+"%, "+s(i,l,d-l,n)+")"}static#t=(()=>{const t=ht.lx,e=(t,e,i,n,s,o)=>{t.position=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))};t.set("position:diagram",e),t.set("position",e),t.set("position:part",((t,e,i,n,s,o)=>{s<o?t.bc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!1):t.position=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.set("location",((t,e,i,n,s,o)=>{s<o?t.bc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!0):t.location=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.set("position:placeholder",((t,e,i,n,s,o)=>{s<o?t.bc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!1):t.position=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.set("position:nodeCollapse",((t,e,i,n,s,o)=>{const r=t.actualBounds,a=i.actualBounds,l=a.x+a.width/2-r.width/2,h=a.y+a.height/2-r.height/2;s<o?t.bc(n(s,e.x,l-e.x,o),n(s,e.y,h-e.y,o),!1):t.position=new y(n(s,e.x,l-e.x,o),n(s,e.y,h-e.y,o))})),t.set("desiredSize",((t,e,i,n,s,o)=>{t.desiredSize=new x(n(s,e.width,i.width-e.width,o),n(s,e.height,i.height-e.height,o))})),t.set("width",((t,e,i,n,s,o)=>{t.width=n(s,e,i-e,o)})),t.set("height",((t,e,i,n,s,o)=>{t.height=n(s,e,i-e,o)})),t.set("fill",((t,e,i,n,s,o)=>{t.fill=ht.VS(e,i,s,o,n)})),t.set("stroke",((t,e,i,n,s,o)=>{t.stroke=ht.VS(e,i,s,o,n)})),t.set("strokeWidth",((t,e,i,n,s,o)=>{t.strokeWidth=n(s,e,i-e,o)})),t.set("strokeDashOffset",((t,e,i,n,s,o)=>{t.strokeDashOffset=n(s,e,i-e,o)})),t.set("background",((t,e,i,n,s,o)=>{t.background=ht.VS(e,i,s,o,n)})),t.set("opacity",((t,e,i,n,s,o)=>{t.opacity=n(s,e,i-e,o)})),t.set("scale",((t,e,i,n,s,o)=>{t.scale=n(s,e,i-e,o)})),t.set("angle",((t,e,i,n,s,o)=>{t.angle=n(s,e,i-e,o)}))})();static Default=1;static AnimateLocations=2;static None=3}class ut{hx;Lm;Si;Pu;Po;ms;wL;Ac;ce;ax;ei;Xn;Su;Tc;cx;fx;Nc;zS;ux;ds;N;XS;YS;KS;constructor(t){this.N=null,this.ds=null,this.zS=null,this.ux=null,this.XS=!1,this.Si=!1,this.Nc=!1,this.ei=0,this.Xn=0,this.hx=ut.EaseInOutQuad,this.Lm=ut.EaseInOutQuad,this.Su=!1,this.Tc=!1,this.cx=1,this.fx=0,this.Po=NaN,this.ms=NaN,this.YS=0,this.Pu=null,this.wL=y.wo,this.ce=new m,this.ax=new m,this.Ac=new u,this.KS=1,t&&Object.assign(this,t)}suspend(){this.Nc=!0}advanceTo(t,e){e&&(this.Nc=!1),this.Su&&t>=this.ms&&(this.Tc=!0,t-=this.ms),this.YS=t,this.gL(!0),this.ds.xu(),this.N.fr(),this.ds.bu(),this.N.redraw()}ex(t){if(this.ax.clear(),this.Tc=!1,this.fx=0,this.ms=NaN,this.Ac.count>0&&this.Ac.clear(),null!==t){const e=t.links;for(;e.next();)e.value.xr=null}}OF(){return this.ce.count>0}start(){if(0===this.ce.count)return this;if(this.Si)return this;let t=this.N;const e=this.ce.iterator;for(;e.next();){const i=e.key;null===t&&(i instanceof vt?t=i:i instanceof At&&(t=i.diagram))}if(null===t)return this;this.N=t,this.ds=t.animationManager;const i=this.ds;return!1===i.isEnabled||(this.ms=isNaN(this.Po)?i.duration:this.Po,this.Lm=this.hx,i.Sc&&1===i.Mc&&this===i.defaultAnimation&&(this.Lm=ut.EaseOutExpo,this.ms=isNaN(this.Po)?600===i.duration?900:i.duration:this.Po),this.KS=t.scrollMode,this.isViewportUnconstrained&&(t.jh=2),i.xu(),this.Ac.each((e=>{e.data=null,t.add(e)})),i.bu(),this.Si=!0,this.ei=+new Date,this.Xn=this.ei+this.ms,i.DF(this)),this}addTemporaryPart(t,e){return t.ke()?(this.Ac.add(t),this.N=e,this):this}add(t,e,i,n,s){if(null===this.N&&(t instanceof vt?this.N=t:t instanceof At&&null!==t.diagram&&(this.N=t.diagram)),t instanceof ce){if(!t.isAnimated)return this;"position"===e&&(e="position:part")}return this.BS(t,e,i,n,s),this}BS(t,e,i,n,s){const o=this.ce;let r,a,l;if(t instanceof vt&&"position"===e&&(e="position:diagram"),("fill"===e||"stroke"===e||"background"===e)&&(Ut.Mo(i),Ut.GS(),i=[Ut.Ii.n0,Ut.Ii.n1,Ut.Ii.n2,Ut.Ii.n3],Ut.Mo(n),Ut.GS(),n=[Ut.Ii.n0,Ut.Ii.n1,Ut.Ii.n2,Ut.Ii.n3]),o.has(t))r=o.get(t),a=r.ei,l=r.gs,void 0===a[e]&&(a[e]=this.Mu(i)),l[e]=this.Mu(n);else{if("position"===e&&i.equalsApprox(n))return;a={},l={},a[e]=this.Mu(i),l[e]=this.Mu(n),r=new ct(a,l,s),o.set(t,r)}const h=a[e];h instanceof y&&!h.isReal()&&h.a(this.wL),s&&0===e.indexOf("position:")&&t instanceof ce?r.gx.location=this.Mu(t.location):s&&(r.gx[e]=this.Mu(i))}Mu(t){return t instanceof y||t instanceof x?t.copy():t}IF(t){const e=this.ce;if(e.has(t)){e.get(t).mx=!0}}nx(t){if(!this.Si)return!1;const e=this.ce.get(t);return null!==e&&e.mx}ES(t){if(!this.Si)return!1;const e=this.ce.get(t);return null!==e&&!!(e.ei.position||e.ei["position:part"]||e.ei.location)}FF(){if(this.Ac.count>0)return!0;const t=this.ce.iterator;for(;t.next();){const e=t.key;if(e instanceof At&&null!==e.diagram||e instanceof vt)return!0}return!1}gL(t){if(this.Nc&&!t)return;const e=this.ds;if(!1===this.Si)return;const i=+new Date;let n=i>this.Xn?this.ms:i-this.ei;t&&(n=this.YS,n<this.ms?(this.ei=+new Date-n,this.Xn=this.ei+this.ms):n=this.ms),e.xu(),this.uL(n),this.N.fr(!0),e.bu(),i>this.Xn&&(this.Su&&!this.Tc?(this.ei=+new Date,this.Xn=this.ei+this.ms,this.Tc=!0):this.ku(!1))}uL(t){const e=this.ms,i=this.ce.iterator,n=this.Tc;for(;i.next();){const s=i.key;if(s instanceof At&&null===s.diagram)continue;const o=i.value,r=n?o.gs:o.ei,a=n?o.ei:o.gs,l=ht.lx;for(const i in a)"position"===i&&(a["position:placeholder"]||a["position:nodeCollapse"])||null!==l.get(i)&&l.get(i)(s,r[i],a[i],this.Lm,t,e,this)}}stop(){return this.Si?(this.ku(!0),this):this}ku(t){if(null!==this.ux&&this.ux.EF(this.zS),!this.Si)return;const e=this.N,i=this.ds;i.Sc=!1,this.Si=!1,this.Nc=!1,i.xu();const n=this.ce,s=this.Ac.iterator;for(;s.next();)e.remove(s.value);const o=this.Su,r=n.iterator,a=ht.lx;for(;r.next();){const t=r.key,e=r.value,i=o?e.gs:e.ei,n=o?e.ei:e.gs,s=e.gx;for(const o in n)if(null!==a.get(o)){let r=o;e.yx&&("position:nodeCollapse"===r||"position:placeholder"===r)&&(r="position"),a.get(r)(t,i[o],void 0!==s[o]?s[o]:e.yx?i[o]:n[o],this.Lm,this.ms,this.ms,this)}e.yx&&void 0!==s.location&&t instanceof ce&&(t.location=s.location),e.mx&&t instanceof ce&&t.Ei(!1)}this.fx++;const l=!t&&this.cx>this.fx;if(!l&&(this===i.Mm||this===i.defaultAnimation)&&this.ce.clear(),e.wx.clear(),e.NP(!1),e.invalidateDocumentBounds(),e.S(),e.fr(!0),i.defaultAnimation===this){const t=i.Cm.iterator;for(;t.next();)t.value.BF();i.Cm.clear()}if(e.fr(!0),this.isViewportUnconstrained&&(e.scrollMode=this.KS),i.bu(),l)return this.Tc=!1,void this.start();this.ex(null),e.xL(),i.ku(this),this.Pu&&this.Pu(this),e.requestUpdate()}Cc(t,e){const i=e.actualBounds;let n=null;if(e instanceof Ne&&(n=e.placeholder),null!==n&&n.visible){const e=n.getDocumentPoint(w.TopLeft),i=n.padding;e.x+=i.left,e.y+=i.top,this.add(t,"position",e,t.position,!1)}else this.add(t,"position",new y(i.x+i.width/2,i.y+i.height/2),t.position,!1);this.add(t,"scale",.01,t.scale,!1),t instanceof Ne&&this.UF(t,e)}UF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof pe&&this.Cc(t,e)}}Lc(t,e){if(!t.isVisible())return;let i=null;if(e instanceof Ne&&(i=e.placeholder),null!==i&&i.visible){const e=i.getDocumentPoint(w.TopLeft),n=i.padding;e.x+=n.left,e.y+=n.top,this.add(t,"position:placeholder",t.position,e,!0)}else this.add(t,"position:nodeCollapse",t.position,e,!0);this.add(t,"scale",t.scale,.01,!0),this.IF(t),t instanceof Ne&&this.VF(t,e)}VF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof pe&&this.Lc(t,e)}}get duration(){return this.Po}set duration(t){e.s(t,"number",ut,"duration"),t<1&&e.W(t,">= 1",ut,"duration"),this.Po=t}get reversible(){return this.Su}set reversible(t){this.Su=t}get runCount(){return this.cx}set runCount(t){t>0?this.cx=t:e.o("Animation.runCount value must be a positive integer.")}get finished(){return this.Pu}set finished(t){this.Pu!==t&&(null!==t&&e.k(t,ut,"finished"),this.Pu=t)}get easing(){return this.hx}set easing(t){this.hx=t}get isViewportUnconstrained(){return this.XS}set isViewportUnconstrained(t){this.XS=t}get isAnimating(){return this.Si}getTemporaryState(t){let e=this.ax.get(t);return null===e&&(e={},this.ax.set(t,e)),e}static EaseLinear=(t,e,i,n)=>i*t/n+e;static EaseInOutQuad=(t,e,i,n)=>(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e;static EaseInQuad=(t,e,i,n)=>i*(t/=n)*t+e;static EaseOutQuad=(t,e,i,n)=>-i*(t/=n)*(t-2)+e;static EaseInExpo=(t,e,i,n)=>0===t?e:i*Math.pow(2,10*(t/n-1))+e;static EaseOutExpo=(t,e,i,n)=>t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e}class ct{ei;gs;gx;yx;mx;constructor(t,e,i){this.ei=t,this.gs=e,this.gx={},this.yx=i,this.mx=!1}}var dt=(t=>(t[t.Default=1]="Default",t[t.Immediate=2]="Immediate",t[t.Bundled=3]="Bundled",t))(dt||{});class ft{be;en;Nu;Dc;constructor(t,e,i){this.be=null,this.en=t,this.Nu=i||1,this.Dc=null,void 0!==e&&(this.Dc=e,void 0===i&&(this.Nu=2))}copy(){const t=new ft(this.en);t.Nu=this.Nu;const e=this.Dc;if(null!==e){const i={};void 0!==e.duration&&(i.duration=e.duration),void 0!==e.finished&&(i.finished=e.finished),void 0!==e.easing&&(i.easing=e.easing),t.Dc=i}return t}get propertyName(){return this.en}set propertyName(t){this.en=t}get animationSettings(){return this.Dc}set animationSettings(t){this.Dc=t}zF(t){const e=this.Dc;null!==e&&(e.duration&&(t.duration=e.duration),e.finished&&(t.finished=e.finished),e.easing&&(t.easing=e.easing))}get startCondition(){return this.Nu}set startCondition(t){this.Nu=t}static Default=1;static Immediate=2;static Bundled=3}class gt{N;Pt;$t;br;Fl;Rl;vl;Ol;Il;El;Bl;Ul;Vl;zl;Xl;Yl;kc;Kl;xx;Am;Cu;Ct;constructor(t){u.Gi(this),this.N=null,this.Ct=new l,this.Pt="",this.$t=1,this.br=!1,this.Fl=!0,this.Rl=!0,this.vl=!0,this.Ol=!0,this.Il=!0,this.El=!0,this.Bl=!0,this.Ul=!0,this.Vl=!0,this.zl=!0,this.Xl=!0,this.Yl=!0,this.kc=!0,this.Kl=!0,this.xx=!0,this.Am=!1,this.Cu=[],t&&Object.assign(this,t)}XF(){const t=this.Ct;for(let e=0;e<t.length;e++)t.r[e].HS(null);t.clear(),this.Cu.length=0}So(t){this.N=t}toString(t){void 0===t&&(t=0);const i='Layer "'+this.name+'"';if(t<=0)return i;let n=0,s=0,o=0,r=0,a=0;const l=this.Ct.iterator;for(;l.next();){const t=l.value;t instanceof Ne?o++:t instanceof pe?s++:t instanceof be?r++:t instanceof fe?a++:n++}let h="";if(n>0&&(h+=n+" Parts "),s>0&&(h+=s+" Nodes "),o>0&&(h+=o+" Groups "),r>0&&(h+=r+" Links "),a>0&&(h+=a+" Adornments "),t>1){const t=this.Ct.iterator;for(;t.next();){const i=t.value;h+="\n    "+i.toString();const n=i.data;null!==n&&u.as(n)&&(h+=" #"+u.as(n)),i instanceof pe?h+=" "+e.toString(n):i instanceof be&&(h+=" "+e.toString(i.fromNode)+" "+e.toString(i.toNode))}}return i+" "+this.Ct.count+": "+h}findObjectAt(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),!1===this.Kl)return null;let n=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(n=!0);const s=y.l(),o=this.Ct.r;for(let r=o.length;r--;){const a=o[r];if(!0===n&&!1===a.Ml()||!a.isVisible())continue;s.a(t),s.Oe(a.Bs);let l=a.bL(s,e,i);if(null!==l&&(null!==e&&(l=e(l)),null!==l&&(null===i||i(l))))return y.e(s),l}return y.e(s),null}findObjectsAt(t,e,i,n){if(void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof l)&&!(n instanceof u)&&(n=new u),!1===this.Kl)return n;let s=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(s=!0);const o=y.l(),r=this.Ct.r;for(let a=r.length;a--;){const l=r[a];if(!0===s&&!1===l.Ml()||!l.isVisible())continue;o.a(t),o.Oe(l.Bs);let h=l;l.kL(o,e,i,n)&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&n.add(h))}return y.e(o),n}findObjectsIn(t,e,i,n,s){if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof l)&&!(s instanceof u)&&(s=new u),!1===this.Kl)return s;let o=!1;null!==this.diagram&&this.diagram.viewportBounds.containsRect(t)&&(o=!0);const r=this.Ct.r;for(let a=r.length;a--;){const l=r[a];if(!0===o&&!1===l.Ml()||!l.isVisible())continue;let h=l;l.Tm(t,e,i,n,s)&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&s.add(h))}return s}vP(t,e,i,n,s,o,r){if(!1===this.Kl)return s;const a=this.Ct.r;for(let l=a.length;l--;){const h=a[l];if(!0===r&&!1===h.Ml()||!o(h)||!h.isVisible())continue;let u=h;h.Tm(t,e,i,n,s)&&(null!==e&&(u=e(u)),null!==u&&(null===i||i(u))&&s.add(u))}return s}findObjectsNear(t,e,i,n,s,o){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof l||s instanceof u)&&(o=s),s=!0),!(o instanceof l)&&!(o instanceof u)&&(o=new u),!1===this.Kl)return o;let r=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(r=!0);const a=y.l(),h=y.l(),c=this.Ct.r;for(let l=c.length;l--;){const u=c[l];if(!0===r&&!1===u.Ml()||!u.isVisible())continue;a.a(t),a.Oe(u.Bs),h.i(t.x+e,t.y),h.Oe(u.Bs);let d=u;u.PL(a,h,i,n,s,o)&&(null!==i&&(d=i(d)),null!==d&&(null===n||n(d))&&o.add(d))}return y.e(a),y.e(h),o}jS(){return this.Ct.r}ps(t,i){if(!this.visible)return;const n=this.Ct.r,s=n.length;if(0===s)return;const o=e.et(),r=e.et();for(let e=0;e<s;e++){const t=n[e];if(t.qS=e,t instanceof be){if(!1===t.Se)continue}else if(t instanceof fe&&null!==t.adornedPart)continue;const s=t.actualBounds;t.isVisible()&&s.intersectsRectPlus(i,10)?(t.ps(!0),o.push(t)):(t.ps(!1),null!==t.adornments&&t.adornments.count>0&&r.push(t))}for(let e=0;e<o.length;e++){const t=o[e];t.WS();const i=t.adornments;for(;i.next();){const t=i.value;t.ht(1/0,1/0),t.Ut(),t.ps(!0)}}for(let e=0;e<r.length;e++)r[e].WS();e.J(o),e.J(r)}Lu(t){let e=1;return 1!==this.$t&&(e=t.globalAlpha,t.globalAlpha=e*this.$t),e}SL(t,e){for(let i=0;i<e;i++)t[i].Au()}Bi(t,e,i){if(!this.visible||0===this.$t||(void 0===i&&(i=!0),!i&&this.isTemporary))return;const n=this.Ct.r,s=n.length;if(0===s)return;t.br&&this.SL(n,s);const o=this.Lu(t),r=this.Cu;r.length=0;const a=e.scale,l=v.l();for(let h=0;h<s;h++){const i=n[h];this.Dm(t,i,e,r,a,l,!0)}v.e(l),t.br&&this.SL(n,s),t.globalAlpha=o}NE(t,e,i){if(!this.visible||0===this.$t)return;const n=this.Ct.r,s=n.length;if(0===s)return;const o=this.Lu(t),r=this.Cu;r.length=0;const a=e.scale,l=v.l();for(let h=0;h<s;h++){const s=n[h];i.has(s)||this.Dm(t,s,e,r,a,l,!0)}v.e(l),t.globalAlpha=o}YF(t,e,i,n){if(!this.visible||0===this.$t||!n&&this.isTemporary)return;const s=this.Ct.r,o=s.length;if(0===o)return;const r=this.Lu(t),a=this.Cu;a.length=0;const l=e.scale,h=v.l();for(let u=0;u<o;u++){const n=s[u];i.has(n)&&this.Dm(t,n,e,a,l,h,!1)}v.e(h),t.globalAlpha=r}KF(t,e,i,n,s){if(!this.visible||0===this.opacity)return;const o=this.diagram.grid.part;if(!n&&this.isTemporary){if(s&&o.layer===this){const e=this.Lu(t);o.Bi(t,i),t.globalAlpha=e}}else{const e=this.Lu(t),n=i.scale,r=v.l(),a=this.Ct.r,l=a.length;for(let h=0;h<l;h++){const e=a[h];!s&&e===o||this.Dm(t,e,i,null,n,r,!1)}v.e(r),t.globalAlpha=e}}CE(t,e,i){if(!this.visible||0===this.$t)return;const n=this.Lu(t),s=this.Cu;s.length=0;const o=e.scale,r=v.l(),a=this.Ct.r,l=a.length,h=i.length;for(let u=0;u<l;u++){const n=a[u],l=n.qh(n.actualBounds);this.GF(l,i,h,o)&&this.Dm(t,n,e,s,o,r,!0)}v.e(r),t.globalAlpha=n}Dm(t,e,i,n,s,o,r){if(r&&!e.Ml())return void t.removePartFromView(e);if(null!==n&&e instanceof be&&(e.isOrthogonal&&n.push(e),!1===e.Se))return void t.removePartFromView(e);let a=!1,l=e.containingGroup;for(;null!==l;)a?null!==l.si&&o.intersectRect(l.si):null!==l.si&&(a=!0,o.a(l.si)),l=l.containingGroup;const h=e.actualBounds;let u=!1;if(a&&e.isVisible()){if(!o.intersectsRect(h))return void t.removePartFromView(e);u=!o.containsRect(h)}u&&(t.save(),t instanceof Rt?t.partClipRect=o.copy():(t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.clip())),h.width*s>i.Fm||h.height*s>i.Fm?e.Bi(t,i):this.HF(t,e,i),u&&(t.restore(),t.clearContextCache(!0))}HF(t,e,i){if(t instanceof Rt)return void e.Bi(t,i);const n=e.actualBounds,s=e.naturalBounds;if(0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y)||!e.isVisible())return;const o=e.T;if(null===e.background)return e.rn(t,"rgba(0,0,0,0.3)",!0,!1,s,n),void t.fillRect(n.x,n.y,n.width,n.height);if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),e.rn(t,e.background,!0,!1,s,n),t.fillRect(0,0,s.width/2,s.height/2),!o.Xk()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}}GF(t,e,i,n){const s=2/n,o=4/n;for(let r=0;r<i;r++){const i=e[r];if(0!==i.width&&0!==i.height&&t.intersects(i.x-s,i.y-s,i.width+o,i.height+o))return!0}return!1}t(t,e,i,n,s){const o=this.diagram;null!==o&&o.raiseChangedEvent(2,t,this,e,i,n,s)}Wh(t,e,i){const n=this.Ct;if(e.HS(this),t>=n.count)t=n.count;else if(n.elt(t)===e)return-1;n.insertAt(t,e),e.Rm(i);const s=this.diagram;return null!==s&&(i?s.S():s.Wh(e)),this.bx(t,e),t}te(t,e,i){if(!i&&e.layer!==this&&null!==e.layer)return e.layer.te(t,e,i);const n=this.Ct;if(t<0||t>=n.length){if((t=n.indexOf(e))<0)return-1}else if(n.elt(t)!==e&&(t=n.indexOf(e))<0)return-1;e.vm(i),n.removeAt(t);const s=this.diagram;return null!==s&&(i?s.S():s.te(e)),e.HS(null),t}bx(t,e){t=this.jF(t,e),e instanceof Ne&&this.qF(t,e),null!==e.svg&&e.svg.remove()}jF(t,e){const i=e.zOrder;if(isNaN(i))return t;const n=this.Ct,s=n.count;if(s<=1)return t;if(t<0&&(t=n.indexOf(e)),t<0)return-1;let o=t-1,r=NaN;for(;o>=0&&(r=n.elt(o).zOrder,isNaN(r));)o--;let a=t+1,l=NaN;for(;a<s&&(l=n.elt(a).zOrder,isNaN(l));)a++;if(!isNaN(r)&&r>i)for(;;){if(-1===o||r<=i)return o++,o===t?t:(n.removeAt(t),n.insertAt(o,e),o);for(r=NaN;--o>=0&&(r=n.elt(o).zOrder,isNaN(r)););}else if(!isNaN(l)&&l<i)for(;;){if(a===s||l>=i)return a--,a===t?t:(n.removeAt(t),n.insertAt(a,e),a);for(l=NaN;++a<s&&(l=n.elt(a).zOrder,isNaN(l)););}return t}qF(t,e){if(null===e||!isNaN(e.zOrder))return;this.WF(t,e);const i=e.containingGroup;null!==i&&this.bx(-1,i)}WF(t,e){if(0===e.memberParts.count)return;let i=-1;const n=this.Ct.r,s=n.length;for(let o=0;o<s;o++){const s=n[o];if(s===e&&(t=o,i>=0)||i<0&&s.containingGroup===e&&(i=o,t>=0))break}if(!(i<0)&&i<t){const n=this.Ct;n.removeAt(t),n.insertAt(i,e)}}get parts(){return this.Ct.iterator}get partsBackwards(){return this.Ct.iteratorBackwards}get diagram(){return this.N}get name(){return this.Pt}set name(t){e.s(t,"string",gt,"name");const i=this.Pt;if(i!==t){const n=this.diagram;if(null!==n){""===i&&e.o("Cannot rename default Layer to: "+t);const s=n.layers;for(;s.next();)s.value.name===t&&e.o("Layer.name is already present in this diagram: "+t)}this.Pt=t,this.t("name",i,t);const s=this.Ct.iterator;for(;s.next();){s.value.layerName=this.Pt}}}get opacity(){return this.$t}set opacity(t){const i=this.$t;if(i!==t){e.s(t,"number",gt,"opacity"),(t<0||t>1)&&e.W(t,"0 <= value <= 1",gt,"opacity"),this.$t=t;const n=this.diagram;null!==n&&n.S(),this.t("opacity",i,t)}}get isViewportAligned(){return this.Am}set isViewportAligned(t){const e=this.Am;e!==t&&(this.Am=t,this.diagram&&(this.ML(),this.diagram.S()),this.t("isViewportAligned",e,t),t&&(this.isInDocumentBounds=!1))}ML(){if(!this.Am)return;const t=this.diagram,e=this.Ct.r,i=e.length,n=t.xt,s=t.bt;for(let o=0;o<i;o++){const i=e[o],r=i.naturalBounds.width,a=i.naturalBounds.height;let l=i.alignment;(l.isDefault()||!l.isSpot())&&(l=w.BottomRight);let h=i.alignmentFocus;h.isDefault()&&(h=new w(l.x,l.y));const u=l.x*n+l.offsetX-(h.x*r+h.offsetX),c=l.y*s+l.offsetY-(h.y*a+h.offsetY),d=y.V(u,c);t.JF(d),i.bc(d.x,d.y,!0),y.e(d),i.tt=1/t.scale}}get isTemporary(){return this.br}set isTemporary(t){const i=this.br;i!==t&&(e.s(t,"boolean",gt,"isTemporary"),this.br=t,this.t("isTemporary",i,t))}get visible(){return this.kc}set visible(t){const i=this.kc;if(i!==t){e.s(t,"boolean",gt,"visible"),this.kc=t;const n=this.Ct.iterator;for(;n.next();)n.value.Ei(t);const s=this.diagram;null!==s&&s.S(),this.t("visible",i,t)}}get pickable(){return this.Kl}set pickable(t){const i=this.Kl;i!==t&&(e.s(t,"boolean",gt,"pickable"),this.Kl=t,this.t("pickable",i,t))}get isInDocumentBounds(){return this.xx}set isInDocumentBounds(t){const e=this.xx;e!==t&&(this.xx=t,null!==this.diagram&&this.diagram.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t))}get allowCopy(){return this.Fl}set allowCopy(t){const i=this.Fl;i!==t&&(e.s(t,"boolean",gt,"allowCopy"),this.Fl=t,this.t("allowCopy",i,t))}get allowDelete(){return this.Rl}set allowDelete(t){const i=this.Rl;i!==t&&(e.s(t,"boolean",gt,"allowDelete"),this.Rl=t,this.t("allowDelete",i,t))}get allowTextEdit(){return this.vl}set allowTextEdit(t){const i=this.vl;i!==t&&(e.s(t,"boolean",gt,"allowTextEdit"),this.vl=t,this.t("allowTextEdit",i,t))}get allowGroup(){return this.Ol}set allowGroup(t){const i=this.Ol;i!==t&&(e.s(t,"boolean",gt,"allowGroup"),this.Ol=t,this.t("allowGroup",i,t))}get allowUngroup(){return this.Il}set allowUngroup(t){const i=this.Il;i!==t&&(e.s(t,"boolean",gt,"allowUngroup"),this.Il=t,this.t("allowUngroup",i,t))}get allowLink(){return this.El}set allowLink(t){const i=this.El;i!==t&&(e.s(t,"boolean",gt,"allowLink"),this.El=t,this.t("allowLink",i,t))}get allowRelink(){return this.Bl}set allowRelink(t){const i=this.Bl;i!==t&&(e.s(t,"boolean",gt,"allowRelink"),this.Bl=t,this.t("allowRelink",i,t))}get allowMove(){return this.Ul}set allowMove(t){const i=this.Ul;i!==t&&(e.s(t,"boolean",gt,"allowMove"),this.Ul=t,this.t("allowMove",i,t))}get allowReshape(){return this.Vl}set allowReshape(t){const i=this.Vl;i!==t&&(e.s(t,"boolean",gt,"allowReshape"),this.Vl=t,this.t("allowReshape",i,t))}get allowResize(){return this.zl}set allowResize(t){const i=this.zl;i!==t&&(e.s(t,"boolean",gt,"allowResize"),this.zl=t,this.t("allowResize",i,t))}get allowRotate(){return this.Xl}set allowRotate(t){const i=this.Xl;i!==t&&(e.s(t,"boolean",gt,"allowRotate"),this.Xl=t,this.t("allowRotate",i,t))}get allowSelect(){return this.Yl}set allowSelect(t){const i=this.Yl;i!==t&&(e.s(t,"boolean",gt,"allowSelect"),this.Yl=t,this.t("allowSelect",i,t))}}var pt=(t=>(t[t.None=1]="None",t[t.Uniform=2]="Uniform",t[t.UniformToFill=3]="UniformToFill",t))(pt||{}),mt=(t=>(t[t.All=1]="All",t[t.NotDirected=2]="NotDirected",t[t.NotDirectedFast=3]="NotDirectedFast",t[t.NotUndirected=4]="NotUndirected",t[t.DestinationTree=5]="DestinationTree",t[t.SourceTree=6]="SourceTree",t))(mt||{}),yt=(t=>(t[t.Document=1]="Document",t[t.Infinite=2]="Infinite",t))(yt||{}),xt=(t=>(t[t.TreeParent=1]="TreeParent",t[t.AllParents=2]="AllParents",t[t.AnyParents=3]="AnyParents",t))(xt||{});class vt{ds;Wt;JS;kx;kr;Tu;Px;Sx;Mx;Nx;Cx;Lx;Jh;jh;Ax;Tx;Dx;Gl;Fc;Pr;Om;Fx;Rx;Du;Yn;Sr;$h;No;Im;Rc;Em;vc;Fu;Mr;Kn;$S;ZS;vx;Ox;QS;Ix;_S;tM;iM;Ex;Bm;Nr;Cr;Lr;Ar;Tr;Dr;Bx;Fr;Ux;Rr;vr;Or;Ir;Vx;eM;Co;sM;zx;Xx;nM;ki;oM;rM;lM;Os;Lo;Oi;Yx;Fl;Rl;Kx;Gx;vl;Ol;Il;Hx;El;Bl;Ul;Vl;zl;Xl;Yl;jx;qx;hM;Ru;vu;Wx;Jx;$x;Zx;Um;Qx;_x;tb;Zt;aM;ib;cM;Ou;ln;Gn;ie;Hn;NL;Hl;fM;uM;Vm;eb;Iu;zm;sb;Er;jl;Zh;dM;gM;Xm;nb;ob;Ze;Eu;Ym;Bu;ql;Oc;Km;Br;Qh;mM;Gm;jt;T;Be;wr;Ui;ys;pM;Wl;Ur;xl;Vr;_h;Ic;yM;Uu;ta;Vu;Xt;Jl;at;tt;zu;xt;bt;ft;Ec;Ew;rb;ia;Bc;lb;hb;ab;$F;ZF;Vi;kl;Fm;Hm;wM;xM;CL;jm;QF;_F;tR;cb;iR;eR;sR;ea;LL;$l;sa;na;oa;ra;mu;Gh;Qt;St;Uc;iP;eP;gc;$t;static fb=null;static AL=(()=>new m)();static bM;static kM=null;gu;ub;db;gb;pb;yb;qm;PM;Wm;Jm;$m;ix;SM;MM;Vc;constructor(e,i){if(vt.dw||(vt.Yk(),vt.dw=!0),u.Gi(this),vt.TL(this),this.jt=!0,this.St=null,this.xt=0,this.bt=0,this.ft=null,vt.isUsingDOM()){const e=this,i=()=>{e.Pi(t.document,"DOMContentLoaded",i,!1),e.setRTL()};null!==t.document.body?this.setRTL():e.Bt(t.document,"DOMContentLoaded",i,!1)}this.Ec=null,vt.NM("Model",Ie);const n=this;return this.oM=t=>n.partManager.doModelDataChanged(t),this.rM=t=>n.partManager.doModelChanged(t),this.lb=null,this.hb=null,this.DL(),this.model=Ue.CM(),this.themeManager=new Ci,this.Co=!0,this.FL(),this.layout=new Le,this.Co=!1,this.QF=null,this._F=null,this.tR=null,this.cb=null,this.iR=null,this.eR=null,this.sR=null,this.ea=null,this.LL=null,this.$l=null,this.sa=null,this.na=null,this.oa=null,this.ra=null,this.mu=()=>{},this.Gh=null,this.Bu=!1,this.Uc=new bt(this),void 0!==e&&("string"==typeof e||t.Element&&e instanceof Element?this.LM(e):i=e),i&&this.setProperties(i),this.jt=!1,this.requestUpdate(),this}gF(){return null!==this.ft}get renderer(){return this.Oc}set renderer(e){if(this instanceof Pt)return;""===e&&(e="default");const i=e.toLowerCase();if(i===this.Oc)return;this.Oc=i;let n=null;"default"===i||"canvas"===i?(n=this.ql.get("svg"),null!==n&&n.Tt.remove(),this.ft&&(this.Qt=this.ft.li),this.Qt.clearContextCache(!0)):"svg"===i?(this.ql.has("svg")?n=this.ql.get("svg"):(n=new Et(this,t.document),this.addRenderer("svg",n)),null!==this.div&&this.div.appendChild(n.Tt),this.Qt=n.li,this.ft&&(this.ft.li.setTransform(this.Vi,0,0,this.Vi,0,0),this.ft.li.clearRect(0,0,this.xt,this.bt))):"debug"===i&&(this.ql.has("SVG")||(n=new Et(this,t.document),this.addRenderer("SVG",n),n.Tt.style.backgroundColor="whitesmoke",null!==this.div&&this.div.after(n.Tt))),this.jt||this.redraw()}DL(){this.Vc=new l,this.setupRouters(),this.ds=new ht,this.ds.So(this),this.Wt=17,this.JS=!1,this.zu=!1,this.kx="default",this.Xt=new l,this.ql=new m,this.Oc="default",this.resetRenderingHints(),this.nR(),this.$t=1,this.at=new y(NaN,NaN).u(),this.ix=new y(NaN,NaN),this.tt=1,this.Gm=1,this.Px=new y(NaN,NaN).u(),this.Sx=NaN,this.Mx=1e-4,this.Nx=100,this.T=new k,this.Cx=new y(NaN,NaN).u(),this.Lx=new v(NaN,NaN,NaN,NaN).u(),this.Jh=new b(0,0,0,0).u(),this.jh=1,this.Ax=!1,this.Tx=null,this.Dx=null,this.Gl=1,this.Fc=w.Default,this.Pr=1,this.Om=w.Default,this.Fx=w.None,this.Rx=w.None,this.Be=!0,this.Du=!1,this.Yn=new Set,this.Sr=new u,this.$h=new u,this.No=!1,this.Jl=new m,this.Uu=!0,this.Im=250,this.Rc=-1,this.Em=new b(16,16,16,16).u(),this.wr=!1,this.vc=!1,this.Fu=!0,this.Km=new D,this.Km.diagram=this,this.Br=new D,this.Br.diagram=this,this.Qh=new D,this.Qh.diagram=this,this.Mr=null,this.Kn=null,this.Ew=!1,this.oR(),this.Vr=new u,this.vx=!0,this.Ox=1,this.QS=!1,this.Ix=1,this.Ex="auto",this.Bm="auto",this.Nr=null,this.Cr=null,this.Lr=null,this.Ar=null,this.Tr=null,this.Dr=null,this.Bx=null,this.Fr=null,this.Ux=!1,this.Rr=null,this.vr=null,this.Or=null,this.Ir=null,this.Vx=!1,this.rb={},this.ia=[null,null],this.Co=!1,this.sM=!1,this.zx=!1,this.Xx=!1,this.nM=!0,this.ys=!1,this.ta=!1,this.lM=!0,this.Os=-2,this.Wl=new m,this.Vu=new l,this.Lo=!1,this.Oi=!0,this.Yx=!0,this.Fl=!0,this.Rl=!0,this.Kx=!1,this.Gx=!0,this.vl=!0,this.Ol=!0,this.Il=!0,this.Hx=!0,this.El=!0,this.Bl=!0,this.Ul=!0,this.Vl=!0,this.zl=!0,this.Xl=!0,this.Yl=!0,this.jx=!0,this.qx=!0,this.hM=!1,this.Bc=!1,this.Ru=!0,this.vu=!0,this.Wx=!0,this.Jx=!0,this.$x=16,this.Zx=16,this.Um=!1,this.Qx=!1,this._x=0,this.tb=0,this.Zt=new b(5).u(),this.aM=(new u).u(),this.ib=999999999,this.cM=(new u).u(),this._h=!0,this.Ou=!0,this.Ic=!0,this.ln=!1,this.Gn=!1,this.Ur=!0,this.xl=!1,this.Hn=!1,this.NL=new u,this.yM=new u,this.Hl=null,this.fM=new x(8,8),this.uM=999,this.Vm=!1,this.iP=1,this.eP=0,this.Ui={scale:1,position:new y,bounds:new v,canvasSize:new x,newCanvasSize:new x,isScroll:!1},this.Ui.canvasSize=this.Ui.canvasSize,this.Ui.newCanvasSize=this.Ui.newCanvasSize,this.Ui.isScroll=!1,this.eb=new v(NaN,NaN,NaN,NaN).u(),this.Iu=new x(NaN,NaN).u(),this.zm=new v(NaN,NaN,NaN,NaN).u(),this.sb=!1,this.rR(),this.Ze=null,this.Eu=!1,this.gc=null,this.partManager=new Ie,this.toolManager=new V,this.toolManager.initializeStandardTools(),this.defaultTool=this.toolManager,this.currentTool=this.defaultTool,this.db=null,this.gb=new St,this.pb=null,this.yb=null,this.ub=!1,this.gu=!1,this.commandHandler=new Ct,this.Jm=null,this.$m=y.Ok,this.SM=!1,this.Vi=1,this.kl=null,this.Fm=1,this.qm=0,this.PM=[0,0,0,0,0],this.Wm=0,this.Hm=1,this.wM=0,this.xM=new y,this.CL=500,this.Ym=new y,this.jm=!1}static RL=(()=>void 0!==t.document)();static isUsingDOM(){return vt.RL}static useDOM(e){vt.RL=!!e&&void 0!==t.document}static Qe=(()=>new WeakMap)();clear(){this.animationManager.stopAnimation(),this.model.clear(),vt.vL(),this.OL(!1),this.Vu.clear(),this.IL(),this.Hl=null,this.invalidateDocumentBounds(),this.ensureBounds(),this.S()}OL(t){this.animationManager.stopAnimation(!0),this.aM=(new u).u(),this.cM=(new u).u();const i=this.skipsUndoManager,n=null!==this.ki&&void 0!==this.ki;n&&(this.skipsUndoManager=!0);let s=null;null!==this.Ze&&(s=this.Ze.part,null!==s&&this.remove(s));const o=[],r=this.Xt.length;if(t){for(let t=0;t<r;t++){const e=this.Xt.r[t].parts;for(;e.next();){const t=e.value;t!==s&&null===t.data&&o.push(t)}}for(let t=0;t<o.length;t++){const e=o[t];this.remove(e)}}for(let e=0;e<r;e++)this.Xt.r[e].XF();return this.partManager.clear(),this.Yn.clear(),this.Sr.clear(),this.$h.clear(),this.Jl.clear(),this.Vr.clear(),this.gc=null,this.Vu.clear(),this.IL(),e.Rk=[],null!==s&&(this.add(s),this.partManager.parts.delete(s)),n&&(this.skipsUndoManager=i),o}static Zm=null;static wb="";static vL(){vt.Zm=null,vt.wb=""}static LE(){return null}reset(){this.clear(),this.jt=!0,this.DL(),this.themeManager=new Ci,this.Zl(),this.Co=!0,this.FL(),this.layout=new Le,this.Co=!1,this.model=Ue.CM(),this.model.undoManager=new B,this.Bu=!1,this.jt=!1,this.S()}rR(){this.Er=new m,this.dM=(new pe).add(new ie({stroke:"black",font:"10pt sans-serif"}).bind("text","",e.toString).theme("stroke","text").theme("font","normal")),this.Er.set("",this.dM),this.Er.set("Comment",(new pe).add(new ie({stroke:"brown",font:"10pt sans-serif"}).bind("text","",e.toString).theme("stroke","comment").theme("font","normal"))),this.Er.set("LinkLabel",new pe({selectable:!1,avoidable:!1}).add(new Jt("Ellipse",{fill:"black",stroke:null,desiredSize:new x(3,3).$()}).theme("fill","link"))),this.Zh=new m,this.pM=new Ne(Yt.Vertical,{selectionObjectName:"GROUPPANEL"}).add(new ie({stroke:"black",font:"bold 12pt sans-serif"}).bind("text","",e.toString).theme("stroke","text").theme("font","bold"),new Yt(Yt.Auto,{name:"GROUPPPANEL"}).add(new Jt({fill:"rgba(128,128,128,0.2)",stroke:"black",strokeWidth:1}).theme("fill","group").theme("stroke","outline").theme("strokeWidth","group"),new Te({padding:5}).theme("padding","group"))),this.Zh.set("",this.pM),this.jl=new m,this.gM=(new be).add(new Jt({isPanelMain:!0,stroke:"black"}).theme("stroke","link"),new Jt({toArrow:"Standard",fill:"black",stroke:null,strokeWidth:0}).theme("toArrow").theme("fill","link")),this.jl.set("",this.gM),this.jl.set("Comment",(new be).add(new Jt({isPanelMain:!0,stroke:"brown"}).theme("stroke","comment"))),this.Xm=new fe(Yt.Auto).add(new Jt({fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"),new Te({margin:1.5}).theme("margin","selection","numbers",null,(t=>t?new b(t/2):1.5))),this.nb=this.Xm,this.ob=new fe(Yt.Link).add(new Jt({isPanelMain:!0,fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"))}setRTL(i){let n=void 0===i?this.div:i;null===n&&(n=t.document.body);const s=e.hs("div");s.dir="rtl",s.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",s.textContent="A",n.appendChild(s);let o="reverse";s.scrollLeft>0?o="default":(s.scrollLeft=1,0===s.scrollLeft&&(o="negative")),n.removeChild(s),this.kx=o}setScrollWidth(i){let n=void 0===i?this.div:i;null===n&&(n=t.document.body);let s=0;if(vt.isUsingDOM()){let t=vt.kM,i=vt.bM;null===t&&(vt.kM=e.hs("p"),t=vt.kM,t.style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",vt.bM=e.hs("div"),i=vt.bM,i.style.position="absolute",i.style.visibility="hidden",i.style.width="200px",i.style.height="150px",i.style.boxSizing="content-box",i.appendChild(t)),i.style.overflow="hidden",n.appendChild(i);const o=t.offsetWidth;i.style.overflow="scroll";let r=t.offsetWidth;o===r&&(r=i.clientWidth),n.removeChild(i),s=o-r,0===s&&!e._o&&(s=11)}this.Wt=s,this.JS=!0}oi(t){t in pt?this.autoScale=t:e.ir(this,t)}toString(t){void 0===t&&(t=0);let e="";this.div&&this.div.id&&(e=this.div.id);let i='Diagram "'+e+'"';if(t<=0)return i;const n=this.Xt.iterator;for(;n.next();){i+="\n  "+n.value.toString(t-1)}return i}static TL(t){vt.fb=t}static um(){return vt.fb}static fromDiv(e){let i=e;if("string"==typeof e&&(i=t.document.getElementById(e)),i instanceof HTMLDivElement){const t=vt.Qe.get(i);if(t)return t}return null}get div(){return this.St}set div(e){if(this.St!==e){const i=this.St;if(null!==i){if(vt.Qe.delete(i),i.goDiagram=void 0,i.go=void 0,i.innerHTML="",null!==this.ft){const t=this.ft.Tt;this.Pi(t,"pointermove",this.sa,!1),this.Pi(t,"pointerdown",this.$l,!1),this.Pi(t,"pointerup",this.na,!1),this.Pi(t,"pointerout",this.oa,!1),this.Pi(t,"pointercancel",this.ra,!1),this.ft.dispose()}this.Ec&&(this.Ec.disconnect(),this.Ec=null);const e=this.toolManager;null!==e&&(e.mouseDownTools.each((t=>t.cancelWaitAfter())),e.mouseMoveTools.each((t=>t.cancelWaitAfter())),e.mouseUpTools.each((t=>t.cancelWaitAfter()))),e.cancelWaitAfter(),this.currentTool.doCancel(),this.ft=null,this.Pi(t,"resize",this.cb,!1),this.Pi(t,"wheel",this.ea,!0),vt.um()===this&&vt.TL(null)}else null===this.$l&&(this.Hn=!1);if(this.St=null,null!==e){const t=vt.Qe.get(e);t&&(t.div=null),this.LM(e),this.mu(),this.themeManager&&this.themeManager.lR()}else this.themeManager&&this.themeManager.hR()}}setupRouters(){this.Vc.push(new Ti)}LM(i){const n=this;if(!vt.isUsingDOM())return;null==i&&e.o("Diagram setup requires an argument DIV."),null!==n.St&&e.o("Diagram has already completed setup."),"string"==typeof i?n.St=t.document.getElementById(i):i instanceof HTMLDivElement?n.St=i:e.o("No DIV or DIV id supplied: "+i),null===n.St&&e.o("Invalid DIV id; could not get element with id: "+i);const s=vt.Qe.get(n.St);if(s&&s!==this&&e.o("Invalid div id; div already has a Diagram associated with it."),!n.Ec&&t.ResizeObserver){const i=t.ResizeObserver,s=e.Fk((()=>n.requestUpdate()),250,!1);n.Ec=new i((()=>s())),n.Ec.observe(n.St)}"static"===t.getComputedStyle(n.St,null).position&&(n.St.style.position="relative");let o=5;const r="rgba(2"+o+"5, 255, 255, 0)";o--,n.St.style["-webkit-tap-highlight-color"]=r,n.St.innerHTML="",vt.Qe.set(n.St,n),n.St.goDiagram=n,n.St.go=t.go;const a=new Bt(n);void 0!==a.style&&(a.style.position="absolute",a.style.top="0px",a.style.left="0px","rtl"===t.getComputedStyle(n.St,null).getPropertyValue("direction")&&(n.zu=!0),a.style.zIndex="2",a.style.userSelect="none",a.style.MozUserSelect="none",a.style.touchAction="none",a.style.letterSpacing="normal !important",a.style.wordSpacing="normal !important",a.style.lang="unknown"),n.ft=a,n.Qt=a.li;const l=n.Qt;n.Vi=n.computePixelRatio(),n.viewSize.isReal()||(n.xt=n.St.clientWidth||1,n.bt=n.St.clientHeight||1),n.EL(n.xt,n.bt);const h=n;n.St.insertBefore(a.Tt,n.St.firstChild);const u=new Bt(null);if(u.width=1,u.height=1,n.$F=u,n.ZF=u.li,vt.isUsingDOM()){const t=e.hs("div"),i=e.hs("div");t.style.position="absolute",t.style.overflow="auto",t.style.width=n.xt+"px",t.style.height=n.bt+"px",t.style.zIndex="1",i.style.position="absolute",i.style.width="1px",i.style.height="1px",n.St.appendChild(t),t.appendChild(i),t.onscroll=vt.aR,t.addEventListener("pointerdown",vt.cR),t.N=n,t.fR=!0,t.uR=!0,n.lb=t,n.hb=i}n.mu=e.Fk((()=>{n.kl=null,n.S()}),300,!1),n.cb=e.Fk((()=>{n.OS()}),250,!1),n.Gh=t=>(t.preventDefault(),!1),n.ea=t=>{if(!h.isEnabled)return;const e=h.zc(t,!0);e.bubbles=!0;let i=0,n=0;e.delta=0,void 0!==t.deltaX?(0!==t.deltaX&&(i=t.deltaX>0?1:-1),0!==t.deltaY&&(n=t.deltaY>0?1:-1),e.delta=Math.abs(t.deltaX)>Math.abs(t.deltaY)?-i:-n):void 0!==t.wheelDeltaX?(0!==t.wheelDeltaX&&(i=t.wheelDeltaX>0?-1:1),0!==t.wheelDeltaY&&(n=t.wheelDeltaY>0?-1:1),e.delta=Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)?-i:-n):void 0!==t.wheelDelta&&0!==t.wheelDelta&&(e.delta=t.wheelDelta>0?1:-1),h.doMouseWheel(),h.la(e,t)},n.LL=t=>{if(!h.isEnabled)return;n.Bc=!1,h.zc(t,!0);const e=h.currentTool;e.cancelWaitAfter(),e.standardMouseOver()},n.$l=t=>{if(!h.isEnabled)return;n.Bc=!0;const e=h.rb;void 0===e[t.pointerId]&&(e[t.pointerId]=t);const i=h.ia;let s=!1;if(null===i[0]||i[0].pointerId!==t.pointerId&&i[0].pointerType===t.pointerType)if(null!==i[1]&&i[1].pointerId===t.pointerId)i[1]=t,s=!0;else if(null===i[0])i[0]=t;else{if(null!==i[1])return void t.preventDefault();i[1]=t,s=!0}else i[0]=t;const o="touch"===t.pointerType||"pen"===t.pointerType;o&&(h.Ew=!1,h.jm=!0);const r=h.dR(t,t,s),a=h.xM,l=o?25:10;t.timeStamp-h.wM<h.CL&&!(Math.abs(a.x-t.screenX)>l||Math.abs(a.y-t.screenY)>l)?h.Hm++:h.Hm=1,r.clickCount=h.Hm,h.wM=t.timeStamp,h.xM.setTo(t.screenX,t.screenY),h.doMouseDown(),1!==t.button?h.la(r,t):t.preventDefault()},n.sa=t=>{if(!h.isEnabled)return;n.Bc=!0;const e=h.ia;if(null===e[0]||e[0].pointerId!==t.pointerId&&e[0].pointerType===t.pointerType){if(null!==e[1]&&e[1].pointerId===t.pointerId)return void(e[1]=t);if(null!==e[0])return;e[0]=t}else e[0]=t;if(e[0].pointerId!==t.pointerId)return;const i=h.gR(t,t,null!==e[1]);h.doMouseMove(),h.la(i,t)},n.na=e=>{if(!h.isEnabled)return;n.Bc=!0;const i="touch"===e.pointerType||"pen"===e.pointerType,s=h.rb;if(i&&h.Ew)return delete s[e.pointerId],void e.preventDefault();const o=h.ia;if(null===o[0]||o[0].pointerId!==e.pointerId&&o[0].pointerType===e.pointerType)return null!==o[1]&&o[1].pointerId===e.pointerId?void(o[1]=null):void 0;o[0]=null;const r=h.AM(e,!1,!0,!1,!0,!1);let a=t.document.elementFromPoint(e.clientX,e.clientY)||null;null!==a&&void 0!==a.shadowRoot&&null!==a.shadowRoot&&(a=a.shadowRoot.elementFromPoint(e.clientX,e.clientY)),null!==a&&a.N instanceof vt&&a.N!==h&&a.N.Qm(e,r),null===a&&(a=e.target),h.Qm(e,r),r.clickCount=h.Hm,r.targetDiagram=h.xb(e,a),r.targetObject=null,h.doMouseUp(),h.la(r,e),i&&(h.jm=!1)},n.oa=t=>{if(!h.isEnabled)return;n.Bc=!1;const e=h.rb;e[t.pointerId]&&delete e[t.pointerId];const i=h.ia;if(null!==i[0]&&i[0].pointerId===t.pointerId&&(i[0]=null),null!==i[1]&&i[1].pointerId===t.pointerId&&(i[1]=null),"touch"===t.pointerType||"pen"===t.pointerType)return;const s=h.currentTool;s.cancelWaitAfter(),s.standardMouseOver()},n.ra=t=>{const e=h.ia;null!==e[0]&&e[0].pointerId===t.pointerId?(e[0]=null,h.jm=!1):null!==e[1]&&e[1].pointerId===t.pointerId&&(e[1]=null)};const c=l;if(n.ab=c.E[e.Ts("7eba17a4ca3b1a8346")][e.Ts("78a118b7")](c.E,vt.Xu,o,o),l.clearContextCache(!0),n.mR(),"svg"===this.Oc){const t=this.ql.get("svg");this.St&&this.St.appendChild(t.Tt),this.Qt=t.li}}addEventListener(t,e,i,n){t.addEventListener(e,i,{capture:n,passive:!1})}Bt(t,e,i,n){t.addEventListener(e,i,{capture:n,passive:!1})}removeEventListener(t,e,i,n){t.removeEventListener(e,i,{capture:n})}Pi(t,e,i,n){t.removeEventListener(e,i,{capture:n})}mR(){const e=this;let i=this.ft.Tt;i instanceof HTMLCanvasElement||(i=e.div),this.Bt(i,"pointerdown",e.$l,!1),this.Bt(i,"pointermove",e.sa,!1),this.Bt(i,"pointerup",e.na,!1),this.Bt(i,"pointerout",e.oa,!1),this.Bt(i,"pointercancel",e.ra,!1),this.Bt(i,"pointerenter",e.pR,!1),this.Bt(i,"pointerleave",e.yR,!1),this.Bt(i,"wheel",e.ea,!1),this.Bt(i,"keydown",e.wR,!1),this.Bt(i,"keyup",e.xR,!1),this.Bt(i,"blur",e.bR,!1),this.Bt(i,"focus",e.kR,!1),this.Bt(i,"selectstart",(t=>(t.preventDefault(),!1)),!1),this.Bt(i,"contextmenu",(t=>(t.preventDefault(),!1)),!1),this.Bt(t,"resize",e.cb,!1)}Bw(){this.qm>30&&(this.kl=1)}NP(t){null!==this.kl&&(this.kl=null,t&&this.mu(),this.qm=0,this.PM=[0,0,0,0,0],this.Wm=0)}computePixelRatio(){return null!==this.kl?this.kl:t.devicePixelRatio||1}get avgSpf(){return this.qm}doMouseDown(){this.currentTool.doMouseDown()}doMouseMove(){this.currentTool.doMouseMove()}doMouseUp(){this.currentTool.doMouseUp()}doMouseWheel(){this.currentTool.doMouseWheel()}doKeyDown(){this.currentTool.doKeyDown()}doKeyUp(){this.currentTool.doKeyUp()}doFocus(){this.focus()}focus(){if(this.ft)if(this.scrollsPageOnFocus)this.ft.focus();else{const e=t.scrollX,i=t.scrollY;this.ft.focus(),t.scrollTo(e,i)}}kR(t){const e=vt.Qe.get(this);e&&e.D("GainedFocus")}bR(t){const e=vt.Qe.get(this);e&&e.D("LostFocus")}OS(){if(null===this.ft)return;const t=this.St;if(null===t||0===t.clientWidth||0===t.clientHeight)return;this.JS||this.setScrollWidth();const e=this.Gn?this.Wt:0,i=this.ln?this.Wt:0,n=this.Vi;if(this.Vi=this.computePixelRatio(),this.Vi!==n&&(this.Du=!0,this.requestUpdate()),t.clientWidth!==this.xt+e||t.clientHeight!==this.bt+i){this.ha(),this.Be=!0;const t=this.layout;null!==t&&t.isViewportSized&&1===this.autoScale&&(this.vc=!0,t.invalidateLayout()),this.ys||this.requestUpdate()}}FL(){let t=0,e=new gt;e.name="Grid",e.allowSelect=!1,e.pickable=!1,e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new gt,e.name="ViewportBackground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new gt,e.name="Background",this.zr(e,t++),e=new gt,e.name="",this.zr(e,t++),e=new gt,e.name="Foreground",this.zr(e,t++),e=new gt,e.name="ViewportForeground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new gt,e.name="Adornment",e.isTemporary=!0,e.isInDocumentBounds=!1,this.zr(e,t++),e=new gt,e.name="Tool",e.isTemporary=!0,e.isInDocumentBounds=!0,this.zr(e,t++)}BL(){const t=new Yt(Yt.Grid,{name:"GRID"}).add(new Jt("LineH",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new Jt("LineV",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new Jt("LineH",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new Jt("LineV",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new Jt("LineH",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor"),new Jt("LineV",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor")),e=new ce({layerName:"Grid",zOrder:0,isInDocumentBounds:!1,isAnimated:!1,pickable:!1,locationObjectName:"GRID"}).add(t);return this.add(e),this.partManager.parts.delete(e),t.visible=!1,t}static aR(){const t=vt.Qe.get(this.parentElement||this);if(t){if(t.Qx)return void(t.Qx=!1);if(!t.isEnabled)return void t.UL();t.diagramScroll(this)}}static cR(t){this.N.isEnabled?(this.N._x=t.target.scrollTop,this.N.tb=t.target.scrollLeft):this.N.updateScroll()}diagramScroll(t){if(null===this.ft)return;const e=this.lb,i=this.hb;this.Um=!0;let n=this.documentBounds,s=this.viewportBounds;const o=this.Jh;let r=n.x-o.left,a=n.y-o.top;const l=n.width+o.left+o.right,h=n.height+o.top+o.bottom;let u=n.right+o.right,c=n.bottom+o.bottom,d=s.x,f=s.y;const g=s.width,p=s.height;let m=s.right,x=s.bottom;const v=this.scale;let b,w=t.scrollLeft;if(this.zu)switch(this.kx){case"negative":w=w+t.scrollWidth-t.clientWidth;break;case"reverse":w=t.scrollWidth-w-t.clientWidth}const k=w;if(g<l||p<h)return b=y.V(this.position.x,this.position.y),this.allowHorizontalScroll&&this.tb!==k&&(b.x=k/v+r,this.tb=k),this.allowVerticalScroll&&this._x!==t.scrollTop&&(b.y=t.scrollTop/v+a,this._x=t.scrollTop),this.position=b,y.e(b),this.Um=!1,void(this.Ou=!1);if(b=y.l(),t.fR&&this.allowHorizontalScroll&&(r<d&&(this.position=b.i(k+r,this.position.y)),u>m)){const t=e.scrollWidth-this.xt;this.position=b.i(-t+k-this.xt/v+u,this.position.y)}if(t.uR&&this.allowVerticalScroll&&(a<f&&(this.position=b.i(this.position.x,t.scrollTop+a)),c>x)){const i=e.scrollHeight-this.bt;this.position=b.i(this.position.x,-i+t.scrollTop-this.bt/v+c)}y.e(b),this.Ql(),this.Um=!1,this.Ou=!1,n=this.documentBounds,s=this.viewportBounds,u=n.right,m=s.right,c=n.bottom,x=s.bottom,r=n.x,d=s.x,a=n.y,f=s.y,g>=l&&r>=d&&u<=m&&(i.style.width="1px"),p>=h&&a>=f&&c<=x&&(i.style.height="1px")}computeBounds(t){return void 0===t&&(t=new v),this.Mi(),this.VL(t)}VL(t){if(this.fixedBounds.isReal())return t.a(this.fixedBounds),t.addMargin(this.Zt),t;let e=!0;const i=this.Xt.r,n=i.length;for(let s=0;s<n;s++){const n=i[s];if(!n.visible||!n.isInDocumentBounds)continue;const o=n.Ct.r,r=o.length;for(let i=0;i<r;i++){const n=o[i];if(!n.isInDocumentBounds||!n.isVisible())continue;const s=n.actualBounds;s.isReal()&&(e?(e=!1,t.a(s)):t.unionRect(s))}}return e&&t.i(0,0,0,0),t.addMargin(this.Zt),t}computePartsBounds(t,e){void 0===e&&(e=!1);let i=null;if(Array.isArray(t))for(let n=0;n<t.length;n++){const s=t[n];!e&&s instanceof be||(s.ensureBounds(),null===i?i=s.actualBounds.copy():i.unionRect(s.actualBounds))}else{const n=t.iterator;for(;n.next();){const t=n.value;!e&&t instanceof be||(t.ensureBounds(),null===i?i=t.actualBounds.copy():i.unionRect(t.actualBounds))}}return null===i?new v(NaN,NaN,0,0):i}Us(t){if(!t&&!this.Hn||this.jt||null===this.ft||!this.documentBounds.isReal())return;if(this.jt=!0,t){const t=this.initialPosition;if(t.isReal())return this.jt=!1,void(this.position=t);let e=this.initialDocumentSpot,i=this.initialViewportSpot;e.isNoSpot()&&(e=w.TopLeft),i.isNoSpot()&&(i=w.TopLeft);const n=y.l();n.setRectSpot(this.documentBounds,e);const s=this.viewportBounds,o=v.V(0,0,s.width,s.height),r=y.l();r.setRectSpot(o,i),r.i(n.x-r.x,n.y-r.y),this.jt=!1,this.position=r,v.e(o),y.e(r)}let e=this.Gl;t&&1!==this.Pr&&(e=this.Pr);const i=1!==e?this.Yu(e):this.scale,n=this.at.x,s=this.at.y,o=this.xt/i,r=this.bt/i;let a=this.Fc;const l=this.Om;if(t&&!a.isSpot()&&(l.isSpot()||l.isDefault())){const t=this.initialDocumentSpot.isSpot()&&this.initialViewportSpot.isSpot();a=l.isDefault()&&!t?w.Center:l}this.TM(this.documentBounds,o,r,a,t);const h=this.scale;this.scale=i,this.jt=!1;const u=this.viewportBounds;u.equalsApproxTo(n,s,o,r)||this.onViewportBoundsChanged(new v(n,s,o,r),u,h,!1)}Yu(t){const e=this.Gm;if(null===this.ft)return e;if(1===t)return this.scale;this.ensureBounds();const i=this.documentBounds;if(!i.isReal())return e;const n=i.width,s=i.height,o=this.xt+(this.Gn?this.Wt:0),r=this.bt+(this.ln?this.Wt:0);let a=o/n,l=r/s;const h=this.Jh,u=h.left+h.right!==0,c=h.top+h.bottom!==0;(u||c)&&(l===a?(l=(r-this.Wt)/s,a=(o-this.Wt)/n):l>a?l=(r-this.Wt)/s:a=(o-this.Wt)/n);let d=0;return 2===t?d=Math.min(l,a):3===t&&(d=l>a?(r-this.Wt)/s:(o-this.Wt)/n),d>e&&(d=e),d<this.minScale&&(d=this.minScale),d>this.maxScale&&(d=this.maxScale),d}zoomToFit(){const t=this.jh;this.jh=1,this.scale=this.Yu(2),this.alignDocument(w.Center,w.Center),1!==t&&(this.Us(!1),this.TM(this.documentBounds,this.xt/this.tt,this.bt/this.tt,this.Fc,!1)),this.jh=t}zoomToRect(t,e){void 0===e&&(e=2);const i=t.width,n=t.height;if(0===i||0===n||isNaN(i)&&isNaN(n))return;let s=1;if(2===e||3===e)if(isNaN(i))s=this.viewportBounds.height*this.scale/n;else if(isNaN(n))s=this.viewportBounds.width*this.scale/i;else{const t=this.xt,o=this.bt;s=3===e?o/n>t/i?(o-(this.ln?this.Wt:0))/n:(t-(this.Gn?this.Wt:0))/i:Math.min(o/n,t/i)}this.scale=s,this.position=new y(t.x,t.y)}get PR(){return this.jt}set PR(t){this.jt=t}alignDocument(t,e){this.ensureBounds();const i=this.documentBounds,n=this.viewportBounds;this.position=new y(i.x+(t.x*i.width+t.offsetX)-(e.x*n.width-e.offsetX),i.y+(t.y*i.height+t.offsetY)-(e.y*n.height-e.offsetY))}focusObject(t){if(t instanceof At){this.Jm=t;const e=y.l();this.$m=this.transformDocToView(t.getDocumentPoint(w.TopLeft,e)),y.e(e)}else this.Jm=null,this.$m=y.Ok}TM(t,e,i,n,s){const o=y.V(this.at.x,this.at.y);let r=o.x,a=o.y;if(null!==this.Jm){let t=y.l();t=this.Jm.getDocumentPoint(w.TopLeft,t),r=t.x-this.$m.x/this.scale,a=t.y-this.$m.y/this.scale,n=w.None,y.e(t)}if(s||1===this.scrollMode){n.isSpot()&&(e>t.width&&(r=t.x+(n.x*t.width+n.offsetX)-(n.x*e-n.offsetX)),i>t.height&&(a=t.y+(n.y*t.height+n.offsetY)-(n.y*i-n.offsetY)));const s=this.Jh,o=e-t.width;if(e<t.width+s.left+s.right){let i=r+e/2;i=Math.min(i,t.right+Math.max(o,s.right)-e/2),i=Math.max(i,t.left-Math.max(o,s.left)+e/2),r=i-e/2}else r>t.left?r=t.left:r<t.right-e&&(r=t.right-e);const l=i-t.height;if(i<t.height+s.top+s.bottom){let e=a+i/2;e=Math.min(e,t.bottom+Math.max(l,s.bottom)-i/2),e=Math.max(e,t.top-Math.max(l,s.top)+i/2),a=e-i/2}else a>t.top?a=t.top:a<t.bottom-i&&(a=t.bottom-i)}if(o.x=isFinite(r)?r:-this.Zt.left,o.y=isFinite(a)?a:-this.Zt.top,null!==this.positionComputation){const t=this.positionComputation(this,o);o.x=t.x,o.y=t.y}this.ds.pL(this.at,o),this.at.i(o.x,o.y),this.bb(),this.Zl(),this.SR(),y.e(o)}findPartAt(t,e){if(void 0===e&&(e=!0),e){const e=this.DP(t,(t=>t.part),(t=>t.canSelect()));if(e instanceof ce)return e}else{const e=this.DP(t,(t=>t.part));if(e instanceof ce)return e}return null}findObjectAt(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Mi();const n=this.Xt.iteratorBackwards;for(;n.next();){const s=n.value;if(!s.visible)continue;const o=s.findObjectAt(t,e,i);if(null!==o)return o}return null}DP(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Mi();const n=this.Xt.iteratorBackwards;for(;n.next();){const s=n.value;if(!s.visible||s.isTemporary)continue;const o=s.findObjectAt(t,e,i);if(null!==o)return o}return null}findPartsAt(t,e,i){return void 0===e&&(e=!0),this.MR(t,(t=>t.part),e?t=>t instanceof ce&&t.canSelect():null,i)}MR(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof l)&&!(n instanceof u)&&(n=new u),this.Mi();const s=this.Xt.iteratorBackwards;for(;s.next();){const o=s.value;!o.visible||o.isTemporary||o.findObjectsAt(t,e,i,n)}return n}findObjectsAt(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof l)&&!(n instanceof u)&&(n=new u),this.Mi();const s=this.Xt.iteratorBackwards;for(;s.next();){const o=s.value;o.visible&&o.findObjectsAt(t,e,i,n)}return n}findPartsIn(t,e,i,n){return void 0===e&&(e=!1),void 0===i&&(i=!0),this.NR(t,null,(t=>t instanceof ce&&(!i||t.canSelect())),e,n)}findObjectsIn(t,e,i,n,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof l)&&!(s instanceof u)&&(s=new u),this.Mi();const o=this.Xt.iteratorBackwards;for(;o.next();){const r=o.value;r.visible&&r.findObjectsIn(t,e,i,n,s)}return s}vP(t,e,i,n,s,o){const r=new u;this.Mi();const a=this.Xt.iteratorBackwards;for(;a.next();){const l=a.value;l.visible&&l.vP(t,e,i,n,r,s,o)}return r}NR(t,e,i,n,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof l)&&!(s instanceof u)&&(s=new u),this.Mi();const o=this.Xt.iteratorBackwards;for(;o.next();){const r=o.value;!r.visible||r.isTemporary||r.findObjectsIn(t,e,i,n,s)}return s}findPartsNear(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),this.CR(t,e,null,(t=>t instanceof ce&&(!n||t.canSelect())),i,s)}findObjectsNear(t,e,i,n,s,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof l||s instanceof u)&&(o=s),s=!0),!(o instanceof l)&&!(o instanceof u)&&(o=new u),this.Mi();const r=this.Xt.iteratorBackwards;for(;r.next();){const a=r.value;a.visible&&a.findObjectsNear(t,e,i,n,s,o)}return o}CR(t,e,i,n,s,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof l||s instanceof u)&&(o=s),s=!0),!(o instanceof l)&&!(o instanceof u)&&(o=new u),this.Mi();const r=this.Xt.iteratorBackwards;for(;r.next();){const a=r.value;!a.visible||a.isTemporary||a.findObjectsNear(t,e,i,n,s,o)}return o}acceptEvent(t){return this.zc(t,t instanceof MouseEvent)}zc(t,i){const n=this.Br;this.Br=this.Qh,this.Qh=n,n.diagram=this,n.event=t,i?this.Qm(t,n):(n.viewPoint=this.Br.viewPoint,n.documentPoint=this.Br.documentPoint);let s=0;const o=t;return o.ctrlKey&&(s+=1),o.altKey&&(s+=2),o.shiftKey&&(s+=4),o.metaKey&&(s+=8),n.modifiers=s,n.button=o.button,void 0!==o.buttons&&(n.buttons=o.buttons),e._o&&0===o.button&&o.ctrlKey&&(n.button=2),n.down=!1,n.up=!1,n.clickCount=1,n.delta=0,n.handled=!1,n.bubbles=!1,n.timestamp=t.timeStamp,n.isMultiTouch=!1,n.targetDiagram=this.xb(t,t.target),n.targetObject=null,n}xb(t,i){if(null===i)return null;const n=vt.Qe.get(i);if(n)return n;let s=t.path;if(!s&&e.it(t.composedPath)&&(s=t.composedPath()),s&&s[0]){const t=vt.Qe.get(s[0]);if(t)return t}return null}dR(t,e,i){const n=this.AM(t,!0,!1,!1,!0,i);return this.Qm(e,n),n.targetDiagram=this.xb(t,t.target),n.targetObject=null,i||n.clone(this.Km),n}gR(e,i,n){const s=this.AM(e,!1,!1,!1,!1,n);let o=t.document.elementFromPoint(i.clientX,i.clientY)||null;null!==o&&void 0!==o.shadowRoot&&null!==o.shadowRoot&&(o=o.shadowRoot.elementFromPoint(i.clientX,i.clientY));let r=this,a=e;if(o){const t=this.xb(e,o);t&&(a=i,r=t)}return s.targetDiagram=r,this.Qm(a,s),s.targetObject=null,s}AM(t,i,n,s,o,r){const a=this.Br;this.Br=this.Qh,this.Qh=a,a.diagram=this,a.clickCount=1,a.delta=0;let l=0;return t.ctrlKey&&(l+=1),t.altKey&&(l+=2),t.shiftKey&&(l+=4),t.metaKey&&(l+=8),a.modifiers=l,a.event=t,a.timestamp=t.timeStamp,a.button=n?this.firstInput.button:t.button,a.buttons=t.buttons,e._o&&0===t.button&&t.ctrlKey&&(a.button=2),a.down=i,a.up=n,a.handled=s,a.bubbles=o,a.isMultiTouch=r,a}la(t,e){return!!t.bubbles||(void 0!==e.stopPropagation&&e.stopPropagation(),!1!==e.cancelable&&e.preventDefault(),e.cancelBubble=!0,!1)}wR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!1);return i.key=t.key,i.code=t.code,i.down=!0,e.doKeyDown(),e.la(i,t)}xR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!1);return i.key=t.key,i.code=t.code,i.up=!0,e.doKeyUp(),e.la(i,t)}pR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!0);return null!==e.mouseEnter&&e.mouseEnter(i),e.currentTool.standardMouseOver(),e.la(i,t)}yR(t){const e=vt.Qe.get(this);if(!e||!e.isEnabled)return!1;const i=e.zc(t,!0);return null!==e.mouseLeave&&e.mouseLeave(i),e.la(i,t)}getMouse(t){const e=this.ft;if(null===e)return new y(0,0);const i=e.getBoundingClientRect(),n=(t.clientX-i.left)*(this.xt/i.width),s=(t.clientY-i.top)*(this.bt/i.height);return new y(n,s).Oe(this.T)}Qm(t,e){const i=this.ft;let n=0,s=0;if(null!==i){const e=i.getBoundingClientRect();n=(t.clientX-e.left)*(this.xt/e.width),s=(t.clientY-e.top)*(this.bt/e.height)}e.viewPoint.i(n,s);const o=y.V(n,s);this.T.$e(o),e.documentPoint.a(o),y.e(o)}UC(t,e,i){let n;if(null===this.ia[0])return;n=this.ia[e];const s=this.ft;if(null!==s){const t=s.getBoundingClientRect();i.i((n.clientX-t.left)*(this.xt/t.width),(n.clientY-t.top)*(this.bt/t.height))}}invalidateDocumentBounds(){this._h||(this._h=!0,this.requestUpdate(!1))}LR(){this.ys||this.Mi(),this.ensureBounds()}redraw(){this.jt||this.ys||(this.S(),this.maybeUpdate())}isUpdateRequested(){return this.wr}delayInitialization(t){void 0===t&&(t=null);const i=this.animationManager,n=i.isEnabled;i.stopAnimation(),i.isEnabled=!1,this.fr(),this.Hn=!1,this.ix=new y(NaN,NaN),i.isEnabled=n,this.ys=!0;const s=this;null!==t&&e.tr((()=>{s.ys=!1,i.Dl("Model"),t(s)}),1)}requestUpdate(e){if(void 0===e&&(e=!1),!0===this.wr||this.jt||!1===e&&this.ys)return;this.wr=!0;const i=this;t.requestAnimationFrame((()=>{i.wr&&i.maybeUpdate()}))}maybeUpdate(){this.Fu&&!this.wr||(this.Fu&&(this.Fu=!1),this.fr())}DM(t,e){!this.Ou||this.jt||this.animationManager.defaultAnimation.isAnimating||this.UL()||(t&&this.Mi(),e&&this.Us(!1))}fr(t){if(this.ys||(this.wr=!1,null===this.St&&!this.Iu.isReal()))return;this.ys=!0;const e=this.animationManager,i=this.Vu;if(!e.isAnimating&&0!==i.length){const t=i.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e.ue(!1),e.c()}i.clear()}const n=this.yM;n.count>0&&(n.each((t=>t.FM())),n.clear());let s=!1,o=!1;e.defaultAnimation.isAnimating&&(o=!0,s=this.skipsUndoManager,this.skipsUndoManager=!0),e.pi||this.OS(),t||this.DM(!1,!0);const r=!this.undoManager.isUndoingRedoing&&(this.xl||0!==this.Vc.count&&0!==this.Sr.size),a=!this.Hn||this.Ur;this.Mi(!0);let l=!1;(a||r)&&(this.Hn?this.RM(!this.vc,r):(this.startTransaction("Initial Layout"),!1===e.isEnabled&&e.stopAnimation(),this.RM(!1,r)),l=a),this.vc=!1,this.xl=!1,this.Mi(),null!==this.Ze&&(this.Ze.visible&&!this.Eu&&(this._l(),this.Eu=!0),!this.Ze.visible&&this.Eu&&(this.Eu=!1)),this.zx||this.LR(),t||this.DM(!0,!1);let h=!1;if(l){const e=v.l();e.a(this.viewportBounds),this.Hn||(this.Hn=!0,h=!0,this.skipsUndoManager||(this.undoManager.Ow=!0),this.undoManager.Iw=!0,this.AR()),this.TR(),this.Mi(!1),t||this.DM(!0,!0),v.e(e)}else if(e.Sc&&e.tx){if(1!==this.Pr)this.scale=this.Yu(this.Pr);else if(1!==this.Gl)this.scale=this.Yu(this.Gl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Us(!0)}l&&h&&this.commitTransaction("Initial Layout"),t||this.Bi(this.Qt),o&&(this.skipsUndoManager=s),this.ys=!1}get Uh(){return this.Hn}AR(){if(1!==this.Pr)this.scale=this.Yu(this.Pr);else if(1!==this.Gl)this.scale=this.Yu(this.Gl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Us(!0);const t=this.Xt.r;this.ps(t,t.length,this,this.viewportBounds),this.D("InitialLayoutCompleted"),this.ix.a(this.at),this._l()}TR(){this.D("LayoutCompleted")}_m(t){this.Yn.add(t)}addInvalidRoute(t){this.No?this.$h.add(t):this.Sr.add(t)}Mi(t){if(0!==this.Yn.size&&(this.ys||!this.animationManager.isTicking)){if(this.ys||(this.xl=!0),t)return void this.zL(this.Yn);for(let t=0;t<23&&0!==this.Yn.size;t++){const t=new Set(this.Yn);this.Yn.clear(),this.FM(t,this.Yn)}this.nodes.each((t=>{t instanceof Ne&&t.XL(!1)}))}}zL(t,e){for(const i of t)!i.ke()||i instanceof Ne||(i.Xr()?(i.ht(1/0,1/0),i.Ut()):e&&e.add(i));for(const i of t)if(i instanceof Ne){if(!i.isVisible())continue;this.kb(i)}}FM(t,e){this.zL(t,e);for(const i of t){if(!(i instanceof be))continue;const t=i;t.isVisible()&&(t.Xr()?(t.ht(1/0,1/0),t.Ut()):e.add(t))}for(const i of t)i instanceof fe&&i.isVisible()&&(i.Xr()?(i.ht(1/0,1/0),i.Ut()):e.add(i))}t0(t){const e=t instanceof vt,i=e?t.links:t.memberParts,n=this.Yn;if(e)this.Mi(!0);else{for(;i.next();){const t=i.value;n.has(t)&&(!t.ke()||t instanceof Ne||t.Xr()&&(t.ht(1/0,1/0),t.Ut()))}for(i.reset();i.next();){const t=i.value;if(n.has(t)&&t instanceof Ne){if(!t.isVisible())continue;this.kb(t)}}i.reset()}for(;i.next();){const t=i.value;t instanceof be&&n.has(t)&&t.isVisible()&&t.Xr()&&(t.ht(1/0,1/0),t.Ut())}}kb(t){const i=e.et(),n=e.et(),s=t.memberParts;for(;s.next();){const e=s.value;e.isVisible()&&(e instanceof Ne?(e.Ao()||e._e()||e.th())&&this.kb(e):e instanceof be?e.fromNode===t||e.toNode===t?n.push(e):i.push(e):(e.ht(1/0,1/0),e.Ut()))}let o=i.length;for(let e=0;e<o;e++){const t=i[e];t.ht(1/0,1/0),t.Ut()}e.J(i),t.ht(1/0,1/0),t.Ut(),o=n.length;for(let e=0;e<o;e++){const t=n[e];t.ht(1/0,1/0),t.Ut()}e.J(n)}ps(t,e,i,n){if(this.Ic||this.animationManager.isAnimating){for(let s=0;s<e;s++)t[s].ps(i,n);this.Mi()}}Bi(t){null!==this.St&&(null===this.ft&&e.o("No canvas specified"),"svg"===this.Oc?this.DR(t):this.FR(t))}FR(t){const e=this.animationManager;if(e.pi||e.isAnimating&&!e.isTicking)return;const i=new Date;if(this.i0(),this.St&&"0"===this.St.style.opacity)return;const n=t!==this.Qt,s=this.Xt.r,o=s.length,r=this;if(this.ps(s,o,r,r.viewportBounds),n)t.clearContextCache(!0),this.Ql();else if(!this.Be&&!e.isAnimating)return;const a=this.T,l=this.Vi;t.setTransform(l,0,0,l,0,0),t.clearRect(0,0,this.xt,this.bt),1!==this.$t&&(t.globalAlpha=this.$t),this.vM(t);for(let f=0;f<o;f++)t.setTransform(l,0,0,l,0,0),t.transform(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),t.commitTransform(),s[f].Bi(t,r);let h=!1;this.Uc?this.Uc.Xu(this)&&(h=this.ab()):h=!0,h&&(k.prototype.$e=k.prototype.xw),n?(this.Qt.clearContextCache(!0),this.Ql()):(this.Ic=!1,this.Be=!1);const u=+new Date-+i,c=!1,d=this.PM;if(null===this.kl){d[this.Wm]=u,this.Wm=(this.Wm+1)%d.length;let t=0;for(let e=0;e<d.length;e++)t+=d[e];this.qm=t/d.length}1!==this.$t&&(t.globalAlpha=1)}DR(t){if(null===this.St)return;const e=this.animationManager;if(e.pi||e.isAnimating&&!e.isTicking)return;this.i0();const i=this.xt,n=this.bt;t.surface.resize(i,n,i,n);const s=this.Xt.r,o=s.length,r=this;if(this.ps(s,o,r,r.viewportBounds),!this.Be&&!e.isAnimating)return;const a=this.T;t.lastDrawnPart=null,t.setDiagramPosScale(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),1!==this.$t&&(t.globalAlpha=this.$t),this.vM(t);const l=this.Vi;this.ft.li.setTransform(l,0,0,l,0,0),this.ft.li.clearRect(0,0,this.xt,this.bt);for(let u=0;u<o;u++)s[u].Bi(t,r);let h=!1;this.Uc?this.Uc.Xu(this)&&(h=this.ab()):h=!0,h&&(k.prototype.$e=k.prototype.xw),this.Ic=!1,this.Be=!1}Pb(t,i,n,s,o,r,a,l,h){if(null===this.St)return;null===this.ft&&e.o("No canvas specified"),void 0===r&&(r=null),void 0===a&&(a=null),void 0===l&&(l=!1),void 0===h&&(h=!1),this.i0(),this.Qt.clearContextCache(!0),this.Ql(),this.ta=!0;const c=this.tt;this.tt=s;const d=this,f=this.Xt.r,g=f.length;try{const e=new v(o.x,o.y,n.width/s,n.height/s),c=e.copy();c.addMargin(i),this._l(c),this.Mi(),this.ps(f,g,d,e),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,n.width,n.height),null!==a&&""!==a&&(t.fillStyle=a,t.fillBackground(0,0,n.width,n.height));const p=this.Vi;t.scale(p,p);const m=k.l();m.Ri(),m.Fs(i.left,i.top),m.tt(s),(0!==o.x||0!==o.y)&&m.Fs(-o.x,-o.y),t.setTransform(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),t.commitTransform(),t instanceof Rt&&t.setDiagramPosScale(m.m11,m.m12,m.m21,m.m22,m.dx,m.dy),k.e(m),this.vM(t),t.globalAlpha=this.$t;const y=this.findLayer("Grid");if(r){const e=new u,i=r.iterator;for(i.reset();i.next();){const t=i.value;t instanceof ce&&(!h&&t.layer===y||(t.Au(),e.add(t)))}for(let n=0;n<g;n++)f[n].YF(t,d,e,l);e.each((t=>t.Au()))}else for(let i=0;i<g;i++){const e=f[i];e===y?h&&e.Bi(t,d,!0):e.Bi(t,d,l)}this.ta=!1,this.Uc&&this.Uc.Xu(this)&&this.ab()}finally{this.tt=c,this.Qt.clearContextCache(!0),this.Ql(),this.ps(f,g,d,d.viewportBounds),this._l(),this.Qt instanceof Rt&&(this.Qt.diagramGroup.replaceChildren(),this.redraw())}}getRenderingHint(t){return this.kr[t]}setRenderingHint(t,e){"minDrawingLength"===t&&(this.Fm=e),this.kr[t]=e,this.redraw()}resetRenderingHints(){this.kr=new n,this.kr.drawShadows=!0,this.kr.textGreeking=!0,this.kr.viewportOptimizations=!e._o,this.kr.temporaryPixelRatio=!0,this.kr.pictureRatioOptimization=!0,this.kr.minDrawingLength=1,this.Fm=1}vM(t){const e=this.kr;if(null===e)return;if(void 0!==e.imageSmoothingEnabled){const i=!!e.imageSmoothingEnabled;t.setImageSmoothingEnabled(i)}const i=e.defaultFont;null!=i&&(t.font=i)}getInputOption(t){return this.Tu[t]}setInputOption(t,e){this.Tu[t]=e}nR(){this.Tu=new n,this.Tu.extraTouchArea=10,this.Tu.extraTouchThreshold=10,this.Tu.hasGestureZoom=!0}set(t){return Object.assign(this,t),this}attach(t){return this.setProperties(t)}setProperties(t){return vt.e0(this,t),this}static e0(t,i){const n=t instanceof Yt,s=t instanceof vt;for(const o in i){""===o&&e.o("Setting properties requires non-empty property names");let r=t,a=o;if(n||s){const i=o.indexOf(".");if(i>0){const s=o.substring(0,i);n?r=t.findObject(s):(r=t[s],null==r&&(r=t.toolManager[s])),e.K(r)?a=o.substring(i+1):e.o("Unable to find object named: "+s+" in "+t.toString()+" when trying to set property: "+o)}}if("_"!==a[0]&&!e.uw(r,a)){if(s&&"ModelChanged"===a){t.addModelChangedListener(i[a]);continue}if(s&&"Changed"===a){t.addChangedListener(i[a]);continue}if(s&&e.uw(t.toolManager,a))r=t.toolManager;else{if(s&&t.YL(a)){t.addDiagramListener(a,i[a]);continue}if(t instanceof Ue&&"Changed"===a){t.addChangedListener(i[a]);continue}e.o('Trying to set undefined property "'+a+'" on object: '+r.toString())}}const l=i[o];r[a]=l,"_"===a[0]&&r instanceof At&&r.addCopyProperty(a)}}xL(){if(0!==this.Jl.count&&!(this.undoManager.transactionLevel>1)){for(;this.Jl.count>0;){const t=this.Jl;this.Jl=new m;const e=t.iterator;for(;e.next();){const t=e.key;t.invalidateOtherJumpOvers(e.value),t.ee()}}this.S()}}S(t){if(void 0===t)this.Be=!0,this.requestUpdate();else{const e=this.viewportBounds;t.isReal()&&e.intersectsRect(t)&&(this.Be=!0,this.requestUpdate())}this.D("InvalidateDraw")}invalidateViewport(t,e){!0!==this.Be&&(this.Be=!0,"svg"!==this.Oc&&!0===this.getRenderingHint("temporaryPixelRatio")?(this.Bw(),this.maybeUpdate(),this.NP(!0)):this.maybeUpdate())}ha(){this.Ou=!0}Ql(){this.Ic=!0}i0(){!1!==this.Du&&(this.Du=!1,this.EL(this.xt,this.bt))}EL(t,e){this.Zl();const i=this.Vi,n=t*i,s=e*i;this.ft.resize(n,s,t,e)&&(this.Be=!0,this.Qt.clearContextCache(!0))}UL(){const t=this.ft;if(null===t||this.Iu.isReal())return!0;const e=this.xt,i=this.bt,n=this.St;let s=!1,o=this.Gn?this.Wt:0,r=this.ln?this.Wt:0,a=n.clientWidth||e+o,l=n.clientHeight||i+r;const h=this.viewportBounds,u=h.x,c=h.y,d=h.width,f=h.height;if((a!==e+o||l!==i+r)&&(this.Gn=!1,this.ln=!1,o=0,r=0,this.xt=a,this.bt=l,this.Du=!0,s=!0,this.Zl()),!this.Hn||!this.viewportBounds.isReal())return!0;const g=this.lb,p=this.hb;if(this.Ou=!1,!s&&!this.Gn&&!this.ln&&!this.Ru&&!this.vu)return!0;const m=this.documentBounds;let x=0,b=0,w=0,k=0;const S=h.width,P=h.height,M=this.Jh;this.contentAlignment.isSpot()?(m.width>S&&(x=M.left,b=M.right),m.height>P&&(w=M.top,k=M.bottom)):(x=M.left,b=M.right,w=M.top,k=M.bottom);const C=m.width+x+b,N=m.height+w+k,T=this.scale,L=T;let A=C>a/T,D=N>l/T;if(!s&&!this.Gn&&!this.ln&&!A&&!D)return!0;const F=m.x-x,O=h.x,E=m.right+b;let R=h.right+o;const B=m.y-w,I=h.y,z=m.bottom+k;let j=h.bottom+r,V="1px",U="1px";if(1===this.scrollMode&&(A||D)){if(A&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;F+1<O&&(t=Math.max((O-F)*T+this.xt,t)),E>R+1&&(t=Math.max((E-R)*T+this.xt,t)),S+o+1<C&&(t=Math.max((C-S)*T+this.xt,t)),V=t.toString()+"px"}if(D&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let t=1;B+1<I&&(t=Math.max((I-B)*T+this.bt,t)),z>j+1&&(t=Math.max((z-j)*T+this.bt,t)),P+r+1<N&&(t=Math.max((N-P)*T+this.bt,t)),U=t.toString()+"px"}}let X="1px"!==V,K="1px"!==U;if((!X||!K)&&(X||K)){if(A=!(C<S+o),D=!(N<P+r),K&&(R-=this.Wt),X&&(j-=this.Wt),A&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;F+1<O&&(t=Math.max((O-F)*T+this.xt,t)),E>R+1&&(t=Math.max((E-R)*T+this.xt,t)),S+1<C&&(t=Math.max((C-S)*T+this.xt,t)),V=t.toString()+"px"}X="1px"!==V;let t=this.bt;if(X!==this.ln&&(t=X?this.bt-this.Wt:this.bt+this.Wt),D&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let e=1;B+1<I&&(e=Math.max((I-B)*T+t,e)),z>j+1&&(e=Math.max((z-j)*T+t,e)),P+1<N&&(e=Math.max((N-P)*T+t,e)),U=e.toString()+"px"}K="1px"!==U}if(this.Um&&X===this.ln&&K===this.Gn)return(e!==this.xt||i!==this.bt)&&this.maybeUpdate(),!1;if(X!==this.ln&&(this.bt="1px"===V?this.bt+this.Wt:Math.max(this.bt-this.Wt,1),s=!0),this.ln=X,p.style.width=V,K!==this.Gn&&(this.xt="1px"===U?this.xt+this.Wt:Math.max(this.xt-this.Wt,1),s=!0,this.zu)){const e=y.l();K?(t.style.left=this.Wt+"px",this.position=e.i(this.at.x+this.Wt/this.scale,this.at.y)):(t.style.left="0px",this.position=e.i(this.at.x-this.Wt/this.scale,this.at.y)),y.e(e)}s&&this.Zl(),this.Gn=K,p.style.height=U,this.Qx=!0,s&&(this.Du=!0);let G=g.scrollLeft;if(this.hasHorizontalScrollbar&&this.allowHorizontalScroll&&(S+1<C?G=(this.position.x-F)*T:F+1<O?G=g.scrollWidth-g.clientWidth:E>R+1&&(G=this.position.x*T)),this.zu)switch(this.kx){case"negative":G=-(g.scrollWidth-G-g.clientWidth);break;case"reverse":G=g.scrollWidth-G-g.clientWidth}if(g.scrollLeft=G,this.hasVerticalScrollbar&&this.allowVerticalScroll&&(P+1<N?g.scrollTop=(this.position.y-B)*T:B+1<I?g.scrollTop=g.scrollHeight-g.clientHeight:z>j+1&&(g.scrollTop=this.position.y*T)),a=this.xt,l=this.bt,g.style.width=a+(this.Gn?this.Wt:0)+"px",g.style.height=l+(this.ln?this.Wt:0)+"px",e!==a||i!==l||this.animationManager.pi){const t=v.V(u,c,d,f);return this.onViewportBoundsChanged(t,this.viewportBounds,L,s),v.e(t),!1}return!0}add(t){const i=t.diagram;if(i===this)return;null!==i&&e.o("Cannot add part "+t.toString()+" to "+this.toString()+". It is already a part of "+i.toString());let n=this.findLayer(t.layerName);if(null===n&&(n=this.findLayer("")),null===n&&e.o('Cannot add a Part when unable find a Layer named "'+t.layerName+'" and there is no default Layer'),t.layer===n)return;const s=n.Wh(99999999,t,t.diagram===this);s>=0&&this.raiseChangedEvent(3,"parts",n,null,t,null,s),n.isTemporary||this.invalidateDocumentBounds(),t.invalidateLayout(1);const o=t.layerChanged;null!==o&&o(t,null,n)}Wh(t){this.partManager.Wh(t);const e=this;t.Yr((t=>e.KL(t))),t.data||t.To(),t.hasPlaceholder()&&t.c(),null!==t.data&&t.Yr((t=>e.partManager.OM(t,null))),(!0===t._e()||!0===t.th())&&this._m(t),t.GL(!0,this),t.HL()?(t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.requestUpdate()}te(t){t.clearAdornments(),this.partManager.te(t);const e=this;null!==t.data&&t.Yr((t=>e.partManager.IM(t,e))),this.Yn.delete(t),t instanceof be&&this.Sr.delete(t),t.HL()?(t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.S(t.qh(t.actualBounds)),this.requestUpdate()}remove(t){this.EM(t,!0)}EM(t,e){const i=t.layer;if(null===i||i.diagram!==this)return;t.isSelected=!1,t.isHighlighted=!1,t.invalidateLayout(2),e&&t.Xc();const n=i.te(-1,t,!1);n>=0&&this.raiseChangedEvent(4,"parts",i,t,null,n,null);const s=t.layerChanged;null!==s&&s(t,i,null)}removeParts(t,e){if(void 0===e&&(e=!1),Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];e&&!i.canDelete()||this.remove(i)}}else{const i=new u;i.addAll(t);const n=i.iterator;for(;n.next();){const t=n.value;e&&!t.canDelete()||this.remove(t)}}}copyParts(t,e,i){void 0===i&&(i=!1);let n=null;const s=e||this,o=s.model;let r=!1,a=!1;try{o.pm()&&(r=o.copiesParentKeyOfNodeData,o.copiesParentKeyOfNodeData=s.commandHandler.copiesParentKey),(o.mm()||o.Sb())&&(a=o.copiesGroupKeyOfNodeData,o.copiesGroupKeyOfNodeData=s.commandHandler.copiesGroupKey),n=this.partManager.copyParts(t,e,i)}finally{o.pm()&&(o.copiesParentKeyOfNodeData=r),(o.mm()||o.Sb())&&(o.copiesGroupKeyOfNodeData=a)}return n}moveParts(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=this.s0()),null===this.toolManager)return;const s=new m;if(null!==t)if(Array.isArray(t))for(let o=0;o<t.length;o++)this.Kr(s,t[o],i,n);else{const e=t.iterator;for(;e.next();)this.Kr(s,e.value,i,n)}else{let t=this.parts;for(;t.next();){const e=t.value;this.Kr(s,e,i,n)}for(t=this.nodes;t.next();){const e=t.value;this.Kr(s,e,i,n)}for(t=this.links;t.next();){const e=t.value;this.Kr(s,e,i,n)}}this.AP(s,e,n,i)}Kr(t,e,i,n,s){if(!t.has(e)&&(void 0===s&&(s=!1),!i||s||e.canMove()||e.canCopy()))if(void 0===n&&(n=this.s0()),e instanceof pe){if(t.set(e,this.Es(n,e,e.location)),e instanceof Ne&&(e.hasPlaceholder()||n.dragsMembers)){const s=e.memberParts;for(;s.next();){const e=s.value;this.Kr(t,e,i,n,n.groupsAlwaysMove)}}const s=e.linksConnected;for(;s.next();){const e=s.value;if(t.has(e))continue;const o=e.fromNode,r=e.toNode;null!==o&&t.has(o)&&null!==r&&t.has(r)&&this.Kr(t,e,i,n)}if(n.dragsTree){const s=e.findTreeChildrenNodes();for(;s.next();){const e=s.value;this.Kr(t,e,i,n)}}}else if(e instanceof be){t.set(e,this.Es(n,e));const s=e.labelNodes;for(;s.next();){const e=s.value;this.Kr(t,e,i,n)}}else e instanceof fe||t.set(e,this.Es(n,e,e.location))}AP(t,i,n,s){if(null===t||0===t.count)return;const o=y.l(),r=y.l();r.a(i),isNaN(r.x)&&(r.x=0),isNaN(r.y)&&(r.y=0);const a=this.ub;a||this.WC(t);const l=e.et(),h=e.et(),u=t.iterator;let c=y.l();for(;u.next();){const e=u.key,i=u.value;if(e.ke()){const a=this.jL(e,t);if(null!==a)l.push(new kt(e,i,a));else if(!s||e.canMove()){const t=i.point;o.a(t),this.computeMove(e,o.add(r),n,c),e.location=c,void 0===i.shifted&&(i.shifted=new y),i.shifted.a(c.subtract(t))}}else u.key instanceof be&&h.push(new g(u.key,u.value))}y.e(c);const d=l.length;for(let e=0;e<d;e++){const t=l[e],i=t.qL.point;o.a(i),void 0===t.Mb.shifted&&(t.Mb.shifted=new y),t.Me.location=o.add(t.Mb.shifted)}const f=y.l(),p=y.l(),m=h.length;for(let e=0;e<m;e++){const i=h[e],s=i.key;if(s instanceof be)if(s.suspendsRouting){s.xr=null;const e=s.fromNode,a=s.toNode;if(null!==this.draggedLink&&n.dragsLink){const e=i.value.point;if(null===s.dragComputation){t.set(s,this.Es(n,s,r));const i=r.x-e.x,o=r.y-e.y;s.cr(i,o)}else{const i=y.V(0,0),o=s.getPoint(0);o&&o.isReal()&&i.a(o),c=y.l().a(i).add(r);let a=c;n.isGridSnapEnabled&&(n.isGridSnapRealtime||this.lastInput.up)&&(a=y.l(),this.pS(s,c,a,n)),c.a(s.dragComputation(s,c,a)).subtract(i),t.set(s,this.Es(n,s,c));const l=c.x-e.x,h=c.y-e.y;s.cr(l,h),y.e(i),y.e(c),a!==c&&y.e(a)}}else{if(null!==e){f.a(e.location);const i=t.get(e);null!==i&&f.subtract(i.point)}if(null!==a){p.a(a.location);const e=t.get(a);null!==e&&p.subtract(e.point)}if(null!==e&&null!==a)if(f.equalsApprox(p)){const e=i.value.point,r=o;r.a(f),r.subtract(e),t.set(s,this.Es(n,s,f)),s.cr(r.x,r.y)}else s.suspendsRouting=!1,s.invalidateRoute();else{const o=i.value.point;let l;l=null!==e?f:null!==a?p:r,t.set(s,this.Es(n,s,l));const h=l.x-o.x,u=l.y-o.y;s.cr(h,u)}}}else if(null===s.fromNode||null===s.toNode){const e=i.value.point;t.set(s,this.Es(n,s,r));const o=r.x-e.x,a=r.y-e.y;s.cr(o,a)}}y.e(o),y.e(r),y.e(f),y.e(p),e.J(l),e.J(h),a||(this.Mi(),this.MP(t))}computeMove(t,e,i,n){if(void 0===n&&(n=new y),n.a(e),null===t)return n;let s=e;const o=i.isGridSnapEnabled;o&&(i.isGridSnapRealtime||this.lastInput.up)&&(s=y.l(),this.pS(t,e,s,i));const r=null!==t.dragComputation?t.dragComputation(t,e,s):s,a=t.minLocation;let l=a.x;isNaN(l)&&(l=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let h=a.y;isNaN(h)&&(h=o?Math.round(1e3*t.location.y)/1e3:t.location.y);const u=t.maxLocation;let c=u.x;isNaN(c)&&(c=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let d=u.y;return isNaN(d)&&(d=o?Math.round(1e3*t.location.y)/1e3:t.location.y),n.i(Math.max(l,Math.min(r.x,c)),Math.max(h,Math.min(r.y,d))),s!==e&&y.e(s),n}s0(){const t=this.toolManager.findTool("Dragging");return t instanceof U?t.dragOptions:this.gb}pS(t,e,i,n){if(void 0===n&&(n=this.s0()),i.a(e),null===t)return i;const s=this.grid,o=n.gridSnapCellSize;let r=o.width,a=o.height;const l=n.gridSnapOrigin;let h=l.x,u=l.y;const c=n.gridSnapCellSpot;if(null!==s){const t=s.gridCellSize;isNaN(r)&&(r=t.width),isNaN(a)&&(a=t.height);const e=s.gridOrigin;isNaN(h)&&(h=e.x),isNaN(u)&&(u=e.y)}const d=y.V(0,0);return d.setSpot(0,0,r,a,c),S.Dg(e.x,e.y,h+d.x,u+d.y,r,a,i),y.e(d),i}WC(t){if(null===t)return;this.ub=!0;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof be&&(t.suspendsRouting=!0)}}MP(t){if(null===t)return;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof be&&(t.suspendsRouting=!1,t.WL()&&t.invalidateRoute())}this.ub=!1}get draggedLink(){return this.db}set draggedLink(t){this.db!==t&&(this.db=t,null!==t&&(this.pb=t.fromPort,this.yb=t.toPort))}get FP(){return this.pb}set FP(t){this.pb=t}get RP(){return this.yb}set RP(t){this.yb=t}jL(t,e){const i=t.containingGroup;if(null!==i){let t=this.jL(i,e);if(null!==t||(t=e.get(i),null!==t))return t}return null}Es(t,e,i){if(void 0===i)return new wt(y.wo);let n=t.isGridSnapEnabled;return!t.groupsSnapMembers&&null!==e.containingGroup&&(n=!1),new wt(n?new y(Math.round(1e3*i.x)/1e3,Math.round(1e3*i.y)/1e3):i.copy())}BM(t,i){if(null!==t.diagram&&t.diagram!==this&&e.o("Cannot share a Layer with another Diagram: "+t+" of "+t.diagram),null===i?null!==t.diagram&&e.o("Cannot add an existing Layer to this Diagram again: "+t):(i.diagram!==this&&e.o("Existing Layer must be in this Diagram: "+i+" not in "+i.diagram),t===i&&e.o("Cannot move a Layer before or after itself: "+t)),t.diagram===this)return;const n=t.name,s=this.Xt,o=s.count;for(let r=0;r<o;r++)s.elt(r).name===n&&e.o("Cannot add Layer with the name '"+n+"'; a Layer with the same name is already present in this Diagram.")}addLayer(t){this.BM(t,null),t.So(this);const e=this.Xt;let i=e.count-1;if(!t.isTemporary)for(;i>=0&&e.elt(i).isTemporary;)i--;return e.insertAt(i+1,t),null!==this.ki&&this.raiseChangedEvent(3,"layers",this,null,t,null,i+1),this.S(),this.invalidateDocumentBounds(),this}addLayerBefore(t,e){this.BM(t,e),t.So(this);const i=this.Xt,n=i.indexOf(t);n>=0&&(i.delete(t),null!==this.ki&&this.raiseChangedEvent(4,"layers",this,t,null,n,null));const s=i.count;let o;for(o=0;o<s;o++)if(i.elt(o)===e){i.insertAt(o,t);break}return null!==this.ki&&this.raiseChangedEvent(3,"layers",this,null,t,null,o),this.S(),n<0&&this.invalidateDocumentBounds(),this}addLayerAfter(t,e){this.BM(t,e),t.So(this);const i=this.Xt,n=i.indexOf(t);n>=0&&(i.delete(t),null!==this.ki&&this.raiseChangedEvent(4,"layers",this,t,null,n,null));const s=i.count;let o;for(o=0;o<s;o++)if(i.elt(o)===e){i.insertAt(o+1,t);break}return null!==this.ki&&this.raiseChangedEvent(3,"layers",this,null,t,null,o+1),this.S(),n<0&&this.invalidateDocumentBounds(),this}zr(t,e){t.So(this),this.Xt.insertAt(e,t)}JL(t){this.Xt.removeAt(t)}removeLayer(t){if(t.diagram!==this&&e.o("Cannot remove a Layer from another Diagram: "+t+" of "+t.diagram),""===t.name)return;const i=this.Xt,n=i.indexOf(t);if(i.delete(t)){const e=t.Ct.copy().iterator;for(;e.next();){const i=e.value,n=i.layerName;n!==t.name?i.layerName=n:i.layerName=""}null!==this.ki&&this.raiseChangedEvent(4,"layers",this,t,null,n,null),this.S(),this.invalidateDocumentBounds()}}findLayer(t){const e=this.layers;for(;e.next();){const i=e.value;if(i.name===t)return i}return null}findRouter(t){for(const e of this.Vc)if(e.name===t)return e;return null}addModelChangedListener(t){return e.k(t,vt,"addModelChangedListener:listener"),null===this.Kn&&(this.Kn=new l),this.Kn.add(t),this.model.addChangedListener(t),this}removeModelChangedListener(t){e.k(t,vt,"removeModelChangedListener:listener"),null!==this.Kn&&(this.Kn.delete(t),0===this.Kn.count&&(this.Kn=null)),this.model.removeChangedListener(t)}addChangedListener(t){return e.k(t,vt,"addChangedListener:listener"),null===this.Mr&&(this.Mr=new l),this.Mr.add(t),this}removeChangedListener(t){e.k(t,vt,"removeChangedListener:listener"),null!==this.Mr&&(this.Mr.delete(t),0===this.Mr.count&&(this.Mr=null))}UM(t){if(!this.skipsUndoManager&&!this.model.skipsUndoManager&&this.model.undoManager.handleChanged(t),1!==t.change&&(this.isModified=!0),null!==this.Mr){const e=this.Mr,i=e.length;for(let n=0;n<i;n++)e.elt(n)(t)}}raiseChangedEvent(t,e,i,n,s,o,r){void 0===o&&(o=null),void 0===r&&(r=null);const a=new E;a.diagram=this,a.change=t,a.propertyName=e,a.object=i,a.oldValue=n,a.oldParam=o,a.newValue=s,a.newParam=r,this.UM(a)}raiseChanged(t,e,i,n,s){this.raiseChangedEvent(2,t,this,e,i,n,s)}t(t,e,i,n,s){this.raiseChangedEvent(2,t,this,e,i,n,s)}get animationManager(){return this.ds}get undoManager(){return this.ki.undoManager}get skipsUndoManager(){return this.Co}set skipsUndoManager(t){e.s(t,"boolean",vt,"skipsUndoManager"),this.Co=t,this.ki.skipsUndoManager=t}get delaysLayout(){return this.Xx}set delaysLayout(t){this.Xx=t}VC(t,i){if(null===t||t.diagram!==this)return;const n=this.fe;try{this.fe=!0;const n=t.change;if(2===n){const e=t.object,n=t.propertyName,s=t.getValue(i);if(t.diagram.model.Z(e,n,s),e instanceof At){const t=e.part;null!==t&&t.invalidateAdornments()}this.isModified=!0}else if(3===n){const n=t.object,s=t.newParam,o=t.newValue;if(n instanceof Yt)if("number"==typeof s&&o instanceof At){i?n.te(s):n.insertAt(s,o);const t=n.part;null!==t&&t.invalidateAdornments()}else"number"==typeof s&&o instanceof $t&&(o.isRow?n.$L(s,i?void 0:o):n.ZL(s,i?void 0:o));else if(n instanceof gt){const e=!0===t.oldParam;"number"==typeof s&&o instanceof ce&&(i?(e||(o.isSelected=!1,o.isHighlighted=!1,o.invalidateAdornments()),n.te(e?s:-1,o,e)):n.Wh(s,o,e))}else n instanceof vt?"number"==typeof s&&o instanceof gt&&(i?this.JL(s):this.zr(o,s)):e.o("unknown ChangeType.Insert object: "+t.toString());this.isModified=!0}else if(4===n){const n=t.object,s=t.oldParam,o=t.oldValue;if(n instanceof Yt)"number"==typeof s&&o instanceof At?i?n.insertAt(s,o):n.te(s):"number"==typeof s&&o instanceof $t&&(o.isRow?n.$L(s,i?o:void 0):n.ZL(s,i?o:void 0));else if(n instanceof gt){const e=!0===t.newParam;"number"==typeof s&&o instanceof ce&&(i?n.Ct.indexOf(o)<0&&n.Wh(s,o,e):(e||(o.isSelected=!1,o.isHighlighted=!1,o.invalidateAdornments()),n.te(e?s:-1,o,e)))}else n instanceof vt?"number"==typeof s&&o instanceof gt&&(i?this.zr(o,s):this.JL(s)):e.o("unknown ChangeType.Remove object: "+t.toString());this.isModified=!0}else 1===n||e.o("unknown ChangedEvent: "+t.toString())}finally{this.fe=n}}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const n=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let s=!1;try{t(this),s=!0}finally{s?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=n}}updateAllTargetBindings(t){this.partManager.updateAllTargetBindings(t)}updateAllThemeBindings(){if(this.partManager.updateAllThemeBindings(),null!==this.Ze){const t=this.Ze.part;null!==t&&t.To()}}setDivBackground(t){this.div&&(this.div.style.backgroundColor=t)}updateAllRelationshipsFromData(){this.partManager.updateAllRelationshipsFromData()}bb(){const t=this.T,e=this.tt,i=this.at;t.Ri(),1!==e&&t.tt(e),(0!==i.x||0!==i.y)&&t.Fs(-i.x,-i.y)}QL(t,e){const i=this.animationManager;if(this.jt||this.ys)return this.tt=e,this.Zl(),this.S(),this.ha(),i.yL(t,this.tt),void this.bb();if(null===this.ft)return this.tt=e,void this.bb();this.jt=!0;const n=this.viewportBounds.copy(),s=this.xt,o=this.bt;let r=this.zoomPoint.x,a=this.zoomPoint.y;const l=this.contentAlignment;isNaN(r)&&(l.isSide()?l.includesSide(w.LeftSide)?r=0:l.includesSide(w.RightSide)&&(r=s-1):r=l.isSpot()?l.x*(s-1):s/2),isNaN(a)&&(l.isSide()?l.includesSide(w.TopSide)?a=0:l.includesSide(w.BottomSide)&&(a=o-1):a=l.isSpot()?l.y*(o-1):o/2),null!==this.scaleComputation&&!this.animationManager.defaultAnimation.isAnimating&&(e=this.scaleComputation(this,e)),e<this.minScale&&(e=this.minScale),e>this.maxScale&&(e=this.maxScale);const h=y.V(this.at.x+r/t-r/e,this.at.y+a/t-a/e);this.position=h,y.e(h),this.tt=e,this.Zl(),this.jt=!1,this.onViewportBoundsChanged(n,this.viewportBounds,t,!1),this.Us(!1),i.yL(t,this.tt),this.S()}SR(){const t=this.Xt.r;for(let e=0;e<t.length;e++)t[e].ML()}onViewportBoundsChanged(t,e,i,n){if(t.equals(e))return;void 0===n&&(n=!1),n||this.ha(),this.Ql();const s=this.layout;null!==s&&s.isViewportSized&&1===this.autoScale&&(t.width!==e.width||t.height!==e.height)&&s.invalidateLayout();const o=this.currentTool;!0===this.Bc&&o instanceof V&&!this.animationManager.isTicking&&(this.lastInput.documentPoint=this.transformViewToDoc(this.lastInput.viewPoint),o.standardMouseActivity(this)),this.jt||this.invalidateViewport(t,e),this._l(),this.Ui.scale=i,this.Ui.position.x=t.x,this.Ui.position.y=t.y,this.Ui.bounds.a(t),this.Ui.canvasSize.width=Math.round(t.width*i),this.Ui.canvasSize.height=Math.round(t.height*i),this.Ui.newCanvasSize.width=this.xt,this.Ui.newCanvasSize.height=this.bt,this.Ui.isScroll=n,this.D("ViewportBoundsChanged",this.Ui,t),this.isVirtualized&&this.links.each((t=>{t.isAvoiding&&t.actualBounds.intersectsRect(e)&&t.invalidateRoute()}))}_l(t){const e=this.Ze;if(null===e||!e.visible||null===e.part||null===e.layer)return;const i=void 0!==t?t:this.eb;if(!i.isReal())return;const n=i.width,s=i.height;if(e.scale=1,e.angle=0,e.layer.isViewportAligned)e.width=n*this.scale,e.height=s*this.scale,e.part.alignment=w.TopLeft;else{null===e.yi&&(e.yi=new Ht);const t=e.yi.Yc;if(!t.isReal())return;e.width=n+2*t.width,e.height=s+2*t.height;const o=y.l();S.Dg(i.x,i.y,0,0,t.width,t.height,o),o.offset(-t.width,-t.height),e.part.location=o,y.e(o)}}clearSelection(t){void 0===t&&(t=!1);const e=this.selection;if(0===e.count)return;t||this.D("ChangingSelection",e);const i=e.toArray(),n=i.length;for(let s=0;s<n;s++){i[s].isSelected=!1}e.Nt(),e.clear(),e.u(),t||this.D("ChangedSelection",e)}select(t){null!==t&&t.diagram===this&&(!t.isSelected||this.selection.count>1)&&(this.D("ChangingSelection",this.selection),this.clearSelection(!0),t.isSelected=!0,this.D("ChangedSelection",this.selection))}selectCollection(t){if(this.D("ChangingSelection",this.selection),this.clearSelection(!0),Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];i instanceof ce||e.o("Diagram.selectCollection given something that is not a Part: "+i),i.isSelected=!0}}else{const i=t.iterator;for(;i.next();){const t=i.value;t instanceof ce||e.o("Diagram.selectCollection given something that is not a Part: "+t),t.isSelected=!0}}this.D("ChangedSelection",this.selection)}clearHighlighteds(){const t=this.highlighteds;if(t.count>0){const e=t.toArray(),i=e.length;for(let t=0;t<i;t++){e[t].isHighlighted=!1}t.Nt(),t.clear(),t.u()}}highlight(t){null!==t&&t.diagram===this&&(!t.isHighlighted||this.highlighteds.count>1)&&(this.clearHighlighteds(),t.isHighlighted=!0)}highlightCollection(t){const i=(new u).addAll(t),n=this.highlighteds.copy().removeAll(i).iterator;for(;n.next();){n.value.isHighlighted=!1}const s=i.iterator;for(;s.next();){const t=s.value;t instanceof ce||e.o("Diagram.highlightCollection given something that is not a Part: "+t),t.isHighlighted=!0}}scroll(t,i,n){void 0===n&&(n=1);const s="up"===i||"down"===i;let o=0;const r=y.l();if("pixel"===t)o=n;else if("line"===t)o=n*(s?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===t){let t=s?this.viewportBounds.height:this.viewportBounds.width;if(t*=this.scale,0!==t){o=n*Math.max(t-(s?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0)}}else{if("document"===t){const t=this.documentBounds,e=this.viewportBounds;return"up"===i?this.position=r.i(e.x,t.y):"left"===i?this.position=r.i(t.x,e.y):"down"===i?this.position=r.i(e.x,t.bottom-e.height):"right"===i&&(this.position=r.i(t.right-e.width,e.y)),void y.e(r)}e.o("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+t)}o/=this.scale;const a=this.position;"up"===i?this.position=r.i(a.x,a.y-o):"down"===i?this.position=r.i(a.x,a.y+o):"left"===i?this.position=r.i(a.x-o,a.y):"right"===i?this.position=r.i(a.x+o,a.y):e.o("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+i),y.e(r)}scrollToRect(t){const e=this.viewportBounds;if(e.containsRect(t))return;const i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}centerRect(t){const e=this.viewportBounds,i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}transformDocToView(t){return t.copy().T(this.T)}transformViewToDoc(t){return t.copy().Oe(this.T)}JF(t){return t.Oe(this.T)}static None=1;static Uniform=2;static UniformToFill=3;static CycleAll=1;static CycleNotDirected=2;static CycleNotDirectedFast=3;static CycleNotUndirected=4;static CycleDestinationTree=5;static CycleSourceTree=6;static DocumentScroll=1;static InfiniteScroll=2;static TreeParentCollapsed=1;static AllParentsCollapsed=2;static AnyParentsCollapsed=3;get opacity(){return this.$t}set opacity(t){const i=this.$t;i!==t&&(e.s(t,"number",vt,"opacity"),(t<0||t>1)&&e.W(t,"0 <= value <= 1",vt,"opacity"),this.$t=t,this.t("opacity",i,t),this.S())}get validCycle(){return this.Ix}set validCycle(t){const e=this.Ix;e!==t&&(this.Ix=t,this.t("validCycle",e,t))}get layers(){return this.Xt.iterator}get isModelReadOnly(){const t=this.ki;return null!==t&&t.isReadOnly}set isModelReadOnly(t){const e=this.ki;null!==e&&(e.isReadOnly=t)}get isReadOnly(){return this.Lo}set isReadOnly(t){const i=this.Lo;i!==t&&(e.s(t,"boolean",vt,"isReadOnly"),this.Lo=t,this.t("isReadOnly",i,t))}get isEnabled(){return this.Oi}set isEnabled(t){const i=this.Oi;i!==t&&(e.s(t,"boolean",vt,"isEnabled"),this.Oi=t,this.t("isEnabled",i,t))}get allowClipboard(){return this.Yx}set allowClipboard(t){const i=this.Yx;i!==t&&(e.s(t,"boolean",vt,"allowClipboard"),this.Yx=t,this.t("allowClipboard",i,t))}get allowCopy(){return this.Fl}set allowCopy(t){const i=this.Fl;i!==t&&(e.s(t,"boolean",vt,"allowCopy"),this.Fl=t,this.t("allowCopy",i,t))}get allowDelete(){return this.Rl}set allowDelete(t){const i=this.Rl;i!==t&&(e.s(t,"boolean",vt,"allowDelete"),this.Rl=t,this.t("allowDelete",i,t))}get allowDragOut(){return this.Kx}set allowDragOut(t){const i=this.Kx;i!==t&&(e.s(t,"boolean",vt,"allowDragOut"),this.Kx=t,this.t("allowDragOut",i,t))}get allowDrop(){return this.Gx}set allowDrop(t){const i=this.Gx;i!==t&&(e.s(t,"boolean",vt,"allowDrop"),this.Gx=t,this.t("allowDrop",i,t))}get allowTextEdit(){return this.vl}set allowTextEdit(t){const i=this.vl;i!==t&&(e.s(t,"boolean",vt,"allowTextEdit"),this.vl=t,this.t("allowTextEdit",i,t))}get allowGroup(){return this.Ol}set allowGroup(t){const i=this.Ol;i!==t&&(e.s(t,"boolean",vt,"allowGroup"),this.Ol=t,this.t("allowGroup",i,t))}get allowUngroup(){return this.Il}set allowUngroup(t){const i=this.Il;i!==t&&(e.s(t,"boolean",vt,"allowUngroup"),this.Il=t,this.t("allowUngroup",i,t))}get allowInsert(){return this.Hx}set allowInsert(t){const i=this.Hx;i!==t&&(e.s(t,"boolean",vt,"allowInsert"),this.Hx=t,this.t("allowInsert",i,t))}get allowLink(){return this.El}set allowLink(t){const i=this.El;i!==t&&(e.s(t,"boolean",vt,"allowLink"),this.El=t,this.t("allowLink",i,t))}get allowRelink(){return this.Bl}set allowRelink(t){const i=this.Bl;i!==t&&(e.s(t,"boolean",vt,"allowRelink"),this.Bl=t,this.t("allowRelink",i,t))}get allowMove(){return this.Ul}set allowMove(t){const i=this.Ul;i!==t&&(e.s(t,"boolean",vt,"allowMove"),this.Ul=t,this.t("allowMove",i,t))}get allowReshape(){return this.Vl}set allowReshape(t){const i=this.Vl;i!==t&&(e.s(t,"boolean",vt,"allowReshape"),this.Vl=t,this.t("allowReshape",i,t))}get allowResize(){return this.zl}set allowResize(t){const i=this.zl;i!==t&&(e.s(t,"boolean",vt,"allowResize"),this.zl=t,this.t("allowResize",i,t))}get allowRotate(){return this.Xl}set allowRotate(t){const i=this.Xl;i!==t&&(e.s(t,"boolean",vt,"allowRotate"),this.Xl=t,this.t("allowRotate",i,t))}get allowSelect(){return this.Yl}set allowSelect(t){const i=this.Yl;i!==t&&(e.s(t,"boolean",vt,"allowSelect"),this.Yl=t,this.t("allowSelect",i,t))}get allowUndo(){return this.jx}set allowUndo(t){const i=this.jx;i!==t&&(e.s(t,"boolean",vt,"allowUndo"),this.jx=t,this.t("allowUndo",i,t))}get allowZoom(){return this.qx}set allowZoom(t){const i=this.qx;i!==t&&(e.s(t,"boolean",vt,"allowZoom"),this.qx=t,this.t("allowZoom",i,t))}get hasVerticalScrollbar(){return this.vu}set hasVerticalScrollbar(t){const i=this.vu;i!==t&&(e.s(t,"boolean",vt,"hasVerticalScrollbar"),this.vu=t,this.ha(),this.S(),this.t("hasVerticalScrollbar",i,t),this.Us(!1))}get hasHorizontalScrollbar(){return this.Ru}set hasHorizontalScrollbar(t){const i=this.Ru;i!==t&&(e.s(t,"boolean",vt,"hasHorizontalScrollbar"),this.Ru=t,this.ha(),this.S(),this.t("hasHorizontalScrollbar",i,t),this.Us(!1))}get allowHorizontalScroll(){return this.Wx}set allowHorizontalScroll(t){const i=this.Wx;i!==t&&(e.s(t,"boolean",vt,"allowHorizontalScroll"),this.Wx=t,this.t("allowHorizontalScroll",i,t),this.Us(!1))}get allowVerticalScroll(){return this.Jx}set allowVerticalScroll(t){const i=this.Jx;i!==t&&(e.s(t,"boolean",vt,"allowVerticalScroll"),this.Jx=t,this.t("allowVerticalScroll",i,t),this.Us(!1))}get scrollHorizontalLineChange(){return this.$x}set scrollHorizontalLineChange(t){const i=this.$x;i!==t&&(e.s(t,"number",vt,"scrollHorizontalLineChange"),t<0&&e.W(t,">= 0",vt,"scrollHorizontalLineChange"),this.$x=t,this.t("scrollHorizontalLineChange",i,t))}get scrollVerticalLineChange(){return this.Zx}set scrollVerticalLineChange(t){const i=this.Zx;i!==t&&(e.s(t,"number",vt,"scrollVerticalLineChange"),t<0&&e.W(t,">= 0",vt,"scrollVerticalLineChange"),this.Zx=t,this.t("scrollVerticalLineChange",i,t))}get lastInput(){return this.Qh}set lastInput(t){this.Qh=t}get previousInput(){return this.Br}set previousInput(t){this.Br=t}get firstInput(){return this.Km}set firstInput(t){this.Km=t}get currentCursor(){return this.Ex}set currentCursor(t){if(""===t&&(t=this.Bm),this.Ex!==t){e.s(t,"string",vt,"currentCursor");const i=this.ft,n=this.St;if(null===i||null===n)return;this.Ex=t;const s=i.style.cursor;i.style.cursor=t,n.style.cursor=t,i.style.cursor===s&&(i.style.cursor="-webkit-"+t,n.style.cursor="-webkit-"+t,i.style.cursor===s&&(i.style.cursor="-moz-"+t,n.style.cursor="-moz-"+t,i.style.cursor===s&&(i.style.cursor=t,n.style.cursor=t)))}}get defaultCursor(){return this.Bm}set defaultCursor(t){""===t&&(t="auto");const i=this.Bm;i!==t&&(e.s(t,"string",vt,"defaultCursor"),this.Bm=t,this.t("defaultCursor",i,t))}get click(){return this.Nr}set click(t){const i=this.Nr;i!==t&&(null!==t&&e.k(t,vt,"click"),this.Nr=t,this.t("click",i,t))}get doubleClick(){return this.Cr}set doubleClick(t){const i=this.Cr;i!==t&&(null!==t&&e.k(t,vt,"doubleClick"),this.Cr=t,this.t("doubleClick",i,t))}get contextClick(){return this.Lr}set contextClick(t){const i=this.Lr;i!==t&&(null!==t&&e.k(t,vt,"contextClick"),this.Lr=t,this.t("contextClick",i,t))}get mouseOver(){return this.Ar}set mouseOver(t){const i=this.Ar;i!==t&&(null!==t&&e.k(t,vt,"mouseOver"),this.Ar=t,this.t("mouseOver",i,t))}get mouseHover(){return this.Tr}set mouseHover(t){const i=this.Tr;i!==t&&(null!==t&&e.k(t,vt,"mouseHover"),this.Tr=t,this.t("mouseHover",i,t))}get mouseHold(){return this.Dr}set mouseHold(t){const i=this.Dr;i!==t&&(null!==t&&e.k(t,vt,"mouseHold"),this.Dr=t,this.t("mouseHold",i,t))}get mouseDragOver(){return this.Bx}set mouseDragOver(t){const i=this.Bx;i!==t&&(null!==t&&e.k(t,vt,"mouseDragOver"),this.Bx=t,this.t("mouseDragOver",i,t))}get mouseDrop(){return this.Fr}set mouseDrop(t){const e=this.Fr;e!==t&&(this.Fr=t,this.t("mouseDrop",e,t))}get handlesDragDropForTopLevelParts(){return this.Ux}set handlesDragDropForTopLevelParts(t){const i=this.Ux;i!==t&&(e.s(t,"boolean",vt,"handlesDragDropForTopLevelParts"),this.Ux=t,this.t("handlesDragDropForTopLevelParts",i,t))}get mouseEnter(){return this.Rr}set mouseEnter(t){const i=this.Rr;i!==t&&(null!==t&&e.k(t,vt,"mouseEnter"),this.Rr=t,this.t("mouseEnter",i,t))}get mouseLeave(){return this.vr}set mouseLeave(t){const i=this.vr;i!==t&&(null!==t&&e.k(t,vt,"mouseLeave"),this.vr=t,this.t("mouseLeave",i,t))}get toolTip(){return this.Or}set toolTip(t){const e=this.Or;e!==t&&(this.Or=t,this.t("toolTip",e,t))}get contextMenu(){return this.Ir}set contextMenu(t){const e=this.Ir;e!==t&&(this.Ir=t,this.t("contextMenu",e,t))}get commandHandler(){return this.eM}set commandHandler(t){const e=this.eM;e!==t&&(e&&e.doStop(),this.eM=t,t.So(this),t.doStart())}get toolManager(){return this._S}set toolManager(t){this._S!==t&&(this._S=t,t.diagram=this)}get defaultTool(){return this.tM}set defaultTool(t){const e=this.tM;e!==t&&(this.tM=t,t.diagram=this,this.currentTool===e&&(this.currentTool=t))}get currentTool(){return this.iM}set currentTool(t){const e=this.iM;e&&(e.isActive&&e.doDeactivate(),e.cancelWaitAfter(),e.doStop()),null===t&&(t=this.defaultTool),null!==t&&(this.iM=t,t.diagram=this,t.doStart())}get selection(){return this.aM}get maxSelectionCount(){return this.ib}set maxSelectionCount(t){const i=this.ib;if(i!==t)if(e.s(t,"number",vt,"maxSelectionCount"),t>=0&&!isNaN(t)){if(this.ib=t,this.t("maxSelectionCount",i,t),!this.undoManager.isUndoingRedoing){const e=this.selection.count-t;if(e>0){this.D("ChangingSelection",this.selection);const t=this.selection.toArray();for(let i=0;i<e;i++)t[i].isSelected=!1;this.D("ChangedSelection",this.selection)}}}else e.W(t,">= 0",vt,"maxSelectionCount")}get nodeSelectionAdornmentTemplate(){return this.Xm}set nodeSelectionAdornmentTemplate(t){const e=this.Xm;e!==t&&(this.Xm=t.Et(),this.t("nodeSelectionAdornmentTemplate",e,t))}get groupSelectionAdornmentTemplate(){return this.nb}set groupSelectionAdornmentTemplate(t){const e=this.nb;e!==t&&(this.nb=t.Et(),this.t("groupSelectionAdornmentTemplate",e,t))}get linkSelectionAdornmentTemplate(){return this.ob}set linkSelectionAdornmentTemplate(t){const e=this.ob;e!==t&&(this.ob=t.Et(),this.t("linkSelectionAdornmentTemplate",e,t))}get highlighteds(){return this.cM}get isModified(){const t=this.undoManager;return t.isEnabled?null!==t.currentTransaction||this.Bu&&this.Os!==t.historyIndex:this.Bu}set isModified(t){if(this.Bu!==t){e.s(t,"boolean",vt,"isModified"),this.Bu=t;const i=this.undoManager;!t&&i.isEnabled&&(this.Os=i.historyIndex),t||this._L()}}_L(){const t=this.isModified;this.lM!==t&&(this.lM=t,this.D("Modified"))}get model(){return this.ki}set model(t){const i=this.ki;if(i!==t){this.currentTool.doCancel(),i&&i.undoManager!==t.undoManager&&i.undoManager.isInTransaction&&e.o("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.stopAnimation(!0);const n=this.OL(!0);this.Hn=!1,this.Fu=!0,this.Os=-2,this.wr=!1;const s=this.jt;this.jt=!0,this.animationManager.Dl("Model"),i&&(null!==this.Kn&&this.Kn.each((t=>i.removeChangedListener(t))),i.removeChangedListener(this.rM)),this.ki=t,this.partManager=this.RR(this.ki.type),this.initializePartManager(this.partManager);for(let t=0;t<n.length;t++)this.add(n[t]);t.addChangedListener(this.oM),this.partManager.VM(),t.removeChangedListener(this.oM),t.addChangedListener(this.rM),null!==this.Kn&&this.Kn.each((e=>t.addChangedListener(e))),this.jt=s,this.invalidateDocumentBounds(),this.jt||this.S(),i&&t.undoManager.copyProperties(i.undoManager)}}get themeManager(){return this.MM}set themeManager(t){const e=this.MM;e!==t&&(e&&e.removeDiagram(this),this.MM=t,null!==t&&t.addDiagram(this))}initializePartManager(t){}static NM(t,e){vt.AL.set(t,e)}static get licenseKey(){return vt.zM.last()}static set licenseKey(t){vt.zM.add(t.replace(/\s/g,""))}static get version(){return vt.vR}static zM=(()=>new l)();static vR="3.0.21";RR(t){const e=vt.AL.get(t);return null!==e?new e:new Ie}get X(){return this.nM}set X(t){this.nM=t}get wx(){return this.NL}OR(t){if(t.model!==this.model)return;const i=t.change,n=t.propertyName;if(1!==i||"S"!==n[0]){if(this.X){this.X=!1;try{if(""===t.modelChange&&1===i){("FinishedUndo"===n||"FinishedRedo"===n)&&(this.D("ChangedSelection",this.selection),this.Mi());const i=this.animationManager;"RolledBackTransaction"===n&&i.stopAnimation(),this.xL(),this.vc=!0,this.maybeUpdate(),(0===this.undoManager.transactionLevel||1===this.undoManager.transactionLevel)&&i.vS(),"CommittedTransaction"===n&&this.undoManager.isJustDiscarded&&(this.Os=Math.min(this.Os,this.undoManager.historyIndex-1)),("CommittedTransaction"===n||"RolledBackTransaction"===n)&&this.undoManager.Iw&&e.tr((()=>{this.isModified=!1}),1);const s=t.isTransactionFinished;if(s&&(this._L(),this.wx.clear(),this.animationManager.vF()),!this.Vx&&s&&this.lastInput.targetDiagram){this.Vx=!0;const t=this;e.tr((()=>{t.currentTool.standardMouseOver(),t.Vx=!1}),10)}}}finally{this.X=!0}}}else if("StartingFirstTransaction"===n){const t=this,e=this.toolManager;e.mouseDownTools.each((e=>e.diagram=t)),e.mouseMoveTools.each((e=>e.diagram=t)),e.mouseUpTools.each((e=>e.diagram=t)),this.routers.each((e=>e.diagram=t)),!this.ys&&!this.Hn&&(this.vc=!0,this.Fu&&(this.wr=!0))}else if("StartingUndo"===n||"StartingRedo"===n){const t=this.animationManager;this.skipsUndoManager||(t.defaultAnimation.isAnimating&&t.stopAnimation(),t.getBundleAnimation().isAnimating&&t.getBundleAnimation().stop()),this.D("ChangingSelection",this.selection)}else if("StartedTransaction"===n){const t=this.animationManager;t.defaultAnimation.isAnimating&&!this.skipsUndoManager&&t.stopAnimation()}}get fe(){return this.sM}set fe(t){this.sM=t}get du(){return this.zx}set du(t){this.zx=t}KL(t){const e=t.C.r;for(const i of e)i instanceof re&&this.XM(i)}XM(t){const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||(e.ts instanceof u&&e.ts.add(this),t.IR(),!e.o0))return;const i=e.getAttribute("src")||"",n=this.Wl.get(i);if(null===n){re.tA(t,e);const n=[];n.push(t),this.Wl.set(i,n)}else{for(let e=0;e<n.length;e++)if(n[e]===t)return;n.push(t)}}ER(t){const e=t.C.r,i=e.length;for(let n=0;n<i;n++)this.YM(e[n])}YM(t){if(!(t instanceof re))return;const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||!e.o0)return;const i=e.getAttribute("src")||"",n=this.Wl.get(i);if(null!==n)for(let s=0;s<n.length;s++)if(n[s]===t)return n.splice(s,1),void(0===n.length&&(this.Wl.delete(i),re.BR(e),e.ts instanceof u&&e.ts.delete(this),re.clearCache(i)))}IL(){re.clearCache(),this.Wl.clear()}rebuildParts(){this.partManager.rebuildParts()}Lc(t,e){this.ds.Lc(t,e)}Cc(t,e){this.ds.Cc(t,e)}findPartForKey(t){return this.partManager.findPartForKey(t)}findNodeForKey(t){return this.partManager.findNodeForKey(t)}findLinkForKey(t){return this.partManager.findLinkForKey(t)}findPartForData(t){return this.partManager.findPartForData(t)}findNodeForData(t){return this.partManager.findNodeForData(t)}findLinkForData(t){return this.partManager.findLinkForData(t)}findNodesByExample(){return this.partManager.findNodesByExample(...arguments)}findLinksByExample(){return this.partManager.findLinksByExample(...arguments)}get nodeTemplate(){return this.Er.get("")}set nodeTemplate(t){const e=this.Er.get("");e!==t&&(this.Er.set("",t),this.t("nodeTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get nodeTemplateMap(){return this.Er}set nodeTemplateMap(t){const e=this.Er;e!==t&&(this.Er=t,this.t("nodeTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplate(){return this.Zh.get("")}set groupTemplate(t){const e=this.Zh.get("");e!==t&&(this.Zh.set("",t),this.t("groupTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplateMap(){return this.Zh}set groupTemplateMap(t){const e=this.Zh;e!==t&&(this.Zh=t,this.t("groupTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplate(){return this.jl.get("")}set linkTemplate(t){const e=this.jl.get("");e!==t&&(this.jl.set("",t),this.t("linkTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplateMap(){return this.jl}set linkTemplateMap(t){const e=this.jl;e!==t&&(this.jl=t,this.t("linkTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get isMouseCaptured(){return this.hM}set isMouseCaptured(e){const i=this.ft;if(null===i)return;const n=i.Tt;n instanceof SVGElement||(e?(this.lastInput.bubbles=!1,this.Pi(n,"pointermove",this.sa,!1),this.Pi(n,"pointerdown",this.$l,!1),this.Pi(n,"pointerup",this.na,!1),this.Pi(n,"pointerout",this.oa,!1),this.Pi(n,"pointercancel",this.ra,!1),this.Bt(t,"pointermove",this.sa,!0),this.Bt(t,"pointerdown",this.$l,!0),this.Bt(t,"pointerup",this.na,!0),this.Bt(t,"pointerout",this.oa,!0),this.Bt(t,"pointercancel",this.ra,!0),this.Pi(n,"wheel",this.ea,!1),this.Bt(t,"wheel",this.ea,!0),this.Bt(t,"selectstart",this.Gh,!1)):(this.Pi(t,"pointermove",this.sa,!0),this.Pi(t,"pointerdown",this.$l,!0),this.Pi(t,"pointerup",this.na,!0),this.Pi(t,"pointerout",this.oa,!0),this.Pi(t,"pointercancel",this.ra,!0),this.Bt(n,"pointermove",this.sa,!1),this.Bt(n,"pointerdown",this.$l,!1),this.Bt(n,"pointerup",this.na,!1),this.Bt(n,"pointerout",this.oa,!1),this.Bt(n,"pointercancel",this.ra,!1),this.Pi(t,"wheel",this.ea,!0),this.Pi(t,"selectstart",this.Gh,!1),this.Bt(n,"wheel",this.ea,!1)),this.hM=e)}get position(){return this.at}set position(t){if(this.at.equals(t))return;const e=y.l().a(this.at),i=this.viewportBounds.copy();if(this.at.a(t),this.animationManager.pL(e,this.at),this.jt||null===this.ft&&!this.Iu.isReal())this.Zl(),this.bb();else{this.jt=!0;const t=this.scale,e=this.xt/t,i=this.bt/t;this.TM(this.zm,e,i,this.Fc,!1),this.jt=!1}if(!this.jt){const t=this.viewportBounds;this.onViewportBoundsChanged(i,t,this.tt,!1)}y.e(e)}get initialPosition(){return this.Px}set initialPosition(t){this.Px.equals(t)||(this.Px=t.P())}get initialScale(){return this.Sx}set initialScale(t){this.Sx!==t&&(e.s(t,"number",vt,"initialScale"),this.Sx=t)}get grid(){return null===this.Ze&&(this.Ze=this.BL()),this.Ze}set grid(t){let i=this.Ze;if(i!==t){null===i&&(this.Ze=this.BL(),i=this.Ze),t.type!==Yt.Grid&&e.o("Diagram.grid must be a Panel of type Panel.Grid");const n=i.panel;null!==n&&n.remove(i),this.Ze=t,t.name="GRID",null!==n&&n.add(t),this.Eu=!1,this.S(),this.t("grid",i,t)}}get viewportBounds(){return this.eb}Zl(){const t=this.eb,e=this.at,i=this.tt;t.i(e.x,e.y,Math.max(this.xt,0)/i,Math.max(this.bt,0)/i),this.Ql()}get viewSize(){return this.Iu}set viewSize(t){const e=this.viewSize;if(!e.equals(t)){t=t.P(),this.Iu=t;let i=0,n=0;t.isReal()?(i=t.width,n=t.height):null!==this.St&&(i=this.St.clientWidth||1,n=this.St.clientHeight||1),this.xt=i,this.bt=n,this.Zl(),this.invalidateDocumentBounds(),this.t("viewSize",e,t),this.S()}}get fixedBounds(){return this.Lx}set fixedBounds(t){const i=this.Lx;i.equals(t)||((t.width===-1/0||t.height===1/0||t.height===-1/0)&&e.o("fixedBounds width/height must not be Infinity"),t=t.P(),this.Lx=t,this.invalidateDocumentBounds(),this.t("fixedBounds",i,t))}get scrollMargin(){return this.Jh}set scrollMargin(t){"number"==typeof t&&(t=new b(t));const e=this.Jh;e.equals(t)||(t=t.P(),this.Jh=t,this.t("scrollMargin",e,t),this.mu())}get scrollMode(){return this.jh}set scrollMode(t){const e=this.jh;e!==t&&(this.jh=t,1===t&&this.Us(!1),this.t("scrollMode",e,t),this.ha(),this.S())}get scrollsPageOnFocus(){return this.Ax}set scrollsPageOnFocus(t){const i=this.Ax;i!==t&&(e.s(t,"boolean",vt,"scrollsPageOnFocus"),this.Ax=t,this.t("scrollsPageOnFocus",i,t))}get positionComputation(){return this.Tx}set positionComputation(t){const i=this.Tx;i!==t&&(null!==t&&e.k(t,vt,"positionComputation"),this.Tx=t,this.Us(!1),this.t("positionComputation",i,t))}get scaleComputation(){return this.Dx}set scaleComputation(t){const i=this.Dx;i!==t&&(null!==t&&e.k(t,vt,"scaleComputation"),this.Dx=t,this.QL(this.scale,this.scale),this.t("scaleComputation",i,t))}get documentBounds(){return this.zm}iA(t){this._h=!1;let e=this.zm;e.equals(t)||(e=e.copy(),this.zm.a(t),this.Us(!1),this.D("DocumentBoundsChanged",void 0,e),this.ha(),this.S())}ensureBounds(){if(this._h){const t=v.l();this.iA(this.computeBounds(t)),v.e(t)}}get isVirtualized(){return this.sb}set isVirtualized(t){const i=this.sb;i!==t&&(e.s(t,"boolean",vt,"isVirtualized"),this.sb=t,this.t("isVirtualized",i,t))}get scale(){return this.tt}set scale(t){const e=this.tt;e!==t&&this.QL(e,t)}get defaultScale(){return this.Gm}set defaultScale(t){this.Gm=t}get autoScale(){return this.Gl}set autoScale(t){const e=this.Gl;e!==t&&(this.Gl=t,this.t("autoScale",e,t),1!==t&&this.Us(!1))}get initialAutoScale(){return this.Pr}set initialAutoScale(t){const e=this.Pr;e!==t&&(this.Pr=t,this.t("initialAutoScale",e,t))}get initialViewportSpot(){return this.Rx}set initialViewportSpot(t){const i=this.Rx;i!==t&&(t.isSpot()||e.o("initialViewportSpot must be a specific Spot: "+t),this.Rx=t,this.t("initialViewportSpot",i,t))}get initialDocumentSpot(){return this.Fx}set initialDocumentSpot(t){const i=this.Fx;i!==t&&(t.isSpot()||e.o("initialViewportSpot must be a specific Spot: "+t),this.Fx=t,this.t("initialDocumentSpot",i,t))}get minScale(){return this.Mx}set minScale(t){const i=this.Mx;i!==t&&(t>0?(this.Mx=t,this.t("minScale",i,t),t>this.scale&&(this.scale=t)):e.W(t,"> 0",vt,"minScale"))}get maxScale(){return this.Nx}set maxScale(t){const i=this.Nx;i!==t&&(t>0?(this.Nx=t,this.t("maxScale",i,t),t<this.scale&&(this.scale=t)):e.W(t,"> 0",vt,"maxScale"))}get zoomPoint(){return this.Cx}set zoomPoint(t){this.Cx.equals(t)||(t=t.P(),this.Cx=t)}get contentAlignment(){return this.Fc}set contentAlignment(t){const e=this.Fc;e.equals(t)||(t=t.P(),this.Fc=t,this.t("contentAlignment",e,t),this.Us(!1))}get initialContentAlignment(){return this.Om}set initialContentAlignment(t){const e=this.Om;e.equals(t)||(t=t.P(),this.Om=t,this.t("initialContentAlignment",e,t))}get padding(){return this.Zt}set padding(t){"number"==typeof t&&(t=new b(t));const e=this.Zt;e.equals(t)||(t=t.P(),this.Zt=t,this.invalidateDocumentBounds(),this.t("padding",e,t))}get partManager(){return this.mM}set partManager(t){const i=this.mM;i!==t&&(null!==t.diagram&&e.o("Cannot share PartManagers between Diagrams: "+t.toString()),i&&i.So(null),this.mM=t,t.So(this))}get nodes(){return this.partManager.nodes.iterator}get links(){return this.partManager.links.iterator}get parts(){return this.partManager.parts.iterator}findTopLevelNodesAndLinks(){const t=new u,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&t.add(i)}const i=this.links;for(;i.next();){const e=i.value;e.isTopLevel&&t.add(e)}return t.iterator}findTopLevelGroups(){return this.Vr.iterator}get routers(){return this.Vc}doLinkRouting(t){this.No=!0;const e=this.Vc.r;for(let i=0;i<e.length;i++)e[i].canRoute(t)&&e[i].routeLinks(this.Sr,t);this.No=!1}get layout(){return this.ie}set layout(t){const e=this.ie;e!==t&&(this.ie=t,t.diagram=this,t.group=null,this.Ur=!0,this.t("layout",e,t),this.requestUpdate())}layoutDiagram(t){this.Mi(),t&&this.Nb(!0),this.ys?this.RM(!1,this.xl||0!==this.Vc.count&&0!==this.Yn.size):(this.vc=!0,this.fr())}Nb(t){const e=this.Vr.iterator;for(;e.next();)this.eA(e.value,t);this.layout&&(t?this.layout.isValidLayout=!1:this.layout.invalidateLayout())}eA(t,e){if(null===t)return;const i=t.aa.iterator;for(;i.next();){const t=i.value;this.eA(t,e)}null!==t.layout&&(e?t.layout.isValidLayout=!1:t.layout.invalidateLayout())}RM(t,e){if(this.Xx)return;const i=this.X;this.X=!0;const n="Layout",s=this.undoManager.transactionLevel,o=this.layout,r=this.animationManager;try{0===s&&(this.undoManager.yl=!0,this.startTransaction(n)),s<=1&&!r.defaultAnimation.isAnimating&&!r.pi&&(t||r.Dl(n)),this.Ur=!1;let i=this.Vr.iterator;for(;i.next();)this.sA(i.value,t,s,e);let a=!1;if(o.isValidLayout||(!t||o.isRealtime||null===o.isRealtime||0===s?(o.doLayout(this),this.t0(this),a=!0,o.isValidLayout=!0):this.Ur=!0),a||this.t0(this),this.doLinkRouting(this),this.Sr.clear(),0!==this.$h.size){for(let t=0;t<23&&0!==this.$h.size;t++){for(i=this.Vr.iterator;i.next();)this.nA(i.value);const t=this.Sr;this.Sr=this.$h,this.$h=t,this.t0(this),this.doLinkRouting(this)}this.Sr.clear(),this.$h.clear()}}finally{const t=this.undoManager.yl;0===s&&(this.commitTransaction(n),this.undoManager.yl=!1),t&&(0===s||1===s)&&r.vS(),this.Ur&&(this.Ur=!o.isValidLayout),this.X=i}}sA(t,e,i,n){const s=t.aa.iterator;for(;s.next();)this.sA(s.value,e,i,n);const o=t.layout;null===o||o.isValidLayout?n&&this.doLinkRouting(t):!e||o.isRealtime||0===i?(t.ca=!t.location.isReal(),o.doLayout(t),t.invalidateLayout(32),this.kb(t),this.t0(t),this.doLinkRouting(t),o.isValidLayout=!0):(this.doLinkRouting(t),this.Ur=!0)}nA(t){const e=t.aa.iterator;for(;e.next();)this.nA(e.value);this.t0(t),this.doLinkRouting(t)}get isTreePathToChildren(){return this.vx}set isTreePathToChildren(t){const i=this.vx;if(i!==t&&(e.s(t,"boolean",vt,"isTreePathToChildren"),this.vx=t,this.t("isTreePathToChildren",i,t),!this.undoManager.isUndoingRedoing)){const t=this.nodes;for(;t.next();)t.value.r0()}}findTreeRoots(){const t=new l,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&null===i.findTreeParentLink()&&t.add(i)}return t.iterator}get treeCollapsePolicy(){return this.Ox}set treeCollapsePolicy(t){const i=this.Ox;i!==t&&(1!==t&&2!==t&&3!==t&&e.o("Unknown Diagram.treeCollapsePolicy: "+t),this.Ox=t,this.t("treeCollapsePolicy",i,t))}get isCollapsingExpanding(){return this.QS}set isCollapsingExpanding(t){this.QS=t}oR(){const t=new m,e=new m;function i(i){const n=i.toLowerCase(),s=new l;t.set(i,s),t.set(n,s),e.set(i,i),e.set(n,i)}i("InitialAnimationStarting"),i("AnimationStarting"),i("AnimationFinished"),i("BackgroundSingleClicked"),i("BackgroundDoubleClicked"),i("BackgroundContextClicked"),i("ClipboardChanged"),i("ClipboardPasted"),i("DocumentBoundsChanged"),i("ExternalObjectsDropped"),i("GainedFocus"),i("InitialLayoutCompleted"),i("LayoutCompleted"),i("LinkDrawn"),i("LinkRelinked"),i("LinkReshaped"),i("LostFocus"),i("Modified"),i("ObjectSingleClicked"),i("ObjectDoubleClicked"),i("ObjectContextClicked"),i("PartCreated"),i("PartResized"),i("PartRotated"),i("SelectionMoved"),i("SelectionCopied"),i("SelectionDeleting"),i("SelectionDeleted"),i("SelectionGrouped"),i("SelectionUngrouped"),i("ChangingSelection"),i("ChangedSelection"),i("SubGraphCollapsed"),i("SubGraphExpanded"),i("TextEdited"),i("ThemeChanged"),i("TreeCollapsed"),i("TreeExpanded"),i("ViewportBoundsChanged"),i("InvalidateDraw"),this.$S=t,this.ZS=e}YL(t){const e=this.ZS.get(t);return null!==e?e:this.ZS.get(t.toLowerCase())}KM(t){let i=this.$S.get(t);if(null!==i)return i;const n=t.toLowerCase();if(i=this.$S.get(n),null!==i)return i;e.o("Unknown DiagramEvent name: "+t)}addDiagramListener(t,i){e.s(t,"string",vt,"addDiagramListener:name"),e.k(i,vt,"addDiagramListener:listener");const n=this.KM(t);return null!==n&&n.add(i),this}removeDiagramListener(t,i){e.s(t,"string",vt,"removeDiagramListener:name"),e.k(i,vt,"addDiagramListener:listener");const n=this.KM(t);null!==n&&n.delete(i)}raiseDiagramEvent(t,e,i){this.D(t,e,i)}D(t,e,i){const n=this.KM(t),s=new F;s.diagram=this;const o=this.YL(t);null!==o&&(s.name=o),void 0!==e&&(s.subject=e),void 0!==i&&(s.parameter=i);const r=n.length;if(1===r)n.elt(0)(s);else if(0!==r){const t=n.toArray();for(let e=0;e<r;e++){(0,t[e])(s)}}}isUnoccupied(t,e){return this.getPositions(!1,null,e||null).isUnoccupied(t.x,t.y,t.width,t.height)}computeOccupiedArea(t){return this.isVirtualized?this.viewportBounds.copy():this._h?this.VL(t):t.a(this.documentBounds)}getPositions(t,e,i){let n=this.Hl;null===n&&(this.Hl=n=new ke(this.avoidanceCellSize));let s=e;if(n.Do||n.fa!==s||n.GM!==i){if(n.HM=Math.max(n.Kc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.width)),n.jM=Math.max(n.Kc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.height)),null!==s&&(s=this.oA(s)),null===s){const t=v.l();this.computeOccupiedArea(t),t.inflate(100,100),n.Cb(t);const e=this.nodes;for(;e.next();){const n=e.value,s=n.layer;null===s||!s.visible||s.isTemporary||this.qM(n,i,t)}v.e(t)}else{if(s.memberParts.count>0){const t=this.computePartsBounds(s.memberParts,!1);t.inflate(20,20),n.Cb(t)}const t=v.l(),e=s.memberParts;for(;e.next();){const n=e.value;n instanceof pe&&this.qM(n,i,t)}v.e(t)}n.fa=s,n.GM=i,n.Do=!1}else t&&n.rA();return n}get avoidanceCellSize(){return this.fM}set avoidanceCellSize(t){this.Hl=null,this.fM=new x(Math.max(1,t.width),Math.max(1,t.height))}get avoidanceLimit(){return this.uM}set avoidanceLimit(t){this.uM=Math.max(1,t)}oA(t){return t.canAvoid()?t:null!==t.containingGroup?this.oA(t.containingGroup):null}qM(t,e,i){if(t===e||!t.isVisible())return;const n=t.canAvoid();if(n){const e=t.getAvoidableRect(i);this.Hl.UR(e.x,e.y,e.width,e.height)}if(t instanceof Ne&&(!n||t.avoidableMembers)){const n=t.memberParts;for(;n.next();){const t=n.value;t instanceof pe&&this.qM(t,e,i)}}}WM(t){null!==this.Hl&&!this.Hl.Do&&(void 0===t||t.canAvoid())&&(this.Hl.Do=!0)}get autoScrollInterval(){return this.Im}set autoScrollInterval(t){const e=this.Im;e!==t&&(this.Im=t,this.t("autoScrollInterval",e,t))}get autoScrollRegion(){return this.Em}set autoScrollRegion(t){"number"==typeof t&&(t=new b(t));const e=this.Em;e.equals(t)||(t=t.P(),this.Em=t,this.invalidateDocumentBounds(),this.t("autoScrollRegion",e,t))}doAutoScroll(t){this.Ym.a(t),this.computeAutoScrollPosition(this.Ym).equalsApprox(this.position)?this.stopAutoScroll():this.lA()}lA(){if(-1!==this.Rc)return;const t=this.Im,i=this;this.Rc=e.tr((()=>{if(-1===i.Rc||(i.stopAutoScroll(),null===i.lastInput.event))return;const t=i.computeAutoScrollPosition(i.Ym);if(t.equalsApprox(i.position))return;i.position=t,i.lastInput.documentPoint=i.transformViewToDoc(i.Ym),i.doMouseMove(),i._h=!0;const e=v.l();i.computeBounds(e),e.unionRect(i.documentBounds),i.iA(e),v.e(e),i.Be=!0,i.maybeUpdate(),i.lA()}),t)}stopAutoScroll(){-1!==this.Rc&&(e.Tg(this.Rc),this.Rc=-1)}computeAutoScrollPosition(t){let e=this.position;const i=this.Em;if(i.top<=0&&i.left<=0&&i.right<=0&&i.bottom<=0)return e;const n=this.viewportBounds,s=this.scale,o=v.V(0,0,n.width*s,n.height*s),r=y.V(0,0);if(t.x>=o.x&&t.x<o.x+i.left&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x-=e,t.x<o.x+i.left/2&&(r.x-=e),t.x<o.x+i.left/4&&(r.x-=4*e)}else if(t.x<=o.x+o.width&&t.x>o.x+o.width-i.right&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x+=e,t.x>o.x+o.width-i.right/2&&(r.x+=e),t.x>o.x+o.width-i.right/4&&(r.x+=4*e)}if(t.y>=o.y&&t.y<o.y+i.top&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y-=e,t.y<o.y+i.top/2&&(r.y-=e),t.y<o.y+i.top/4&&(r.y-=4*e)}else if(t.y<=o.y+o.height&&t.y>o.y+o.height-i.bottom&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y+=e,t.y>o.y+o.height-i.bottom/2&&(r.y+=e),t.y>o.y+o.height-i.bottom/4&&(r.y+=4*e)}return r.equalsApprox(y.wo)||(e=new y(e.x+r.x/s,e.y+r.y/s)),v.e(o),y.e(r),e}makeSvg(i){this.ql.has("SVG")||this.addRenderer("SVG",new Et(this,t.document));const n=new Et(this,t.document,!0);void 0===i&&(i={});const s=this;return this.aA((function(t,i){const o=s.hA(t,"SVG",n),r=null!==o?o.svg:null;return e.it(i)?(i(r),null):r}),i)}makeSVG(t){return this.makeSvg(t)}addRenderer(t,e){this.ql.set(t,e)}removeRenderer(t){this.ql.delete(t)}cacheGroupExternalLinks(t){this.SM=t,t||this.nodes.each((t=>{t instanceof Ne&&(t.l0=null)}))}aA(i,n){const s=n.callback;let o=!0;const r=this.Wl.iterator;for(;r.next();)if(!r.value[0].hn){o=!1;break}if(!e.it(s)||o)return i(n,s,this);const a=this;function l(){const e=+new Date;for(o=!0,r.reset();r.next();)if(!r.value[0].hn){o=!1;break}o||e-u>h?i(n,s,a):t.requestAnimationFrame(l)}const h=n.callbackTimeout||300,u=+new Date;return t.requestAnimationFrame((()=>l())),null}makeImage(t){return vt.isUsingDOM()?(void 0===t&&(t={}),t.returnType="Image",this.makeImageData(t)):null}makeImageData(t){return void 0===t&&(t={}),this.aA(this.VR,t)}static img="image";VR(t,i,n){const s=n.hA(t,"canvas",null);if(null===s)return null;const o=s.E.canvas;let r=null;if(null!==o){let n=t.returnType;switch(n=void 0===n?"string":n.toLowerCase(),n){case vt.img+"data":r=s.getImageData(0,0,o.width,o.height);break;case vt.img:const n=(t.document||document).createElement("img");n.src=o.toDataURL(t.type,t.details),r=n;break;case"blob":{const n=o;return e.it(i)||(r="",e.o('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.')),e.it(n.toBlob)?(n.toBlob(i,t.type,t.details),"toBlob"):(i(null),null)}default:r=o.toDataURL(t.type,t.details)}}return e.it(i)?(i(r),null):r}static zR=!1;hA(t,i,n){if(this.animationManager.stopAnimation(),this.maybeUpdate(),null===this.ft)return null;e.K(t)||e.o("properties argument must be an Object.");let s=!1,o=t.size||null,r=t.scale||null;void 0!==t.scale&&isNaN(t.scale)&&(r="NaN");let a=t.maxSize;void 0===t.maxSize&&(s=!0,a="SVG"===i?new x(1/0,1/0):new x(2e3,2e3));const h=t.position||null;let u=t.parts||null;Array.isArray(u)&&(u=new l(u));let c=void 0===t.padding?1:t.padding;const d=t.background||null;let f=t.omitTemporary;void 0===f&&(f=!0);const g=t.document||document,p=t.elementFinished||null;let m=t.showTemporary;void 0===m&&(m=!f);let w=t.showGrid;void 0===w&&(w=m),null!==o&&isNaN(o.width)&&isNaN(o.height)&&(o=null),"number"==typeof c?c=new b(c):c instanceof b||e.o("MakeImage padding must be a Margin or a number."),c.left=Math.max(c.left,0),c.right=Math.max(c.right,0),c.top=Math.max(c.top,0),c.bottom=Math.max(c.bottom,0),this.Qt.clearContextCache(!0);const k=new Bt(null,g,void 0,!0),S=k.li;if(!(o||r||u||h))return k.width=this.xt+Math.ceil(c.left+c.right),k.height=this.bt+Math.ceil(c.top+c.bottom),"SVG"===i?null===n?null:(n.resize(k.width,k.height,k.width,k.height),n.ua=g,n.Ku=p,this.Pb(n.li,c,new x(k.width,k.height),this.tt,this.at,u,d,m,w),n.li):(this.Uu=!1,this.Pb(S,c,new x(k.width,k.height),this.tt,this.at,u,d,m,w),this.Uu=!0,k.li);const P=this.Gm,M=this.documentBounds.copy();if(M.subtractMargin(this.Zt),m){const t=this.Xt.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];if(!e.visible||!e.isTemporary)continue;const n=e.Ct.r,s=n.length;for(let t=0;t<s;t++){const e=n[t];if(!e.isInDocumentBounds||!e.isVisible())continue;const i=e.actualBounds;i.isReal()&&M.unionRect(i)}}}let C=new y(M.x,M.y);if(null!==u){const t=new v(0,0,0,0);let e=!0;const i=u.iterator;for(i.reset();i.next();){const n=i.value;if(!(n instanceof ce))continue;const s=n.layer;if(null!==s&&!s.visible||null!==s&&!m&&s.isTemporary||!n.isVisible())continue;const o=n.actualBounds;o.isReal()&&(e?(e=!1,t.a(o)):t.unionRect(o))}M.width=t.width,M.height=t.height,C.x=t.x,C.y=t.y}null!==h&&h.isReal()&&(C=h,r||(r=P));let N=0,T=0;null!==c&&(N=c.left+c.right,T=c.top+c.bottom);let L=0,A=0;null!==o&&(L=o.width,A=o.height,isFinite(L)&&(L=Math.max(0,L-N)),isFinite(A)&&(A=Math.max(0,A-T)));let D=0,F=0;if(null!==o&&null!==r?("NaN"===r&&(r=P),o.isReal()?(D=L,F=A):isNaN(A)?(D=L,F=M.height*r):(D=M.width*r,F=A)):null!==o?o.isReal()?(r=Math.min(L/M.width,A/M.height),D=L,F=A):isNaN(A)?(r=L/M.width,D=L,F=M.height*r):(r=A/M.height,D=M.width*r,F=A):null!==r?"NaN"===r&&a.isReal()?(r=Math.min((a.width-N)/M.width,(a.height-T)/M.height),r>P?(r=P,D=M.width,F=M.height):(D=a.width,F=a.height)):(D=M.width*r,F=M.height*r):(r=P,D=M.width,F=M.height),null!==c?(D+=N,F+=T):c=new b(0),null!==a){let t=a.width,e=a.height;"SVG"!==i&&s&&vt.zR,isNaN(t)&&(t=2e3),isNaN(e)&&(e=2e3),isFinite(t)&&(D=Math.min(D,t)),isFinite(e)&&(F=Math.min(F,e))}return k.width=Math.ceil(D),k.height=Math.ceil(F),"SVG"===i?null===n?null:(n.resize(k.width,k.height,k.width,k.height),n.ua=g,n.Ku=p,this.Pb(n.li,c,new x(Math.ceil(D),Math.ceil(F)),r,C,u,d,m,w),n.li):(this.Uu=!1,this.Pb(S,c,new x(Math.ceil(D),Math.ceil(F)),r,C,u,d,m,w),this.Uu=!0,k.li)}static Xu=null;static cA="5da73c80a36555d4038e4972187c3cae51fd22";static dw=!1;static Yk=()=>{if(void 0===vt.cA[5]&&(k.prototype.$e=k.prototype.xw),!vt.isUsingDOM())return;const t=e.hs("canvas"),i=t.getContext("2d"),n=e.Ts("7ca11abfd022028846");i[n]=e.Ts("398c3597c01238");const s="7ca11abfd7330390",o=[vt.cA,e.dw+"4ae6247590da4bb21c324ba3a84e385776",k.Yk+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",S.za];for(let r=1;r<5;r++)i[e.Ts(s)](e.Ts(o[r-1]),10,15*r+0);i[n]=e.Ts("39f046ebb36e4b");for(let r=1;r<5;r++)i[e.Ts(s)](e.Ts(o[r-1]),10,15*r+0);(4!==o.length||"5"!==o[0][0]||"7"!==o[3][0])&&(k.prototype.$e=k.prototype.xw),vt.Xu=t}}class bt{fA;uA;JM;Ne;constructor(t){if(this.fA=null,this.uA="63ad05bbe23a1786468a4c741b6d2",this.JM="@onz",this.uA===this._tk)return this.JM=!0,void(this.Ne=this.JM);this.Ne=null}XR(i,n){let s="f";const o=t[e.Ts("76a715b2f73f148a")][e.Ts("72ba13b5")]||"",r=e.Ts;if(this.Ne=!0,!vt.isUsingDOM())return;let a=vt[r("76a115b6ed251eaf4692")];if(!a){const t=o[r("76ad18b4f73e")];for(let i=o[r("73a612b6fb191d")](r("35e7"))+2;i<t;i++)s+=o[i];const e=s[r("73a612b6fb191d")](r("7da71ca0ad381e90"));return void(this.Ne=!(e>=0&&e<s[r("73a612b6fb191d")](r("35"))))}const l=vt.zM.iterator;for(;l.next();){a=l.value;const i=r(a).split(r("39e9"));if(i.length<6)return;const h=r(i[1]).split(".");if("7da71ca0"!==i[4])return;const u=r(e[r("6cae19")]).split(".");if(!(h[0]>u[0]||h[0]===u[0]&&h[1]>=u[1]))continue;const c="73a612b6fb191d",d=t[r("74a900bae4370f8b51")][r("6fbb13a1c2311e8a57")].toLowerCase(),f=d[r(c)](r("3aad1ab6e022098b4dc4")),g=r(i[2]);if(f>-1){const t=d[r(c)](g.toLowerCase()+"/");if(this.Ne=!(t>-1&&t<f),!this.Ne)return}const p=o[r("76ad18b4f73e")];for(let t=o[r(c)](r("35e7"))+2;t<p;t++)s+=o[t];let m=s[r(c)](g);if(m<0&&g!==r("7da71ca0ad381e90")&&(m=s[r(c)](r("76a715b2ef3e149757"))),m<0&&(m=s[r(c)](r("76a715b2ef3e149757"))),m<0&&(m=s[r(c)](r("2bfa41fdb3784bca12"))),m<0&&(m=o[r(c)](r("7baa19a6f76c1988428554"))),m<0&&(m=o[r(c)](r("7ea902b2b9221e9c57c45767196566"))),this.Ne=!(m>=0&&m<s[r(c)](r("35"))||-1===s[r(c)](r("35"))),!this.Ne||o[r(c)](r("7fb002b6ed25128b4da25b2e"))&&(this.Ne=!(o[r(c)](g)>-1),!this.Ne))return;const y=t[e.Ts("76a715b2f73f148a")][e.Ts("69ad17a1e03e")],x=y[r(c)](r("7fb002b6ed25128b4da25b2e"));if(x>-1&&(this.Ne=!(y[r(c)](g)>x),!this.Ne))return;const v=g;if("#"!==v[0])continue;const b=e.hs("div");let w=i[0].replace(/[A-Za-z]/g,"");for(;w.length<4;)w+="9";const k=w;w=w.substring(w.length-4);let S="";const P=["Header","Background","Display","Feedback"];if(S+=["gsh","gsf"][parseInt(w.substring(0,1),10)%2],S+=P[parseInt(w.substring(0,1),10)%4],b[r("79a417a0f0181a8946")]=S,t.document[r("78a712aa")]){t.document[r("78a712aa")][r("7bb806b6ed32388c4a875b")](b);const e=t.getComputedStyle(b).getPropertyValue(r("78a704b7e62456904c9b12701b6532a8")),i=t.getComputedStyle(b).getPropertyValue(r("75b817b0ea2202"));if(t.document[r("78a712aa")][r("68ad1bbcf533388c4a875b")](b),!e)continue;const n=t[r("77a902b0eb1b1e804a8a")];if(i==="0."+parseInt(k,10)%100||-1!==e.indexOf(parseInt(v[1]+v[2],16))&&-1!==e.indexOf(parseInt(v[3]+v[4],16)))return void(this.Ne=!1);if(n&&n(r("32ae19a1e0331fc94084537c067a67fa59f1386b89d006")).matches){S="."+S;for(let t=0;t<document.styleSheets.length;t++){const e=document.styleSheets[t].rules||document.styleSheets[t].cssRules;for(const t in e)if(S===e[t].selectorText)return void(this.Ne=!1)}}}else this.Ne=null,n&&(this.Ne=!1)}}Xu(t){return t.Qt.setTransform(t.Vi,0,0,t.Vi,0,0),t.Qt.commitTransform(),null===this.Ne&&this.XR(t,!0),0<this.Ne&&this!==this.fA}}class wt{$M;ZM;constructor(t){this.$M=void 0===t?new y:t,this.ZM=new y}get point(){return this.$M}set point(t){this.$M=t}get shifted(){return this.ZM}set shifted(t){this.ZM=t}}class kt{Me;qL;Mb;constructor(t,e,i){this.Me=t,this.qL=e,this.Mb=i}}class St{isGridSnapEnabled;isGridSnapRealtime;gridSnapCellSize;gridSnapCellSpot;gridSnapOrigin;dragsLink;dragsTree;groupsSnapMembers;groupsAlwaysMove;dragsMembers;constructor(t){this.Ri(),t&&Object.assign(this,t)}Ri(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new x(NaN,NaN).u(),this.gridSnapCellSpot=w.TopLeft,this.gridSnapOrigin=new y(NaN,NaN).u(),this.dragsLink=!1,this.dragsTree=!1,this.groupsSnapMembers=!1,this.groupsAlwaysMove=!0,this.dragsMembers=!0}}class Pt extends vt{Lb;Ab;Tb;Db;h0;Gc;Ll;QM;_M;Fb;t2;constructor(i,n){let s;return void 0===i||"string"==typeof i||t.Element&&i instanceof Element?s=i:e.K(i)&&(n=i),super(s),this.animationManager.isEnabled=!1,this.jt=!0,this.Lb=null,this.Ru=!1,this.vu=!1,this.Ab=!0,this.Tb=!0,this.Db=0,this.h0=!1,this.Gc=null,this.setRenderingHint("drawShadows",!1),this.Ll=new ce({selectable:!0,selectionAdorned:!1,selectionObjectName:"BOXSHAPE",locationObjectName:"BOXSHAPE",resizeObjectName:"BOXSHAPE",cursor:"move"}).add(new Jt({name:"BOXSHAPE",fill:"transparent",stroke:"magenta",strokeWidth:2}).theme("stroke","overviewBox")).Et(),this.allowCopy=!1,this.allowDelete=!1,this.allowDrop=!1,this.allowSelect=!0,this.autoScrollRegion=new b(0,0,0,0),this.at.i(0,0),this.toolManager.Jt("Dragging",new Mt,this.toolManager.mouseMoveTools),this.click=()=>{const t=this.observed;if(null===t)return;const e=t.viewportBounds,i=this.lastInput.documentPoint;t.position=new y(i.x-e.width/2,i.y-e.height/2)},this.QM=t=>{this.invalidateDocumentBounds(),this.a0()},this._M=t=>{null!==this.observed&&(this.invalidateDocumentBounds(),this.S())},this.Fb=t=>{this.updateDelay<1?this.S():this.h0||(this.h0=!0,e.tr((()=>this.redraw()),this.updateDelay))},this.t2=t=>{null!==this.observed&&this.a0()},this.autoScale=2,this.jt=!1,n&&Object.assign(this,n),this}setupRouters(){}computePixelRatio(){return 1}redraw(){this.h0&&this.updateDelay>=1&&(this.h0=!1,this.YR()),super.redraw()}Bi(){if(null===this.St&&e.o("No div specified"),null===this.ft&&e.o("No canvas specified"),this.ft instanceof Et||(this.box.WS(),!this.Be))return;const t=this.observed;if(null===t||t.animationManager.defaultAnimation.isAnimating||!t.Uh)return;this.i0();const i=this.ft,n=this.Qt;if(n.clearContextCache(!0),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,i.width,i.height),this.updateDelay<1)this.gA();else if(null!==this.Gc){n.drawImage(this.Gc.Tt,0,0);const t=this.T;n.scale(this.Vi,this.Vi),n.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),n.commitTransform()}const s=this.Xt.r,o=s.length;for(let e=0;e<o;e++)s[e].Bi(n,this);this.Ic=!1,this.Be=!1}YR(){const t=this.ft,e=this.Qt;if(null!==t&&null!==e){if(this.i0(),null===this.Gc){const e=new Bt(null);e.width=t.width,e.height=t.height,this.Gc=e}try{this.ft=this.Gc,this.Qt=this.ft.li,this.Qt.clearContextCache(!0),this.Qt.setTransform(1,0,0,1,0,0),this.Qt.clearRect(0,0,this.ft.width,this.ft.height),this.gA()}finally{this.ft=t,this.Qt=e}}}gA(){const t=this.observed;if(null===t)return;const e=this.drawsTemporaryLayers,i=this.drawsGrid&&e,n=t.grid;if(i&&null!==n&&n.visible&&!isNaN(n.width)&&!isNaN(n.height)){const e=v.l().a(this.viewportBounds).unionRect(t.viewportBounds);t._l(e),v.e(e),t.Mi()}const s=this.T,o=this.Qt;o.scale(this.Vi,this.Vi),o.transform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),o.commitTransform();const r=this.viewportBounds,a=t.Xt.r,l=a.length,h=this.Xt.r;this.ps(h,h.length,this,this.viewportBounds);for(let u=0;u<l;u++)a[u].KF(o,r,this,e,i)}get observed(){return this.Lb}set observed(t){const i=this.Lb;if(t instanceof Pt&&e.o("Overview.observed Diagram may not be an Overview itself: "+t),i!==t){if(null!==i&&this.KR(i),this.Lb=t,null!==t&&this.GR(t),this.invalidateDocumentBounds(),null===t){this.Gc=null;const t=this.ft,e=this.Qt;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else this.Fb(null),this.a0(),this.S();this.t("observed",i,t)}}get box(){return this.Ll}set box(t){const e=this.Ll;e!==t&&(t.Et(),this.Ll=t,this.remove(e),this.add(this.Ll),this.a0(),this.t("box",e,t))}get drawsTemporaryLayers(){return this.Ab}set drawsTemporaryLayers(t){this.Ab!==t&&(this.Ab=t,this.redraw())}get drawsGrid(){return this.Tb}set drawsGrid(t){this.Tb!==t&&(this.Tb=t,this.redraw())}get updateDelay(){return this.Db}set updateDelay(t){t<0&&(t=0),this.Db!==t&&(this.Db=t)}GR(t){null!==t&&(t.addDiagramListener("ViewportBoundsChanged",this.QM),t.addDiagramListener("DocumentBoundsChanged",this._M),t.addDiagramListener("InvalidateDraw",this.Fb),t.addDiagramListener("AnimationFinished",this.t2),this.add(this.box))}KR(t){null!==t&&(this.remove(this.box),t.removeDiagramListener("ViewportBoundsChanged",this.QM),t.removeDiagramListener("DocumentBoundsChanged",this._M),t.removeDiagramListener("InvalidateDraw",this.Fb),t.removeDiagramListener("AnimationFinished",this.t2))}a0(){const t=this.box,e=this.observed;if(null===e)return;this.Be=!0;const i=e.viewportBounds,n=t.selectionObject,s=x.l();s.i(i.width,i.height),n.desiredSize=s,x.e(s);const o=2/this.scale;n instanceof Jt&&(n.strokeWidth=o),t.location=new y(i.x-o/2,i.y-o/2),t.isSelected=!0}computeBounds(){const t=this.observed;if(null===t)return v.Fg;const e=t.documentBounds.copy();return e.unionRect(t.viewportBounds),e}invalidateViewport(t,e){!0!==this.Be&&(this.Be=!0,this.requestUpdate())}onViewportBoundsChanged(t,e,i,n){this.jt||(this.Ql(),this.S(),this.ha(),this.invalidateDocumentBounds(),this.a0(),this.Ui.scale=i,this.Ui.position.x=t.x,this.Ui.position.y=t.y,this.Ui.bounds.a(t),this.Ui.isScroll=n,this.D("ViewportBoundsChanged",this.Ui,t))}}class Mt extends U{ih;constructor(){super(),this.ih=null}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||!t.allowMove||!t.allowSelect)return!1;const e=t.observed;if(null===e)return!1;const i=t.lastInput;if(!i.left||t.currentTool!==this&&(!this.isBeyondDragSize()||i.isTouchEvent&&i.timestamp-t.firstInput.timestamp<this.delay))return!1;if(null===this.findDraggablePart()){const i=e.viewportBounds;this.ih=new y(i.width/2,i.height/2);const n=t.firstInput.documentPoint;e.position=new y(n.x-this.ih.x,n.y-this.ih.y)}return!0}doActivate(){this.ih=null,super.doActivate()}doUpdateCursor(t){const e=this.diagram,i=e.box;null!==i&&i.cursor&&(e.currentCursor=i.cursor)}moveParts(t,e,i){void 0===i&&(i=!1);const n=this.diagram,s=n.observed;if(null===s)return;const o=n.box;if(null===o)return;if(null===this.ih){const t=n.firstInput.documentPoint,e=o.location;this.ih=new y(t.x-e.x,t.y-e.y)}const r=n.lastInput.documentPoint;s.position=new y(r.x-this.ih.x,r.y-this.ih.y)}}class Ct{N;i2;e2;s2;o2;l2;h2;a2;c2;eh;f2;Rb;vb;Ob;Ib;u2;Fo;d2;constructor(t){u.Gi(this),this.N=vt.um(),this.i2=!0,this.e2=!0,this.s2=!0,this.o2=!1,this.l2=!1,this.h2=!1,this.a2=!1,this.c2=null,this.eh=null,this.f2=1.05,this.Rb=NaN,this.vb=null,this.Ob=NaN,this.Ib=v.Fg,this.u2=!1,this.Fo=null,this.d2=200,t&&Object.assign(this,t)}toString(){return"CommandHandler"}get diagram(){return this.N}So(t){this.N=t}doStart(){}doStop(){}doKeyDown(){const t=this.diagram,i=t.lastInput,n=e._o?i.meta:i.control,s=i.shift,o=i.alt,r=i.commandKey;!n||"Insert"!==r&&"c"!==r?n&&"x"===r||s&&"Delete"===r?this.canCutSelection()&&this.cutSelection():n&&"v"===r||s&&"Insert"===r?this.canPasteSelection()&&this.pasteSelection():n&&"y"===r||n&&s&&"z"===r||o&&s&&"Backspace"===r?this.canRedo()&&this.redo():n&&"z"===r||o&&"Backspace"===r?this.canUndo()&&this.undo():"Delete"===r||"Backspace"===r?this.canDeleteSelection()&&this.deleteSelection():n&&"a"===r?this.canSelectAll()&&this.selectAll():"Escape"===r?this.canStopCommand()&&this.stopCommand():"ArrowUp"===r?t.allowVerticalScroll&&(n?t.scroll("pixel","up"):t.scroll("line","up")):"ArrowDown"===r?t.allowVerticalScroll&&(n?t.scroll("pixel","down"):t.scroll("line","down")):"ArrowLeft"===r?t.allowHorizontalScroll&&(n?t.scroll("pixel","left"):t.scroll("line","left")):"ArrowRight"===r?t.allowHorizontalScroll&&(n?t.scroll("pixel","right"):t.scroll("line","right")):"PageUp"===r?s&&t.allowHorizontalScroll?t.scroll("page","left"):t.allowVerticalScroll&&t.scroll("page","up"):"PageDown"===r?s&&t.allowHorizontalScroll?t.scroll("page","right"):t.allowVerticalScroll&&t.scroll("page","down"):"Home"===r?n&&t.allowVerticalScroll?t.scroll("document","up"):!n&&t.allowHorizontalScroll&&t.scroll("document","left"):"End"===r?n&&t.allowVerticalScroll?t.scroll("document","down"):!n&&t.allowHorizontalScroll&&t.scroll("document","right"):"Space"===r?this.canScrollToPart()&&this.scrollToPart():"Minus"===r||"NumpadSubtract"===r?this.canDecreaseZoom()&&this.decreaseZoom():"Equal"===r||"NumpadAdd"===r?this.canIncreaseZoom()&&this.increaseZoom():n&&"Digit0"===r?this.canResetZoom()&&this.resetZoom():s&&"z"===r?this.canZoomToFit()&&this.zoomToFit():n&&!s&&"g"===r?this.canGroupSelection()&&this.groupSelection():n&&s&&"g"===r?this.canUngroupSelection()&&this.ungroupSelection():"F2"===r?this.canEditTextBlock()&&this.editTextBlock():"ContextMenu"===r||s&&"F10"===r||n&&s&&"Backslash"===r?this.canShowContextMenu()&&this.showContextMenu():i.bubbles=!0:this.canCopySelection()&&this.copySelection()}doKeyUp(){this.diagram.lastInput.bubbles=!0}stopCommand(){const t=this.diagram,e=t.currentTool;e instanceof V&&t.allowSelect&&t.clearSelection(),null!==e&&e.doCancel()}canStopCommand(){return!0}selectAll(){const t=this.diagram;t.S();try{t.currentCursor="wait",t.D("ChangingSelection",t.selection);const e=t.parts;for(;e.next();){const t=e.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const i=t.nodes;for(;i.next();){const t=i.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const n=t.links;for(;n.next();){const t=n.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}}finally{t.D("ChangedSelection",t.selection),t.currentCursor=""}}canSelectAll(){return this.diagram.allowSelect}deleteSelection(){const t=this.diagram;try{t.currentCursor="wait",t.D("ChangingSelection",t.selection),t.startTransaction("Delete"),t.D("SelectionDeleting",t.selection);const e=new u,i=t.selection.iterator;for(;i.next();){const t=i.value;ce.nh(e,t,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(t=>t.canDelete()))}t.removeParts(e,!0),t.D("SelectionDeleted",e)}finally{t.commitTransaction("Delete"),t.D("ChangedSelection",t.selection),t.currentCursor=""}}canDeleteSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowDelete||0===t.selection.count)}copySelection(){const t=this.diagram;try{const e=new u,i=t.selection.iterator;for(;i.next();){const t=i.value;ce.nh(e,t,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(t=>t.canCopy()))}this.copyToClipboard(e)}finally{}}canCopySelection(){const t=this.diagram;return!(!t.allowCopy||!t.allowClipboard||0===t.selection.count)}cutSelection(){this.copySelection(),this.deleteSelection()}canCutSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowCopy||!t.allowDelete||!t.allowClipboard||0===t.selection.count)}copyToClipboard(t){const e=this.diagram;let i=null;if(null===t)vt.vL();else{let n=null;try{n=e.copyParts(t,null,!0)}finally{i=new l,null!==n&&i.addAll(n.iteratorValues),vt.Zm=i,vt.wb=e.model.dataFormat}}e.D("ClipboardChanged",i)}pasteFromClipboard(){const t=new u,e=vt.Zm;if(null===e)return t;const i=this.diagram;if(vt.wb!==i.model.dataFormat)return t;let n=null;try{n=i.copyParts(e,i,!1)}finally{if(null!==n){const e=n.iterator;for(;e.next();){const i=e.value,n=e.key;i.location.isReal()||(n.location.isReal()?i.location=n.location:!i.position.isReal()&&n.position.isReal()&&(i.position=n.position)),t.add(i)}}}return t}pasteSelection(t){void 0===t&&(t=null);const e=this.diagram;try{e.currentCursor="wait",e.D("ChangingSelection",e.selection),e.startTransaction("Paste");const i=this.pasteFromClipboard();i.count>0&&e.clearSelection(!0);const n=i.iterator;for(;n.next();){n.value.isSelected=!0}if(null!==t){const i=e.computePartsBounds(e.selection);if(i.isReal()){const n=this.computeEffectiveCollection(e.selection,e.gb);e.AP(n,new y(t.x-i.centerX,t.y-i.centerY),e.gb,!1)}}e.D("ClipboardPasted",i)}finally{e.commitTransaction("Paste"),e.D("ChangedSelection",e.selection),e.currentCursor=""}}canPasteSelection(t){const e=this.diagram;return!(e.isReadOnly||e.isModelReadOnly||!e.allowInsert||!e.allowClipboard||null===vt.Zm||0===vt.Zm.count||vt.wb!==e.model.dataFormat)}undo(){this.diagram.undoManager.undo()}canUndo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canUndo())}redo(){this.diagram.undoManager.redo()}canRedo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canRedo())}decreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canDecreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}increaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canIncreaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}resetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;t<e.minScale||t>e.maxScale||(e.scale=t)}canResetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;return!(t<e.minScale||t>e.maxScale)&&e.allowZoom}zoomToFit(){const t=this.diagram,e=t.animationManager;e.stopAnimation(),t.redraw();const i=t.position,n=t.scale;e.Dl("Zoom To Fit"),this.isZoomToFitRestoreEnabled&&n===this.Ob&&!isNaN(this.Rb)&&null!==this.vb&&t.documentBounds.equals(this.Ib)?(t.scale=this.Rb,t.position=this.vb,this.Ob=NaN,this.Ib=v.Fg):(this.Rb=n,this.vb=i.copy(),t.zoomToFit(),this.Ob=t.scale,this.Ib=t.documentBounds.copy()),e.vS()}canZoomToFit(){return this.diagram.allowZoom}scrollToPart(t){void 0===t&&(t=null);const i=this.diagram;if(i.ensureBounds(),null===t){try{null!==this.Fo&&(this.Fo.next()?t=this.Fo.value:this.Fo=null)}catch{this.Fo=null}null===t&&(i.highlighteds.count>0?this.Fo=i.highlighteds.iterator:i.selection.count>0&&(this.Fo=i.selection.iterator),null!==this.Fo&&this.Fo.next()&&(t=this.Fo.value))}if(null!==t){const n=i.animationManager;n.Dl("Scroll To Part");const s=this.scrollToPartPause;if(s>0){const o=this.Hc(t,[t]);if(1===o.length)i.startTransaction(),i.centerRect(t.actualBounds),i.commitTransaction("Scroll To Part");else{const t=()=>{i.startTransaction();let t=o.pop();for(;o.length>0&&t instanceof pe&&t.isTreeExpanded&&(!(t instanceof Ne)||t.isSubGraphExpanded);)t=o.pop();o.length>0?(t instanceof ce&&i.scrollToRect(t.actualBounds),t instanceof pe&&!t.isTreeExpanded&&(t.isTreeExpanded=!0),t instanceof Ne&&!t.isSubGraphExpanded&&(t.isSubGraphExpanded=!0)):(t instanceof ce&&i.centerRect(t.actualBounds),i.removeDiagramListener("LayoutCompleted",r)),i.commitTransaction("Scroll To Part")},r=()=>{e.tr(t,(n.isEnabled?n.duration:0)+s)};i.addDiagramListener("LayoutCompleted",r),t()}}else{const e=i.position.copy();i.centerRect(t.actualBounds),e.equalsApprox(i.position)&&n.stopAnimation()}}}Hc(t,e){if(t.isVisible())return e;if(t instanceof fe){const i=t.adornedPart;null!==i&&this.Hc(i,e)}else if(t instanceof be){const i=t.fromNode;null!==i&&this.Hc(i,e);const n=t.toNode;null!==n&&this.Hc(n,e)}else{if(t instanceof pe){const i=t.labeledLink;null!==i&&this.Hc(i,e);const n=t.findTreeParentNode();null!==n&&(!n.isTreeExpanded&&!n.wasTreeExpanded&&e.push(n),this.Hc(n,e))}const i=t.containingGroup;null!==i&&(!i.isSubGraphExpanded&&!i.wasSubGraphExpanded&&e.push(i),this.Hc(i,e))}return e}canScrollToPart(t){if(void 0===t&&(t=null),null!==t&&!(t instanceof ce))return!1;const e=this.diagram;return(0!==e.selection.count||0!==e.highlighteds.count)&&(e.allowHorizontalScroll&&e.allowVerticalScroll)}collapseTree(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse Tree";try{e.startTransaction(i),e.animationManager.Dl(i);const n=new l;if(null!==t&&t.isTreeExpanded)t.collapseTree(),n.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof pe&&e.isTreeExpanded&&(e.collapseTree(),n.add(e))}}e.D("TreeCollapsed",n)}finally{e.commitTransaction(i)}}canCollapseTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof pe)||!t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof pe){if(!e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}expandTree(t){void 0===t&&(t=null);const e=this.diagram,i="Expand Tree";try{e.startTransaction(i),e.animationManager.Dl(i);const n=new l;if(null===t||t.isTreeExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof pe&&(e.isTreeExpanded||(e.expandTree(),n.add(e)))}}}else t.expandTree(),n.add(t);e.D("TreeExpanded",n)}finally{e.commitTransaction(i)}}canExpandTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof pe)||t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof pe){if(e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}groupSelection(){const t=this.diagram,i=t.model;if(!i.jc())return;const n=this.archetypeGroupData;if(null===n)return;let s=null;try{t.currentCursor="wait",t.D("ChangingSelection",t.selection),t.startTransaction("Group");const o=new l,r=t.selection.iterator;for(;r.next();){const t=r.value;t.ke()&&t.canGroup()&&o.add(t)}const a=new l,h=o.iterator;for(;h.next();){const t=h.value;let e=!1;const i=o.iterator;for(;i.next();){const n=i.value;if(t.isMemberOf(n)){e=!0;break}}e||a.add(t)}const u=a.first();if(null!==u){let o=u.containingGroup;if(null!==o)for(;null!==o;){let t=!1;const e=a.iterator;for(;e.next();)if(!e.value.isMemberOf(o)){t=!0;break}if(!t)break;o=o.containingGroup}if(n instanceof Ne)n.Et(),s=n.copy(),null!==s&&t.add(s);else if(i.isGroupForData(n)){const o=i.copyNodeData(n);e.K(o)&&(i.addNodeData(o),s=t.findNodeForData(o))}if(null!==s){null!==o&&this.isValidMember(o,s)&&(s.containingGroup=o);const e=a.iterator;for(;e.next();){const t=e.value;this.isValidMember(s,t)&&(t.containingGroup=s)}t.clearSelection(!0),s.isSelected=!0}}t.D("SelectionGrouped",s)}finally{t.commitTransaction("Group"),t.D("ChangedSelection",t.selection),t.currentCursor=""}}canGroupSelection(){const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowGroup||!t.model.jc()||null===this.archetypeGroupData)return!1;const e=t.selection.iterator;for(;e.next();){const t=e.value;if(t.ke()&&t.canGroup())return!0}return!1}g2(t){const i=e.et();if(Array.isArray(t))t.forEach((t=>{t instanceof be||t instanceof ce&&i.push(t)}));else{const e=t.iterator;for(;e.next();){const t=e.value;t instanceof be||t instanceof ce&&i.push(t)}}const n=new u,s=i.length;for(let e=0;e<s;e++){const t=i[e];let o=!0;for(let e=0;e<s;e++)if(t.isMemberOf(i[e])){o=!1;break}o&&n.add(t)}return e.J(i),n}isValidMember(t,e){if(null===e||t===e||e instanceof be)return!1;let i;return(null===t||!(t===e||t.isMemberOf(e)||(i=t.memberValidation,null!==i&&!i(t,e))||null===t.data&&null!==e.data||null!==t.data&&null===e.data))&&(i=this.memberValidation,null===i||i(t,e))}ungroupSelection(t){void 0===t&&(t=null);const e=this.diagram,i=e.model;if(i.jc())try{e.currentCursor="wait",e.D("ChangingSelection",e.selection),e.startTransaction("Ungroup");const n=new l;if(null!==t)n.add(t);else{const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ne&&e.canUngroup()&&n.add(e)}}const s=new l;if(n.count>0){e.clearSelection(!0);const t=n.iterator;for(;t.next();){const n=t.value;n.expandSubGraph();const o=n.containingGroup,r=null!==o&&null!==o.data?i.getKeyForNodeData(o.data):void 0;s.addAll(n.memberParts);const a=s.iterator;for(;a.next();){const t=a.value;if(t.isSelected=!0,t instanceof be)continue;const e=t.data;null!==e?i.setGroupForData(e,r):t.containingGroup=o}e.remove(n)}}e.D("SelectionUngrouped",n,s)}finally{e.commitTransaction("Ungroup"),e.D("ChangedSelection",e.selection),e.currentCursor=""}}canUngroupSelection(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowDelete||!e.allowUngroup||!e.model.jc())return!1;if(null!==t){if(!(t instanceof Ne))return!1;if(t.canUngroup())return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ne&&e.canUngroup())return!0}}return!1}addTopLevelParts(t,e){let i=!0;const n=this.g2(t).iterator;for(;n.next();){const t=n.value;null!==t.containingGroup&&(!e||this.isValidMember(null,t)?t.containingGroup=null:i=!1)}return i}collapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse SubGraph";try{e.startTransaction(i),e.animationManager.Dl(i);const n=new l;if(null!==t&&t.isSubGraphExpanded)t.collapseSubGraph(),n.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ne&&e.isSubGraphExpanded&&(e.collapseSubGraph(),n.add(e))}}e.D("SubGraphCollapsed",n)}finally{e.commitTransaction(i)}}canCollapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof Ne)||!t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ne&&e.isSubGraphExpanded)return!0}}return!1}expandSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Expand SubGraph",n=new l;try{if(e.startTransaction(i),e.animationManager.Dl(i),null===t||t.isSubGraphExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ne&&(e.isSubGraphExpanded||(e.expandSubGraph(),n.add(e)))}}}else t.expandSubGraph(),n.add(t);e.D("SubGraphExpanded",n)}finally{for(const t of n)this.mA(e,t);t&&this.mA(e,t),e.commitTransaction(i)}}mA(t,e){for(const i of e.memberParts)i instanceof pe&&t.Cc(i,e)}canExpandSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof Ne)||t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ne&&!e.isSubGraphExpanded)return!0}}return!1}editTextBlock(t){void 0===t&&(t=null);const e=this.diagram,i=e.toolManager.findTool("TextEditing");if(null!==i){if(null===t){let i=null;const n=e.selection.iterator;for(;n.next();){const t=n.value;if(t.canEdit()){i=t;break}}if(null===i)return;t=i.findInVisualTree((t=>t instanceof ie&&t.editable))}null!==t&&(e.currentTool=null,i.textBlock=t,e.currentTool=i)}}canEditTextBlock(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowTextEdit||null===e.toolManager.findTool("TextEditing"))return!1;if(null!==t){if(!(t instanceof ie))return!1;const e=t.part;if(null!==e&&e.canEdit())return!0}else{const i=e.selection.iterator;for(;i.next();){const e=i.value;if(e.canEdit()&&null!==(t=e.findInVisualTree((t=>t instanceof ie&&t.editable))))return!0}}return!1}showContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");if(null===i)return;void 0===t&&(t=null),null===t&&(t=e.selection.count>0?e.selection.first():e);const n=i.findObjectWithContextMenu(t);if(null!==n){const t=e.lastInput;let s=null;if(n instanceof At)s=n.getDocumentPoint(w.Center);else if(!e.viewportBounds.containsPoint(t.documentPoint)){const t=e.viewportBounds;s=new y(t.x+t.width/2,t.y+t.height/2)}if(null!==s){const t=new D;t.diagram=e,t.viewPoint=e.transformDocToView(s),t.documentPoint=s,t.button=2,t.up=!0,e.lastInput=t}e.currentTool=i,i.openMenu(!1,n)}}canShowContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");return!(null===i||(void 0===t&&(t=null),null===t&&(t=e.selection.count>0?e.selection.first():e),null===i.findObjectWithContextMenu(t)))}get copiesClipboardData(){return this.i2}set copiesClipboardData(t){e.s(t,"boolean",Ct,"copiesClipboardData"),this.i2=t}get copiesConnectedLinks(){return this.e2}set copiesConnectedLinks(t){e.s(t,"boolean",Ct,"copiesConnectedLinks"),this.e2=t}get deletesConnectedLinks(){return this.s2}set deletesConnectedLinks(t){e.s(t,"boolean",Ct,"deletesConnectedLinks"),this.s2=t}get copiesTree(){return this.o2}set copiesTree(t){e.s(t,"boolean",Ct,"copiesTree"),this.o2=t}get deletesTree(){return this.l2}set deletesTree(t){e.s(t,"boolean",Ct,"deletesTree"),this.l2=t}get copiesParentKey(){return this.h2}set copiesParentKey(t){e.s(t,"boolean",Ct,"copiesParentKey"),this.h2=t}get copiesGroupKey(){return this.a2}set copiesGroupKey(t){e.s(t,"boolean",Ct,"copiesGroupKey"),this.a2=t}get archetypeGroupData(){return this.c2}set archetypeGroupData(t){null!==t&&e.ec(t,Ct,"archetypeGroupData");this.diagram;this.c2=t}get memberValidation(){return this.eh}set memberValidation(t){null!==t&&e.k(t,Ct,"memberValidation"),this.eh=t}get defaultScale(){return this.diagram.defaultScale}set defaultScale(t){this.diagram.defaultScale=t}get zoomFactor(){return this.f2}set zoomFactor(t){t>1||e.o("zoomFactor must be larger than 1.0, not: "+t),this.f2=t}get isZoomToFitRestoreEnabled(){return this.u2}set isZoomToFitRestoreEnabled(t){e.s(t,"boolean",Ct,"isZoomToFitRestoreEnabled"),this.u2=t}get scrollToPartPause(){return this.d2}set scrollToPartPause(t){this.d2=t}computeEffectiveCollection(t,e){const i=this.diagram,n=i.toolManager.findTool("Dragging"),s=i.currentTool===n;void 0===e&&(e=i.s0());const o=new m;if(null===t)return o;let r=t.iterator;for(;r.next();){const t=r.value;i.Kr(o,t,s,e)}if(null!==i.draggedLink&&e.dragsLink)return o;for(r=t.iterator;r.next();){const t=r.value;if(t instanceof be){const e=t.fromNode;if(null===e||o.has(e)){const e=t.toNode;null!==e&&!o.has(e)&&o.delete(t)}else o.delete(t)}}return o}}var Nt=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Vertical=4]="Vertical",t[t.Horizontal=5]="Horizontal",t[t.Fill=2]="Fill",t))(Nt||{}),Tt=(t=>(t[t.None=0]="None",t[t.Along=21]="Along",t[t.Plus90=22]="Plus90",t[t.Minus90=23]="Minus90",t[t.Opposite=24]="Opposite",t[t.Upright=25]="Upright",t[t.Plus90Upright=26]="Plus90Upright",t[t.Minus90Upright=27]="Minus90Upright",t[t.Upright45=28]="Upright45",t))(Tt||{}),Lt=(t=>(t[t.None=0]="None",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal",t[t.Both=3]="Both",t))(Lt||{});class At{n;c0;f0;Gr;p;oh;ct;at;se;$t;u0;Vs;Lt;is;Hr;lh;wi;da;tt;Yt;jr;Ni;zi;Gu;hi;Hu;Ot;si;qr;Eb;hh;ju;constructor(){u.Gi(this),this.n=30723,this.$t=1,this.u0="",this.Vs=null,this.Lt=null,this.at=new y(NaN,NaN).u(),this.is=x.pw,this.Hr=new k,this.lh=new k,this.wi=null,this.da=1,this.tt=1,this.Yt=0,this.jr=b.Rg,this.se=new v(NaN,NaN,NaN,NaN).u(),this.Ni=new v(NaN,NaN,NaN,NaN).u(),this.zi=new v(0,0,NaN,NaN).u(),this.Gu=null,this.c0=null,this.ct=null,this.hi=w.Default,this.Hu=w.Default,this.f0=0,this.Gr=0,this.Ot=null,this.p=null,this.oh=null,this.si=null,this.Eb=null,this.hh=null,this.qr=null,this.ju=null}cloneProtected(t){t.n=-32769&this.n|6144,t.$t=this.$t,t.u0=this.u0,t.Lt=this.Lt,t.at.a(this.at),t.is=this.is.P(),null!==this.wi?t.wi=this.wi.copy():t.wi=null,t.tt=this.tt,t.Yt=this.Yt,t.jr=this.jr.P(),t.se.a(this.se),t.Ni.a(this.Ni),t.zi.a(this.zi),t.c0=this.c0,null!==this.ct&&(t.ct=this.ct.copy()),t.hi=this.hi.P(),t.Hu=this.Hu.P(),t.f0=this.f0,t.Gr=this.Gr,null!==this.Ot&&(t.Ot=this.Ot.copy()),null!==this.p&&(this.p.fi?t.p=this.p:t.p=this.p.copy()),null!==this.oh&&(t.oh=this.oh.slice()),null!==this.si&&(t.si=this.si.copy())}addCopyProperty(t){let e=this.oh;if(Array.isArray(e)){for(let i=0;i<e.length;i++)if(e[i]===t)return}else e=[],this.oh=e;e.push(t)}Ro(t){t.Gu=null,t.qr=null,t.c()}clone(){const t=new this.constructor;if(this.cloneProtected(t),null!==this.oh)for(let e=0;e<this.oh.length;e++){const i=this.oh[e];t[i]=this[i]}return t}copy(){return this.clone()}oS(){const t=this.Ci;if(null!==t){this.Ci=null;for(const e of t)e.qu()&&(e.isToData?this.themeData(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):e.isToObject?this.themeObject(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter,e.sourceName):e.isToModel?this.themeModel(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):this.theme(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter))}return this}oi(t){t in Tt?this.segmentOrientation=t:t in Nt?this.stretch=t:e.ir(this,t)}toString(){return e.Dn(this.constructor)+"#"+u.as(this)}static None=0;static Default=1;static Fill=2;static Vertical;static Horizontal;static Uniform=6;static UniformToFill=7;static FlipVertical=1;static FlipHorizontal=2;static FlipBoth=3;ah(){null!==this.p&&(this.p.fi=!0)}Gt(){return null===this.p?this.p=new Dt:this.p.fi&&(this.p=this.p.copy()),this.p}Ue(){if(null===this.ct){const t=new Me;t.ga=w.None,t.ma=w.None,t.pa=10,t.ya=10,t.wa=0,t.xa=0,this.ct=t}return this.ct}raiseChangedEvent(t,e,i,n,s,o,r){const a=this.part;if(null!==a){a.qc(t,e,i,n,s,o,r),i===this&&2===t&&this.Wc()&&this.ba(a,e);const l=this.diagram;if(null!==this.ws&&null!==l&&l.Uh&&!l.undoManager.isUndoingRedoing&&!l.animationManager.pu){const t=this.ws.get(e);if(null!==t&&l.animationManager.isEnabled&&!l.animationManager.isTicking){null===this.ju&&(this.ju=new m);let i=0===l.undoManager.transactionLevel;if(2===t.startCondition?i=!0:3===t.startCondition&&(i=!1),i){const i=new ut;t.zF(i);const o=this.ju.get(t);null!==o&&o.stop(),this.ju.set(t,i),i.ux=this,i.zS=t,i.add(this,e,n,s),i.start()}else l.animationManager.getBundleAnimation().add(this,e,n,s)}}if(this instanceof Yt&&i===a&&a.m2()&&null!==a.data){const t=this.C.r,i=t.length;for(let n=0;n<i;n++){const i=t[n];i instanceof Yt&&i.Yr((t=>{null!==t.data&&t.m2()&&t.updateTargetBindings(e)}))}}}}EF(t){this.ju.delete(t)}To(){if(null!==this.diagram&&null===this.findBindingPanel()&&null!==this.Ci){const t=this.diagram.model,e=this.Ci.iterator;for(;e.next();){const i=e.value;if(!i.isToTheme)continue;let n=null;const s=i.sourceName;i.isToObject&&(n=this.pA(s));let o=this;const r=i.targetId;-1!==r&&(o=this.d0(r),null===o)||("/"===s?n=o.part:"."===s?n=o:".."===s&&(n=o.panel),i.updateTarget(o,n,void 0,t))}}}ba(t,e){const i=this.findBindingPanel();if(null!==i){const n=t.diagram,s=this.Ci.iterator;for(;s.next();){const t=s.value;let o=null;if(t.isToObject){if(o=t.yA(i,this),null===o)continue;t.updateSource(this,o,e,null)}else if(t.isToModel)null!==n&&!n.fe&&t.updateSource(this,n.model.modelData,e,i);else if(!t.isToTheme){const s=i.data;if(null===s)continue;null!==n&&!n.fe&&t.updateSource(this,s,e,i)}if(o===this){const s=t.targetId,r=i.d0(s);null!==r&&t.updateTarget(r,o,e,n?.model)}}}}d0(t){return this.jn===t?this:null}pA(t){let e;return e=""===t||"/"===t||"."===t||".."===t?this:this.part.findObject(t),e}get jn(){return null!==this.p?this.p.jn:-1}set jn(t){this.jn!==t&&(null===this.p&&(this.p=new Dt),this.p.jn=t)}get Ci(){return null!==this.p?this.p.Ci:null}set Ci(t){this.Ci!==t&&(null===this.p&&(this.p=new Dt),this.p.Ci=t)}get qn(){return null!==this.p?this.p.qn:null}set qn(t){this.qn!==t&&(null===this.p&&(this.p=new Dt),this.p.qn=t)}raiseChanged(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}t(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}Wn(t,e,i,n){const s=this.se;if(s.i(t,e,i,n),1!==this.tt||0!==this.Yt){null===this.wi&&(this.wi=new k);const o=this.wi;o.Ri(),this.g0(o,t,e,i,n),o.vg(s)}}wA(t,e,i){return!1!==this.pickable&&(i.nc(this.T),e?this.intersectsRect(t,i):this.containedInRect(t,i))}xA(t,e,i){if(!1===this.pickable)return!1;const n=this.naturalBounds,s=t.distanceSquaredPoint(e);return i?y.distanceLineSegmentSquared(t.x,t.y,0,0,0,n.height)<=s||y.distanceLineSegmentSquared(t.x,t.y,0,n.height,n.width,n.height)<=s||y.distanceLineSegmentSquared(t.x,t.y,n.width,n.height,n.width,0)<=s||y.distanceLineSegmentSquared(t.x,t.y,n.width,0,0,0)<=s:t.distanceSquared(0,0)<=s&&t.distanceSquared(0,n.height)<=s&&t.distanceSquared(n.width,0)<=s&&t.distanceSquared(n.width,n.height)<=s}an(){return!0}containsPoint(t){const e=y.l();e.a(t),this.T.gt(e);const i=this.actualBounds;if(!i.isReal())return y.e(e),!1;const n=this.diagram;if(null!==n&&n.jm){const t=n.getInputOption("extraTouchThreshold"),s=n.getInputOption("extraTouchArea"),o=s/2,r=this.naturalBounds,a=this.getDocumentScale()*n.scale,l=1/a;if(r.width*a<t&&r.height*a<t){const t=v.contains(i.x-o*l,i.y-o*l,i.width+s*l,i.height+s*l,e.x,e.y);return y.e(e),t}}let s=!1;return(this instanceof fe||this instanceof Jt?v.contains(i.x-5,i.y-5,i.width+10,i.height+10,e.x,e.y):i.containsPoint(e))&&(s=!(this.si&&!this.si.containsPoint(e))&&(!(null===this.Lt||!this.zi.containsPoint(t))||this.ch(t))),y.e(e),s}ch(t){const e=this.naturalBounds;return v.contains(0,0,e.width,e.height,t.x,t.y)}containsRect(t){if(0===this.angle)return this.actualBounds.containsRect(t);const e=this.naturalBounds,i=v.V(0,0,e.width,e.height),n=this.T;let s=!1;const o=y.V(t.x,t.y);return i.containsPoint(n.$e(o))&&(o.i(t.x,t.bottom),i.containsPoint(n.$e(o))&&(o.i(t.right,t.bottom),i.containsPoint(n.$e(o))&&(o.i(t.right,t.y),i.containsPoint(n.$e(o))&&(s=!0)))),y.e(o),v.e(i),s}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);const i=this.naturalBounds,n=e;let s=!1;const o=y.V(0,0);return t.containsPoint(n.gt(o))&&(o.i(0,i.height),t.containsPoint(n.gt(o))&&(o.i(i.width,i.height),t.containsPoint(n.gt(o))&&(o.i(i.width,0),t.containsPoint(n.gt(o))&&(s=!0)))),y.e(o),s}intersectsRect(t,e){if(void 0===e&&(e=this.T,0===this.angle))return t.intersectsRect(this.actualBounds);const i=this.naturalBounds,n=e,s=y.V(0,0),o=y.V(0,i.height),r=y.V(i.width,i.height),a=y.V(i.width,0);let l=!1;if(t.containsPoint(n.gt(s))||t.containsPoint(n.gt(o))||t.containsPoint(n.gt(r))||t.containsPoint(n.gt(a)))l=!0;else{const e=v.V(0,0,i.width,i.height),h=y.V(t.x,t.y);e.containsPoint(n.$e(h))?l=!0:(h.i(t.x,t.bottom),e.containsPoint(n.$e(h))?l=!0:(h.i(t.right,t.bottom),e.containsPoint(n.$e(h))?l=!0:(h.i(t.right,t.y),e.containsPoint(n.$e(h))&&(l=!0)))),y.e(h),v.e(e),l||(S.Pw(t,s,o)||S.Pw(t,o,r)||S.Pw(t,r,a)||S.Pw(t,a,s))&&(l=!0)}return y.e(s),y.e(o),y.e(r),y.e(a),l}getDocumentPoint(t,e){if(void 0===e&&(e=new y),t instanceof w){const i=t,n=this.naturalBounds;return e.i(i.x*n.width+i.offsetX,i.y*n.height+i.offsetY),this.Bs.gt(e),e}return e.set(t),this.Bs.gt(e),e}getDocumentBounds(t){void 0===t&&(t=new v);const e=this.naturalBounds,i=this.Bs,n=y.V(0,0).T(i);return t.i(n.x,n.y,0,0),n.i(e.width,0).T(i),t.unionNoCheck(n.x,n.y,0,0),n.i(e.width,e.height).T(i),t.unionNoCheck(n.x,n.y,0,0),n.i(0,e.height).T(i),t.unionNoCheck(n.x,n.y,0,0),y.e(n),t}getDocumentAngle(){return this.Bs.$D()}getDocumentScale(){if(!1===this.m0())return this.da;const t=this.tt;return null!==this.panel?t*this.panel.getDocumentScale():t}getLocalPoint(t,e){return void 0===e&&(e=new y),e.a(t),this.Bs.$e(e),e}getNearestIntersectionPoint(t,e,i){return this.Jc(t.x,t.y,e.x,e.y,i)}Jc(t,e,i,n,s){const o=this.T,r=1/(o.m11*o.m22-o.m12*o.m21),a=o.m22*r,l=-o.m12*r,h=-o.m21*r,u=o.m11*r,c=r*(o.m21*o.dy-o.m22*o.dx),d=r*(o.m12*o.dx-o.m11*o.dy),f=t*a+e*h+c,g=t*l+e*u+d,p=i*a+n*h+c,m=i*l+n*u+d;s.i(0,0);const y=this.naturalBounds,x=S.dl(0,0,y.width,y.height,f,g,p,m,s);return s.T(o),x}ht(t,i,n,s){if(!1===this.Ao())return;const o=this.jr,r=o.right+o.left,a=o.top+o.bottom;t=Math.max(t-r,0),i=Math.max(i-a,0),n=n||0,s=s||0,n=Math.max(n-r,0),s=Math.max(s-a,0);const l=this.angle;let h=0;const u=this.desiredSize,c=this.p0();90===l||270===l?(t=isFinite(u.height)?u.height+c:t,i=isFinite(u.width)?u.width+c:i):(t=isFinite(u.width)?u.width+c:t,i=isFinite(u.height)?u.height+c:i);let d=n||0,f=s||0;const g=this instanceof Yt;switch(this.zs(!0)){case 0:d=0,f=0,g&&(t=1/0,i=1/0);break;case 2:isFinite(t)&&t>n&&(d=t),isFinite(i)&&i>s&&(f=i);break;case 5:isFinite(t)&&t>n&&(d=t),f=0,g&&(i=1/0);break;case 4:isFinite(i)&&i>s&&(f=i),d=0,g&&(t=1/0)}const p=this.maxSize,m=this.minSize;d>p.width&&m.width<p.width&&(d=p.width),f>p.height&&m.height<p.height&&(f=p.height),n=Math.max(d,m.width),s=Math.max(f,m.height),p.width<n&&(n=Math.min(m.width,n)),p.height<s&&(s=Math.min(m.height,s)),t=Math.min(p.width,t),i=Math.min(p.height,i),t=Math.max(n,t),i=Math.max(s,i),(90===l||270===l)&&(h=t,t=i,i=h,h=n,n=s,s=h),this.se.Nt(),this.Wu(t,i,n,s),this.se.u(),this.se.isReal()||e.o("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.se.toString()),this.ue(!1)}Wu(t,e,i,n){}Xs(){return!1}Ut(t,i,n,s,o){this.$c();const r=v.l();r.a(this.Ni),this.Ni.Nt(),!1===this._e()?this.Ni.i(t,i,n,s):this.fh(t,i,n,s),this.Ni.u(),this.si=void 0===o?null:o;let a=!1;if(void 0!==o)a=!0;else{let e=this.panel;if(null!==e&&e.Wr()&&(e=e.panel),null!==e){const n=e.zi,s=this.measuredBounds,o=i+s.height,r=t+s.width;if(a=!(0<=t+.05&&r<=n.width+.05&&0<=i+.05&&o<=n.height+.05),this instanceof ie){const t=this.naturalBounds;(this.y0>t.height||this.ui>t.width)&&(a=!0)}}}a?this.n|=256:this.n&=-257,this.Ni.isReal()||e.o("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.Ni.toString()),this.Ju(r,this.Ni),this.Jn(!1),v.e(r)}fh(t,e,i,n){}commonArrange(t,e,i,n){if(this.Ni.i(t,e,i,n),this.desiredSize.isReal())return;const s=this.se,o=this.jr,r=o.right+o.left,a=o.top+o.bottom,l=s.width+r,h=s.height+a;i+=r,n+=a;let u=this.zs(!0);switch(l===i&&h===n&&(u=0),u){case 0:(l>i||h>n)&&(this.ue(!0),this.ht(l>i?i:l,h>n?n:h,0,0));break;case 2:this.ue(!0),this.ht(i,n,0,0);break;case 5:this.ue(!0),this.ht(i,h,0,0);break;case 4:this.ue(!0),this.ht(l,n,0,0)}}Ju(t,e){const i=this.part;null!==i&&null!==i.diagram&&((i.selectionObject===this||i.resizeObject===this||i.rotateObject===this)&&i.p2(!0),this.S(),!t.equalsApproxClose(e)&&(i.uh(),this.w0(i)))}w0(t){null!==this.portId&&(t.p2(!0),t instanceof pe&&t.bA(this))}get shadowVisible(){return null!==this.p?this.p.x0:null}set shadowVisible(t){const e=this.shadowVisible;e!==t&&(this.Gt().x0=t,this.Ve(!0),this.S(),this.t("shadowVisible",e,t))}HR(t,e){const i=this.naturalBounds,n=this.lh,s=n.m11,o=n.m21,r=n.dx,a=n.m12,l=n.m22,h=n.dy;let u=0,c=0,d=u,f=c;u=d*s+f*o+r,c=d*a+f*l+h;let g=u,p=c,m=0,y=0;d=i.width+e,f=0,u=d*s+f*o+r,c=d*a+f*l+h;let x=Math.min(g,u),v=Math.min(p,c);m=Math.max(g+m,u)-x,y=Math.max(p+y,c)-v,g=x,p=v,d=i.width+e,f=i.height+e,u=d*s+f*o+r,c=d*a+f*l+h,x=Math.min(g,u),v=Math.min(p,c),m=Math.max(g+m,u)-x,y=Math.max(p+y,c)-v,g=x,p=v,d=0,f=i.height+e,u=d*s+f*o+r,c=d*a+f*l+h,x=Math.min(g,u),v=Math.min(p,c),m=Math.max(g+m,u)-x,y=Math.max(p+y,c)-v,g=x,p=v;const b=t.viewportBounds,w=b.x,k=b.y,S=b.width,P=b.height;return g>S+w||w>m+g||p>P+k||k>y+p}Bi(t,e){if(this.jR(t,e)||!this.visible)return;const i=this.opacity;if(0===i)return;let n=1;1!==i&&(n=t.globalAlpha,t.globalAlpha=n*i);let s="";""!==this.filter&&(s=t.filter,t.filter=this.filter);const o=this.T,r=this.panel;!0===this.m0()&&this.Bb();const a=this.part;let l=!1,h=0;if(a&&e.getRenderingHint("drawShadows")&&(l=a.isShadowed,l)){const t=a.shadowOffset;h=Math.max(t.y,t.x)*e.scale*e.Vi}const u=this instanceof Yt&&this.Wr(),c=this.Ni;if(u&&(this.kA(l,t,!1,r),this.qR(t,e),this.PA(l,t,!1,r),this.SA(l,t,!1)),u||!u&&(0===c.width||0===c.height||isNaN(c.x)||isNaN(c.y)))return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));const d=this.Xs();if(!e.ta&&d&&this.HR(e,h))return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));let f=0!==(256&this.n);if(t.clipInsteadOfFill&&(f=!1),this instanceof ie&&(t.font=this.font),f){const e=r.an()?r.naturalBounds:r.actualBounds;let o=Math.max(c.x,e.x),a=Math.max(c.y,e.y),l=Math.min(c.right,e.right)-o,h=Math.min(c.bottom,e.bottom)-a;const u=this.si;if(null!==u&&(o=u.x,a=u.y,l=u.width,h=u.height),o>c.width+c.x||c.x>e.width+e.x)return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));t.save(),t.beginPath(),t.rect(o,a,l,h),t.clip()}if(d){if(!a.isVisible())return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));if(l){const i=a.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Vi,i.y*e.scale*this.scale*e.Vi,a.shadowBlur),t.shadowsOn(),t.shadowColor=a.shadowColor}}const g=this.naturalBounds;if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.kA(l,t,d,r),null!==this.Lt&&(t.commitTransform(),this.Ub(t,g,c)),this.PA(l,t,d,r),this.dh(t,e),this.SA(l,t,d),f&&(t.restore(),t.clearContextCache(this instanceof Yt)),!o.Xk()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}1!==i&&(t.globalAlpha=n),""!==this.filter&&(t.filter=s)}kA(t,e,i,n){t&&!0===this.shadowVisible?e.shadowsOn():t&&!1===this.shadowVisible&&e.shadowsOff(),t&&this.Vb(n)&&null===this.shadowVisible&&e.shadowsOff()}PA(t,e,i,n){t&&(null!==this.Lt||this.Vb(n))?(this.zb(!0),null===this.shadowVisible&&e.shadowsOff()):this.zb(!1)}SA(t,e,i){t&&!0===this.w2()&&e.shadowsOn(),i&&t&&e.shadowsOff()}WR(t,e,i){const n=this.part;let s=!1;n&&t.getRenderingHint("drawShadows")&&(s=n.isShadowed),e.clipInsteadOfFill&&(s=!1),this.Xs()&&s&&e.shadowsOn(),s&&!0===this.shadowVisible?e.shadowsOn():s&&!1===this.shadowVisible&&e.shadowsOff();const o=this.panel;if(s&&this.Vb(o)&&null===this.shadowVisible&&e.shadowsOff(),e.Jr){const n=t.computePixelRatio(),s=`drop-shadow(${e.shadowOffsetX/n}px ${e.shadowOffsetY/n}px ${e.shadowBlur/n/2}px ${e.shadowColor})`;null!==this.background&&i.Lt.setAttributeNS(null,"filter",s)}return s&&(null!==this.Lt||this.Vb(o))?(this.zb(!0),null===this.shadowVisible&&e.shadowsOff()):this.zb(!1),s}JR(t,e,i,n){if(i.Jr){const n=e.computePixelRatio(),s=`drop-shadow(${i.shadowOffsetX/n}px ${i.shadowOffsetY/n}px ${i.shadowBlur/n/2}px ${i.shadowColor})`;this.b2(t,s)}n&&!0===this.w2()&&i.shadowsOn(),this.Xs()&&i.shadowsOff()}Vb(t){return null!==t&&(t.Wr()&&(t=t.panel),t.w2()||(t.type===Yt.Auto||t.type===Yt.Spot)&&t.findMainElement()!==this)}b2(t,e){}Ub(t,e,i){const n=this.p0(),s=e.x,o=e.y,r=e.width+n,a=e.height+n;this.rn(t,this.Lt,!0,!1,e,i),this.Lt instanceof Ut&&3===this.Lt.type?(t.beginPath(),t.rect(s-n/2,o-n/2,r,a),t.fillContext(this.Lt,!1,null)):t.fillRect(s-n/2,o-n/2,r,a)}MA(t,e){let i=t.$R(this);const n=null!==t.hh?t.hh:t.svg;if(-1!==i)if(0===i)if(n.Lt)n.Lt.after(e);else if(t.type===Yt.Table){const t=n.getElementsByClassName("gojs-ts"),i=0!==t.length?t[0]:null;null!==i&&i.after(e)}else n.prepend(e);else{for(;0!==i&&!t.elt(i-1).isVisibleObject();)i--;if(0===i)n.prepend(e);else{const s=t.elt(i-1).svg;null!==s?s.after(e):n.appendChild(e)}}}jR(t,e){if(!(t instanceof Rt))return!1;if(!this.visible||0===this.opacity)return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const i=this.Ni;if(this.Xs()&&(!this.isVisible()||0===i.width||0===i.height||isNaN(i.x)||isNaN(i.y)))return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const n=this.panel,s=this.$u(t);if(this.Zc(t,e,s))return this.NA(this.svg),null!==this.svg.parentElement?(this.Xs()&&(t.lastDrawnPart=this.svg),!0):(this.Xs()?(null!==t.lastDrawnPart?t.lastDrawnPart.after(this.svg):t.diagramGroup.prepend(this.svg),t.lastDrawnPart=this.svg):n&&this.MA(n,this.svg),!0);if(this.Ve(!1),this.Xs()&&this.isShadowed){const i=this.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Vi,i.y*e.scale*this.scale*e.Vi,this.shadowBlur),t.shadowsOn(),t.shadowColor=this.shadowColor}this instanceof ie&&(t.font=this.font),t.currentElement=null;const o=this.T,r=this instanceof Yt,a=this instanceof Yt&&this.Wr(),l=this.svg;if(!0===this.m0()&&this.Bb(),t.setCurrentTransform(1,0,0,1,0,0),t.outerGroup=!1,s)if(t.outerGroup=!0,r&&a)t.newGroup(1,0,0,1,0,0),this.svg=t.lastCreatedElement;else if(r&&this.isClipping){const e=this.findMainElement();let i=0,n=0;null!==e&&(i=e.actualBounds.x,n=e.actualBounds.y),t.newGroup(o.m11,o.m12,o.m21,o.m22,o.dx+i,o.dy+n),this.svg=t.lastCreatedElement,null!==e&&t.createOrUpdateClipGroup(this,e.actualBounds),t.currentElement=t.lastCreatedElement}else r?(t.newGroup(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.svg=t.lastCreatedElement):t.newGroup(1,0,0,1,0,0);const h=this.naturalBounds;r||t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),null!==this.background&&(r?(a&&t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.Ub(t,h,i),a&&t.setCurrentTransform(1,0,0,1,0,0)):(t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.Ub(t,h,i)),t.currentElement.Lt=t.lastCreatedElement,t.currentElement.prepend(t.lastCreatedElement));const u=this.WR(e,t,t.currentElement);this.dh(t,e),r&&t.endGroup(),t.outerGroup&&t.endGroup();const c=t.surface.Ku,d=r?this.svg:t.currentElement;if(null!==l&&d!==l&&l.parentNode===this.panel.svg){const e=this.svg.getAttribute("filter");return null!==e&&d.setAttribute("filter",e),l.replaceWith(d),this.svg=d,null!==d&&this.b0(t,n,i,d),!0}if(this.svg=d,null!==c&&null===d&&t.dummyGroup(),null===d)return!0;this.b0(t,n,i,d),this.JR(d,e,t,u);const f=this.Xs()?this.opacity*t.globalAlpha:this.opacity;if(1!==f&&d.setAttributeNS(null,"opacity",f.toString()),""!==this.filter&&d.setAttributeNS(null,"filter",this.filter),this.Xs()){if(null!==l&&d!==l&&l.parentNode===t.diagramGroup){const t=l.getAttribute("filter");null!==t&&d.setAttribute("filter",t),l.replaceWith(d)}else t.lastDrawnPart?t.lastDrawnPart.after(d):t.diagramGroup.prepend(d);t.lastDrawnPart=d}else null!==n&&this.MA(n,d);return null!==c&&c(this,d),this.NA(d),!0}NA(t){const i=this,n=t.dataset;i instanceof At&&(null!==i.portId&&(n.portId=i.portId),i instanceof Yt&&(isNaN(i.itemIndex)||(n.itemIndex=i.itemIndex.toString()),i instanceof ce&&(n.className=e.Dn(i),void 0!==i.key&&(n.key=i.key.toString()),null!==i.containingGroup&&(n.group=i.containingGroup.key.toString()),i instanceof be&&(null!==i.fromNode&&void 0!==i.fromNode.key&&(n.fromKey=i.fromNode.key.toString()),""!==i.fromPortId&&(n.fromPortId=i.fromPortId),null!==i.toNode&&void 0!==i.toNode.key&&(n.toKey=i.toNode.key.toString()),""!==i.toPortId&&(n.toPortId=i.toPortId)))))}b0(t,e,i,n){let s=0!==(256&this.n);if(t.clipInsteadOfFill&&(s=!1),!s)return void n.removeAttributeNS(null,"clip-path");const o=e.an()?e.naturalBounds:e.actualBounds;let r=Math.max(i.x,o.x),a=Math.max(i.y,o.y),l=Math.min(i.right,o.right)-r,h=Math.min(i.bottom,o.bottom)-a;const u=this.si;null!==u&&(r=u.x,a=u.y,l=u.width,h=u.height);const c=new v(r,a,Math.max(l,0),Math.max(h,0));this instanceof Yt&&this.T.copy().ww().vg(c),n.setAttributeNS(null,"clip-path",`path('      M ${c.x},${c.y}       L ${c.width+c.x} ${c.y}       L ${c.width+c.x} ${c.height+c.y}       L ${c.x} ${c.height+c.y} z') view-box`)}ZR(){if(null===this.svg)return;const t=this.svg.innerHTML.match(/url\(#((CLIP|GRAD).+?)\)/g),e=this.svg.ownerDocument;if(null!==t)for(const i of t){const t=e.getElementById(i.split("#")[1].slice(0,-1));null!==t&&t.remove()}this.svg.remove()}qR(t,e){const i=this.Ni,n=this.zi,s=this.Lt;null!==s&&t.commitTransform(),null!==s&&(this.rn(t,s,!0,!1,n,i),s instanceof Ut&&3===s.type?(t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.fillContext(s,!1,null)):t.fillRect(i.x,i.y,i.width,i.height)),this.dh(t,e)}dh(t,e){}Qc(){this.Ve(!0)}Zc(t,e,i){const n=this.svg;if(this.QR()){if(this.Qc(),this.Ve(!1),null===n)return!1;const e=n.getAttribute("clip-path");if(null!==e&&e.includes("url")){const i=t.svg.getElementById(e.split("#")[1].slice(0,-1));null!==i&&i.remove()}return n.getAttribute("filter")&&n.removeAttribute("filter"),!1}if(null===n)return!1;if(!this.visible)return n.remove(),!1;if("g"!==n.nodeName&&i||"g"===n.nodeName&&!i)return!1;const s=this.T,o="matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+s.dx+", "+s.dy+")",r=this instanceof Yt,a=!!r&&this.Wr();if(!r||!a)if(this instanceof re){const e=this.Xb;t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),null!==e&&t.amendImageTransform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i?n.lastElementChild.setAttributeNS(null,"transform",t.getCurrentTransform()):n.setAttributeNS(null,"transform",t.getCurrentTransform())}else if(i&&!r)if(this instanceof Jt){const t=n.getElementsByTagName("path");for(let e=0;e<t.length;e++)t[e].setAttributeNS(null,"transform",o)}else if(this instanceof ie){const t=n.getElementsByTagName("text"),e="string"==typeof this.stroke?this.stroke:null;for(let i=0;i<t.length;i++)t[i].setAttributeNS(null,"transform",o),e&&t[i].setAttributeNS(null,"fill",e)}else(n.lastElementChild||n).setAttributeNS(null,"transform",o);else if(r&&this.isClipping&&this.hh){const t=this.findMainElement(),e=null!==t?t.actualBounds.x:0,i=null!==t?t.actualBounds.y:0;this.hh.setAttributeNS(null,"transform","matrix(1,0,0,1,"+-e+", "+-i+")"),n.setAttributeNS(null,"transform","matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+(s.dx+e)+", "+(s.dy+i)+")")}else n.setAttributeNS(null,"transform",o);const l=this.Xs()?this.opacity*t.globalAlpha:this.opacity;1===l?n.removeAttribute("opacity"):n.setAttributeNS(null,"opacity",l.toString()),t.setCurrentTransform(1,0,0,1,0,0);const h=this.hh?this.hh:this.Eb;if(null!==this.background||void 0!==h.Lt){const e=h.Lt;if(null===this.background)t.removeOldGradient(this,h.Lt,"fill"),h.Lt.remove(),h.Lt=void 0;else{if((a||i&&!(this instanceof Yt))&&t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),this.Ub(t,this.naturalBounds,this.actualBounds),h.Lt){t.removeOldGradient(this,h.Lt,"fill");const e=h.Lt.getAttribute("filter");null!==e&&t.lastCreatedElement.setAttribute("filter",e),h.Lt.replaceWith(t.lastCreatedElement)}else h.prepend(t.lastCreatedElement);h.Lt=t.lastCreatedElement}e&&t.removeOldGradient(this,e,"fill")}return this.b0(t,this.panel,this.actualBounds,n),!0}$u(t){if(null!==this.background)return!0;let e=0!==(256&this.n);return t.clipInsteadOfFill&&(e=!1),!!e}static AE(t,e,i,n,s,o,r){let a=.001;const l=o.length;t.moveTo(e,i);let h=n-e;const u=s-i;0===h&&(h=.001);const c=u/h;let d=Math.sqrt(h*h+u*u),f=0,g=!0;a=o[f%l];let p=0!==r;for(;d>=.1;){if(p){for(a=o[f++%l],a-=r;a<0;)a+=o[f++%l],g=!g;p=!1}else a=o[f++%l];a>d&&(a=d);let n=Math.sqrt(a*a/(1+c*c));h<0&&(n=-n),e+=n,i+=c*n,g?t.lineTo(e,i):t.moveTo(e,i),d-=a,g=!g}}rn(t,i,n,s,o,r){let a,l=1,h=1;if("string"==typeof i)return void(n?t.fillStyle=i:t.strokeStyle=i);if(1===i.type)return void(n?t.fillStyle=i.color:t.strokeStyle=i.color);const u=this.p0();l=o.width,h=o.height,s?(l=r.width,h=r.height):n||(l+=u,h+=u);const c=t instanceof It;if(c&&i.cn&&(4===i.type||i._c===l&&i.Yb===h))a=i.cn;else{let o=0,d=0,f=0,g=0,p=0,m=0,y=0,x=0;if(s?(y=r.x,x=r.y):n||(y-=u/2,x-=u/2),o=i.start.x*l+i.start.offsetX+y,d=i.start.y*h+i.start.offsetY+x,f=i.end.x*l+i.end.offsetX+y,g=i.end.y*h+i.end.offsetY+x,2===i.type)a=t.createLinearGradient(o,d,f,g);else if(3===i.type)m=isNaN(i.endRadius)?Math.max(l,h)/2:i.endRadius,isNaN(i.startRadius)?(p=0,m=Math.max(l,h)/2):p=i.startRadius,a=t.createRadialGradient(o,d,p,f,g,m);else if(4===i.type)try{a=t.createPattern(i.pattern,"repeat")}catch{a=null}else e.Zi(i.type,"Brush type");if(4!==i.type){const t=i.colorStops;if(null!==t){const e=t.iterator;for(;e.next();)a.addColorStop(e.key,e.value)}}if(c&&(i.cn=a,null!==a&&(i._c=l,i.Yb=h),null===a&&4===i.type&&-1!==i._c)){i._c=-1;const t=this.diagram;null!==t&&-1===i._c&&e.tr((()=>{t.redraw()}),600)}}n?t.fillStyle=a:t.strokeStyle=a}isContainedBy(t){return t instanceof Yt&&this._R(this,t)}_R(t,e){if(t===e||null===e)return!1;let i=t.panel;for(;null!==i;){if(i===e)return!0;i=i.panel}return!1}isVisibleObject(){if(!this.visible)return!1;const t=this.panel;return null===t||t.isVisibleObject()}isEnabledObject(){let t=this instanceof Yt?this:this.panel;for(;null!==t&&t.isEnabled;)t=t.panel;return null===t}get enabledChanged(){return null!==this.p?this.p.k0:null}set enabledChanged(t){const i=this.enabledChanged;i!==t&&(null!==t&&e.k(t,At,"enabledChanged"),this.Gt().k0=t,this.t("enabledChanged",i,t))}Bb(){if(!0===this.Kb()){const t=this.Hr;if(t.Ri(),!this.Ni.isReal()||!this.se.isReal())return void this.Zu(!1);if(t.Fs(this.Ni.x-this.se.x,this.Ni.y-this.se.y),1!==this.scale||0!==this.angle){const e=this.naturalBounds;this.g0(t,e.x,e.y,e.width,e.height)}this.Zu(!1),this.ka(!0)}if(!0===this.m0()){const t=this.panel;if(null===t)this.lh.set(this.Hr),this.da=this.scale;else if(null!==t.Bs){const e=this.lh;e.Ri(),t.an()?e.nc(t.lh):null!==t.panel&&e.nc(t.panel.lh),e.nc(this.Hr),this.da=this.scale*t.da}this.ka(!1)}}g0(t,e,i,n,s){if(1!==this.tt&&t.tt(this.tt),0===this.Yt)return;const o=y.l();o.setSpot(e,i,n,s,w.Center),t.cs(this.Yt,o.x,o.y),y.e(o)}c(t){if(this.Ao())return;void 0===t&&(t=!1),this.ue(!0),this.Jn(!0);const e=this.panel;null!==e&&!t&&e.c()}tf(){this.Ao()||(this.ue(!0),this.Jn(!0))}ef(t){if(this._e())return;const e=this.panel;!t&&null!==e&&e.c(),this.Jn(!0)}$c(){!1===this.Kb()&&(this.Zu(!0),this.ka(!0))}k2(){this.ka(!0)}S(){const t=this.part;null!==t&&t.S()}zs(t){const e=this.stretch,i=this.panel;if(null===i)return this.vo(1===e?0:e,t);if(i.type===Yt.Table)return this.P0(i.getRowDefinition(this.row),i.getColumnDefinition(this.column),t);if(i.type===Yt.Auto&&i.findMainElement()===this)return this.vo(2,t);if(1===e){if(i.type===Yt.Spot&&i.findMainElement()===this)return this.vo(2,t);const e=i.defaultStretch;return 1===e?this.vo(0,t):this.vo(e,t)}return this.vo(e,t)}P0(t,e,i){const n=this.stretch;if(1!==n)return this.vo(n,i);let s=null,o=null;switch(t.stretch){case 1:case 5:break;case 4:case 2:o=!0}switch(e.stretch){case 1:case 4:break;case 5:case 2:s=!0}const r=this.panel.defaultStretch;return null===s&&(s=5===r||2===r),null===o&&(o=4===r||2===r),!0===s&&!0===o?this.vo(2,i):!0===s?this.vo(5,i):!0===o?this.vo(4,i):this.vo(0,i)}vo(t,e){if(e)return t;if(0===t)return 0;const i=this.desiredSize;if(i.isReal())return 0;const n=!isNaN(i.width),s=!isNaN(i.height),o=this.angle;if(n)if(90!==o&&270!==o){if(5===t)return 0;if(2===t)return 4}else{if(4===t)return 0;if(2===t)return 5}if(s)if(90!==o&&270!==o){if(4===t)return 0;if(2===t)return 5}else{if(5===t)return 0;if(2===t)return 4}return t}get segmentOrientation(){return null!==this.Ot?this.Ot.S0:0}set segmentOrientation(t){const e=this.segmentOrientation;e!==t&&(null===this.Ot&&(this.Ot=new Ce),this.Ot.S0=t,this.c(),this.t("segmentOrientation",e,t),0===t&&(this.angle=0))}tv(){this.segmentOrientation=21}get segmentIndex(){return null!==this.Ot?this.Ot.M0:-1/0}set segmentIndex(t){t=Math.round(t);const e=this.segmentIndex;e!==t&&(null===this.Ot&&(this.Ot=new Ce),this.Ot.M0=t,this.c(),this.t("segmentIndex",e,t))}get segmentFraction(){return null!==this.Ot?this.Ot.N0:0}set segmentFraction(t){t<0?t=0:t>1&&(t=1);const e=this.segmentFraction;e!==t&&(null===this.Ot&&(this.Ot=new Ce),this.Ot.N0=t,this.c(),this.t("segmentFraction",e,t))}get segmentOffset(){return null!==this.Ot?this.Ot.C0:y.wo}set segmentOffset(t){const e=this.segmentOffset;e.equals(t)||(t=t.P(),null===this.Ot&&(this.Ot=new Ce),this.Ot.C0=t,this.c(),this.t("segmentOffset",e,t))}get stretch(){return null!==this.p?this.p.$n:1}set stretch(t){const e=this.stretch;e!==t&&(this.Gt().$n=t,this.c(),this.t("stretch",e,t))}get name(){return null!==this.p?this.p.Pt:""}set name(t){const e=this.name;e!==t&&(this.Gt().Pt=t,null!==this.part&&this.part.L0(),this.t("name",e,t))}get opacity(){return this.$t}set opacity(t){t<0?t=0:t>1&&(t=1);const e=this.opacity;if(e!==t){this.$t=t,this.t("opacity",e,t);const i=this.diagram,n=this.part;null!==i&&null!==n&&i.S(n.qh(n.actualBounds))}}get filter(){return this.u0}set filter(t){const e=this.filter;if(e!==t){this.u0=t,this.Ve(!0),this.t("filter",e,t);const i=this.diagram,n=this.part;null!==i&&null!==n&&i.S(n.qh(n.actualBounds))}}get visible(){return 0!==(1&this.n)}set visible(t){const e=0!==(1&this.n);if(e!==t){this.n=1^this.n,this.Qc(),this.t("visible",e,t);const i=this.panel;null!==i?i.c():this.Xs()&&this.Ei(t),this.S(),this.CA()}}get pickable(){return 0!==(2&this.n)}set pickable(t){const e=0!==(2&this.n);e!==t&&(this.n=2^this.n,this.t("pickable",e,t))}get fromLinkableDuplicates(){return 0!==(4&this.n)}set fromLinkableDuplicates(t){const e=0!==(4&this.n);e!==t&&(this.n=4^this.n,this.t("fromLinkableDuplicates",e,t))}get fromLinkableSelfNode(){return 0!==(8&this.n)}set fromLinkableSelfNode(t){const e=0!==(8&this.n);e!==t&&(this.n=8^this.n,this.t("fromLinkableSelfNode",e,t))}get toLinkableDuplicates(){return 0!==(16&this.n)}set toLinkableDuplicates(t){const e=0!==(16&this.n);e!==t&&(this.n=16^this.n,this.t("toLinkableDuplicates",e,t))}get toLinkableSelfNode(){return 0!==(32&this.n)}set toLinkableSelfNode(t){const e=0!==(32&this.n);e!==t&&(this.n=32^this.n,this.t("toLinkableSelfNode",e,t))}get isPanelMain(){return 0!==(64&this.n)}set isPanelMain(t){const e=0!==(64&this.n);e!==t&&(this.n=64^this.n,this.c(),this.t("isPanelMain",e,t))}get isActionable(){return 0!==(128&this.n)}set isActionable(t){const e=0!==(128&this.n);e!==t&&(this.n=128^this.n,this.t("isActionable",e,t))}get background(){return this.Lt}set background(t){const e=this.background;e!==t&&(null!==t&&Ut.Qu(t,"GraphObject.background"),t instanceof Ut&&t.u(),this.Lt=t,this.S(),this.t("background",e,t))}w2(){return 0!==(512&this.n)}zb(t){t?this.n|=512:this.n&=-513}Wc(){return 0!==(1024&this.n)}P2(t){t?this.n|=1024:this.n&=-1025}Kb(){return 0!==(2048&this.n)}Zu(t){t?this.n|=2048:this.n&=-2049}m0(){return 0!==(4096&this.n)}ka(t){t?this.n|=4096:this.n&=-4097}Ao(){return 0!==(8192&this.n)}ue(t){t?this.n|=8192:this.n&=-8193}_e(){return 0!==(16384&this.n)}Jn(t){t?this.n|=16384:this.n&=-16385}QR(){return 0!==(32768&this.n)}Ve(t){t?this.n|=32768:this.n&=-32769}get part(){if(this.Xs())return this;if(null!==this.qr)return this.qr;let t=this;for(t=t.panel;t;){if(t instanceof ce)return this.qr=t,t;t=t.panel}return null}get svg(){return this.Eb}set svg(t){this.Eb=t}Au(){this.svg=null}get panel(){return this.Vs}Pa(t){this.Vs=t,null!==this.svg&&this.svg.remove()}get layer(){const t=this.part;return null!==t?t.layer:null}get diagram(){const t=this.part;return null!==t?t.diagram:null}get position(){return this.at}set position(t){const e=t.x,i=t.y,n=this.position,s=n.x,o=n.y;(s===e||isNaN(s)&&isNaN(e))&&(o===i||isNaN(o)&&isNaN(i))?this.M2():(t=t.copy(),this.S2(t,s,o)&&this.t("position",new y(s,o),t.copy()))}M2(){}S2(t,e,i){return this.at=t,this.ef(),!0}bc(t,e,i){this.at.x===t&&this.at.y===e||(this.at.i(t,e),this.$c())}get actualBounds(){return this.Ni}get scale(){return this.tt}set scale(t){const i=this.scale;i!==t&&(t<=0&&e.o("GraphObject.scale for "+this+" must be greater than zero, not: "+t),this.tt=t,this.c(),this.t("scale",i,t))}get angle(){return this.Yt}set angle(t){const e=this.angle;if(e!==t){if((t%=360)<0&&(t+=360),e===t)return;this.Yt=t,this.CA(),this.c(),this.t("angle",e,t)}}get desiredSize(){return this.is}set desiredSize(t){const e=t.width,i=t.height,n=this.desiredSize,s=n.width,o=n.height;if((s!==e&&(!isNaN(s)||!isNaN(e))||o!==i&&(!isNaN(o)||!isNaN(i)))&&(t=t.P(),this.is=t,this.c(),this instanceof Jt&&this.ee(),this.t("desiredSize",n,t),this.Wc())){const t=this.part;null!==t&&(this.ba(t,"width"),this.ba(t,"height"))}}get width(){return this.is.width}set width(t){const e=this.is.width;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.is,i=new x(t,this.is.height).u();if(this.is=i,this.c(),this instanceof Jt&&this.ee(),this.t("desiredSize",e,i),this.Wc()){const t=this.part;null!==t&&this.ba(t,"width")}}}get height(){return this.is.height}set height(t){const e=this.is.height;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.is,i=new x(this.is.width,t).u();if(this.is=i,this.c(),this instanceof Jt&&this.ee(),this.t("desiredSize",e,i),this.Wc()){const t=this.part;null!==t&&this.ba(t,"height")}}}get minSize(){return null!==this.p?this.p.gr:x.sc}set minSize(t){const e=this.minSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0),t.u(),this.Gt().gr=t,this.c(),this.t("minSize",e,t))}get maxSize(){return null!==this.p?this.p.pr:x.Bk}set maxSize(t){const e=this.maxSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=1/0),isNaN(t.height)&&(t.height=1/0),t.u(),this.Gt().pr=t,this.c(),this.t("maxSize",e,t))}get measuredBounds(){return this.se}get naturalBounds(){return this.zi}p0(){return 0}get margin(){return this.jr}set margin(t){"number"==typeof t&&(t=new b(t));const e=this.jr;e.equals(t)||(t=t.P(),this.jr=t,this.c(),this.t("margin",e,t))}get T(){return!0===this.Kb()&&this.Bb(),this.Hr}get Bs(){return!0===this.m0()&&this.Bb(),this.lh}trigger(t,e,i){let n=null;return n="string"==typeof t?new ft(t,e,i):t,n.be=this,null===this.ws&&(this.ws=new m),this.ws.set(n.propertyName,n),this}get ws(){return null!==this.p?this.p.ws:null}set ws(t){this.ws!==t&&(this.Gt().ws=t)}get dr(){return null!==this.p?this.p.dr:0}set dr(t){this.dr!==t&&(this.Gt().dr=t)}get alignment(){return this.hi}set alignment(t){const i=this.alignment;i.equals(t)||(t.isNoSpot()&&!t.isDefault()&&e.o("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+t),t=t.P(),this.hi=t,this.ef(),this.t("alignment",i,t))}get column(){return this.Gr}set column(t){t=Math.round(t);const i=this.column;i!==t&&(t<0&&e.W(t,">= 0",At,"column"),this.Gr=t,this.c(),this.t("column",i,t),null!==this.svg&&this.svg.remove())}get columnSpan(){return null!==this.p?this.p.A0:1}set columnSpan(t){t=Math.round(t);const i=this.columnSpan;i!==t&&(t<1&&e.W(t,">= 1",At,"columnSpan"),this.Gt().A0=t,this.c(),this.t("columnSpan",i,t))}get row(){return this.f0}set row(t){t=Math.round(t);const i=this.row;i!==t&&(t<0&&e.W(t,">= 0",At,"row"),this.f0=t,this.c(),this.t("row",i,t),null!==this.svg&&this.svg.remove())}get rowSpan(){return null!==this.p?this.p.T0:1}set rowSpan(t){t=Math.round(t);const i=this.rowSpan;i!==t&&(t<1&&e.W(t,">= 1",At,"rowSpan"),this.Gt().T0=t,this.c(),this.t("rowSpan",i,t))}get spanAllocation(){return null!==this.p?this.p.D0:null}set spanAllocation(t){const i=this.spanAllocation;i!==t&&(null!==t&&e.k(t,At,"spanAllocation"),this.Gt().D0=t,this.c(),this.t("spanAllocation",i,t))}get alignmentFocus(){return this.Hu}set alignmentFocus(t){const e=this.alignmentFocus;e.equals(t)||(t=t.P(),this.Hu=t,this.c(),this.t("alignmentFocus",e,t))}get portId(){return this.c0}set portId(t){const i=this.portId;if(i!==t){const n=this.part;null!==n&&!(n instanceof pe)&&e.o("Cannot set portID on a Link: "+t);const s=n;null!==i&&null!==s&&s.N2(this),this.c0=t,null!==t&&null!==s&&(s.fn=!0,s.LA(this)),this.t("portId",i,t)}}Sa(){const t=this.part;if(t instanceof pe&&(null!==this.portId||this===t.port)){const e=t.diagram;null!==e&&!e.undoManager.isUndoingRedoing&&t.bA(this)}}CA(){const t=this.diagram;null===t||t.undoManager.isUndoingRedoing||(this instanceof Yt?this instanceof pe?this.invalidateConnectedLinks():this.walkVisualTreeFrom(this,(t=>{t.Sa()})):this.Sa())}get toSpot(){return null!==this.ct?this.ct.ma:w.None}set toSpot(t){const e=this.toSpot;e.equals(t)||(t=t.P(),this.Ue().ma=t,this.t("toSpot",e,t),this.Sa())}get toEndSegmentLength(){return null!==this.ct?this.ct.ya:10}set toEndSegmentLength(t){const i=this.toEndSegmentLength;i!==t&&(t<0&&e.W(t,">= 0",At,"toEndSegmentLength"),this.Ue().ya=t,this.t("toEndSegmentLength",i,t),this.Sa())}get toShortLength(){return null!==this.ct?this.ct.xa:0}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Ue().xa=t,this.t("toShortLength",e,t),this.Sa())}get toLinkable(){return null!==this.ct?this.ct.F0:null}set toLinkable(t){const e=this.toLinkable;e!==t&&(this.Ue().F0=t,this.t("toLinkable",e,t))}get toMaxLinks(){return null!==this.ct?this.ct.R0:1/0}set toMaxLinks(t){const i=this.toMaxLinks;i!==t&&(t<0&&e.W(t,">= 0",At,"toMaxLinks"),this.Ue().R0=t,this.t("toMaxLinks",i,t))}get fromSpot(){return null!==this.ct?this.ct.ga:w.None}set fromSpot(t){const e=this.fromSpot;e.equals(t)||(t=t.P(),this.Ue().ga=t,this.t("fromSpot",e,t),this.Sa())}get fromEndSegmentLength(){return null!==this.ct?this.ct.pa:10}set fromEndSegmentLength(t){const i=this.fromEndSegmentLength;i!==t&&(t<0&&e.W(t,">= 0",At,"fromEndSegmentLength"),this.Ue().pa=t,this.t("fromEndSegmentLength",i,t),this.Sa())}get fromShortLength(){return null!==this.ct?this.ct.wa:0}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Ue().wa=t,this.t("fromShortLength",e,t),this.Sa())}get fromLinkable(){return null!==this.ct?this.ct.v0:null}set fromLinkable(t){const e=this.fromLinkable;e!==t&&(this.Ue().v0=t,this.t("fromLinkable",e,t))}get fromMaxLinks(){return null!==this.ct?this.ct.O0:1/0}set fromMaxLinks(t){const i=this.fromMaxLinks;i!==t&&(t<0&&e.W(t,">= 0",At,"fromMaxLinks"),this.Ue().O0=t,this.t("fromMaxLinks",i,t))}get cursor(){return null!==this.p?this.p.Pl:""}set cursor(t){const i=this.cursor;i!==t&&(e.s(t,"string",At,"cursor"),this.Gt().Pl=t,this.t("cursor",i,t))}get click(){return null!==this.p?this.p.Nr:null}set click(t){const i=this.click;i!==t&&(null!==t&&e.k(t,At,"click"),this.Gt().Nr=t,this.t("click",i,t))}get doubleClick(){return null!==this.p?this.p.Cr:null}set doubleClick(t){const i=this.doubleClick;i!==t&&(null!==t&&e.k(t,At,"doubleClick"),this.Gt().Cr=t,this.t("doubleClick",i,t))}get contextClick(){return null!==this.p?this.p.Lr:null}set contextClick(t){const i=this.contextClick;i!==t&&(null!==t&&e.k(t,At,"contextClick"),this.Gt().Lr=t,this.t("contextClick",i,t))}get mouseEnter(){return null!==this.p?this.p.Rr:null}set mouseEnter(t){const i=this.mouseEnter;i!==t&&(null!==t&&e.k(t,At,"mouseEnter"),this.Gt().Rr=t,this.t("mouseEnter",i,t))}get mouseLeave(){return null!==this.p?this.p.vr:null}set mouseLeave(t){const i=this.mouseLeave;i!==t&&(null!==t&&e.k(t,At,"mouseLeave"),this.Gt().vr=t,this.t("mouseLeave",i,t))}get mouseOver(){return null!==this.p?this.p.Ar:null}set mouseOver(t){const i=this.mouseOver;i!==t&&(null!==t&&e.k(t,At,"mouseOver"),this.Gt().Ar=t,this.t("mouseOver",i,t))}get mouseHover(){return null!==this.p?this.p.Tr:null}set mouseHover(t){const i=this.mouseHover;i!==t&&(null!==t&&e.k(t,At,"mouseHover"),this.Gt().Tr=t,this.t("mouseHover",i,t))}get mouseHold(){return null!==this.p?this.p.Dr:null}set mouseHold(t){const i=this.mouseHold;i!==t&&(null!==t&&e.k(t,At,"mouseHold"),this.Gt().Dr=t,this.t("mouseHold",i,t))}get mouseDragEnter(){return null!==this.p?this.p.I0:null}set mouseDragEnter(t){const i=this.mouseDragEnter;i!==t&&(null!==t&&e.k(t,At,"mouseDragEnter"),this.Gt().I0=t,this.t("mouseDragEnter",i,t))}get mouseDragLeave(){return null!==this.p?this.p.E0:null}set mouseDragLeave(t){const i=this.mouseDragLeave;i!==t&&(null!==t&&e.k(t,At,"mouseDragLeave"),this.Gt().E0=t,this.t("mouseDragLeave",i,t))}get mouseDrop(){return null!==this.p?this.p.Fr:null}set mouseDrop(t){const i=this.mouseDrop;i!==t&&(null!==t&&e.k(t,At,"mouseDrop"),this.Gt().Fr=t,this.t("mouseDrop",i,t))}get actionDown(){return null!==this.p?this.p.B0:null}set actionDown(t){const i=this.actionDown;i!==t&&(null!==t&&e.k(t,At,"actionDown"),this.Gt().B0=t,this.t("actionDown",i,t))}get actionMove(){return null!==this.p?this.p.U0:null}set actionMove(t){const i=this.actionMove;i!==t&&(null!==t&&e.k(t,At,"actionMove"),this.Gt().U0=t,this.t("actionMove",i,t))}get actionUp(){return null!==this.p?this.p.V0:null}set actionUp(t){const i=this.actionUp;i!==t&&(null!==t&&e.k(t,At,"actionUp"),this.Gt().V0=t,this.t("actionUp",i,t))}get actionCancel(){return null!==this.p?this.p.z0:null}set actionCancel(t){const i=this.actionCancel;i!==t&&(null!==t&&e.k(t,At,"actionCancel"),this.Gt().z0=t,this.t("actionCancel",i,t))}get toolTip(){return null!==this.p?this.p.Or:null}set toolTip(t){const e=this.toolTip;e!==t&&(this.Gt().Or=t,this.t("toolTip",e,t))}get contextMenu(){return null!==this.p?this.p.Ir:null}set contextMenu(t){const e=this.contextMenu;e!==t&&(this.Gt().Ir=t,this.t("contextMenu",e,t))}findBindingPanel(){let t=this instanceof Yt?this:this.panel;for(;null!==t;){if(t.C2())return t;t=t.panel}return null}bind(t,e,i,n){return this.sf(t,e,i,n),this}bindTwoWay(t,e,i,n){return this.sf(t,e,i,n).makeTwoWay(),this}bindModel(t,e,i,n){return this.sf(t,e,i,n).ofModel(),this}bindObject(t,e,i,n,s){return this.sf(t,e,i,n).ofObject(s),this}theme(t,e,i,n,s){return this.gh(t,e,i,n,s),this}themeData(t,e,i,n,s){return this.gh(t,e,i,n,s).ofData(),this}themeObject(t,e,i,n,s,o){return this.gh(t,e,i,n,s).ofObject(o),this}themeModel(t,e,i,n,s){return this.gh(t,e,i,n,s).ofModel(),this}sf(t,e,i,n){let s=null;return s="string"==typeof t?new je(t,e,i,n):t,this.X0(s),s}gh(t,e,i,n,s){let o=null;return o="string"==typeof t?new Ve(t,e,i,n,s):t,this.X0(o),o}X0(t){t.be=this;const i=this.findBindingPanel();null!==i&&i.AA()&&e.o("Cannot add a Binding to a template that has already been copied: "+t),null===this.Ci&&(this.Ci=new l),this.Ci.add(t)}set(t){return Object.assign(this,t),this}attach(t){return At.L2(this,t),this}apply(t){return t(this),this}setProperties(t){return vt.e0(this,t),this}static make(i){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];let r=arguments,a=null,l=null;if(e.it(i))l=i;else if("string"==typeof i){const n=At.Gb.get(i);e.it(n)?(r=Array.prototype.slice.call(r),a=n(r),e.K(a)||e.o('GraphObject.make invoked object builder "'+i+'", but it did not return an Object')):l=t.go[i]}null===a&&((null==l||!l.constructor)&&e.o("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+i),a=new l);let h=1;if(a instanceof vt&&r.length>1){const t=a,e=r[1];("string"==typeof e||e instanceof HTMLDivElement)&&(t.LM(e),h++)}for(let t=h;t<r.length;t++){const i=r[t];void 0===i?e.o("Undefined value at argument "+t+" for object being constructed by GraphObject.make: "+a):At.L2(a,i)}return a}static L2(t,i){if("number"==typeof i)At.iv(t,i);else if("string"==typeof i)At.ev(t,i);else if(i instanceof At)t instanceof Yt||e.o("A GraphObject can only be added to a Panel, not to: "+t),t.add(i);else if(i instanceof $t){let n;i.isRow&&e.it(t.getRowDefinition)?n=t.getRowDefinition(i.index):!i.isRow&&e.it(t.getColumnDefinition)&&(n=t.getColumnDefinition(i.index)),n instanceof $t?n.Hb(i):e.o("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+t)}else if(i instanceof Xt){t.type=i}else if(i instanceof je)t instanceof At||t instanceof $t?t.bind(i):e.o("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+t);else if(i instanceof ft)t instanceof At?t.trigger(i):e.o("An AnimationTrigger can only be applied to a GraphObject, not to: "+t);else if(i instanceof T)t instanceof N&&4===t.type?t.figures.add(i):e.o("A PathFigure can only be added to a Path Geometry, not to: "+t);else if(i instanceof A)t instanceof T?t.segments.add(i):e.o("A PathSegment can only be added to a PathFigure, not to: "+t);else if(i instanceof Le)t instanceof vt||t instanceof Ne?t.layout=i:e.o("A Layout can only be assigned to a Diagram or a Group, not to: "+t);else if(Array.isArray(i))for(let e=0;e<i.length;e++){const n=i[e];At.L2(t,n)}else e.K(i)?At.sv(t,i):e.o('Unknown initializer "'+i+'" for object being constructed by GraphObject.make: '+t)}static ev(t,i){if(t instanceof ie)t.text=i;else if(t instanceof Jt)t.figure=i;else if(t instanceof re)t.source=i;else if(t instanceof Yt){const e=Xt.es.get(i);null!==e&&(t.type=e)}else if(t instanceof Ut){const n=e.Eh(zt,i);null!==n?t.type=n:e.o("Unknown Brush type as an argument to GraphObject.make: "+i)}else if(t instanceof N){const n=e.Eh(M,i);null!==n&&(t.type=n)}else if(t instanceof A){const n=e.Eh(L,i);null!==n&&(t.type=n)}}static iv(t,i){e.it(t.oi)?t.oi(i):e.ir(t,i)}static sv(t,i){if(t instanceof Ut){const e=new n;for(const n in i){const s=parseFloat(n);isNaN(s)?e[n]=i[n]:t.addColorStop(s,i[n])}vt.e0(t,e)}else if(t instanceof $t){if(void 0!==i.row){const n=i.row;(null==n||n===1/0||isNaN(n)||n<0)&&e.o("Must specify non-negative integer row for RowColumnDefinition "+i+", not: "+n),t.isRow=!0,t.index=n}else if(void 0!==i.column){const n=i.column;(null==n||n===1/0||isNaN(n)||n<0)&&e.o("Must specify non-negative integer column for RowColumnDefinition "+i+", not: "+n),t.isRow=!1,t.index=n}const s=new n;for(const t in i)"row"===t||"column"===t||(s[t]=i[t]);vt.e0(t,s)}else vt.e0(t,i)}static build(t,i){const n=At.Gb.get(t);if(e.it(n)){for(var s=arguments.length,o=new Array(s>2?s-2:0),r=2;r<s;r++)o[r-2]=arguments[r];const e=n([t].concat(o));if(e instanceof At)return i&&e.setProperties(i),e}e.o('GraphObject.build invoked object builder "'+t+'", but it did not return an Object')}static defineBuilder(t,i){e.s(t,"string",At,"defineBuilder:name"),e.k(i,At,"defineBuilder:func");t.toLowerCase();At.Gb.set(t,i)}static isBuilderDefined(t){return At.Gb.has(t)}static takeBuilderArgument(t,i,n){void 0===n&&(n=null);const s=t[1];return(e.it(n)?n(s):"string"==typeof s)?(t.splice(1,1),s):(void 0===i&&e.o("no "+(e.it(n)?"satisfactory":"string")+" argument for GraphObject builder "+t[0]),i)}static Gb=(()=>new m)();static#t=(()=>(At.Vertical=4,At.Horizontal=5,At.defineBuilder("Button",(t=>{const e=2.76142374915397,i=2.761423749153969,n=new Yt(Yt.Auto,{isActionable:!0,enabledChanged:(t,e)=>{if(t instanceof Yt){const i=t.findObject("ButtonBorder");if(null!==i)if(void 0===t._buttonFillNormal&&(t._buttonFillNormal=i.fill),e){let e=null;null!==t.layer&&null!==t.diagram&&t.isVisibleObject()&&(e=t.layer.findObjectAt(t.diagram.lastInput.documentPoint)),e===t||null!==e&&e.isContainedBy(t)?i.fill=t._buttonFillOver:i.fill=t._buttonFillNormal}else i.fill=t._buttonFillDisabled}},cursor:"pointer"}).attach({_buttonFillNormal:void 0,_buttonStrokeNormal:void 0,_buttonFillOver:"#d4d4d4",_buttonStrokeOver:"#737373",_buttonFillDisabled:"#a3a3a3"}).add(new Jt("RoundedRectangle",{name:"ButtonBorder",spot1:new w(0,0,e,i),spot2:new w(1,1,-e,-i),parameter1:2,fill:"#f5f5f5",stroke:"#737373"}));return n.mouseEnter=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof Yt))return;const n=e.findObject("ButtonBorder");n instanceof Jt&&(void 0===e._buttonFillNormal&&(e._buttonFillNormal=n.fill),n.fill=e._buttonFillOver,void 0===e._buttonStrokeNormal&&(e._buttonStrokeNormal=n.stroke),n.stroke=e._buttonStrokeOver)},n.mouseLeave=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof Yt))return;const n=e.findObject("ButtonBorder");n instanceof Jt&&(void 0!==e._buttonFillNormal&&(n.fill=e._buttonFillNormal),void 0!==e._buttonStrokeNormal&&(n.stroke=e._buttonStrokeNormal))},n})),At.defineBuilder("TreeExpanderButton",(t=>{const e=At.build("Button");return e.attach({_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine",visible:!1}),e.add(new Jt("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:x.nu}).bindObject("figure","isTreeExpanded",((t,e)=>{const i=e.panel;return t?i._treeExpandedFigure:i._treeCollapsedFigure}))),e.bindObject("visible","isTreeLeaf",(t=>!t)),e.click=(t,e)=>{let i=e.part;if(i instanceof fe&&(i=i.adornedPart),!(i instanceof pe))return;const n=i.diagram;if(null===n)return;const s=n.commandHandler;if(i.isTreeExpanded){if(!s.canCollapseTree(i))return}else if(!s.canExpandTree(i))return;t.handled=!0,i.isTreeExpanded?s.collapseTree(i):s.expandTree(i)},e})),At.defineBuilder("SubGraphExpanderButton",(t=>{const e=At.build("Button");return e.attach({_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"}),e.add(new Jt("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:x.nu}).bindObject("figure","isSubGraphExpanded",((t,e)=>{const i=e.panel;return t?i._subGraphExpandedFigure:i._subGraphCollapsedFigure}))),e.click=(t,e)=>{let i=e.part;if(i instanceof fe&&(i=i.adornedPart),!(i instanceof Ne))return;const n=i.diagram;if(null===n)return;const s=n.commandHandler;if(i.isSubGraphExpanded){if(!s.canCollapseSubGraph(i))return}else if(!s.canExpandSubGraph(i))return;t.handled=!0,i.isSubGraphExpanded?s.collapseSubGraph(i):s.expandSubGraph(i)},e})),At.defineBuilder("ToolTip",(t=>new fe(Yt.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new y(0,2)}).add(new Jt("RoundedRectangle",{name:"Border",parameter1:1,fill:"#f5f5f5",strokeWidth:0,spot1:new w(0,0,4,6),spot2:new w(1,1,-4,-4)})))),At.defineBuilder("ContextMenu",(t=>new fe(Yt.Vertical,{background:"#f5f5f5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new y(0,2)}).bindObject("background","",(t=>null!==t.adornedPart&&t.hasPlaceholder()?null:"#f5f5f5")))),At.defineBuilder("ContextMenuButton",(t=>{const e=At.build("Button");e.stretch=5;const i=e.findObject("ButtonBorder");return i instanceof Jt&&(i.figure="Rectangle",i.strokeWidth=0,i.spot1=new w(0,0,4,6),i.spot2=new w(1,1,-4,-4)),e})),At.defineBuilder("PanelExpanderButton",(t=>{const e=At.takeBuilderArgument(t,"COLLAPSIBLE"),i=At.build("Button");i.attach({_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8","ButtonBorder.fill":"rgba(0, 0, 0, 0)",_buttonFillNormal:"rgba(0, 0, 0, 0)","ButtonBorder.stroke":null,_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null}),i.add(new Jt({name:"ButtonIcon",strokeWidth:2}).bindObject("geometryString","visible",(t=>t?i._buttonExpandedFigure:i._buttonCollapsedFigure),void 0,e));const n=i.findObject("ButtonBorder");return n instanceof Jt&&(n.stroke=null,n.fill="rgba(0, 0, 0, 0)"),i.click=(t,i)=>{if(!(i instanceof Yt))return;const n=i.diagram;if(null===n||n.isReadOnly)return;let s=i.findBindingPanel();if(null===s&&(s=i.part),null!==s){const i=s.findObject(e);null!==i&&(t.handled=!0,n.startTransaction("Collapse/Expand Panel"),i.visible=!i.visible,n.commitTransaction("Collapse/Expand Panel"))}},i})),At.defineBuilder("CheckBoxButton",(t=>{const i=At.takeBuilderArgument(t),n=At.build("Button",{desiredSize:new x(14,14)});n.attach({"ButtonBorder.spot1":new w(0,0,1,1),"ButtonBorder.spot2":new w(1,1,-1,-1)});const s=new Jt({name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:2,geometryStretch:6,visible:!1});return""!==i&&s.bindTwoWay("visible",i),n.add(s),n.click=(t,n)=>{if(!(n instanceof Yt))return;const s=t.diagram;if(null===s||s.isReadOnly||""!==i&&s.model.isReadOnly)return;t.handled=!0;const o=n.findObject("ButtonIcon");s.startTransaction("checkbox"),null!==o&&(o.visible=!o.visible),e.it(n._doClick)&&n._doClick(t,n),s.commitTransaction("checkbox")},n})),At.defineBuilder("CheckBox",(t=>{const e=At.takeBuilderArgument(t),i=At.build("CheckBoxButton",{name:"Button",isActionable:!1,margin:new b(0,1,0,0)},e),n=new Yt("Horizontal",{isActionable:!0,cursor:i.cursor,margin:new b(1),mouseEnter:i.mouseEnter,mouseLeave:i.mouseLeave,click:i.click}).attach({_buttonFillNormal:i._buttonFillNormal,_buttonStrokeNormal:i._buttonStrokeNormal,_buttonFillOver:i._buttonFillOver,_buttonStrokeOver:i._buttonStrokeOver,_buttonFillDisabled:i._buttonFillDisabled,_buttonClick:i.click});return n.add(i),i.mouseEnter=null,i.mouseLeave=null,i.click=null,n}))))()}class Dt{fi;Pt;jn;Ci;qn;Ys;Pl;Nr;Cr;Lr;Rr;vr;Ar;Tr;Dr;I0;E0;Fr;B0;U0;V0;z0;Or;Ir;k0;D0;ws;gr;pr;$n;T0;A0;dr;x0;Y0;K0;constructor(){this.fi=!1,this.Pt="",this.jn=-1,this.Ci=null,this.qn=null,this.Ys=null,this.Pl="",this.Nr=null,this.Cr=null,this.Lr=null,this.Rr=null,this.vr=null,this.Ar=null,this.Tr=null,this.Dr=null,this.I0=null,this.E0=null,this.Fr=null,this.B0=null,this.U0=null,this.V0=null,this.z0=null,this.Or=null,this.Ir=null,this.k0=null,this.D0=null,this.ws=null,this.gr=x.sc,this.pr=x.Bk,this.$n=1,this.T0=1,this.A0=1,this.dr=0,this.x0=null,this.Y0=null,this.K0="category"}copy(){const t=new Dt;return t.Pt=this.Pt,t.jn=this.jn,t.Ci=this.Ci,t.Ys=this.Ys,t.Pl=this.Pl,t.Nr=this.Nr,t.Cr=this.Cr,t.Lr=this.Lr,t.Rr=this.Rr,t.vr=this.vr,t.Ar=this.Ar,t.Tr=this.Tr,t.Dr=this.Dr,t.I0=this.I0,t.E0=this.E0,t.Fr=this.Fr,t.B0=this.B0,t.U0=this.U0,t.V0=this.V0,t.z0=this.z0,t.Or=this.Or,t.Ir=this.Ir,t.k0=this.k0,t.D0=this.D0,t.ws=this.ws,t.gr=this.gr.P(),t.pr=this.pr.P(),t.$n=this.$n,t.T0=this.T0,t.A0=this.A0,t.dr=this.dr,t.x0=this.x0,t.Y0=this.Y0,t.K0=this.K0,t}}class Ft{m;constructor(){this.m=[1,0,0,1,0,0]}copy(){const t=new Ft;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}translate(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e}scale(t,e){this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e}rotate(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return;this.translate(e,i);let n=0,s=0;if(90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}const o=this.m[0]*n+this.m[2]*s,r=this.m[1]*n+this.m[3]*s,a=this.m[0]*-s+this.m[2]*n,l=this.m[1]*-s+this.m[3]*n;this.m[0]=o,this.m[1]=r,this.m[2]=a,this.m[3]=l,this.translate(-e,-i)}}class Ot{type;x1;y1;r1;x2;y2;r2;colors;pattern;constructor(t){this.type=t,this.x1=0,this.y1=0,this.r1=0,this.x2=0,this.y2=0,this.r2=0,this.colors=[],this.pattern=null}addColorStop(t,e){this.colors.push({offset:t,color:e})}}class Et{Tt;li;ua;Ku;A2;constructor(e,i,n){const s=void 0===i?t.document:i;this.ua=s,this.A2="http://www.w3.org/2000/svg";const o="http://www.w3.org/2000/xmlns/";void 0!==s&&(this.Tt=this.makeElement("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.style.display="block",this.style.letterSpacing="normal",this.style.wordSpacing="normal",n||(this.style.position="absolute"),this.Tt.setAttributeNS(o,"xmlns",this.A2),this.Tt.setAttributeNS(o,"xmlns:xlink","http://www.w3.org/1999/xlink")),this.Ku=null,this.li=new Rt(this,n)}resize(t,e,i,n){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=n+"px",this.Tt.setAttributeNS(null,"width",i+"px"),this.Tt.setAttributeNS(null,"height",n+"px"),this.Tt.setAttributeNS(null,"viewBox","0 0 "+i+" "+n),this.li.T2.firstElementChild.setAttributeNS(null,"width",i+"px"),this.li.T2.firstElementChild.setAttributeNS(null,"height",n+"px"),!0)}makeElement(t,i,n){const s=this.ua.createElementNS(this.A2,t);if(e.K(i))for(const e in i)s.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,i[e]);return void 0!==n&&(s.textContent=n),s}getBoundingClientRect(){return this.Tt.getBoundingClientRect()}focus(){this.Tt.focus()}get width(){return this.Tt.width.baseVal.value}set width(t){this.Tt.setAttribute("width",t+"px")}get height(){return this.Tt.height.baseVal.value}set height(t){this.Tt.setAttribute("height",t+"px")}dispose(){this.ua=null}get style(){return this.Tt.style}}class Rt{nf;of;un;Li;ze;fillStyle;font;globalAlpha;lineCap;lineDashOffset;lineJoin;lineWidth;miterLimit;shadowBlur;shadowColor;shadowOffsetX;shadowOffsetY;strokeStyle;textAlign;imageSmoothingEnabled;clipInsteadOfFill;lastCreatedElement;rf;lf;surface;svg;T2;TA;jb;Oo;mh;Ma;currentElement;clipPathGroup;diagramGroup;lastDrawnPart;currentPath;outerGroup;pathAttributes;Jr;br;filter;partClipRect;constructor(t,e){this.surface=t,this.svg=t.Tt,this.rf=[],this.lf=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetX=0,this.shadowOffsetY=0,this.Jr=!1,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.nf=0,this.of=0,this.un=0,this.lastCreatedElement=null,this.currentElement=null,this.Li=[],this.pathAttributes={},this.jb=!1,this.Oo=null,this.mh=0,this.ze=new Ft,this.clipPathGroup=this.newGroup2(),this.diagramGroup=this.newGroup2("gojs-diagram"),this.lastDrawnPart=null,this.currentPath=null;const i=u.gw++,n=this.makeElement("clipPath",{id:"mainClip"+i}),s={x:0,y:0,width:t.width,height:t.height};n.appendChild(this.makeElement("rect",s)),this.T2=n,this.svg.appendChild(this.clipPathGroup),this.clipPathGroup.appendChild(this.diagramGroup),this.svg.appendChild(n),this.clipPathGroup.setAttributeNS(null,"clip-path","url(#mainClip"+i+")"),this.TA={},this.br=!!e,this.filter="",this.partClipRect=null}setDiagramPosScale(t,e,i,n,s,o){void 0===this.diagramGroup?this.newGroup(t,e,i,n,s,o):this.diagramGroup.setAttribute("transform","matrix("+t+", "+e+", "+i+", "+n+", "+s+", "+o+")")}resetInnerSVG(){null!==this.diagramGroup&&(this.diagramGroup.innerHTML="")}arc(t,e,i,n,s,o,r,a){const l=2*Math.PI,h=1e-6,u=l-h,c=i*Math.cos(n),d=i*Math.sin(n),f=t+c,g=e+d,p=o?0:1;let m=o?n-s:s-n;(Math.abs(r-f)>h||Math.abs(a-g)>h)&&this.Li.push(["L",f,+g]),m<0&&(m=m%l+l),m>u?(this.Li.push(["A",i,i,0,1,p,t-c,e-d]),this.Li.push(["A",i,i,0,1,p,f,g])):m>h&&this.Li.push(["A",i,i,0,+(m>=Math.PI),p,t+i*Math.cos(s),e+i*Math.sin(s)])}beginPath(){this.Li=[],this.pathAttributes={stroke:"none",fill:"none"}}endPath(t){this.nv(this.Li,this.ze,t||0)}bezierCurveTo(t,e,i,n,s,o){this.Li.push(["C",t,e,i,n,s,o])}clearRect(t,e,i,n){}clip(){this.pathAttributes.clipPath=!0}closePath(){this.Li.push(["z"])}createLinearGradient(t,e,i,n){const s=new Ot("linear");return s.x1=t,s.y1=e,s.x2=i,s.y2=n,s}createPattern(t,e){let i="";t instanceof HTMLCanvasElement&&(i=t.toDataURL()),t instanceof HTMLImageElement&&(i=t.getAttribute("src"));const n=this.TA;if(n[i])return"url(#"+n[i]+")";const s="PATTERN"+u.gw++,o={width:t.width,height:t.height,id:s,patternUnits:"userSpaceOnUse"},r={x:0,y:0,width:t.width,height:t.height,href:i},a=this.makeElement("pattern",o);return a.appendChild(this.makeElement(vt.img,r)),this.svg.appendChild(a),n[i]=s,"url(#"+s+")"}createRadialGradient(t,e,i,n,s,o){const r=new Ot("radial");return r.x1=t,r.y1=e,r.r1=i,r.x2=n,r.y2=s,r.r2=o,r}amendImageTransform(t,e,i,n,s,o,r,a){const l=r/i,h=a/n;(0!==s||0!==o)&&this.ze.translate(s,o),(1!==l||1!==h)&&this.ze.scale(l,h),(0!==t||0!==e)&&this.ze.translate(-t,-e)}drawImage(t,e,i,n,s,o,r,a,l){let h="";t instanceof HTMLCanvasElement&&(h=t.toDataURL()),t instanceof HTMLImageElement&&(h=t.getAttribute("src"));const u=t instanceof HTMLImageElement?t.naturalWidth:t.width,c=t instanceof HTMLImageElement?t.naturalHeight:t.height;void 0===n&&(o=e,r=i,a=n=u,l=s=c),n=n||0,s=s||0,o=o||0,r=r||0,a=a||0,l=l||0,this.amendImageTransform(e,i,n,s,o,r,a,l);const d={x:0,y:0,width:u||n,height:c||s,href:h};S.z(n,a)&&S.z(s,l)?-1===h.toLowerCase().indexOf(".svg")&&-1===h.toLowerCase().indexOf("data:image/svg")&&(d.preserveAspectRatio="xMidYMid slice"):d.preserveAspectRatio="none",(0!==e||0!==i||n!==u||s!==c)&&(n+=e,s+=i,d["clip-path"]=`path('M ${e},${i} L ${n} ${i} L ${n} ${s} L ${e} ${s} z')`),this.processCommon(vt.img,d,this.ze),this._u(vt.img,d)}fill(t,e){t&&(this.pathAttributes["fill-rule"]="evenodd"),this.setFill(this.pathAttributes)}fillContext(t,e,i){this.clipInsteadOfFill?this.clip():this.fill(e,i)}createOrUpdateClipGroup(t,e){const i=this.newGroup(1,0,0,1,-e.x,-e.y);i.setAttributeNS(null,"class","spotClip"),t.hh=i}fillRect(t,e,i,n){this.addRect("fill",[t,e,i,n],this.ze)}fillBackground(t,e,i,n){const s={x:t,y:e,width:i,height:n};this.processCommon("fill",s,this.ze),this.setFill(s),this.svg.prepend(this.makeElement("rect",s))}fillText(t,e,i){this.addText("fill",[t,e,i],this.ze)}lineTo(t,e){this.Li.push(["L",t,e])}moveTo(t,e){this.Li.push(["M",t,e])}quadraticCurveTo(t,e,i,n){this.Li.push(["Q",t,e,i,n])}rect(t,e,i,n){this.Li.push(["M",t,e],["L",t+i,e],["L",t+i,e+n],["L",t,e+n],["z"])}restore(){this.ze=this.rf.pop(),this.Li=this.rf.pop();const t=this.rf.pop();this.fillStyle=t.fillStyle,this.font=t.font,this.globalAlpha=t.globalAlpha,this.lineCap=t.lineCap,this.lineDashOffset=t.lineDashOffset,this.lineJoin=t.lineJoin,this.lineWidth=t.lineWidth,this.miterLimit=t.miterLimit,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.strokeStyle=t.strokeStyle,this.textAlign=t.textAlign,this.partClipRect=t.partClipRect}save(){const t={fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign,partClipRect:this.partClipRect};this.rf.push(t);const e=[];for(let i=0;i<this.Li.length;i++)e.push(this.Li[i]);this.rf.push(e),this.rf.push(this.ze.copy())}setTransform(t,e,i,n,s,o){1===t&&0===e&&0===i&&1===n&&0===s&&0===o||this.newGroup(t,e,i,n,s,o)}setCurrentTransform(t,e,i,n,s,o){this.ze.m=[t,e,i,n,s,o]}getCurrentTransform(){const t=this.ze.m;return"matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}scale(t,e){this.ze.scale(t,e)}translate(t,e){this.ze.translate(t,e)}transform(t,e,i,n,s,o){}commitTransform(){}stroke(){this.setStroke(this.pathAttributes)}strokeContext(){this.clipInsteadOfFill||this.stroke()}strokeRect(t,e,i,n){this.addRect("stroke",[t,e,i,n],this.ze)}makeElement(t,e,i){return this.surface.makeElement(t,e,i)}_u(t,e,i){const n=this.makeElement(t,e,i);return null!==this.currentElement?this.currentElement.appendChild(n):this.currentElement=n,this.lastCreatedElement=n,n}processCommon(t,e,i){if("fill"===t?this.setFill(e):"stroke"===t&&this.setStroke(e),null!==i){const t=i.m;e.transform="matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}}setFill(t){if(this.fillStyle instanceof Ot)t.fill=this.addGradient(this.fillStyle,!0);else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.fill="rgb("+e[1]+","+e[2]+","+e[3]+")",t["fill-opacity"]=e[4]}else t.fill=this.fillStyle}setFillOrStrokeInPlace(t,e){const i=e?"fill":"stroke";if(this.fillStyle instanceof Ot)t.setAttributeNS(null,"fill",this.addGradient(this.fillStyle,!0));else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.setAttributeNS(null,i,"rgb("+e[1]+","+e[2]+","+e[3]+")"),t.setAttributeNS(null,i+"-opacity",e[4])}else t.setAttributeNS(null,i,this.fillStyle)}setStroke(t){if(this.strokeStyle instanceof Ot)t.stroke=this.addGradient(this.strokeStyle,!1);else if(/^rgba\(/.test(this.strokeStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.strokeStyle);t.stroke="rgb("+e[1]+","+e[2]+","+e[3]+")",t["stroke-opacity"]=e[4]}else t.stroke=this.strokeStyle;t["stroke-width"]=this.lineWidth,t["stroke-linecap"]=this.lineCap,t["stroke-linejoin"]=this.lineJoin,t["stroke-miterlimit"]=this.miterLimit,this.jb&&(t["stroke-dasharray"]=this.Oo.toString(),t["stroke-dashoffset"]=this.mh)}addGradient(t,i){let n="";const s=null!==this.currentPath?this.currentPath.getAttribute(i?"fill":"stroke"):null;if(null!==s&&-1!==s.indexOf("GRAD")){n=s.split("#")[1].slice(0,-1);const t=this.svg.getElementById(n);null!==t&&t.remove()}else n="GRAD"+u.gw++;let o;if("linear"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,id:n,gradientUnits:"userSpaceOnUse"};o=this.makeElement("linearGradient",e)}else if("radial"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,r1:t.r1,r2:t.r2,id:n};o=this.makeElement("radialGradient",e)}else e.o("invalid gradient");const r=t.colors,a=r.length,l=[];for(let e=0;e<a;e++){const t=r[e],i=t.color,n={offset:t.offset,"stop-color":i};if(/^rgba\(/.test(i)){const t=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(i);n["stop-color"]="rgb("+t[1]+","+t[2]+","+t[3]+")",n["stop-opacity"]=t[4]}l.push(n)}l.sort(((t,e)=>t.offset>e.offset?1:-1));for(let e=0;e<a;e++)o.appendChild(this.makeElement("stop",l[e]));return this.svg.appendChild(o),"url(#"+n+")"}addRect(t,e,i){const n={x:e[0],y:e[1],width:e[2],height:e[3]};this.processCommon(t,n,i),this._u("rect",n)}addText(t,e,i){let n=this.textAlign;"left"===n?n="start":"right"===n?n="end":"center"===n&&(n="middle");const s={x:e[1],y:e[2],style:"font: "+this.font,"text-anchor":n};this.processCommon(t,s,i),this._u("text",s,e[0])}nv(t,e,i){const n=this.ov(t),s=this.pathAttributes;if(s.clipPath)this.lf.length>1&&this.lf[this.lf.length-2].setAttributeNS(null,"clip-path",'path("'+n+'") view-box');else if(s.d=n,this.processCommon("",s,e),null!==this.currentPath){const t=this.currentPath;if("g"!==t.nodeName)for(const e in s)"transform"!==e&&t.setAttributeNS(null,e,s[e]);else{const e=t.getElementsByTagName("path");for(const t in s)"transform"!==t&&e[i].setAttributeNS(null,t,s[t])}}else this._u("path",s)}ov(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i].slice(),s=[n.shift()];if("A"===s[0])s.push(n.shift()+","+n.shift(),n.shift(),n.shift()+","+n.shift(),n.shift()+","+n.shift());else for(;n.length;)s.push(n.shift()+","+n.shift());e.push(s.join(" "))}return e.join(" ")}newGroup(t,e,i,n,s,o){const r=new Ft;r.m=[t,e,i,n,s,o];const a={};this.processCommon("g",a,r);const l=this._u("g",a);return this.lf.push(l),l}newGroup2(t){const e={};t&&(e.class=t);const i=this._u("g",e);return this.lf.push(i),i}endGroup(){return this.lf.pop()}dummyGroup(){return this.newGroup2(),this.endGroup()}shadowsSet(t,e,i){this.nf=t,this.of=e,this.un=i}shadowsOff(){this.Jr=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.Jr=!0,this.shadowOffsetX=this.nf,this.shadowOffsetY=this.of,this.shadowBlur=this.un}enableDash(t,e){this.jb=!0,this.Oo=t,this.mh=e}disableDash(){this.jb=!1}clearContextCache(t){}setImageSmoothingEnabled(t){}rotate(t){this.ze.rotate(57.2958*t,0,0)}getImageData(t,e,i,n){return null}measureText(t){return null}removeOldGradient(t,e,i){const n=e.getAttribute(i);if(null===n)return;const s=n.split("#");if(1===s.length)return;const o=this.svg.getElementById(s[1].slice(0,-1));if(null!==o){const t=new RegExp(o.id,"g");1===this.svg.innerHTML.match(t).length&&o.remove()}}removePartFromView(t){null!==t.svg&&t.svg.parentNode===this.diagramGroup&&t.svg.remove()}}class Bt{Tt;li;ua;Ku;constructor(e,i,n,s){const o=void 0===i?t.document:i;this.ua=o,this.Ku=null;const r=o.createElement("canvas");r.tabIndex=0,this.Tt=r,this.li=new It(r,n,s),vt.Qe.set(r,e)}resize(t,e,i,n){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=n+"px",!0)}toDataURL(t,e){return this.Tt.toDataURL(t,e)}getBoundingClientRect(){return this.Tt.getBoundingClientRect()}focus(){this.Tt.focus()}get width(){return this.Tt.width}set width(t){this.Tt.width=t}get height(){return this.Tt.height}set height(t){this.Tt.height=t}dispose(){vt.Qe.delete(this.Tt),this.ua=null}get style(){return this.Tt.style}}class It{E;qb;Wb;Jb;clipInsteadOfFill;nf;of;un;Ma;Jr;br;constructor(t,i,n){this.E=t.getContext?t.getContext("2d",i):null,null===this.E&&e.o("Browser does not support HTML Canvas Element"),this.qb="",this.Wb="",this.Jb="",this.clipInsteadOfFill=!1,this.nf=0,this.of=0,this.un=0,this.Jr=!1,this.Ma=new k,this.br=!!n}createOrUpdateClipGroup(t,e){}setImageSmoothingEnabled(t){this.E.imageSmoothingEnabled=t}get fillStyle(){return this.E.fillStyle}set fillStyle(t){this.Jb!==t&&(this.E.fillStyle=t,this.Jb=t)}get font(){return this.E.font}set font(t){this.qb!==t&&(this.E.font=t,this.qb=t)}get globalAlpha(){return this.E.globalAlpha}set globalAlpha(t){this.E.globalAlpha=t}get lineCap(){return this.E.lineCap}set lineCap(t){this.E.lineCap=t}get lineDashOffset(){return this.E.lineDashOffset}set lineDashOffset(t){this.E.lineDashOffset=t}get lineJoin(){return this.E.lineJoin}set lineJoin(t){this.E.lineJoin=t}get lineWidth(){return this.E.lineWidth}set lineWidth(t){this.E.lineWidth=t}get miterLimit(){return this.E.miterLimit}set miterLimit(t){this.E.miterLimit=t}get shadowBlur(){return this.E.shadowBlur}set shadowBlur(t){this.E.shadowBlur=t}get shadowColor(){return this.E.shadowColor}set shadowColor(t){this.E.shadowColor=t}get shadowOffsetX(){return this.E.shadowOffsetX}set shadowOffsetX(t){this.E.shadowOffsetX=t}get shadowOffsetY(){return this.E.shadowOffsetY}set shadowOffsetY(t){this.E.shadowOffsetY=t}get strokeStyle(){return this.E.strokeStyle}set strokeStyle(t){this.Wb!==t&&(this.E.strokeStyle=t,this.Wb=t)}get textAlign(){return this.E.textAlign}set textAlign(t){this.E.textAlign=t}get imageSmoothingEnabled(){return this.E.imageSmoothingEnabled}set imageSmoothingEnabled(t){this.E.imageSmoothingEnabled=t}get filter(){return this.E.filter}set filter(t){this.E.filter=""===t?"none":t}arc(t,e,i,n,s,o,r,a){this.E.arc(t,e,i,n,s,o)}beginPath(){this.E.beginPath()}endPath(){}bezierCurveTo(t,e,i,n,s,o){this.E.bezierCurveTo(t,e,i,n,s,o)}clearRect(t,e,i,n){this.commitTransform(),this.E.clearRect(t,e,i,n)}clip(t){t?this.E.clip(t):this.E.clip()}closePath(){this.E.closePath()}createLinearGradient(t,e,i,n){return this.E.createLinearGradient(t,e,i,n)}createPattern(t,e){return this.E.createPattern(t,e)}createRadialGradient(t,e,i,n,s,o){return this.E.createRadialGradient(t,e,i,n,s,o)}drawImage(t,e,i,n,s,o,r,a,l){void 0===n?this.E.drawImage(t,e,i):this.E.drawImage(t,e,i,n,s,o,r,a,l)}fill(t,e){e?this.E.fill(e,t?"evenodd":"nonzero"):this.E.fill(t?"evenodd":"nonzero")}fillRect(t,e,i,n){this.E.fillRect(t,e,i,n)}fillBackground(t,e,i,n){this.E.fillRect(t,e,i,n)}fillText(t,e,i){this.E.fillText(t,e,i)}getImageData(t,e,i,n){return this.E.getImageData(t,e,i,n)}lineTo(t,e){this.E.lineTo(t,e)}measureText(t){return this.E.measureText(t)}moveTo(t,e){this.E.moveTo(t,e)}quadraticCurveTo(t,e,i,n){this.E.quadraticCurveTo(t,e,i,n)}rect(t,e,i,n){this.E.rect(t,e,i,n)}restore(){this.E.restore()}save(){this.commitTransform(),this.E.save()}rotate(t){this.Ma.cs(57.2958*t,0,0)}setTransform(t,e,i,n,s,o){this.Ma.setTo(t,e,i,n,s,o)}scale(t,e){this.Ma.tt(t,e)}translate(t,e){this.Ma.Fs(t,e)}stroke(t){t?this.E.stroke(t):this.E.stroke()}transform(t,e,i,n,s,o){if(1===t&&0===e&&0===i&&1===n&&0===s&&0===o)return;const r=this.Ma,a=r.m11*t+r.m21*e,l=r.m12*t+r.m22*e,h=r.m11*i+r.m21*n,u=r.m12*i+r.m22*n;r.dx=r.m11*s+r.m21*o+r.dx,r.dy=r.m12*s+r.m22*o+r.dy,r.m11=a,r.m12=l,r.m21=h,r.m22=u}commitTransform(){const t=this.Ma;this.E.setTransform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy)}fillContext(t,e,i){this.radialFill(t,e,i)||this.fillOrClip(e,i)}radialFill(t,e,i){if(!(t instanceof Ut)||3!==t.type)return!1;const n=t._c,s=t.Yb;return s>n?(this.scale(n/s,1),this.translate((s-n)/2,0)):n>s&&(this.scale(1,s/n),this.translate(0,(n-s)/2)),this.fillOrClip(e,i),s>n?(this.translate(-(s-n)/2,0),this.scale(1/(n/s),1)):n>s&&(this.translate(0,-(n-s)/2),this.scale(1,1/(s/n))),!0}strokeContext(){this.clipInsteadOfFill||this.stroke()}fillOrClip(t,e){this.clipInsteadOfFill?this.clip(e):this.fill(t,e)}shadowsSet(t,e,i){this.nf=t,this.of=e,this.un=i}shadowsOff(){this.Jr=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.Jr=!0,this.shadowOffsetX=this.nf,this.shadowOffsetY=this.of,this.shadowBlur=this.un}enableDash(t,e){const i=this.E;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}disableDash(){const t=this.E;void 0!==t.setLineDash&&(t.setLineDash(It.EmptyArray),t.lineDashOffset=0)}clearContextCache(t){t&&(this.qb=""),this.Wb="",this.Jb=""}removePartFromView(t){}static EmptyArray=(()=>Object.freeze([]))()}var zt=(t=>(t[t.Solid=1]="Solid",t[t.Linear=2]="Linear",t[t.Radial=3]="Radial",t[t.Pattern=4]="Pattern",t))(zt||{}),jt=(t=>(t[t.Lab=1]="Lab",t[t.HSL=2]="HSL",t[t.Oklch=3]="Oklch",t))(jt||{});class Vt{n0;n1;n2;n3;constructor(){this.n0=0,this.n1=0,this.n2=0,this.n3=0}}class Ut{h;j;Na;ei;gs;G0;H0;Io;j0;cn;_c;Yb;constructor(t,i){if(u.Gi(this),this.h=!1,void 0===t)this.j=1,this.Na="black";else if("string"==typeof t){const i=e.Eh(zt,t);null!==i?(this.j=i,this.Na="black"):(this.j=1,this.Na=t)}else Object.keys(zt).hasOwnProperty(t)?(this.j=t,this.Na="black"):"object"==typeof t&&(this.j=1,i=t);const n=this.j;if(2===n?(this.ei=w.TopCenter,this.gs=w.BottomCenter):3===n?(this.ei=w.Center,this.gs=w.Center):(this.ei=w.None,this.gs=w.None),this.G0=0,this.H0=NaN,this.Io=null,this.j0=null,this.cn=null,this._c=0,this.Yb=0,i){const t={};for(const e in i)isFinite(parseFloat(e))?this.addColorStop(parseFloat(e),i[e]):t[e]=i[e];Object.assign(this,t)}}copy(){const t=new Ut;return t.j=this.j,t.Na=this.Na,t.ei=this.ei.P(),t.gs=this.gs.P(),t.G0=this.G0,t.H0=this.H0,null!==this.Io&&(t.Io=this.Io.copy()),t.j0=this.j0,t}u(){return this.h=!0,null!==this.Io&&this.Io.u(),this}oi(t){t in zt?this.type=t:e.ir(this,t)}toString(){let t="Brush(";if(1===this.type)t+=this.color;else if(2===this.type?t+="Linear ":3===this.type?t+="Radial ":4===this.type?t+="Pattern ":t+="(unknown) ",t+=this.start+" "+this.end,null!==this.colorStops){const e=this.colorStops.iterator;for(;e.next();){t+=" "+e.key+":"+e.value}}return t+=")",t}addColorStop(t,i){return this.h&&e.L(this),("number"!=typeof t||!isFinite(t)||t>1||t<0)&&e.W(t,"0 <= loc <= 1",Ut,"addColorStop:loc"),e.s(i,"string",Ut,"addColorStop:color"),null===this.Io&&(this.Io=new m),this.Io.set(t,i),1===this.j&&(this.type=2),this.cn=null,this}get type(){return this.j}set type(t){this.h&&e.L(this,t),this.j=t,this.start.isNoSpot()&&(2===t?this.start=w.TopCenter:3===t&&(this.start=w.Center)),this.end.isNoSpot()&&(2===t?this.end=w.BottomCenter:3===t&&(this.end=w.Center)),this.cn=null}get color(){return this.Na}set color(t){this.h&&e.L(this,t),this.Na=t,this.cn=null}get start(){return this.ei}set start(t){this.h&&e.L(this,t),this.ei=t.P(),this.cn=null}get end(){return this.gs}set end(t){this.h&&e.L(this,t),this.gs=t.P(),this.cn=null}get startRadius(){return this.G0}set startRadius(t){this.h&&e.L(this,t),t<0&&e.W(t,">= zero",Ut,"startRadius"),this.G0=t,this.cn=null}get endRadius(){return this.H0}set endRadius(t){this.h&&e.L(this,t),t<0&&e.W(t,">= zero",Ut,"endRadius"),this.H0=t,this.cn=null}get colorStops(){return this.Io}set colorStops(t){this.h&&e.L(this,t),this.Io=t,this.cn=null}get pattern(){return this.j0}set pattern(t){this.h&&e.L(this,t),this.j0=t,this.cn=null}static randomColor(t,e){void 0===t&&(t=128),void 0===e&&(e=Math.max(t,255));const i=Math.abs(e-t);let n=Math.floor(t+Math.random()*i).toString(16),s=Math.floor(t+Math.random()*i).toString(16),o=Math.floor(t+Math.random()*i).toString(16);return n.length<2&&(n="0"+n),s.length<2&&(s="0"+s),o.length<2&&(o="0"+o),"#"+n+s+o}static isValidColor(e){return!t.CSS||t.CSS.supports("color",e)}static lighten(t){return Ut.lightenBy(t)}lightenBy(t,i){this.h&&e.L(this);const n=void 0===t||"number"!=typeof t?.2:t,s=void 0===i?3:i;if(1===this.type)Ut.Mo(this.color),this.color=Ut.td(n,s);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)Ut.Mo(t.value),this.addColorStop(t.key,Ut.td(n,s))}return this}static lightenBy(t,e,i){const n=void 0===e||"number"!=typeof e?.2:e,s=void 0===i?3:i;return Ut.Mo(t),Ut.td(n,s)}static darken(t){return Ut.darkenBy(t)}darkenBy(t,i){this.h&&e.L(this);const n=void 0===t||"number"!=typeof t?.2:t,s=void 0===i?3:i;if(1===this.type)Ut.Mo(this.color),this.color=Ut.td(-n,s);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)Ut.Mo(t.value),this.addColorStop(t.key,Ut.td(-n,s))}return this}static darkenBy(t,e,i){const n=void 0===e||"number"!=typeof e?.2:e,s=void 0===i?3:i;return Ut.Mo(t),Ut.td(-n,s)}static mix(t,e,i){Ut.Mo(t);const n=Ut.Y.n0,s=Ut.Y.n1,o=Ut.Y.n2,r=Ut.Y.n3;Ut.Mo(e),void 0===i&&(i=.5);return`rgba(${Math.round((Ut.Y.n0-n)*i+n)}, ${Math.round((Ut.Y.n1-s)*i+s)}, ${Math.round((Ut.Y.n2-o)*i+o)}, ${Math.round((Ut.Y.n3-r)*i+r)})`}isDark(){if(1===this.type)return Ut.isDark(this.color);if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops;if(3===this.type)return Ut.isDark(t.first().value);if(null!==t.get(.5))return Ut.isDark(t.get(.5));if(2===t.count){const e=t.toArray();return Ut.isDark(Ut.mix(e[0].value,e[1].value))}const e=t.iterator;let i=-1,n=-1,s=1,o=1;for(;e.next();){const t=e.key,r=Math.abs(.5-e.key);s>o&&r<s?(i=t,s=r):o>=s&&r<o&&(n=t,o=r)}if(i>n){let t=i;i=n,n=t,t=s,s=o,o=t}const r=n-i;return Ut.isDark(Ut.mix(t.get(i),t.get(n),1-o/r))}return!1}static isDark(t){return!!t&&(t instanceof Ut?t.isDark():(Ut.Mo(t),(299*Ut.Y.n0+587*Ut.Y.n1+114*Ut.Y.n2)/1e3<128))}static td(t,i){switch(i){case 1:return Ut.rv(),Ut.Zn.n0=Math.min(100,Math.max(0,Ut.Zn.n0+100*t)),Ut.lv(),"rgba("+Ut.Y.n0+", "+Ut.Y.n1+", "+Ut.Y.n2+", "+Ut.Y.n3+")";case 2:return Ut.GS(),Ut.Ii.n2=Math.min(100,Math.max(0,Ut.Ii.n2+100*t)),"hsla("+Ut.Ii.n0+", "+Ut.Ii.n1+"%, "+Ut.Ii.n2+"%, "+Ut.Ii.n3+")";case 3:return Ut.hv(),Ut.Qn.n0=Math.min(100,Math.max(0,Ut.Qn.n0+100*t)),Ut.av(),"rgba("+Ut.Y.n0+", "+Ut.Y.n1+", "+Ut.Y.n2+", "+Ut.Y.n3+")";default:e.o("Unknown color space: "+i)}}static Mo(t){const e=Ut.$r;if(null===e)return;e.clearRect(0,0,1,1),e.fillStyle="#000000";const i=e.fillStyle;if(e.fillStyle=t,e.fillStyle!==i){e.fillRect(0,0,1,1);const t=e.getImageData(0,0,1,1).data;Ut.Y.n0=t[0],Ut.Y.n1=t[1],Ut.Y.n2=t[2],Ut.Y.n3=t[3]/255}else{e.fillStyle="#FFFFFF";e.fillStyle;e.fillStyle=t,e.fillStyle,Ut.Y.n0=0,Ut.Y.n1=0,Ut.Y.n2=0,Ut.Y.n3=1}}static GS(){const t=Ut.Y.n0/255,e=Ut.Y.n1/255,i=Ut.Y.n2/255,n=Math.max(t,e,i),s=Math.min(t,e,i),o=n-s;let r,a;const l=(n+s)/2;if(0===o)r=a=0;else{switch(n){case t:r=(e-i)/o%6;break;case e:r=(i-t)/o+2;break;case i:r=(t-e)/o+4}r*=60,r<0&&(r+=360),a=o/(1-Math.abs(2*l-1))}Ut.Ii.n0=Math.round(r),Ut.Ii.n1=Math.round(100*a),Ut.Ii.n2=Math.round(100*l),Ut.Ii.n3=Ut.Y.n3}static TE(){const t=Ut.Ii.n0,e=Ut.Ii.n1/100,i=Ut.Ii.n2/100;let n,s,o;const r=(1-Math.abs(2*i-1))*e,a=t/60,l=r*(1-Math.abs(a%2-1));a>=0&&a<1?(n=r,s=l,o=0):a>=1&&a<2?(n=l,s=r,o=0):a>=2&&a<3?(n=0,s=r,o=l):a>=3&&a<4?(n=0,s=l,o=r):a>=4&&a<5?(n=l,s=0,o=r):a>=5&&a<6&&(n=r,s=0,o=l);const h=i-.5*r;n+=h,s+=h,o+=h,Ut.Y.n0=Math.round(255*n),Ut.Y.n1=Math.round(255*s),Ut.Y.n2=Math.round(255*o),Ut.Y.n3=Ut.Ii.n3}static rv(){Ut.DA(),Ut.cv()}static lv(){Ut.fv(),Ut.FA()}static D2(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}static F2(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}static DA(){const t=Ut.D2(Ut.Y.n0),e=Ut.D2(Ut.Y.n1),i=Ut.D2(Ut.Y.n2);Ut.Dt.n0=.4124564*t+.3575761*e+.1804375*i,Ut.Dt.n1=.2126729*t+.7151522*e+.072175*i,Ut.Dt.n2=.0193339*t+.119192*e+.9503041*i,Ut.Dt.n3=Ut.Y.n3}static FA(){const t=3.2404542*Ut.Dt.n0+-1.5371385*Ut.Dt.n1+-.4985314*Ut.Dt.n2,e=-.969266*Ut.Dt.n0+1.8760108*Ut.Dt.n1+.041556*Ut.Dt.n2,i=.0556434*Ut.Dt.n0+-.2040259*Ut.Dt.n1+1.0572252*Ut.Dt.n2;Ut.Y.n0=255*Ut.F2(t),Ut.Y.n1=255*Ut.F2(e),Ut.Y.n2=255*Ut.F2(i),Ut.Y.n3=Ut.Dt.n3,Ut.Y.n0=Math.round(Ut.Y.n0),Ut.Y.n0>255?Ut.Y.n0=255:Ut.Y.n0<0&&(Ut.Y.n0=0),Ut.Y.n1=Math.round(Ut.Y.n1),Ut.Y.n1>255?Ut.Y.n1=255:Ut.Y.n1<0&&(Ut.Y.n1=0),Ut.Y.n2=Math.round(Ut.Y.n2),Ut.Y.n2>255?Ut.Y.n2=255:Ut.Y.n2<0&&(Ut.Y.n2=0)}static R2=216/24389;static $b=24389/27;static ed=[95.047,100,108.883];static v2(t){return t>Ut.R2?Math.pow(t,1/3):(Ut.$b*t+16)/116}static cv(){const t=Ut.v2(100*Ut.Dt.n0/Ut.ed[0]),e=Ut.v2(100*Ut.Dt.n1/Ut.ed[1]),i=Ut.v2(100*Ut.Dt.n2/Ut.ed[2]);Ut.Zn.n0=116*e-16,Ut.Zn.n1=500*(t-e),Ut.Zn.n2=200*(e-i),Ut.Zn.n3=Ut.Dt.n3}static RA(t){const e=t*t*t;return e>Ut.R2?e:(116*t-16)/Ut.$b}static fv(){const t=(Ut.Zn.n0+16)/116,e=Ut.Zn.n1/500+t,i=t-Ut.Zn.n2/200;Ut.Dt.n0=Ut.ed[0]/100*Ut.RA(e),Ut.Dt.n1=Ut.ed[1]/100*(Ut.Zn.n0>Ut.$b*Ut.R2?Math.pow(t,3):Ut.Zn.n0/Ut.$b),Ut.Dt.n2=Ut.ed[2]/100*Ut.RA(i),Ut.Dt.n3=Ut.Zn.n3}static uv(){let t=.8190224*Ut.Dt.n0+.3619062*Ut.Dt.n1+-.1288737*Ut.Dt.n2,e=.03298366*Ut.Dt.n0+.9292868*Ut.Dt.n1+.03614466*Ut.Dt.n2,i=.04817719*Ut.Dt.n0+.2642395*Ut.Dt.n1+.6335478*Ut.Dt.n2;t=Math.cbrt(t),e=Math.cbrt(e),i=Math.cbrt(i),Ut.ai.n0=.2104542*t+.7936177*e+-.004072046*i,Ut.ai.n1=1.977998*t+-2.428592*e+.4505937*i,Ut.ai.n2=.02590403*t+.7827717*e+-.8086757*i,Ut.ai.n3=Ut.Dt.n3,Ut.ai.n0*=100}static dv(){Ut.ai.n0/=100;let t=.9999999*Ut.ai.n0+.3963377*Ut.ai.n1+.2158037*Ut.ai.n2,e=1.000000009*Ut.ai.n0+-.1055613*Ut.ai.n1+-.06385417*Ut.ai.n2,i=1.00000005*Ut.ai.n0+-.08948418*Ut.ai.n1+-1.291485*Ut.ai.n2;t=t**3,e=e**3,i=i**3,Ut.Dt.n0=1.2268798*t+-.5578149*e+.281391*i,Ut.Dt.n1=-.04057576*t+1.112286*e+-.07171106*i,Ut.Dt.n2=-.07637294*t+-.4214933*e+1.586924*i,Ut.Dt.n3=Ut.ai.n3}static gv(){const t=180*Math.atan2(Ut.ai.n2,Ut.ai.n1)/Math.PI;Ut.Qn.n0=Ut.ai.n0,Ut.Qn.n1=Math.sqrt(Ut.ai.n1**2+Ut.ai.n2**2),Ut.Qn.n2=t>=0?t:t+360,Ut.Qn.n3=Ut.ai.n3}static mv(){Ut.ai.n0=Ut.Qn.n0,Ut.ai.n1=Ut.Qn.n1*Math.cos(Ut.Qn.n2*Math.PI/180),Ut.ai.n2=Ut.Qn.n1*Math.sin(Ut.Qn.n2*Math.PI/180),Ut.ai.n3=Ut.Qn.n3}static hv(){Ut.DA(),Ut.uv(),Ut.gv()}static av(){Ut.mv(),Ut.dv(),Ut.FA()}static Qu(t,i){"string"==typeof t||t instanceof Ut||e.o("Value for "+i+" must be a color string or a Brush, not "+t)}static Solid=1;static Linear=2;static Radial=3;static Pattern=4;static Lab=1;static HSL=2;static $r=(()=>vt.isUsingDOM()?new Bt(null,void 0,{willReadFrequently:!0}).li:null)();static Y=(()=>new Vt)();static Ii=(()=>new Vt)();static Dt=(()=>new Vt)();static Zn=(()=>new Vt)();static ai=(()=>new Vt)();static Qn=(()=>new Vt)()}class Xt{Pt="Base";static es=(()=>new m)();static dn(t,e){e.name=t,Xt.es.set(t,e)}get name(){return this.Pt}set name(t){this.Pt=t}constructor(){}get classType(){return Yt}measure(t,e,i,n,s,o,r){}measureElement(t,e,i,n,s){t.ht(e,i,n,s)}arrange(t,e,i){}arrangeElement(t,e,i,n,s,o){t.Ut(e,i,n,s,o)}remeasureObject(t){t.tf()}Bi(t,e,i){}}Xt.dn("Position",new class extends Xt{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length,l=t.Eo();for(let h=0;h<a;h++){const t=n[h];if(!t.visible&&t!==l)continue;const a=t.margin,u=a.right+a.left,c=a.top+a.bottom;t.ht(e,i,o,r);const d=t.measuredBounds,f=Math.max(d.width+u,0),g=Math.max(d.height+c,0);let p=t.position.x,m=t.position.y;if(isFinite(p)||(p=0),isFinite(m)||(m=0),t instanceof Jt&&t.isGeometryPositioned){const e=t.strokeWidth/2;p-=e,m-=e}s.unionNoCheck(p,m,f,g)}}arrange(t,e,i){const n=e.length,s=t.padding,o=i.x-s.left,r=i.y-s.top;for(let a=0;a<n;a++){const t=e[a],i=t.measuredBounds,n=t.margin,s=t.position.x,l=t.position.y;let h=isNaN(s)?-o:s-o,u=isNaN(l)?-r:l-r;if(t instanceof Jt&&t.isGeometryPositioned){const e=t.strokeWidth/2;h-=e,u-=e}t.visible&&t.Ut(h+n.left,u+n.top,i.width,i.height)}}});Xt.dn("Horizontal",new class extends Xt{constructor(){super()}measure(t,i,n,s,o,r,a){const l=s.length,h=e.et(),u=t.Eo();for(let e=0;e<l;e++){const t=s[e];if(!t.visible&&t!==u)continue;const i=t.zs(!1);if(0!==i&&5!==i){h.push(t);continue}t.ht(1/0,n,0,a);const r=t.margin,l=t.measuredBounds,c=Math.max(l.width+r.right+r.left,0),d=Math.max(l.height+r.top+r.bottom,0);o.Fn(o.width+c,Math.max(o.height,d))}const c=h.length;t.desiredSize.height?n=Math.min(t.desiredSize.height,t.maxSize.height):0!==o.height&&(n=Math.min(o.height,t.maxSize.height));for(let e=0;e<c;e++){const t=h[e];if(!t.visible&&t!==u)continue;const i=t.margin,s=i.right+i.left,r=i.top+i.bottom;t.ht(1/0,n,0,a);const l=t.measuredBounds,c=Math.max(l.width+s,0),d=Math.max(l.height+r,0);o.width+=c,o.height=Math.max(o.height,d)}e.J(h)}arrange(t,e,i){const n=e.length,s=t.padding,o=s.top,r=t.isOpposite;let a=r?i.width:s.left;for(let l=0;l<n;l++){const n=o,h=e[l];if(!h.visible)continue;const u=h.measuredBounds,c=h.margin,d=c.top+c.bottom,f=o+s.bottom;let g=u.height;const p=h.zs(!1);(isNaN(h.desiredSize.height)&&2===p||4===p)&&(g=Math.max(i.height-d-f,0));const m=g+d+f;let y=h.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=w.Center),r&&(a-=u.width+c.left+c.right),h.Ut(a+y.offsetX+c.left,n+y.offsetY+c.top+(i.height*y.y-m*y.y),u.width,g),r||(a+=u.width+c.left+c.right)}}});Xt.dn("Vertical",new class extends Xt{constructor(){super()}measure(t,i,n,s,o,r,a){const l=s.length,h=e.et(),u=t.Eo();for(let e=0;e<l;e++){const t=s[e];if(!t.visible&&t!==u)continue;const n=t.zs(!1);if(0!==n&&4!==n){h.push(t);continue}t.ht(i,1/0,r,0);const a=t.margin,l=t.measuredBounds,c=Math.max(l.width+a.right+a.left,0),d=Math.max(l.height+a.top+a.bottom,0);o.Fn(Math.max(o.width,c),o.height+d)}const c=h.length;t.desiredSize.width?i=Math.min(t.desiredSize.width,t.maxSize.width):0!==o.width&&(i=Math.min(o.width,t.maxSize.width));for(let e=0;e<c;e++){const t=h[e];if(!t.visible&&t!==u)continue;const n=t.margin,s=n.right+n.left,a=n.top+n.bottom;t.ht(i,1/0,r,0);const l=t.measuredBounds,c=Math.max(l.width+s,0),d=Math.max(l.height+a,0);o.width=Math.max(o.width,c),o.height+=d}e.J(h)}arrange(t,e,i){const n=e.length,s=t.padding,o=s.left,r=t.isOpposite;let a=r?i.height:s.top;for(let l=0;l<n;l++){const n=o,h=e[l];if(!h.visible)continue;const u=h.measuredBounds,c=h.margin,d=c.left+c.right,f=o+s.right;let g=u.width;const p=h.zs(!1);(isNaN(h.desiredSize.width)&&2===p||5===p)&&(g=Math.max(i.width-d-f,0));const m=g+d+f;let y=h.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=w.Center),r&&(a-=u.height+c.bottom+c.top),h.Ut(n+y.offsetX+c.left+(i.width*y.x-m*y.x),a+y.offsetY+c.top,g,u.height),r||(a+=u.height+c.bottom+c.top)}}});class Kt extends Xt{constructor(){super()}static vA=!1;measure(t,i,n,s,o,r,a){const l=s.length;if(0===l)return;const h=t.findMainElement();let u=h.margin,c=0,d=0;const f=u.right+u.left,g=u.top+u.bottom;h.ht(i,n,r,a);let p=h.measuredBounds,m=p.width,x=p.height,b=Math.max(m+f,0),k=Math.max(x+g,0);const S=t.isClipping;S&&0!==h.p0()&&!Kt.vA&&(Kt.vA=!0,e.ni("Main Shape for Spot Panel with isClipping = true must have a zero strokeWidth: "+t.toString()));const P=v.V(-u.left,-u.top,b,k);let M=v.V(0,0,m,x);this.O2(h,M,!0),m=M.width,x=M.height;let C=!0;const N=t.Eo();let T;for(let e=0;e<l;e++){const r=s[e];let a=i,l=n;if(r===h||!r.visible&&r!==N)continue;u=r.margin;let f=u.left,g=u.top;switch(c=u.right+u.left,d=u.top+u.bottom,T=r.zs(!1),T){case 2:a=m,l=x,c=0,d=0,f=0,g=0;break;case 5:a=m,c=0,f=0;break;case 4:l=x,d=0,g=0}r.ht(a,l,0,0),p=r.measuredBounds,b=Math.max(p.width+c,0),k=Math.max(p.height+d,0);let v=r.alignment;v.isDefault()&&(v=t.defaultAlignment),v.isSpot()||(v=w.Center);let S=r.alignmentFocus;S.isDefault()&&(S=w.Center);let P=null;r instanceof Yt&&""!==r._n&&(P=r.findObject(r._n),P===r&&(P=null));let L=M.x-f,A=M.y-g;if(null!==P){r.Ut(0,0,p.width,p.height);const t=P.actualBounds,e=y.V(t.x+(S.x*t.width-S.offsetX),t.y+(S.y*t.height-S.offsetY));for(P=P.panel;P!==r;)P.T.gt(e),P=P.panel;L+=v.x*m+v.offsetX-e.x,A+=v.y*x+v.offsetY-e.y,y.e(e)}else L+=v.x*m+v.offsetX-(S.x*p.width+S.offsetX),A+=v.y*x+v.offsetY-(S.y*p.height+S.offsetY);C?(C=!1,o.i(L,A,b,k)):o.unionNoCheck(L,A,b,k)}switch(C?o.a(P):S?o.intersect(M.x,M.y,M.width,M.height):o.unionNoCheck(P.x,P.y,P.width,P.height),v.e(P),v.e(M),T=h.stretch,1===T&&(T=h.zs(!1)),T){case 0:return;case 2:if(!isFinite(i)&&!isFinite(n))return;break;case 5:if(!isFinite(i))return;break;case 4:if(!isFinite(n))return}p=h.measuredBounds,m=p.width,x=p.height,b=Math.max(m+f,0),k=Math.max(x+g,0),u=h.margin,M=v.V(-u.left,-u.top,b,k),this.O2(h,M,!0),m=M.width,x=M.height;for(let e=0;e<l;e++){const i=s[e];if(i===h||!i.visible&&i!==N)continue;u=i.margin,c=u.right+u.left,d=u.top+u.bottom,p=i.measuredBounds,b=Math.max(p.width+c,0),k=Math.max(p.height+d,0);let n=i.alignment;n.isDefault()&&(n=t.defaultAlignment),n.isSpot()||(n=w.Center);let r=i.alignmentFocus;r.isDefault()&&(r=w.Center),C?(C=!1,o.i(n.x*m+n.offsetX-(r.x*p.width+r.offsetX)-u.left,n.y*x+n.offsetY-(r.y*p.height+r.offsetY)-u.top,b,k)):o.unionNoCheck(n.x*m+n.offsetX-(r.x*p.width+r.offsetX)-u.left,n.y*x+n.offsetY-(r.y*p.height+r.offsetY)-u.top,b,k)}C?o.a(P):S?o.intersect(M.x,M.y,M.width,M.height):o.unionNoCheck(P.x,P.y,P.width,P.height),v.e(M)}arrange(t,e,i){const n=e.length;if(0===n)return;const s=t.findMainElement(),o=s.measuredBounds,r=o.width,a=o.height,l=t.padding,h=l.left,u=l.top;let c=h-i.x,d=u-i.y;s.Ut(c,d,r,a);const f=v.V(0,0,r,a);this.O2(s,f,!1);for(let g=0;g<n;g++){const n=e[g];if(n===s)continue;const o=n.measuredBounds,r=o.width,a=o.height;let l=n.alignment;l.isDefault()&&(l=t.defaultAlignment),l.isSpot()||(l=w.Center);let p=n.alignmentFocus;p.isDefault()&&(p=w.Center);let m=null;if(n instanceof Yt&&""!==n._n&&(m=n.findObject(n._n),m===n&&(m=null)),null!==m){const t=m.actualBounds,e=y.V(t.x+(p.x*t.width-p.offsetX),t.y+(p.y*t.height-p.offsetY));for(m=m.panel;m!==n;)m.T.gt(e),m=m.panel;c=l.x*f.width+l.offsetX-e.x,d=l.y*f.height+l.offsetY-e.y,y.e(e)}else c=l.x*f.width+l.offsetX-(p.x*r+p.offsetX),d=l.y*f.height+l.offsetY-(p.y*a+p.offsetY);c+=f.x-i.x,d+=f.y-i.y,n.visible&&n.Ut(h+c,u+d,r,a)}v.e(f)}O2(t,e,i){let n=null;if(t instanceof Yt&&""!==t._n&&(n=t.findObject(t._n),n===t&&(n=null)),null!==n)for(i&&t.Ut(0,0,e.width,e.height),e.a(n.actualBounds),n=n.panel;n!==t;)n.T.vg(e),n=n.panel}}Xt.dn("Spot",new Kt);Xt.dn("Auto",new class extends Xt{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length;if(0===a)return;const l=t.findMainElement();let h=l.margin,u=e,c=i;const d=h.right+h.left,f=h.top+h.bottom;l.ht(e,i,o,r);let g=l.measuredBounds,p=0,m=null;l instanceof Jt&&(m=l,p=m.strokeWidth*m.scale);let y=Math.max(g.width+d,0),v=Math.max(g.height+f,0),b=t.I2(l);const w=b.x*y+b.offsetX,k=b.y*v+b.offsetY;let S=t.E2(l);const P=S.x*y+S.offsetX,M=S.y*v+S.offsetY;isFinite(e)&&(u=Math.max(Math.abs(w-P)-p,0)),isFinite(i)&&(c=Math.max(Math.abs(k-M)-p,0));let C=0,N=0;o>0&&(C=Math.max(Math.abs(b.x*o+b.offsetX-(S.x*o+S.offsetX))-p,0)),r>0&&(N=Math.max(Math.abs(b.y*r+b.offsetY-(S.y*r+S.offsetY))-p,0));const T=x.l();T.i(0,0);const L=t.Eo();for(let x=0;x<a;x++){const t=n[x];if(t===l||!t.visible&&t!==L)continue;h=t.margin;const e=h.right+h.left,i=h.top+h.bottom;t.ht(u,c,C,N),g=t.measuredBounds,y=Math.max(g.width+e,0),v=Math.max(g.height+i,0),T.i(Math.max(y,T.width),Math.max(v,T.height))}if(1===a)return g=l.measuredBounds,s.width=y,s.height=v,void x.e(T);b=t.I2(l),S=t.E2(l);let A=0,D=0;S.x!==b.x&&S.y!==b.y&&(A=T.width/Math.abs(S.x-b.x),D=T.height/Math.abs(S.y-b.y)),x.e(T),p=0,null!==m&&(p=m.strokeWidth*m.scale,6===m.hS()&&(A=D=Math.max(A,D))),A+=Math.abs(b.offsetX)+Math.abs(S.offsetX)+p,D+=Math.abs(b.offsetY)+Math.abs(S.offsetY)+p;let F=l.stretch;switch(1===F&&(F=l.zs(!1)),F){case 0:o=0,r=0;break;case 2:isFinite(e)&&(A=e),isFinite(i)&&(D=i);break;case 5:isFinite(e)&&(A=e),r=0;break;case 4:o=0,isFinite(i)&&(D=i)}l.tf(),l.ht(A,D,o,r),s.width=l.measuredBounds.width+d,s.height=l.measuredBounds.height+f}arrange(t,e,i){const n=e.length;if(0===n)return;const s=t.findMainElement(),o=s.measuredBounds,r=v.l();r.i(0,0,1,1);let a=s.margin;const l=a.left,h=a.top,u=t.padding,c=u.left,d=u.top;let f=l,g=h,p=o.width,m=o.height;s.Ut(c+f,d+g,p,m);const y=t.I2(s),x=t.E2(s),b=0+y.x*o.width+y.offsetX,k=0+y.y*o.height+y.offsetY,S=0+x.x*o.width+x.offsetX,P=0+x.y*o.height+x.offsetY;r.x=b,r.y=k,r.unionNoCheck(S,P,0,0),r.x+=l+c,r.y+=h+d;for(let M=0;M<n;M++){const i=e[M];if(i===s)continue;const n=i.measuredBounds;a=i.margin;const o=Math.max(n.width+a.right+a.left,0),l=Math.max(n.height+a.top+a.bottom,0);let h=i.alignment;h.isDefault()&&(h=t.defaultAlignment),h.isSpot()||(h=w.Center),f=r.width*h.x+h.offsetX-o*h.x+a.left+r.x,g=r.height*h.y+h.offsetY-l*h.y+a.top+r.y,p=r.width,m=r.height,i.visible&&(v.contains(r.x,r.y,r.width,r.height,f,g,n.width,n.height)?i.Ut(f,g,n.width,n.height):i.Ut(f,g,n.width,n.height,new v(r.x,r.y,r.width,r.height)))}v.e(r)}});Xt.dn("Table",new class extends Xt{constructor(){super(),this.name="Table"}measure(t,i,n,s,o,r,a){let l=s.length;const h=e.et(),u=e.et();for(let e=0;e<l;e++){const t=s[e],i=t instanceof Yt?t:null;if(null!==i&&i.Wr()&&t.visible){u.push(i);const e=i.C.r,n=e.length;for(let s=0;s<n;s++){const n=e[s];i.type===Yt.TableRow?n.row=t.row:i.type===Yt.TableColumn&&(n.column=t.column),h.push(n)}}else h.push(t)}l=h.length,0===l&&(t.getRowDefinition(0),t.getColumnDefinition(0));const c=[];for(let e=0;e<l;e++){const t=h[e];t.visible&&(t.ue(!0),t.Jn(!0),c[t.row]||(c[t.row]=[]),c[t.row][t.column]||(c[t.row][t.column]=[]),c[t.row][t.column].push(t))}e.J(h);const d=e.et(),f=e.et(),g=e.et(),p={count:0},m={count:0};let y=i,v=n;const b=t.Xe,w=t.Ye;let k=null;l=b.length;for(let e=0;e<l;e++)k=b[e],void 0!==k&&(k.actual=0,k.Ai=0);l=w.length;for(let e=0;e<l;e++)k=w[e],void 0!==k&&(k.actual=0,k.Ai=0);let S=c.length,P=0;for(let e=0;e<S;e++)c[e]&&(P=Math.max(P,c[e].length));const M=Math.min(t.topIndex,S-1),C=Math.min(t.leftIndex,P-1);let N,T=0;S=c.length;const L=t.Eo();for(let e=0;e<S;e++){if(!c[e])continue;P=c[e].length;const i=t.getRowDefinition(e);i.actual=0,i.Ai=0;for(let n=0;n<P;n++){if(!c[e][n])continue;const s=t.getColumnDefinition(n);void 0===d[n]&&(s.actual=0,s.Ai=0,d[n]=!0);const o=c[e][n],r=o.length;for(let a=0;a<r;a++){const r=o[a];if(!r.visible&&r!==L)continue;const l=r.rowSpan>1,h=r.columnSpan>1;(l||h)&&!(e<M)&&!(n<C)&&f.push(r);const u=r.margin,c=u.right+u.left,d=u.top+u.bottom;N=r.P0(i,s,!1);const x=r.desiredSize,b=!isNaN(x.width),w=!isNaN(x.height);if(0!==N&&!(b&&w)&&!(e<M)&&!(n<C)&&(!h&&void 0===p[n]&&(2===N||5===N)&&(p[n]=-1,p.count++),!l&&void 0===m[e]&&(2===N||4===N)&&(m[e]=-1,m.count++),!l&&!h&&g.push(r)),r.ht(1/0,1/0,0,0),e<M||n<C)continue;const S=r.measuredBounds,P=Math.max(S.width+c,0),A=Math.max(S.height+d,0);if(1===r.rowSpan&&(0===N||5===N)){k=t.getRowDefinition(e);const i=k.computeEffectiveSpacing(),n=0===k._;T=Math.max(A-k.actual,0),T+(n?i:0)>v&&(T=Math.max(v-i,0)),k.Ai=k.Ai+T,k.actual=k._+T,v=Math.max(v-(T+(n?i:0)),0)}if(1===r.columnSpan&&(0===N||4===N)){k=t.getColumnDefinition(n);const e=k.computeEffectiveSpacing(),i=0===k._;T=Math.max(P-k.actual,0),T+(i?e:0)>y&&(T=Math.max(y-e,0)),k.Ai=k.Ai+T,k.actual=k._+T,y=Math.max(y-(T+(i?e:0)),0)}(l||h)&&r.tf()}}}e.J(d);let A=0,D=0;l=t.columnCount;for(let e=0;e<l;e++){const t=w[e];void 0!==t&&(A+=isNaN(t.de)?t.Ai:t.de,0!==t.Ai&&(A+=t.computeEffectiveSpacing()))}l=t.rowCount;for(let e=0;e<l;e++){const t=b[e];void 0!==t&&(D+=isNaN(t.de)?t.Ai:t.de,0!==t.Ai&&(D+=t.computeEffectiveSpacing()))}y=Math.max(i-A,0),v=Math.max(n-D,0);let F=v,O=y;l=g.length;for(let e=0;e<l;e++){const i=g[e],n=t.getRowDefinition(i.row),s=t.getColumnDefinition(i.column),o=i.measuredBounds,r=i.margin,a=r.right+r.left,l=r.top+r.bottom;0===s.Ai&&void 0!==p[i.column]?p[i.column]=Math.max(o.width+a,p[i.column]):p[i.column]=null,0===n.Ai&&void 0!==m[i.row]?m[i.row]=Math.max(o.height+l,m[i.row]):m[i.row]=null}let E,R=0,B=0;for(E in m)"count"!==E&&(R+=m[E]);for(E in p)"count"!==E&&(B+=p[E]);const I=x.l();for(let e=0;e<l;e++){const i=g[e];if(!i.visible&&i!==L)continue;const n=t.getRowDefinition(i.row),s=t.getColumnDefinition(i.column);let o=0;isFinite(s.width)?o=s.width:(o=isFinite(y)&&null!==p[i.column]?0===B?s.actual+y:p[i.column]/B*O:null!==p[i.column]?y:s.actual||y,o=Math.max(0,o-s.computeEffectiveSpacing()));let r=0;switch(isFinite(n.height)?r=n.height:(r=isFinite(v)&&null!==m[i.row]?0===R?n.actual+v:m[i.row]/R*F:null!==m[i.row]?v:n.actual||v,r=Math.max(0,r-n.computeEffectiveSpacing())),I.i(Math.max(s.minimum,Math.min(o,s.maximum)),Math.max(n.minimum,Math.min(r,n.maximum))),N=i.P0(n,s,!1),N){case 5:I.height=Math.max(I.height,n.actual+v);break;case 4:I.width=Math.max(I.width,s.actual+y)}const a=i.margin,l=a.right+a.left,h=a.top+a.bottom;i.tf();let u=s.minimum,c=n.minimum;const d=i.measuredBounds;0===d.width&&null!==p[i.column]&&(u=Math.max(u,p[i.column])),0===d.height&&null!==m[i.row]&&(c=Math.max(u,m[i.row])),i.ht(I.width,I.height,u,c);const f=i.measuredBounds;let x=Math.max(f.width+l,0),b=Math.max(f.height+h,0);isFinite(y)&&(x=Math.min(x,I.width)),isFinite(v)&&(b=Math.min(b,I.height));let w=0;w=n.actual,n.actual=Math.max(n.actual,b),n.Ai=Math.max(n.Ai,b),T=n.actual-w,v=Math.max(v-T,0),null===m[i.row]&&(F=Math.max(F-T,0)),w=s.actual,s.actual=Math.max(s.actual,x),s.Ai=Math.max(s.Ai,x),T=s.actual-w,y=Math.max(y-T,0),null===p[i.column]&&(O=Math.max(O-T,0))}e.J(g);const z=x.l(),j=e.et(),V=e.et();if(l=f.length,0!==l)for(let e=0;e<S;e++){if(!c[e])continue;P=c[e].length;const i=t.getRowDefinition(e);j[e]=i.actual;for(let n=0;n<P;n++){if(!c[e][n])continue;const i=t.getColumnDefinition(n);V[n]=i.actual}}for(let e=0;e<l;e++){const s=f[e];if(!s.visible&&s!==L)continue;const o=t.getRowDefinition(s.row),r=t.getColumnDefinition(s.column);switch(I.i(Math.max(r.minimum,Math.min(i,r.maximum)),Math.max(o.minimum,Math.min(n,o.maximum))),N=s.P0(o,r,!1),N){case 2:0!==V[r.index]&&(I.width=Math.min(I.width,V[r.index])),0!==j[o.index]&&(I.height=Math.min(I.height,j[o.index]));break;case 5:0!==V[r.index]&&(I.width=Math.min(I.width,V[r.index]));break;case 4:0!==j[o.index]&&(I.height=Math.min(I.height,j[o.index]))}isFinite(r.width)&&(I.width=r.width),isFinite(o.height)&&(I.height=o.height),z.i(0,0);let a=r.minimum,l=o.minimum;for(let e=1;e<s.rowSpan&&!(s.row+e>=t.rowCount);e++)k=t.getRowDefinition(s.row+e),T=0,T=2===N||4===N?Math.max(k.minimum,0===j[s.row+e]?k.maximum:Math.min(j[s.row+e],k.maximum)):Math.max(k.minimum,isNaN(k.de)?k.maximum:Math.min(k.de,k.maximum)),z.height+=T,l+=k.minimum;for(let e=1;e<s.columnSpan&&!(s.column+e>=t.columnCount);e++)k=t.getColumnDefinition(s.column+e),T=0,T=2===N||5===N?Math.max(k.minimum,0===V[s.column+e]?k.maximum:Math.min(V[s.column+e],k.maximum)):Math.max(k.minimum,isNaN(k.de)?k.maximum:Math.min(k.de,k.maximum)),z.width+=T,a+=k.minimum;I.width+=z.width,I.height+=z.height;const h=s.margin,u=h.right+h.left,c=h.top+h.bottom;s.ht(I.width,I.height,a,l);const d=s.measuredBounds,g=Math.max(d.width+u,0),p=Math.max(d.height+c,0);let m=0;for(let e=0;e<s.rowSpan&&!(s.row+e>=t.rowCount);e++)k=t.getRowDefinition(s.row+e),m+=k.total||0;if(m<p){let e=p-m;const i=p-m;if(null!==s.spanAllocation){const n=s.spanAllocation;for(let o=0;o<s.rowSpan&&!(e<=0||s.row+o>=t.rowCount);o++){k=t.getRowDefinition(s.row+o);const r=k._||0,a=n(s,k,i);k.actual=Math.min(k.maximum,r+a),k._!==r&&(e-=k._-r)}}for(;e>0;){const i=k._||0;if(isNaN(k.height)&&k.maximum>i&&(k.actual=Math.min(k.maximum,i+e),k._!==i&&(e-=k._-i)),0===k.index)break;k=t.getRowDefinition(k.index-1)}}let y=0;for(let e=0;e<s.columnSpan&&!(s.column+e>=t.columnCount);e++)k=t.getColumnDefinition(s.column+e),y+=k.total||0;if(y<g){let e=g-y;const i=g-y;if(null!==s.spanAllocation){const n=s.spanAllocation;for(let o=0;o<s.columnSpan&&!(e<=0||s.column+o>=t.columnCount);o++){k=t.getColumnDefinition(s.column+o);const r=k._||0,a=n(s,k,i);k.actual=Math.min(k.maximum,r+a),k._!==r&&(e-=k._-r)}}for(;e>0;){const i=k._||0;if(isNaN(k.width)&&k.maximum>i&&(k.actual=Math.min(k.maximum,i+e),k._!==i&&(e-=k._-i)),0===k.index)break;k=t.getColumnDefinition(k.index-1)}}}e.J(f),x.e(z),x.e(I),void 0!==j&&e.J(j),void 0!==V&&e.J(V);let U=0,X=0;const K=t.desiredSize,G=t.maxSize;N=t.zs(!0),A=0,D=0;let Y=0,q=0;l=t.columnCount;for(let e=0;e<l;e++)if(void 0!==w[e]){if(k=t.getColumnDefinition(e),isFinite(k.width)){Y+=k.width,Y+=k.computeEffectiveSpacing();continue}if(2===k.Zb()){Y+=k._,Y+=k.computeEffectiveSpacing();continue}0!==k._&&(A+=k._,A+=k.computeEffectiveSpacing())}U=isFinite(K.width)?Math.min(K.width,G.width):0!==N&&isFinite(i)?i:A,U=Math.max(U,isFinite(i)?Math.min(r,i):r),U=Math.max(U-Y,0);const H=0===A?1:Math.max(U/A,1);for(let e=0;e<l;e++)void 0!==w[e]&&(k=t.getColumnDefinition(e),!isFinite(k.width)&&2!==k.Zb()&&(k.actual=k._*H),k.position=o.width,0!==k._&&(o.width+=k._,o.width+=k.computeEffectiveSpacing()));l=t.rowCount;for(let e=0;e<l;e++)if(void 0!==b[e]){if(k=t.getRowDefinition(e),isFinite(k.height)){q+=k.height,q+=k.computeEffectiveSpacing();continue}if(2===k.Zb()){q+=k._,q+=k.computeEffectiveSpacing();continue}0!==k._&&(D+=k._,D+=k.computeEffectiveSpacing())}X=isFinite(K.height)?Math.min(K.height,G.height):0!==N&&isFinite(n)?n:D,X=Math.max(X,isFinite(n)?Math.min(a,n):a),X=Math.max(X-q,0);const _=0===D?1:Math.max(X/D,1);for(let e=0;e<l;e++)void 0!==b[e]&&(k=t.getRowDefinition(e),!isFinite(k.height)&&2!==k.Zb()&&(k.actual=k._*_),k.position=o.height,0!==k._&&(o.height+=k._,o.height+=k.computeEffectiveSpacing()));l=u.length;for(let e=0;e<l;e++){const i=u[e];let n=0,s=0;i.type===Yt.TableRow?(n=o.width,k=t.getRowDefinition(i.row),s=k.actual):(k=t.getColumnDefinition(i.column),n=k.actual,s=o.height),i.measuredBounds.i(0,0,n,s),i.ue(!1)}e.J(u),t.ph=c}arrange(t,e,i){const n=e.length,s=t.padding,o=s.left,r=s.top,a=t.ph;if(null===a)return;let l=0,h=0;const u=a.length;let c=0;for(let x=0;x<u;x++)a[x]&&(c=Math.max(c,a[x].length));const d=t.Xe,f=t.Ye;let g=0,p=0,m=Math.min(t.topIndex,u-1);if(d.length>0){for(;m!==u&&(void 0===d[m]||0===d[m]._);)m++;m=Math.max(Math.min(m,u-1),0),g=-d[m].position}let y=Math.min(t.leftIndex,c-1);if(f.length>0){for(;y!==c&&(void 0===f[y]||0===f[y]._);)y++;y=Math.max(Math.min(y,c-1),0),p=-f[y].position}let b=0,k=0;for(;b!==u&&void 0===d[b];)b++;for(;k!==u&&void 0===f[k];)k++;const S=t.part;let P=t.getRowDefinition(b),M=t.getColumnDefinition(k);for(let x=0;x<e.length;x++){const i=e[x];if(!(i instanceof Yt&&i.visible&&i.Wr()))continue;i.type===Yt.TableRow?(P=t.getRowDefinition(i.row),M=t.getColumnDefinition(k)):(P=t.getRowDefinition(b),M=t.getColumnDefinition(i.column)),h=P.position+g+r,0!==P._&&(h+=P.computeEffectiveSpacingTop(Math.max(b,m))),l=M.position+p+o,0!==M._&&(l+=M.computeEffectiveSpacingTop(Math.max(k,y)));const n=i.measuredBounds;i.$c(),i.actualBounds.Nt();const s=i.actualBounds,a=v.V(s.x,s.y,s.width,s.height);(s.x=i.type===Yt.TableRow?o:l,s.y=i.type===Yt.TableColumn?r:h,s.width=n.width,s.height=n.height,i.actualBounds.u(),i.Jn(!1),a.equalsApproxClose(s))?v.e(a):(null!==S&&(S.uh(),i.w0(S)),v.e(a))}const C=x.l();for(let x=0;x<u;x++){if(!a[x])continue;c=a[x].length;const e=t.getRowDefinition(x);h=e.position+g+r,0!==e._&&(h+=e.computeEffectiveSpacingTop(Math.max(b,m)));for(let n=0;n<c;n++){if(!a[x][n])continue;const s=t.getColumnDefinition(n);l=s.position+p+o,0!==s._&&(l+=s.computeEffectiveSpacingTop(Math.max(k,y)));const r=a[x][n],u=r.length;for(let o=0;o<u;o++){const a=r[o],u=a.measuredBounds;C.i(0,0);for(let e=1;e<a.rowSpan&&!(x+e>=t.rowCount);e++){const i=t.getRowDefinition(x+e);0!==i._&&(C.height+=i.total)}for(let e=1;e<a.columnSpan&&!(n+e>=t.columnCount);e++){const i=t.getColumnDefinition(n+e);0!==i._&&(C.width+=i.total)}const c=s._+C.width,d=e._+C.height;let f=l,g=h;const p=c,m=d,y=l,b=h;let k=c,S=d;l+c>i.width&&(k=Math.max(i.width-l,0)),h+d>i.height&&(S=Math.max(i.height-h,0));let P=a.alignment,M=0,N=0,T=0,L=0;if(P.isDefault()){P=t.defaultAlignment,P.isSpot()||(P=w.Center),M=P.x,N=P.y,T=P.offsetX,L=P.offsetY;const i=s.alignment,n=e.alignment;i.isSpot()&&(M=i.x,T=i.offsetX),n.isSpot()&&(N=n.y,L=n.offsetY)}else M=P.x,N=P.y,T=P.offsetX,L=P.offsetY;(isNaN(M)||isNaN(N))&&(M=.5,N=.5,T=0,L=0);let A=u.width,D=u.height;const F=a.margin,O=F.left+F.right,E=F.top+F.bottom,R=a.P0(e,s,!1);isNaN(a.desiredSize.width)&&(2===R||5===R)&&(A=Math.max(c-O,0)),isNaN(a.desiredSize.height)&&(2===R||4===R)&&(D=Math.max(d-E,0));const B=a.maxSize,I=a.minSize;A=Math.min(B.width,A),D=Math.min(B.height,D),A=Math.max(I.width,A),D=Math.max(I.height,D);const z=D+E;f+=p*M-(A+O)*M+T+F.left,g+=m*N-z*N+L+F.top,a.visible&&(v.contains(y,b,k,S,f,g,u.width,u.height)?a.Ut(f,g,A,D):a.Ut(f,g,A,D,new v(y,b,k,S)))}}}x.e(C);for(let x=0;x<n;x++){const t=e[x],i=t instanceof Yt?t:null;if(null!==i&&i.Wr()){const e=t.actualBounds;t.naturalBounds.Nt(),t.naturalBounds.i(0,0,e.width,e.height),t.naturalBounds.u()}}}});Xt.dn("TableRow",new class extends Xt{constructor(){super()}measure(t,e,i,n,s,o,r){}arrange(t,e,i){}});Xt.dn("TableColumn",new class extends Xt{constructor(){super()}measure(t,e,i,n,s,o,r){}arrange(t,e,i){}});Xt.dn("Viewbox",new class extends Xt{constructor(){super()}measure(t,i,n,s,o,r,a){1!==s.length&&e.o("Viewbox Panel must contain exactly one GraphObject.");const l=s[0];l.tt=1,l.tf(),l.ht(1/0,1/0,r,a);let h=l.measuredBounds;const u=l.margin,c=u.right+u.left,d=u.top+u.bottom;if(isFinite(i)||isFinite(n)){const e=l.scale,s=h.width,o=h.height,u=Math.max(i-c,0),f=Math.max(n-d,0);let g=1;6===t.viewboxStretch?(0!==s&&0!==o&&(g=Math.min(u/s,f/o)),0===g&&(g=1e-4),l.tt*=g):(0!==s&&0!==o&&(g=Math.max(u/s,f/o)),0===g&&(g=1e-4),l.tt*=g),e!==l.scale&&(l.ue(!0),l.ht(1/0,1/0,r,a))}h=l.measuredBounds,o.width=isFinite(i)?i:Math.max(h.width+c,0),o.height=isFinite(n)?n:Math.max(h.height+d,0)}arrange(t,e,i){const n=e[0],s=n.measuredBounds,o=n.margin,r=o.right+o.left,a=o.top+o.bottom,l=Math.max(s.width+r,0),h=Math.max(s.height+a,0);let u=n.alignment;u.isDefault()&&(u=t.defaultAlignment),u.isSpot()||(u=w.Center),n.Ut(i.width*u.x-l*u.x+u.offsetX,i.height*u.y-h*u.y+u.offsetY,s.width,s.height)}});Xt.dn("Grid",new class extends Xt{constructor(){super()}measure(t,e,i,n,s,o,r){null===t.yi&&(t.yi=new Ht),this.pv(t),this.yv(t)}arrange(t,e,i){}Bi(t,e,i){const n=t.naturalBounds,s=n.width,o=n.height;e.save(),e.beginPath(),e.rect(0,0,s,o),e.clip(),e.endPath(),this.wv(t,e,i),e.restore(),e.clearContextCache(!1)}wv(t,e,i){let n=t.getDocumentScale()*i.scale;n<=0&&(n=1);const s=t.gridCellSize,o=s.width,r=s.height,a=t.naturalBounds,l=t.actualBounds,h=a.width,u=a.height,c=Math.ceil(h/o),d=Math.ceil(u/r),f=t.gridOrigin,g=f.x,p=f.y,m=t.yi.q0,y=t.C.r,x=y.length;for(let v=0;v<x;v++){const i=y[v];if(!i.visible)continue;const s=i.interval||1,f=Math.abs(s);if(o*f*n<2)continue;let x=i.segmentIndex;(!isFinite(x)||isNaN(x))&&(x=0),x<0&&(x=f-Math.min(-x,f)),x=Math.round(x%f);const b=i.opacity;let w=1;if(1!==b){if(0===b)continue;w=e.globalAlpha,e.globalAlpha=w*b}const k=m[v];let S=!1;const P=i.strokeDashArray;if(null!==P&&(S=!0,e.enableDash(P,i.strokeDashOffset)),null!==i.stroke&&i.strokeWidth>0&&("LineV"===i.figure||"LineH"===i.figure)){if(e.lineWidth=i.strokeWidth,t.rn(e,i.stroke,!1,!1,a,l),e.beginPath(),"LineV"===i.figure){const t=Math.floor((g-o)/o);for(let i=t;i<=t+c;i++){const t=i*o+g;0<=t&&t<=h&&this.Qb(i,s,x,k)&&(e.moveTo(t,0),e.lineTo(t,u))}}else if("LineH"===i.figure){const t=Math.floor((p-r)/r);for(let i=t;i<=t+d;i++){const t=i*r+p;0<=t&&t<=u&&this.Qb(i,s,x,k)&&(e.moveTo(0,t),e.lineTo(h,t))}}e.stroke(),e.endPath()}else if(null!==i.fill)if(t.rn(e,i.fill,!0,!1,a,l),"BarV"===i.figure){let t=i.width;isNaN(t)&&(t=o);const n=Math.floor((g-o)/o);for(let i=n;i<=n+c;i++){const n=i*o+g;0<=n+t&&n<=h&&this.Qb(i,s,x,k)&&e.fillRect(n,0,t,u)}}else if("BarH"===i.figure){let t=i.height;isNaN(t)&&(t=r);const n=Math.floor((p-r)/r);for(let i=n;i<=n+d;i++){const n=i*r+p;0<=n+t&&n<=u&&this.Qb(i,s,x,k)&&e.fillRect(0,n,h,t)}}S&&e.disableDash(),1!==b&&(e.globalAlpha=w)}}Qb(t,e,i,n){if(e<0)return t%e===i;if(t%e!==i)return!1;const s=n.length;for(let o=0;o<s;o++){if(t%n[o]===i)return!1}return!0}yv(t){const e=[],i=t.C.r,n=i.length;for(let s=0;s<n;s++){const t=i[s],o=[];if(e.push(o),!t.visible)continue;const r=t.interval;if(r<0)continue;const a=t.figure,l=this.B2(a);for(let e=0;e<n;e++){if(e===s)continue;const t=i[e];if(!t.visible)continue;const n=t.figure;if(this.B2(n)!==l)continue;const a=t.interval;a>r&&o.push(a)}}t.yi.q0=e}B2(t){return"LineV"===t||"BarV"===t}pv(t){let e=1,i=1;const n=t.C.r,s=n.length;for(let a=0;a<s;a++){const t=n[a],s=Math.abs(t.interval);s<2||(this.B2(t.figure)?i=i*s/S.DC(i,s):e=e*s/S.DC(e,s))}const o=t.gridCellSize,r=t.yi;r.Yc.isReal()?r.Yc.i(i*o.width,e*o.height):r.Yc=new x(i*o.width,e*o.height)}});Xt.dn("Link",new class extends Xt{constructor(){super()}measure(t,i,n,s,o,r,a){const l=s.length;if(!(t instanceof fe||t instanceof be))return;let h=null,u=null;if(t instanceof be&&(h=t),t instanceof fe&&(u=t,h=u.adornedPart,null===t.hf&&(t.hf=[])),!(h instanceof be))return;const c=h;if(0===l)return t.naturalBounds.Fn(0,0),void t.measuredBounds.i(0,0,0,0);const d=t instanceof fe?null:h.path,f=h.routeBounds,g=t.Bo;g.i(0,0,f.width,f.height);const p=c.points,m=h.pointsCount;null!==u?u.sd(!1):null!==h&&h.sd(!1);const x=f.width,b=f.height,S=t.hf;if(S.length=0,null!==d){this.measureLinkPath(t,x,b,d);const e=d.measuredBounds;g.unionRect(e),S.push(e)}const P=k.l(),M=y.l(),C=y.l();for(let k=0;k<l;k++){const i=s[k];if(i===d)continue;let n=i.measuredBounds;if(i.isPanelMain&&i instanceof Jt){this.measureLinkPath(t,x,b,i),n=i.measuredBounds,g.unionRect(n),S.push(n);continue}if(m<2){i.ht(1/0,1/0,0,0),n=i.measuredBounds,g.unionRect(n),S.push(n);continue}const o=i.segmentIndex,r=i.segmentFraction;let a=i.alignmentFocus;a.isNoSpot()&&(a=w.Center);const l=i.segmentOrientation,h=i.segmentOffset;let u=0,N=0,T=0,L=0;if(isNaN(o)){const t=c.ot,n=e.et();t.getPointAndAngleAlongPath(r,n);const s=y.V(n[0],n[1]);L=n[2],0!==l&&(T=c.computeAngle(i,l,L),i.Yt=T,i.ue(!0),i.Jn(!0)),u=s.x,N=s.y,y.e(s),e.J(n)}else if(o<-m||o>=m){const t=y.l();c.OA(t),L=c.midAngle,0!==l&&(T=c.computeAngle(i,l,L),i.Yt=T,i.ue(!0),i.Jn(!0)),u=t.x-f.x,N=t.y-f.y,y.e(t)}else{let t,e,n=0;if(o>=0?(t=p.elt(o),e=o<m-1?p.elt(o+1):t):(n=m+o,t=p.elt(n),e=n>0?p.elt(n-1):t),L=0,t.equalsApprox(e)){let i,s;o>=0?(i=o>0?p.elt(o-1):t,s=o<m-2?p.elt(o+2):e):(i=n<m-1?p.elt(n+1):t,s=n>1?p.elt(n-2):e);const r=i.distanceSquaredPoint(t),a=e.distanceSquaredPoint(s);L=r>a+10?o>=0?i.directionPoint(t):t.directionPoint(i):a>r+10?o>=0?e.directionPoint(s):s.directionPoint(e):o>=0?i.directionPoint(s):s.directionPoint(i)}else L=o>=0?t.directionPoint(e):e.directionPoint(t);0!==l&&(T=c.computeAngle(i,l,L),i.Yt=T,i.ue(!0),i.Jn(!0)),u=t.x+(e.x-t.x)*r-f.x,N=t.y+(e.y-t.y)*r-f.y}i.ht(1/0,1/0,0,0),n=i.measuredBounds;const A=i.naturalBounds;let D=0;i instanceof Jt&&(D=i.strokeWidth);const F=A.width+D,O=A.height+D;P.Ri(),P.Fs(-n.x,-n.y),P.tt(i.scale,i.scale),P.cs(0===l?i.angle:L,F/2,O/2),(22===l||26===l)&&P.cs(90,F/2,O/2),(23===l||27===l)&&P.cs(-90,F/2,O/2),28===l&&(L>45&&L<135||L>225&&L<315)&&P.cs(-L,F/2,O/2);const E=new v(0,0,F,O);M.setRectSpot(E,a),P.gt(M);const R=-M.x+D/2*i.scale,B=-M.y+D/2*i.scale;C.a(h);const I=isNaN(h.x),z=isNaN(h.y);if(I||z){const t=F/2+3,e=O/2+3,i=L>=45&&L<=135,n=L>=225&&L<=315;0===l&&(i||n)?(C.x=z?t:h.y,C.y=I?e:h.x,i?o>=0||isNaN(o)&&r<.5||I&&(C.y=-e):n&&((o>=0||isNaN(o)&&r<.5)&&I&&(C.y=-e),z&&(C.x=-t))):(I&&(o>=0||isNaN(o)&&r<.5?C.x=t:C.x=-t),z&&(C.y=-e),C.rotate(L))}else C.rotate(L);u+=C.x,N+=C.y,E.i(u+R,N+B,n.width,n.height),S.push(E),g.unionRect(E)}if(null!==h){const t=h.labelNodes;for(;t.next();)t.value.ht(1/0,1/0)}t.Bo=g,t.position.i(f.x+g.x,f.y+g.y),o.Fn(g.width||0,g.height||0),k.e(P),y.e(M),y.e(C)}arrange(t,e,i){const n=e.length;if(!(t instanceof fe||t instanceof be))return;let s=t,o=null;t instanceof fe&&(o=t,s=o.adornedPart);const r=t,a=t instanceof fe?null:s.path,l=t.hf;if(0!==l.length){let t=0;if(null!==a&&t<l.length){const e=l[t];t++,a.Ut(e.x-r.Bo.x,e.y-r.Bo.y,e.width,e.height)}for(let i=0;i<n;i++){const n=e[i];if(n!==a&&t<l.length){const e=l[t];t++,n.Ut(e.x-r.Bo.x,e.y-r.Bo.y,e.width,e.height)}}}const h=s.points,u=h.count;if(u>=2&&r instanceof be){const t=r.labelNodes;for(;t.next();){const e=t.value;r.xv(e,u,h)}}null!==o?o.sd(!1):s.sd(!1);const c=t.IA(y.l());t.location.i(t.position.x+c.x,t.position.y+c.y),y.e(c)}measureLinkPath(t,e,i,n){if(!1===n.Ao())return;let s=n.strokeWidth;if(0===s&&t instanceof fe&&t.type===Yt.Link&&t.adornedObject instanceof Jt&&(s=t.adornedObject.strokeWidth),s*=n.tt,t instanceof be&&null!==t.ot){const e=t.geometry.bounds;n.Wn(e.x-s/2,e.y-s/2,e.width+s,e.height+s)}else if(t instanceof fe&&null!==t.adornedPart.ot){const e=t.adornedPart.ot.bounds;n.Wn(e.x-s/2,e.y-s/2,e.width+s,e.height+s)}else n.Wn(-s/2,-s/2,e+s,i+s);n.bv(),n.ue(!1)}});Xt.dn("Graduated",new class extends Xt{constructor(){super()}measure(t,e,i,n,s,o,r){const a=t.findMainElement();t.Ke=[];const l=a.margin,h=l.right+l.left,u=l.top+l.bottom;a.ht(e,i,o,r);const c=a.measuredBounds,d=c.width,f=c.height,g=Math.max(d+h,0),p=Math.max(f+u,0),m=new v(-l.left,-l.top,g,p);t.Ke.push(m),s.a(m),this.determineGraduatedMarks(t,a);const y=t.xs;if(null===y)return;const x=n.length;for(let v=0;v<x;v++){const e=n[v],i=y[v];!e.visible||e===a||0===i.length||(e instanceof Jt?this.measureGraduatedTicks(t,e,i,s):e instanceof ie&&this.measureGraduatedLabels(t,e,i,s),e.ue(!1))}}arrange(t,e,i){if(null===t.Ke)return;const n=t.findMainElement(),s=t.xs;if(null===s)return;const o=t.Ke;let r=0,a=o[r];r++,null!==n&&n.Ut(a.x-i.x,a.y-i.y,a.width,a.height);const l=e.length;for(let h=0;h<l;h++){const t=e[h],l=s[h];!t.visible||t===n||0===l.length||(a=o[r],r++,t.Ut(a.x-i.x,a.y-i.y,a.width,a.height))}t.Ke=null}measureGraduatedTicks(t,e,i,n){let s=e.alignmentFocus;s.isNoSpot()&&(s=w.TopCenter);const o=e.angle;e.Yt=0,e.ht(1/0,1/0,0,0),e.Yt=o;const r=e.measuredBounds,a=r.width,l=r.height,h=v.V(0,0,a,l),u=y.l();u.setRectSpot(h,s),v.e(h);const c=-u.x,d=-u.y,f=new v,g=i.length;for(let p=0;p<g;p++){const t=i[p],n=t.pt.x,s=t.pt.y,o=t.angle;for(let i=0;i<4;i++){switch(i){case 0:u.i(c,d);break;case 1:u.i(c+a,d);break;case 2:u.i(c,d+l);break;case 3:u.i(c+a,d+l)}u.rotate(o+e.angle),u.offset(n,s),0===p&&0===i?f.i(u.x,u.y,0,0):f.unionPoint(u),u.offset(-n,-s),u.rotate(-o-e.angle)}}y.e(u),null!==t.Ke&&t.Ke.push(f),n.unionNoCheck(f.x,f.y,f.width,f.height)}measureGraduatedLabels(t,e,i,n){null===t.Pe&&(t.Pe=new ie);const s=t.Pe;this.EA(e,s);let o=e.alignmentFocus;o.isNoSpot()&&(o=w.TopCenter);const r=e.segmentOrientation,a=e.segmentOffset,l=new v;let h=0,u=0,c=0,d=0,f=0;const g=i.length;for(let p=0;p<g;p++){const t=i[p];h=t.pt.x,u=t.pt.y,c=t.angle,d=e.angle,f=e.angle,0!==r&&(f=21===r||25===r?c+e.angle:c,d=be.computeAngle(r,f)),s.Yt=d,s.text=t.text||"",s.ht(1/0,1/0,0,0);const n=s.measuredBounds,g=s.naturalBounds,m=g.width,x=g.height,b=k.l();b.Ri(),b.Fs(-n.x,-n.y),b.tt(s.scale,s.scale),b.cs(f,m/2,x/2),(22===r||26===r)&&b.cs(90,m/2,x/2),(23===r||27===r)&&b.cs(-90,m/2,x/2),28===r&&(c>45&&c<135||c>225&&c<315)&&b.cs(-c,m/2,x/2);const w=v.V(0,0,m,x),S=y.l();S.setRectSpot(w,o),b.gt(S);const P=-S.x,M=-S.y,C=y.l();C.a(a),isNaN(C.x)&&(C.x=m/2+3),isNaN(C.y)&&(C.y=-(x/2+3)),C.rotate(c),h+=C.x+P,u+=C.y+M;const N=new v(h,u,n.width,n.height),T=new v(n.x,n.y,n.width,n.height),L=new v(g.x,g.y,g.width,g.height);t.labelAngle=d,t.lineCount=s.lineCount,t.lines=s.getMetrics(),t.actualBounds=N,t.measuredBounds=T,t.naturalBounds=L,0===p?l.a(N):l.unionRect(N),y.e(C),y.e(S),v.e(w),k.e(b)}null!==t.Ke&&t.Ke.push(l),n.unionNoCheck(l.x,l.y,l.width,l.height)}determineGraduatedMarks(t,i){const n=i.geometry,s=i.strokeWidth,o=n.flattenedSegments,r=n.flattenedLengths,a=n.flattenedTotalLength,l=o.length;let h=0,u=0;const c=e.et();for(let e=0;e<l;e++){const t=o[e],i=[];h=0,u=0;const n=t.length;for(let e=0;e<n;e+=2){const n=t[e],s=t[e+1];if(0===e){h=n,u=s;continue}let o=180*Math.atan2(s-u,n-h)/Math.PI;o<0&&(o+=360),i.push(o),h=n,u=s}c.push(i)}const d=this.kv(t),f=t.C.r,g=f.length;let p,m=0,x=0,v=a;t.xs=[];for(let e=0;e<g;e++){const l=f[e];if(p=[],!l.visible||l===i){t.xs.push(p);continue}const h=Math.abs(l.interval),u=t.graduatedTickUnit;if(u*h*a/t.graduatedRange<2&&null===l.graduatedSkip){t.xs.push(p);continue}let g=r[0][0],b=0,w=0;x=a*l.graduatedStart-1e-4,v=a*l.graduatedEnd+1e-4;const k=u*h;let S=t.graduatedTickBase;if(S<t.graduatedMin){let e=(t.graduatedMin-S)/k;e=e%1===0?e:Math.floor(e+1),S+=e*k}else if(S>t.graduatedMin+k){S-=Math.floor((S-t.graduatedMin)/k)*k}const P=d[e],M=S,C=1e-6*t.graduatedMax;for(let e=1;S<=t.graduatedMax+C;e++){if(this.Pv(t,S-t.graduatedTickBase,P)&&(S>t.graduatedMax&&(S=t.graduatedMax),(null===l.graduatedSkip||l instanceof ie&&!l.graduatedSkip(S,l)||l instanceof Jt&&!l.graduatedSkip(S,l))&&(m=(S-t.graduatedMin)*a/t.graduatedRange,m>a&&(m=a),x<=m&&m<=v))){let t=c[b][w],e=r[b][w];for(;b<r.length;){for(;m>g&&w<r[b].length-1;)w++,t=c[b][w],e=r[b][w],g+=e;if(m<=g)break;b++,w=0,t=c[b][w],e=r[b][w],g+=e}const a=o[b],h=a[2*w],u=a[2*w+1],d=a[2*w+2],f=a[2*w+3],x=(m-(g-e))/e,v=new y(h+(d-h)*x+s/2-n.bounds.x,u+(f-u)*x+s/2-n.bounds.y);if(v.scale(i.scale,i.scale),t=this.Sv(t,x,a,c[b],w),l instanceof ie){let e="";null!==l.graduatedFunction?(e=l.graduatedFunction(S,l),e=null!=e?e.toString():""):e=(+S.toFixed(2)).toString(),""!==e&&p.push({pt:v,angle:t,text:e})}else p.push({pt:v,angle:t})}S=M+e*k}t.xs.push(p)}e.J(c)}Sv(t,e,i,n,s){if(e<.5005&&e>.4995)return t;let o=t;if(e<.5?s>0?o=n[s-1]:S.z(i[0],i[i.length-2])&&S.z(i[1],i[i.length-1])&&(o=n[n.length-1]):e>.5&&(s+1<n.length?o=n[s+1]:S.z(i[0],i[i.length-2])&&S.z(i[1],i[i.length-1])&&(o=n[0])),t!==o){let i=Math.abs(t-o);if(i>180&&(t<o?t+=360:o+=360,i=Math.abs(t-o)),e<5e-4||e>.9995)return(t+o)/2%360;if(i<10){const i=1-Math.abs(.5-e);return(t*i+o*(1-i))%360}}return t}kv(t){if(null===t.ss){const e=[],i=t.C.r,n=i.length;for(let t=0;t<n;t++){const s=i[t],o=[];if(e.push(o),!s.visible)continue;const r=s.interval;if(!(r<0))for(let e=0;e<n;e++){if(e===t)continue;const n=i[e];if(!n.visible||s.constructor!==n.constructor)continue;const a=n.interval;a>r&&o.push(a)}}t.ss=e}return t.ss}Pv(t,e,i){const n=i.length;for(let s=0;s<n;s++){const n=e%(i[s]*t.graduatedTickUnit),o=1e-6*t.graduatedTickUnit;if(n<o&&n>-o)return!1}return!0}Bi(t,e,i){const n=i.ta;i.ta=!0;const s=t.naturalBounds,o=s.width,r=s.height,a=e instanceof Rt;e.save(),e.beginPath(),e.rect(-1,-1,o+1,r+1),e.clip(),e.endPath();const l=t.findMainElement();l.Bi(e,i);let h=t.getDocumentScale()*i.scale;h<=0&&(h=1);const u=l.actualBounds,c=t.C.r,d=t.xs,f=c.length;for(let g=0;g<f;g++){const n=c[g],s=d[g],o=s.length;if(n.visible&&n!==l&&0!==s.length)if(n instanceof Jt){if(t.graduatedTickUnit*n.interval*l.geometry.flattenedTotalLength/t.graduatedRange*h<2&&null===n.graduatedSkip)continue;const r=n.measuredBounds,c=n.strokeWidth*n.scale;let d=n.alignmentFocus;d.isNoSpot()&&(d=w.TopCenter);for(let l=0;l<o;l++){const o=s[l].pt,h=s[l].angle;this.Mv(n,o,u,h,r,c,d),n.Bi(e,i),a&&(t.svg.appendChild(n.svg),n.svg=null),n.Hr.Ri()}}else if(n instanceof ie){null===t.Pe&&(t.Pe=new ie);const r=t.Pe;this.EA(n,r),r.U2=!0;for(let l=0;l<o;l++){const o=s[l];if(o.actualBounds&&o.measuredBounds&&o.naturalBounds){r.Nv(o);const s=o.actualBounds;r.Ut(s.x,s.y,s.width,s.height),this.Cv(r,u,s,o.measuredBounds,o.naturalBounds),r.qr=n.part,r.Vs=n.panel,r.Bi(e,i),r.Vs=null,r.qr=null,a&&(t.svg.appendChild(r.svg),r.svg=null)}}}}i.ta=n,e.restore(),e.clearContextCache(!0)}Mv(t,e,i,n,s,o,r){const a=t.Hr;a.Ri(),a.Fs(e.x+i.x,e.y+i.y),a.cs(n+t.angle,0,0),a.Fs(-s.width*r.x+r.offsetX+o/2,-s.height*r.y+r.offsetY+o/2),a.tt(t.scale,t.scale),t.Zu(!1),t.lh.set(t.Hr),t.da=t.scale,t.ka(!1)}Cv(t,e,i,n,s){const o=t.Hr;o.Ri(),o.Fs(i.x+e.x,i.y+e.y),o.Fs(-n.x,-n.y),t.g0(o,s.x,s.y,s.width,s.height),t.Zu(!1),t.lh.set(t.Hr),t.da=t.scale,t.ka(!1)}EA(t,e){e.Lv(t)}});var Gt=(t=>(t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(Gt||{});class Yt extends At{j;C;Zt;nd;Un;Zr;_n;Bo;V2;F;od;st;yi;_t;rd;yh;Ks;constructor(t,i){if(super(),this.j=null,void 0===t)this.j=Yt.Position;else if("string"==typeof t){const e=Xt.es.get(t);null!==e&&(this.j=e)}else t instanceof Xt?this.j=t:t&&(this.j=Yt.Position,i=t);null===this.j&&e.o("Panel type not specified or PanelLayout not loaded: "+t),this.n|=4194304|(this.j===Yt.Grid?1048576:0),this.C=new l,this.Zt=b.Rg,this.nd=w.Default,this.Un=1,this.Zr=null,this._n="",this.Bo=new v(NaN,NaN,NaN,NaN),this.V2=null,this.F=null,this.od=6,this.yi=null,this.st=null,this._t=null,this.rd=NaN,this.yh=null,this.Ks=null,i&&Object.assign(this,i)}cloneProtected(t){super.cloneProtected(t),t.j=this.j,t.Zt=this.Zt.P(),t.nd=this.nd.P(),t.Un=this.Un,t._n=this._n,t.Bo.a(this.Bo),null!==this.F&&(t.F=this.F.copy(t)),t.od=this.od,null!==this.st&&(t.st=this.st.copy()),null!==this.yi&&(t.yi=this.yi.copy()),t._t=this._t,t.rd=this.rd,t.yh=this.yh}Ro(t){super.Ro(t),t.C=this.C;const e=t.C.r,i=e.length;for(let n=0;n<i;n++){e[n].Vs=t}t.Zr=null}copy(){const t=super.copy();if(null!==t){const e=this.C.r,i=e.length;for(let n=0;n<i;n++){const i=e[n].copy();t.Av(i)}return t}return null}toString(){return"Panel("+this.type.name+")#"+u.as(this)}get type(){return this.j}set type(t){const e=this.j;e!==t&&(this.j=t,this.af=this.j===Yt.Grid,this.c(),this.t("type",e,t))}get elements(){return this.C.iterator}get naturalBounds(){return this.zi}get padding(){return this.Zt}set padding(t){"number"==typeof t?(t<0&&e.W(t,">= 0",Yt,"padding"),t=new b(t)):(t.left<0&&e.W(t.left,">= 0",Yt,"padding:value.left"),t.right<0&&e.W(t.right,">= 0",Yt,"padding:value.right"),t.top<0&&e.W(t.top,">= 0",Yt,"padding:value.top"),t.bottom<0&&e.W(t.bottom,">= 0",Yt,"padding:value.bottom"));const i=this.Zt;i.equals(t)||(t=t.P(),this.Zt=t,this.c(),this.t("padding",i,t))}get defaultAlignment(){return this.nd}set defaultAlignment(t){const e=this.nd;e.equals(t)||(t=t.P(),this.nd=t,this.c(),this.t("defaultAlignment",e,t))}get defaultStretch(){return this.Un}set defaultStretch(t){const e=this.Un;e!==t&&(this.Un=t,this.c(),this.t("defaultStretch",e,t))}get defaultSeparatorPadding(){return null!==this.F?this.F.W0:b.Rg}set defaultSeparatorPadding(t){"number"==typeof t&&(t=new b(t));const e=this.defaultSeparatorPadding;e.equals(t)||(t=t.P(),null===this.F&&(this.F=new _t),this.F.W0=t,this.c(),this.t("defaultSeparatorPadding",e,t))}get defaultRowSeparatorStroke(){return null!==this.F?this.F.J0:null}set defaultRowSeparatorStroke(t){const e=this.defaultRowSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof Ut)&&(t instanceof Ut&&t.u(),null===this.F&&(this.F=new _t),this.F.J0=t,this.S(),this.t("defaultRowSeparatorStroke",e,t))}get defaultRowSeparatorStrokeWidth(){return null!==this.F?this.F.$0:1}set defaultRowSeparatorStrokeWidth(t){const e=this.defaultRowSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.F&&(this.F=new _t),this.F.$0=t,this.c(),this.t("defaultRowSeparatorStrokeWidth",e,t))}get defaultRowSeparatorDashArray(){return null!==this.F?this.F.Z0:null}set defaultRowSeparatorDashArray(t){const i=this.defaultRowSeparatorDashArray;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Yt,"defaultRowSeparatorDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];("number"!=typeof n||!(n>=0)||!isFinite(n))&&e.o("defaultRowSeparatorDashArray value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}null===this.F&&(this.F=new _t),this.F.Z0=t,this.S(),this.t("defaultRowSeparatorDashArray",i,t)}}get defaultColumnSeparatorStroke(){return null!==this.F?this.F.Q0:null}set defaultColumnSeparatorStroke(t){const e=this.defaultColumnSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof Ut)&&(t instanceof Ut&&t.u(),null===this.F&&(this.F=new _t),this.F.Q0=t,this.S(),this.t("defaultColumnSeparatorStroke",e,t))}get defaultColumnSeparatorStrokeWidth(){return null!==this.F?this.F._0:1}set defaultColumnSeparatorStrokeWidth(t){const e=this.defaultColumnSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.F&&(this.F=new _t),this.F._0=t,this.c(),this.t("defaultColumnSeparatorStrokeWidth",e,t))}get defaultColumnSeparatorDashArray(){return null!==this.F?this.F.tp:null}set defaultColumnSeparatorDashArray(t){const i=this.defaultColumnSeparatorDashArray;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Yt,"defaultColumnSeparatorDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];("number"!=typeof n||!(n>=0)||!isFinite(n))&&e.o("defaultColumnSeparatorDashArray value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}null===this.F&&(this.F=new _t),this.F.tp=t,this.S(),this.t("defaultColumnSeparatorDashArray",i,t)}}get ph(){return null!==this.F?this.F.ph:null}set ph(t){null===this.F&&(this.F=new _t),this.F.ph=t}get viewboxStretch(){return this.od}set viewboxStretch(t){const e=this.od;e!==t&&(this.od=t,this.c(),this.t("viewboxStretch",e,t))}get gridCellSize(){return null!==this.yi?this.yi.ld:x.wC}set gridCellSize(t){null===this.yi&&(this.yi=new Ht);const i=this.yi.ld;if(!i.equals(t)){(!t.isReal()||0===t.width||0===t.height)&&e.o("Invalid Panel.gridCellSize: "+t),this.yi.ld=t.P();const n=this.diagram;null!==n&&this===n.grid&&n._l(),this.S(),this.t("gridCellSize",i,t)}}get gridOrigin(){return null!==this.yi?this.yi.hd:y.wo}set gridOrigin(t){null===this.yi&&(this.yi=new Ht);const i=this.yi.hd;if(!i.equals(t)){t.isReal()||e.o("Invalid Panel.gridOrigin: "+t),this.yi.hd=t.P();const n=this.diagram;null!==n&&this===n.grid&&n._l(),this.S(),this.t("gridOrigin",i,t)}}get graduatedMin(){return null!==this.st?this.st.ip:0}set graduatedMin(t){const e=this.graduatedMin;if(e!==t&&(null===this.st&&(this.st=new qt),this.st.ip=t,this.c(),this.t("graduatedMin",e,t),this.Wc())){const t=this.part;null!==t&&this.ba(t,"graduatedRange")}}get graduatedMax(){return null!==this.st?this.st.ep:100}set graduatedMax(t){const e=this.graduatedMax;if(e!==t&&(null===this.st&&(this.st=new qt),this.st.ep=t,this.c(),this.t("graduatedMax",e,t),this.Wc())){const t=this.part;null!==t&&this.ba(t,"graduatedRange")}}get graduatedRange(){return this.graduatedMax-this.graduatedMin}get graduatedTickUnit(){return null!==this.st?this.st.sp:10}set graduatedTickUnit(t){const e=this.graduatedTickUnit;e!==t&&t>0&&(null===this.st&&(this.st=new qt),this.st.sp=t,this.c(),this.t("graduatedTickUnit",e,t))}get graduatedTickBase(){return null!==this.st?this.st.np:0}set graduatedTickBase(t){const e=this.graduatedTickBase;e!==t&&(null===this.st&&(this.st=new qt),this.st.np=t,this.c(),this.t("graduatedTickBase",e,t))}get xs(){return null!==this.st?this.st.xs:null}set xs(t){null!==this.st?this.st.xs=t:null!==t&&(this.st=new qt,this.st.xs=t)}get Ke(){return null!==this.st?this.st.Ke:null}set Ke(t){null!==this.st?this.st.Ke=t:null!==t&&(this.st=new qt,this.st.Ke=t)}get ss(){return null!==this.st?this.st.ss:null}set ss(t){null!==this.st?this.st.ss=t:null!==t&&(this.st=new qt,this.st.ss=t)}get Pe(){return null!==this.st?this.st.Pe:null}set Pe(t){null!==this.st?this.st.Pe=t:null!==t&&(this.st=new qt,this.st.Pe=t)}w0(t){super.w0(t);const e=this.C.r,i=e.length;for(let n=0;n<i;n++)e[n].w0(t)}dh(t,e){if(this.j===Yt.Grid)return t.commitTransform(),void this.j.Bi(this,t,e);if(this.j===Yt.Graduated)return t.commitTransform(),void this.j.Bi(this,t,e);if(this.j===Yt.Table)if(t.commitTransform(),t instanceof Rt){const i=t.currentElement;t.currentElement=t.newGroup2("gojs-ts"),this.z2(t,e),t.endGroup(),t.currentElement=i}else this.z2(t,e);const i=this.isClipping&&this.j===Yt.Spot;i&&t.save();const n=this.findMainElement(),s=this.C.r,o=s.length;for(let r=0;r<o;r++){const o=s[r];i&&o===n&&(t.clipInsteadOfFill=!0),o.Bi(t,e),i&&o===n&&(t.clipInsteadOfFill=!1)}i&&(t.restore(),t.clearContextCache(!0))}z2(t,e){t.lineCap="butt";const i=this.rowCount>0?this.Xe:null,n=this.columnCount>0?this.Ye:null;null!==i&&this._b(t,e,!0,i,!0),null!==n&&this._b(t,e,!1,n,!0),null!==i&&this.BA(t,!0,i),null!==n&&this.BA(t,!1,n),null!==i&&this._b(t,e,!0,i,!1),null!==n&&this._b(t,e,!1,n,!1)}BA(t,e,i){const n=i.length,s=this.actualBounds,o=this.naturalBounds;let r=!0;for(let a=0;a<n;a++){const n=i[a];if(void 0===n||0===n.actual)continue;if(r){r=!1;continue}if(e){if(n.position>o.height)continue}else if(n.position>o.width)continue;let l=n.separatorStrokeWidth;isNaN(l)&&(l=e?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let h=n.separatorStroke;if(null===h&&(h=e?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),0===l||null===h)continue;this.rn(t,h,!1,!1,o,s);let u=!1,c=n.separatorDashArray;null===c&&(c=e?this.defaultRowSeparatorDashArray:this.defaultColumnSeparatorDashArray),null!==c&&(u=!0,t.enableDash(c,0)),t.beginPath();const d=n.position+l;e?d>o.height&&(l-=d-o.height):d>o.width&&(l-=d-o.width);let f=n.position+l/2;t.lineWidth=l;const g=this.Zt;if(e){f+=g.top;const e=g.left,i=o.width-g.right;t.moveTo(e,f),t.lineTo(i,f)}else{f+=g.left;const e=g.top,i=o.height-g.bottom;t.moveTo(f,e),t.lineTo(f,i)}t.stroke(),t.endPath(),u&&t.disableDash()}}_b(t,e,i,n,s){const o=n.length,r=this.actualBounds,a=this.naturalBounds,l=this.UA(!0),h=this.UA(!1);for(let u=0;u<o;u++){const e=n[u];if(void 0===e||null===e.background||e.coversSeparators===s||0===e.actual)continue;const o=i?r.height:r.width;if(e.position>o)continue;let c=e.computeEffectiveSpacing(),d=e.separatorStrokeWidth;isNaN(d)&&(d=i?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let f=e.separatorStroke;null===f&&(f=i?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),(null===f||e.index===(i?l:h))&&(d=0),c-=d;const g=e.position+d;let p=c+e.actual;if(g+p>o&&(p=o-g),p<=0)continue;const m=this.Zt;this.rn(t,e.background,!0,!1,a,r),i?t.fillRect(m.left,g+m.top,r.width-(m.left+m.right),p):t.fillRect(g+m.left,m.top,p,r.height-(m.top+m.bottom))}}UA(t){const e=t?this.rowCount:this.columnCount;for(let i=0;i<e;i++){const e=t?this.Xe[i]:this.Ye[i];if(void 0!==e)return e.index}return 0}Qc(){const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].Qc();this.Ve(!0)}Zc(t,e,i){const n=this.svg;if(null===n)return!1;if(this.type===Yt.Table){const i=n.getElementsByClassName("gojs-ts"),s=0!==i.length?i[0]:null;null!==s&&(s.innerHTML=""),t.currentElement=s,this.z2(t,e),t.currentElement=null}else{if(this.j===Yt.Grid)return n.innerHTML="",n.remove(),!1;if(this.j===Yt.Graduated)return n.innerHTML="",n.remove(),!1;if(this.j===Yt.Spot&&this.isClipping)return n.innerHTML="",n.remove(),this.hh=null,this.Qc(),!1}if(!super.Zc(t,e,i))return!1;const s=this.C.r,o=s.length;for(let r=0;r<o;r++)s[r].Bi(t,e);return!0}$u(t){return!0}b0(t,e,i,n){if(!this.isClipping){if(this.Xs()&&null!==t.partClipRect){const e=t.partClipRect,s=this.C.r;let o=0,r=0;for(let t=0;t<s.length;t++){if(!s[t].isVisibleObject())continue;const e=s[t].actualBounds;o=0===t?e.x:Math.min(e.x,o),r=0===t?e.y:Math.min(e.y,r)}return void n.setAttributeNS(null,"clip-path",`path('M ${e.x-i.x-o},${e.y-i.y-r} l ${e.width} 0 l 0 ${e.height} l -${e.width} 0 z')`)}super.b0(t,e,i,n)}}Jc(t,e,i,n,s){const o=this.an(),r=this.T,a=1/(r.m11*r.m22-r.m12*r.m21);let l=r.m22*a,h=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy);if(null!==this.background){const o=t*l+e*u+d,a=t*h+e*c+f,g=i*l+n*u+d,p=i*h+n*c+f;s.i(0,0);const m=this.naturalBounds,y=S.dl(0,0,m.width,m.height,o,a,g,p,s);return s.T(r),y}{o||(l=1,h=0,u=0,c=1,d=0,f=0);const a=t*l+e*u+d,g=t*h+e*c+f,p=i*l+n*u+d,m=i*h+n*c+f;s.i(p,m);let x=(p-a)**2+(m-g)**2,v=!1;const b=this.C.r,w=b.length,k=y.l();let S=null,P=1/0,M=null;const C=this.isClipping&&this.j===Yt.Spot;C&&(M=y.l(),S=this.findMainElement(),v=S.Jc(a,g,p,m,M),v&&(P=(a-M.x)**2+(g-M.y)**2));for(let t=0;t<w;t++){const e=b[t];if(!e.visible||e===S||!e.Jc(a,g,p,m,k))continue;v=!0;const i=(a-k.x)**2+(g-k.y)**2;i<x&&(x=i,s.set(k))}return C&&(P>x&&s.set(M),y.e(M)),y.e(k),o&&s.T(r),v}}Au(){const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].Au();super.Au()}c(t){if(this.Ao())return;super.c(t);let e=null;(this.j===Yt.Auto||this.j===Yt.Link)&&(e=this.findMainElement());const i=this.C.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];if((t===e||t.isPanelMain)&&t.c(!0),t.desiredSize.isReal())continue;const n=t.zs(!1);!(t instanceof Te)&&!(t instanceof Yt)&&!(t instanceof ie)&&0===n||t.c(!0)}}tf(){if(this.Ao())return;this.ue(!0),this.Jn(!0);const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].tf()}$c(){if(!1===this.Kb()){this.Zu(!0),this.ka(!0);const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].k2()}}k2(){this.ka(!0);const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].k2()}Wu(t,e,i,n){const s=this.Bo;s.i(0,0,0,0);const o=this.desiredSize,r=this.minSize;void 0===i&&(i=r.width,n=r.height),i=Math.max(i,r.width),n=Math.max(n,r.height);const a=this.maxSize;isNaN(o.width)||(t=Math.min(o.width,a.width)),isNaN(o.height)||(e=Math.min(o.height,a.height)),t=Math.max(i,t),e=Math.max(n,e);const l=this.Zt;t=Math.max(t-l.left-l.right,0),e=Math.max(e-l.top-l.bottom,0);const h=this.C.r;this.j.measure(this,t,e,h,s,i,n);let u=s.width+l.left+l.right,c=s.height+l.top+l.bottom;isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height),u=Math.min(a.width,u),c=Math.min(a.height,c),u=Math.max(r.width,u),c=Math.max(r.height,c),u=Math.max(i,u),c=Math.max(n,c),s.Fn(u,c),this.naturalBounds.Fn(u,c),this.Wn(0,0,u,c)}findMainElement(){if(null===this.Zr){const t=this.C.r,e=t.length;if(0===e)return null;for(let i=0;i<e;i++){const e=t[i];if(!0===e.isPanelMain)return this.Zr=e,e}this.Zr=t[0]}return this.Zr}Eo(){return null!==this.part?this.part.locationObject:null}get panelLayoutState(){return this.V2}set panelLayoutState(t){this.V2=t}fh(t,e,i,n){const s=this.C.r;if(this.actualBounds.i(t,e,i,n),!this.desiredSize.isReal()){let t=this.zs(!0);const e=this.measuredBounds,s=e.width,o=e.height,r=this.jr,a=r.left+r.right,l=r.top+r.bottom;switch(s===i&&o===n&&(t=0),t){case 0:(s>i||o>n)&&(this.c(),this.ht(s>i?i:s,o>n?n:o,0,0));break;case 2:this.c(!0),this.ht(i+a,n+l,0,0);break;case 5:this.c(!0),this.ht(i+a,o+l,0,0);break;case 4:this.c(!0),this.ht(s+a,n+l,0,0)}}this.j.arrange(this,s,this.Bo)}ch(t){const e=this.naturalBounds,i=this.Eo();if(v.contains(0,0,e.width,e.height,t.x,t.y)){const e=this.C.r,n=e.length,s=y.V(0,0);for(let o=n;o--;){const n=e[o];if((n.visible||n===i)&&(s.set(t).Oe(n.T),n.containsPoint(s)))return y.e(s),!0}return y.e(s),null!==this.Lt}return!1}d0(t){if(this.jn===t)return this;const e=this.C.r,i=e.length;for(let n=0;n<i;n++){const i=e[n].d0(t);if(null!==i)return i}return null}walkVisualTreeFrom(t,e){if(e(this,t),t instanceof Yt){const i=t.C.r,n=i.length;for(let t=0;t<n;t++)this.walkVisualTreeFrom(i[t],e)}}Yr(t){this.VA(this,t)}VA(t,e){e(t);const i=t.C.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];t instanceof Yt&&this.VA(t,e)}}Tv(t){this.zA(this,t)}zA(t,e){if(e(t),t instanceof Yt){const i=t.C.r,n=i.length;for(let t=0;t<n;t++)this.zA(i[t],e)}}findInVisualTree(t){return this.XA(this,t)}XA(t,e){if(e(t))return t;if(t instanceof Yt){const i=t.C.r,n=i.length;for(let t=0;t<n;t++){const n=this.XA(i[t],e);if(null!==n)return n}}return null}findObject(t){if(this.name===t)return this;const e=this.C.r;let i=e.length;this.Dv()&&(i=this.op());for(let n=0;n<i;n++){const i=e[n];if(i instanceof Yt){const e=i.findObject(t);if(null!==e)return e}if(i.name===t)return i}return null}YA(){const t=this.C.r,e=t.length;let i=0;for(let n=0;n<e;n++){const e=t[n];e instanceof Yt?i=Math.max(i,e.YA()):e instanceof Jt&&(i=Math.max(i,e.Fv()))}return i}an(){return!(this.type===Yt.TableRow||this.type===Yt.TableColumn)}Wr(){return this.type===Yt.TableRow||this.type===Yt.TableColumn}bL(t,e,i){if(!1===this.pickable||(void 0===e&&(e=null),void 0===i&&(i=null),this._e()))return null;const n=this.naturalBounds,s=1/this.getDocumentScale(),o=this.an(),r=o?t:y.V(t.x,t.y).Oe(this.T),a=this.diagram;let l=10,h=5;if(null!==a&&(l=a.getInputOption("extraTouchArea"),h=l/2),v.contains(-h*s,-h*s,n.width+l*s,n.height+l*s,r.x,r.y)){if(!this.af){const n=this.C.r,s=n.length,a=y.l(),l=this.isClipping&&this.j===Yt.Spot,h=l?this.findMainElement():null;if(l&&(h.an()?a.set(t).Oe(h.T):a.set(t),!h.containsPoint(a)))return y.e(a),o||y.e(r),null;const u=this.Eo();for(let c=s;c--;){const s=n[c];if(!s.visible&&s!==u||(s.an()?a.set(t).Oe(s.T):a.set(t),l&&s===h))continue;let d=null;if(s instanceof Yt?d=s.bL(a,e,i):!0===s.pickable&&s.containsPoint(a)&&(d=s),null!==d&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))))return y.e(a),o||y.e(r),d}y.e(a)}if(null===this.background)return o||y.e(r),null;const s=v.contains(0,0,n.width,n.height,r.x,r.y)?this:null;return o||y.e(r),s}return o||y.e(r),null}kL(t,e,i,n){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);const s=this.naturalBounds,o=this.an(),r=o?t:y.V(t.x,t.y).Oe(this.T),a=this.Wr(),l=v.contains(0,0,s.width,s.height,r.x,r.y);if(a||l){if(!this.af){const s=this.C.r,o=s.length,r=y.l(),a=this.Eo();for(let l=o;l--;){const o=s[l];if(!o.visible&&o!==a)continue;o.an()?r.set(t).Oe(o.T):r.set(t);let h=o;const u=o instanceof Yt?o:null;if(null!==u?u.kL(r,e,i,n):h.containsPoint(r)){if(!1===h.pickable)continue;null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&n.add(h)}}y.e(r)}return o||y.e(r),l&&null!==this.background}return o||y.e(r),!1}Tm(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);let r=o;if(void 0===r&&(r=k.l(),r.Ri()),r.nc(this.T),this.containedInRect(t,r))return this.X2(e,i,s),void 0===o&&k.e(r),!0;if(this.intersectsRect(t,r)){if(!this.af){const o=this.Eo(),a=this.C.r;for(let l=a.length;l--;){const h=a[l];if(!h.visible&&h!==o)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;let d=h;const f=h instanceof Yt?h:null,g=k.l();g.set(r),(null!==f?f.Tm(t,e,i,n,s,g):d.wA(t,n,g))&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))&&s.add(d)),k.e(g)}}return void 0===o&&k.e(r),n}return void 0===o&&k.e(r),!1}X2(t,e,i){const n=this.C.r;for(let s=n.length;s--;){const o=n[s];if(!o.visible)continue;const r=o.actualBounds,a=this.naturalBounds;if(r.x>a.width||r.y>a.height||r.x+r.width<0||r.y+r.height<0)continue;o instanceof Yt&&o.X2(t,e,i);let l=o;null!==t&&(l=t(l)),null!==l&&(null===e||e(l))&&i.add(l)}}PL(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===i&&(i=null),void 0===n&&(n=null);const r=this.naturalBounds,a=this.an(),l=a?t:y.V(t.x,t.y).Oe(this.T),h=a?e:y.V(e.x,e.y).Oe(this.T),u=l.distanceSquaredPoint(h),c=l.x>0&&l.x<r.width&&l.y>0&&l.y<r.height||y.distanceLineSegmentSquared(l.x,l.y,0,0,0,r.height)<=u||y.distanceLineSegmentSquared(l.x,l.y,0,r.height,r.width,r.height)<=u||y.distanceLineSegmentSquared(l.x,l.y,r.width,r.height,r.width,0)<=u||y.distanceLineSegmentSquared(l.x,l.y,r.width,0,0,0)<=u,d=l.distanceSquared(0,0)<=u&&l.distanceSquared(0,r.height)<=u&&l.distanceSquared(r.width,0)<=u&&l.distanceSquared(r.width,r.height)<=u;if(a||(y.e(l),y.e(h)),c){if(!this.af){const r=y.l(),l=y.l(),h=this.Eo(),u=this.C.r;for(let c=u.length;c--;){const d=u[c];if(!d.visible&&d!==h)continue;const f=d.actualBounds,g=this.naturalBounds;if(a&&(f.x>g.width||f.y>g.height||f.x+f.width<0||f.y+f.height<0))continue;if(d.an()){const i=d.T;r.set(t).Oe(i),l.set(e).Oe(i)}else r.set(t),l.set(e);let p=d;const m=d instanceof Yt?d:null;(null!==m?m.PL(r,l,i,n,s,o):p.xA(r,l,s))&&(null!==i&&(p=i(p)),null!==p&&(null===n||n(p))&&o.add(p))}y.e(r),y.e(l)}return s?c:d}return!1}I2(t){let e=null;if(t instanceof Jt){e=t.spot1,e===w.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot1)}return null===e&&(e=w.TopLeft),e}E2(t){let e=null;if(t instanceof Jt){e=t.spot2,e===w.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot2)}return null===e&&(e=w.BottomRight),e}add(){for(let t=0;t<arguments.length;t++)this.insertAt(this.C.count,t<0||arguments.length<=t?void 0:arguments[t]);return this}elt(t){return this.C.elt(t)}insertAt(t,i){i instanceof ce&&e.o("Cannot add a Part to a Panel: "+i+"; use a Panel instead"),(this===i||this.isContainedBy(i))&&(this===i&&e.o("Cannot make a Panel contain itself: "+this.toString()),e.o("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+i.toString()));const n=i.panel;if(null!==n&&n!==this&&e.o("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+i.toString()+", already contained by "+n.toString()+", cannot be shared by this Panel: "+this.toString()),this.j===Yt.Grid&&!(i instanceof Jt)&&e.o("Can only add Shapes to a Grid Panel, not: "+i),this.j===Yt.Graduated&&!(i instanceof Jt||i instanceof ie)&&e.o("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+i),i.Pa(this),i.qr=null,null!==this.itemArray){const t=i.data;e.K(t)&&(null===this.Ks&&(this.Ks=new m),this.Ks.set(t,i))}const s=this.C;let o=-1;if(n===this){let r=-1;const a=this.C.r,l=a.length;for(let t=0;t<l;t++)if(a[t]===i){r=t;break}if(-1!==r){if(r===t||r+1>=s.count&&t>=s.count)return;s.removeAt(r),o=r}else e.o("element "+i.toString()+" has panel "+n.toString()+" but is not contained by it.")}(t<0||t>s.count)&&(t=s.count),s.insertAt(t,i),(0===t||i.isPanelMain)&&(this.Zr=null),this.Ao()||this.c(),i.c(!1),(null!==i.portId||i instanceof Yt&&!0===i.fn)&&(this.fn=!0),this.ss=null,this.isEnabledObject()||this.t1(i,!1);const r=this.part;if(null!==r){r.L0(),r.cf(),this.fn&&r instanceof pe&&(r.fn=!0),r.fn&&r instanceof pe&&(r.ne=null);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;-1!==o&&r.raiseChangedEvent(4,"elements",this,i,null,o,null),r.raiseChangedEvent(3,"elements",this,null,i,null,t)}}get fn(){return 0!==(8388608&this.n)}set fn(t){0!==(8388608&this.n)!==t&&(this.n=8388608^this.n)}m2(){return 0!==(16777216&this.n)}Y2(t){t?this.n|=16777216:this.n&=-16777217}Av(t){t.Pa(this),t.qr=null;const e=this.C,i=e.count;e.insertAt(i,t);const n=this.part;if(null!==n){n.L0(),null!==t.portId&&n instanceof pe&&(n.fn=!0);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;n.raiseChangedEvent(3,"elements",this,null,t,null,i)}}$R(t){const e=this.C.r,i=e.length;let n=-1;for(let s=0;s<i;s++)if(e[s]===t){n=s;break}return n}remove(t){const e=this.C.r,i=e.length;let n=-1;for(let s=0;s<i;s++)if(e[s]===t){n=s;break}-1!==n&&this.te(n,!0)}removeAt(t){t>=0&&this.te(t,!0)}te(t,i){const n=this.C,s=n.elt(t);if(s.qr=null,s.Pa(null),null!==this.Ks){const t=s.data;e.K(t)&&this.Ks.delete(t)}n.removeAt(t),this.ue(!1),this.c(),this.Zr===s&&(this.Zr=null),this.ss=null;const o=this.part;if(null!==o){o.L0(),o.cf(),o.invalidateAdornments(),o instanceof pe&&(s instanceof Yt?s.walkVisualTreeFrom(s,((t,e)=>o.N2(e,i))):o.N2(s,i));const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;o.raiseChangedEvent(4,"elements",this,s,null,t,null)}}get Xe(){return null===this.F&&(this.F=new _t),this.F.Xe}get rowCount(){return null===this.F?0:this.Xe.length}getRowDefinition(t){t<0&&e.W(t,">= 0",Yt,"getRowDefinition:idx"),t=Math.round(t);const i=this.Xe;if(void 0===i[t]){const e=new $t;e.Pa(this),e.isRow=!0,e.index=t,i[t]=e,this.raiseChangedEvent(3,"rowdefs",this,null,e,null,t)}return i[t]}removeRowDefinition(t){if(t<0&&e.W(t,">= 0",Yt,"removeRowDefinition:idx"),0===this.rowCount)return;t=Math.round(t);const i=this.Xe,n=i[t];if(n){i[t]=void 0;let e=i.length-1;for(;e>=0&&void 0===i[e--];)i.length--;this.raiseChangedEvent(4,"rowdefs",this,n,null,t,null),this.c()}}$L(t,e){const i=this.Xe;if(!(t<0)){if(i[t]=e instanceof $t?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}get Ye(){return null===this.F&&(this.F=new _t),this.F.Ye}get columnCount(){return null===this.F?0:this.Ye.length}getColumnDefinition(t){t<0&&e.W(t,">= 0",Yt,"getColumnDefinition:idx"),t=Math.round(t);const i=this.Ye;if(void 0===i[t]){const e=new $t;e.Pa(this),e.isRow=!1,e.index=t,i[t]=e,this.raiseChangedEvent(3,"coldefs",this,null,e,null,t)}return i[t]}removeColumnDefinition(t){if(t<0&&e.W(t,">= 0",Yt,"removeColumnDefinition:idx"),0===this.columnCount)return;t=Math.round(t);const i=this.Ye,n=i[t];if(n){i[t]=void 0;let e=i.length-1;for(;e>=0&&void 0===i[e--];)i.length--;this.raiseChangedEvent(4,"coldefs",this,n,null,t,null),this.c()}}ZL(t,e){const i=this.Ye;if(!(t<0)){if(i[t]=e instanceof $t?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}addRowColumnDefinition(t){let e=null;return t.isRow?e=this.getRowDefinition(t.index):t.isRow||(e=this.getColumnDefinition(t.index)),e&&e.Hb(t),this}addRowDefinition(t,e){const i=this.getRowDefinition(t);return i&&i.Hb(new $t(e)),this}addColumnDefinition(t,e){const i=this.getColumnDefinition(t);return i&&i.Hb(new $t(e)),this}get rowSizing(){return null!==this.F?this.F.rp:3}set rowSizing(t){const e=this.rowSizing;e!==t&&(null===this.F&&(this.F=new _t),this.F.rp=t,this.c(),this.t("rowSizing",e,t))}get columnSizing(){return null!==this.F?this.F.lp:3}set columnSizing(t){const e=this.columnSizing;e!==t&&(null===this.F&&(this.F=new _t),this.F.lp=t,this.c(),this.t("columnSizing",e,t))}get topIndex(){return null!==this.F?this.F.hp:0}set topIndex(t){const i=this.topIndex;i!==t&&((!isFinite(t)||t<0)&&e.o("Panel.topIndex must be greater than zero and a real number, not: "+t),null===this.F&&(this.F=new _t),this.F.hp=t,this.c(),this.t("topIndex",i,t))}get leftIndex(){return null!==this.F?this.F.ap:0}set leftIndex(t){const i=this.leftIndex;i!==t&&((!isFinite(t)||t<0)&&e.o("Panel.leftIndex must be greater than zero and a real number, not: "+t),null===this.F&&(this.F=new _t),this.F.ap=t,this.c(),this.t("leftIndex",i,t))}findRowForLocalY(t){if(t<0||this.type!==Yt.Table||0===this.rowCount)return-1;let e=0;const i=this.Xe,n=i.length;let s=this.topIndex;for(;s<n;s++){const n=i[s];if(void 0!==n&&(e+=n.total,t<e))return s}return s}findColumnForLocalX(t){if(t<0||this.type!==Yt.Table||0===this.columnCount)return-1;let e=0;const i=this.Ye,n=i.length;let s=this.leftIndex;for(;s<n;s++){const n=i[s];if(void 0!==n&&(e+=n.total,t<e))return s}return s}graduatedPointForValue(t,e){if(void 0===e&&(e=new y(NaN,NaN)),this.type!==Yt.Graduated)return e.i(NaN,NaN),e;t=Math.min(Math.max(t,this.graduatedMin),this.graduatedMax);const i=this.findMainElement();return i.geometry.getPointAlongPath((t-this.graduatedMin)/this.graduatedRange,e),i.T.gt(e)}graduatedValueForPoint(t){if(this.type!==Yt.Graduated)return NaN;const e=this.findMainElement();return e.T.$e(t),e.geometry.getFractionForPoint(t)*this.graduatedRange+this.graduatedMin}get data(){return this._t}set data(t){const i=this._t;if(i!==t){const n=this instanceof ce&&!(this instanceof fe);n&&e.s(t,"object",Yt,"data"),this.Et(),this._t=t;const s=this.diagram;if(null!==s)if(n)s.partManager.Rv(this,i,t);else{const e=this.panel;null!==e&&null!==e.Ks&&(null!==i&&e.Ks.delete(i),null!==t&&e.Ks.set(t,this))}if(this.t("data",i,t),null!==s&&s.undoManager.isUndoingRedoing)return;null!==t&&this.updateTargetBindings()}}get itemIndex(){return this.rd}set itemIndex(t){const e=this.rd;e!==t&&(this.rd=t,this.t("itemIndex",e,t))}get Ys(){return null!==this.p?this.p.Ys:null}set Ys(t){this.Ci!==t&&(null===this.p&&(this.p=new Dt),this.p.Ys=t)}C2(){return null!==this.Ys}AA(){const t=this.Ys;return null!==t&&t.h}freezeBindings(){return this.Et()}Et(){let t=this.Ys;if(null===t)null!==this.data&&e.o("Template cannot have .data be non-null: "+this),this.Ys=t=new l;else if(t.h)return this;const i=new l;this.Y2(!1),this.walkVisualTreeFrom(this,((e,n)=>{n.ah();const s=n.Ci;if(null!==s){n.P2(!1);const o=s.iterator;for(;o.next();){const s=o.value;2===s.mode&&n.P2(!0);const r=s.sourceName;if(s.isToObject){"/"===r&&e.Y2(!0);const t=s.yA(e,n);null!==t&&(i.add(t),null===t.qn&&(t.qn=new l),t.qn.add(s))}t.add(s)}}if(n instanceof Yt&&n.type===Yt.Table){if(n.rowCount>0){const e=n.Xe,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(void 0!==i&&null!==i.bs){const e=i.bs.iterator;for(;e.next();){const n=e.value;n.be=i,n.ad=2,n.ff=i.index,t.add(n)}}}}if(n.columnCount>0){const e=n.Ye,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(void 0!==i&&null!==i.bs){const e=i.bs.iterator;for(;e.next();){const n=e.value;n.be=i,n.ad=1,n.ff=i.index,t.add(n)}}}}}}));const n=i.iterator;for(;n.next();){const t=n.value;if(null!==t.qn){t.P2(!0);const e=t.qn.iterator;for(;e.next();){const i=e.value;null===t.Ci&&(t.Ci=new l),t.Ci.add(i)}}t.qn=null}let s=t.iterator;for(;s.next();){const t=s.value;let i=t.be;if(null!==i){t.be=null;const n=t.targetProperty,s=n.indexOf(".");if(s>0&&i instanceof Yt){const o=n.substring(0,s),r=n.substring(s+1),a=i.findObject(o);null!==a?(i=a,t.targetProperty=r):(e.ni('Warning: unable to find GraphObject named "'+o+'" for Binding: '+t.toString()),i=null)}if(i instanceof $t){const e=u.as(i.panel);t.targetId=void 0===e?-1:e,i.panel.jn=t.targetId}else if(i instanceof At){const e=u.as(i);t.targetId=void 0===e?-1:e,i.jn=t.targetId}else e.o("Unknown type of binding target: "+i);t.check(i)}}return t.u(),this instanceof ce&&this.ke()&&this.ensureBounds(),this}static DE=!1;copyTemplate(t){void 0===t&&(t=!1);const e=this.copy();return e.Tv((t=>{t instanceof Yt&&(t.Ys=null,t._t=null);const e=t.Ci;null!==e&&(t.Ci=null,e.each((e=>t.bind(e.copy()))));const i=t.ws;null!==i&&(t.ws=null,i.each((e=>t.trigger(e.value.copy()))))})),t&&e.Et(),e}updateTargetBindings(t){const e=this.Ys;if(null===e)return;void 0===t&&(t="");const i=this.diagram?.model,n=e.iterator;for(;n.next();){const e=n.value,s=this.KA(e,t);if(null===s)continue;const{data:o,elt:r}=s;e.isToTheme&&null===this.diagram||void 0!==r&&e.updateTarget(r,o,void 0,i)}}To(){if(null!==this.diagram)if(this.C2()){const t=this.diagram.model,e=this.Ys.iterator;for(;e.next();){const i=e.value;if(!i.isToTheme)continue;const n=this.KA(i);if(null===n)continue;const{data:s,elt:o}=n;void 0!==o&&i.updateTarget(o,s,void 0,t)}}else{const t=this.C.r,e=t.length;for(let i=0;i<e;i++)t[i].To()}}KA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=t.sourceProperty;if(""!==e&&""!==i&&i!==e)return null;const n=t.targetProperty;if(null===t.converter&&""===n)return null;let s=this.data;const o=t.sourceName;if(t.isToObject){if(s=this.pA(o),null===s)return null}else if(t.isToModel){const t=this.diagram;if(null===t)return null;s=t.model.modelData}let r=this;const a=t.targetId;if(-1!==a){if(r=this.d0(a),null===r)return null}else null!==t.be&&(r=t.be);"/"===o?s=r.part:"."===o?s=r:".."===o&&(s=r.panel);const l=t.ad;if(0!==l){if(!(r instanceof Yt))return null;1===l?r=r.getColumnDefinition(t.ff):2===l&&(r=r.getRowDefinition(t.ff))}return{data:s,elt:r}}get itemArray(){return this.yh}set itemArray(t){const e=this.yh;if(e!==t||null!==t&&this.vv(t)){const i=this.diagram;if(e!==t&&(null!==i&&null!==e&&i.partManager.IM(this,i),this.yh=t,null!==i&&null!==t&&i.partManager.OM(this,i)),this.t("itemArray",e,t),null!==i&&i.undoManager.isUndoingRedoing)return;this.GA(e,t)}}findItemPanelForData(t){return null==t||null===this.Ks?null:(e.ec(t,Yt,"findItemPanelForData"),this.Ks.get(t))}vv(t){const e=this.C.r,i=e.length,n=t.length;let s=0,o=null;for(;s<i&&(o=e[s],!(o instanceof Yt)||null===o.data);)s++,o=e[s];if(i-s!==n)return!0;if(null===o)return n>0;let r=0;for(;s<i&&r<n;){if(o=e[s],!(o instanceof Yt)||o.data!==t[r])return!0;s++,r++}return!1}op(){if(this.type===Yt.Spot||this.type===Yt.Auto)return Math.min(this.C.length,1);if(this.type===Yt.Link){const t=this.C,e=t.length;let i=0;for(;i<e;i++){const e=t.elt(i);if(!(e instanceof Jt)||!e.isPanelMain)return i}return i}if(this.type===Yt.Table&&this.C.length>0){const t=this.C.elt(0);if(t.isPanelMain&&t instanceof Yt&&t.Wr())return 1}return 0}rebuildItemElements(){const t=this.op();for(;this.C.length>t;)this.te(this.C.length-1,!1);this.GA(null,this.itemArray)}GA(t,e){const i=this.op(),n=e;if(null!==n&&0!==n.length)if(this.C.length<=i){const t=n.length;for(let e=0;e<t;e++)this.i1(n[e],e,!0)}else{let t=i;for(let i=0;i<n.length;i++,t++){const e=n[i],s=t<this.C.length?this.C.elt(t):null;if(s instanceof Yt){if(s.data!==e){const n=this.K2(s.data,i),o=this.K2(e,i);let r=o!==n;if(!r){const t=this.G2(s.data,i,n);r=this.G2(e,i,o)!==t}r?(this.te(t,!1),this.i1(e,i,!1)):s.data=e}}else this.i1(e,i,!1)}for(;t<this.C.length;)this.te(t,!1);this.Zr=null,this.H2(i,0),this.Ao()||this.c(),this.ss=null,this.isEnabledObject()||this.t1(this,!1);const e=this.part;null!==e&&(e.L0(),e.cf(),this.fn&&e instanceof pe&&(e.fn=!0),e.fn&&e instanceof pe&&(e.ne=null))}else for(;this.C.length>i;)this.te(this.C.length-1,!1)}i1(t,i,n){if(null==t||i<0)return null;const s=this.K2(t,i),o=this.G2(t,i,s);if(null!==o){o.Et();const s=o.copy();if(s.m2()){const t=this.findBindingPanel();null!==t&&t.Y2(!0)}e.K(t)&&(null===this.Ks&&(this.Ks=new m),this.Ks.set(t,s));const r=i+this.op();return this.insertAt(r,s),n&&(s._t=t,this.H2(r,i),s._t=null),s.data=t,s}return null}Ov(t){if(t<0)return;const e=t+this.op();this.te(e,!0),this.H2(e,t)}H2(t,e){const i=this.C;let n=t,s=e;for(;n<i.length;){const t=i.elt(n);t instanceof Yt&&t.Iv(n,s),n++,s++}}Iv(t,e){this.type===Yt.TableRow?this.row=t:this.type===Yt.TableColumn&&(this.column=t),this.itemIndex=e}Dv(){return null!==this.yh||null!==this.itemTemplateMap}get itemTemplate(){return null===this.itemTemplateMap?null:this.itemTemplateMap.get("")}set itemTemplate(t){if(null===this.itemTemplateMap){if(null===t)return;this.itemTemplateMap=new m}const i=this.itemTemplateMap.get("");if(i!==t){(t instanceof ce||t.isPanelMain)&&e.o("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+t),this.itemTemplateMap.set("",t),this.t("itemTemplate",i,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemTemplateMap(){return null!==this.p?this.p.Y0:null}set itemTemplateMap(t){const e=this.itemTemplateMap;if(e!==t){const i=t.iterator;for(;i.next();){i.value}this.Gt().Y0=t,this.t("itemTemplateMap",e,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemCategoryProperty(){return null!==this.p?this.p.K0:"category"}set itemCategoryProperty(t){const i=this.itemCategoryProperty;i!==t&&("string"!=typeof t&&!e.it(t)&&e.Zi(t,"string or function",Yt,"itemCategoryProperty"),this.Gt().K0=t,this.t("itemCategoryProperty",i,t))}K2(t,i){if(null===t)return"";const n=this.itemCategoryProperty;let s="";if(e.it(n))s=n(t);else{if("string"!=typeof n||!e.K(t))return"";{if(""===n)return"";const e=this.diagram,i=null!==e?e.model:null;s=i?i.yt(t,n):Ue.yt(t,n)}}return void 0===s?"":"string"==typeof s?s:void e.o("Panel.getCategoryForItemData found a non-string category for "+t+": "+s)}static HA=!1;static jA=null;G2(t,i,n){const s=this.itemTemplateMap;let o=null;return null!==s&&(o=s.get(n)),null===o&&(null!==s&&(o=s.get("")),null===o&&(Yt.HA||(Yt.HA=!0,e.ni('No item template Panel found for category "'+n+'" on '+this),e.ni("  Using default item template."),Yt.jA=(new Yt).add((new ie).bind("text","",e.toString).theme("stroke","text"))),o=Yt.jA)),o}get af(){return 0!==(1048576&this.n)}set af(t){const i=0!==(1048576&this.n);i!==t&&(e.s(t,"boolean",Yt,"isAtomic"),this.n=1048576^this.n,this.t("isAtomic",i,t))}get isClipping(){return 0!==(2097152&this.n)}set isClipping(t){const e=0!==(2097152&this.n);e!==t&&(this.Qc(),this.n=2097152^this.n,this instanceof Ne&&(this.si=null),this.c(),this.t("isClipping",e,t))}get isOpposite(){return 0!==(33554432&this.n)}set isOpposite(t){const e=0!==(33554432&this.n);e!==t&&(this.n=33554432^this.n,this.c(),this.t("isOpposite",e,t))}get isEnabled(){return 0!==(4194304&this.n)}set isEnabled(t){const e=0!==(4194304&this.n);if(e!==t){const i=null===this.panel||this.panel.isEnabledObject();this.n=4194304^this.n,this.t("isEnabled",e,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;i&&this.t1(this,t)}}t1(t,e){const i=t.enabledChanged;if(null!==i&&i(t,e),t instanceof Yt){const i=t.C.r,n=i.length;for(let t=0;t<n;t++){const n=i[t];e&&n instanceof Yt&&!n.isEnabled||this.t1(n,e)}}}get alignmentFocusName(){return this._n}set alignmentFocusName(t){const e=this._n;e!==t&&(this._n=t,this.c(),this.t("alignmentFocusName",e,t))}static definePanelLayout(t,e){Xt.dn(t,e)}static isBuilderDefined(t){return Xt.es.has(t)}static Position=(()=>Xt.es.get("Position"))();static Horizontal=(()=>Xt.es.get("Horizontal"))();static Vertical=(()=>Xt.es.get("Vertical"))();static Spot=(()=>Xt.es.get("Spot"))();static Auto=(()=>Xt.es.get("Auto"))();static Table=(()=>Xt.es.get("Table"))();static Viewbox=(()=>Xt.es.get("Viewbox"))();static TableRow=(()=>Xt.es.get("TableRow"))();static TableColumn=(()=>Xt.es.get("TableColumn"))();static Link=(()=>Xt.es.get("Link"))();static Grid=(()=>Xt.es.get("Grid"))();static Graduated=(()=>Xt.es.get("Graduated"))()}Yt.definePanelLayout=Yt.definePanelLayout;class qt{ip;ep;sp;np;xs;Ke;ss;Pe;constructor(){this.ip=0,this.ep=100,this.sp=10,this.np=0,this.xs=null,this.Ke=null,this.ss=null,this.Pe=null}copy(){const t=new qt;return t.ip=this.ip,t.ep=this.ep,t.sp=this.sp,t.np=this.np,t.xs=this.xs,t.Ke=this.Ke,t.ss=this.ss,t.Pe=this.Pe,t}}class Ht{ld;hd;Yc;q0;constructor(){this.ld=x.wC,this.hd=y.wo,this.Yc=x.pw,this.q0=[]}copy(){const t=new Ht;return t.ld=this.ld.copy(),t.hd=this.hd.copy(),t.Yc=this.Yc.copy(),t.q0=this.q0,t}}class _t{Xe;Ye;rp;lp;hp;ap;W0;$0;J0;Z0;_0;Q0;tp;ph;constructor(){this.Xe=[],this.Ye=[],this.rp=3,this.lp=3,this.hp=0,this.ap=0,this.W0=b.Rg,this.$0=1,this.J0=null,this.Z0=null,this._0=1,this.Q0=null,this.tp=null,this.ph=null}copy(t){const e=new _t,i=this.Xe,n=i.length,s=e.Xe;for(let l=0;l<n;l++){if(void 0===i[l])continue;const e=i[l].copy();e.Pa(t),s[l]=e}const o=this.Ye,r=o.length,a=e.Ye;for(let l=0;l<r;l++){if(void 0===o[l])continue;const e=o[l].copy();e.Pa(t),a[l]=e}return e.rp=this.rp,e.lp=this.lp,e.hp=this.hp,e.ap=this.ap,e.W0=this.W0.P(),e.$0=this.$0,e.J0=this.J0,e.Z0=this.Z0,e._0=this._0,e.Q0=this.Q0,e.tp=this.tp,e.ph=this.ph,e}}var Wt=(t=>(t[t.Default=1]="Default",t[t.None=2]="None",t[t.ProportionalExtra=3]="ProportionalExtra",t))(Wt||{});class $t{Vs;cp;At;Ca;La;hi;at;cd;$n;Qr;fd;ud;Aa;Lt;dd;bs;_;Ai;de;constructor(t){u.Gi(this),this.Vs=null,this.cp=!0,this.At=0,this.de=NaN,this.Ca=0,this.La=1/0,this.hi=w.Default,this._=0,this.Ai=0,this.at=0,this.bs=null,this.cd=1,this.$n=1,this.Qr=null,this.fd=null,this.ud=NaN,this.Aa=null,this.Lt=null,this.dd=!1,t&&(Object.assign(this,t),void 0!==t.column?(this.isRow=!1,this.index=t.column):void 0!==t.row&&(this.isRow=!0,this.index=t.row))}copy(){const t=new $t;return t.cp=this.cp,t.At=this.At,t.de=this.de,t.Ca=this.Ca,t.La=this.La,t.hi=this.hi,t._=this._,t.Ai=this.Ai,t.at=this.at,t.$n=this.$n,t.cd=this.cd,null===this.Qr?t.Qr=null:t.Qr=this.Qr.P(),t.fd=this.fd,t.ud=this.ud,t.Aa=null,null!==this.Aa&&(t.separatorDashArray=this.Aa.slice()),t.Lt=this.Lt,t.dd=this.dd,t.bs=this.bs,t}Hb(t){t.isRow?void 0!==t.height&&(this.height=t.height):void 0!==t.width&&(this.width=t.width),void 0!==t.minimum&&(this.minimum=t.minimum),void 0!==t.maximum&&(this.maximum=t.maximum),void 0!==t.alignment&&(this.alignment=t.alignment),void 0!==t.stretch&&(this.stretch=t.stretch),void 0!==t.sizing&&(this.sizing=t.sizing),void 0!==t.separatorPadding&&(this.separatorPadding=t.separatorPadding),void 0!==t.separatorStroke&&(this.separatorStroke=t.separatorStroke),void 0!==t.separatorStrokeWidth&&(this.separatorStrokeWidth=t.separatorStrokeWidth),void 0!==t.separatorDashArray&&(this.Aa=t.separatorDashArray),void 0!==t.background&&(this.background=t.background),void 0!==t.coversSeparators&&(this.coversSeparators=t.coversSeparators),void 0!==t.bs&&(this.bs=t.bs)}oi(t){t in Wt?this.sizing=t:e.ir(this,t)}toString(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+u.as(this)}static Default=1;static None=2;static ProportionalExtra=3;Pa(t){this.Vs=t}computeEffectiveSpacingTop(t){let e=0;const i=this.Vs;if(this.index!==t){let t=this.separatorStroke;null===t&&null!==i&&(t=this.isRow?i.defaultRowSeparatorStroke:i.defaultColumnSeparatorStroke),null!==t&&(e=this.separatorStrokeWidth,isNaN(e)&&(e=null!==i?this.isRow?i.defaultRowSeparatorStrokeWidth:i.defaultColumnSeparatorStrokeWidth:0))}let n=this.Qr;if(null===n){if(null===i)return e;n=i.defaultSeparatorPadding}return e+(this.isRow?n.top:n.left)}computeEffectiveSpacing(){let t=0;const e=this.Vs;let i=0;const n=this.isRow;if(null!==e&&e.type===Yt.Table){const t=n?e.Xe.length:e.Ye.length;for(let s=0;s<t;s++){const t=n?e.Xe[s]:e.Ye[s];if(void 0!==t&&0!==t._){i=t.index;break}}}if(this.index!==i){let i=this.separatorStroke;null===i&&null!==e&&(i=n?e.defaultRowSeparatorStroke:e.defaultColumnSeparatorStroke),null!==i&&(t=this.separatorStrokeWidth,isNaN(t)&&(t=null!==e?n?e.defaultRowSeparatorStrokeWidth:e.defaultColumnSeparatorStrokeWidth:0))}let s=this.Qr;if(null===s){if(null===e)return t;s=e.defaultSeparatorPadding}return t+(this.isRow?s.top+s.bottom:s.left+s.right)}t(t,e,i,n,s){const o=this.Vs;if(null!==o&&(o.raiseChangedEvent(2,t,this,e,i,n,s),null!==this.bs)){const e=o.diagram;if(null!==e&&!e.fe){const e=o.findBindingPanel();if(null!==e){const i=e.data;if(null!==i){const n=this.bs.iterator;for(;n.next();)n.value.updateSource(this,i,t,e)}}}}}get panel(){return this.Vs}get isRow(){return this.cp}set isRow(t){this.cp=t}get index(){return this.At}set index(t){this.At=t}get height(){return this.de}set height(t){const i=this.de;i!==t&&(t<0&&e.W(t,">= 0",$t,"height"),this.de=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("height",i,t))}get width(){return this.de}set width(t){const i=this.de;i!==t&&(t<0&&e.W(t,">= 0",$t,"width"),this.de=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("width",i,t))}get minimum(){return this.Ca}set minimum(t){const i=this.Ca;i!==t&&((t<0||!isFinite(t))&&e.W(t,">= 0",$t,"minimum"),this.Ca=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("minimum",i,t))}get maximum(){return this.La}set maximum(t){const i=this.La;i!==t&&(t<0&&e.W(t,">= 0",$t,"maximum"),this.La=t,this.actual=this._,null!==this.panel&&this.panel.c(),this.t("maximum",i,t))}get alignment(){return this.hi}set alignment(t){const e=this.hi;e.equals(t)||(this.hi=t.P(),null!==this.panel&&this.panel.c(),this.t("alignment",e,t))}get stretch(){return this.$n}set stretch(t){const e=this.$n;e!==t&&(this.$n=t,null!==this.panel&&this.panel.c(),this.t("stretch",e,t))}get separatorPadding(){return this.Qr}set separatorPadding(t){"number"==typeof t&&(t=new b(t));const e=this.Qr;(null===t||null===e||!e.equals(t))&&(null!==t&&(t=t.P()),this.Qr=t,null!==this.panel&&this.panel.c(),this.t("separatorPadding",e,t))}get separatorStroke(){return this.fd}set separatorStroke(t){const e=this.fd;e!==t&&(null!==t&&Ut.Qu(t,"RowColumnDefinition.separatorStroke"),t instanceof Ut&&t.u(),this.fd=t,null!==this.panel&&this.panel.c(),this.t("separatorStroke",e,t))}get separatorStrokeWidth(){return this.ud}set separatorStrokeWidth(t){const e=this.ud;e!==t&&(this.ud=t,null!==this.panel&&this.panel.c(),this.t("separatorStrokeWidth",e,t))}get separatorDashArray(){return this.Aa}set separatorDashArray(t){const i=this.Aa;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",$t,"separatorDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];("number"!=typeof n||!(n>=0)||!isFinite(n))&&e.o("separatorDashArray value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}this.Aa=t,null!==this.panel&&this.panel.S(),this.t("separatorDashArray",i,t)}}get background(){return this.Lt}set background(t){const e=this.Lt;e!==t&&(null!==t&&Ut.Qu(t,"RowColumnDefinition.background"),t instanceof Ut&&t.u(),this.Lt=t,null!==this.panel&&this.panel.S(),this.t("background",e,t))}get coversSeparators(){return this.dd}set coversSeparators(t){const i=this.dd;i!==t&&(e.s(t,"boolean",$t,"coversSeparators"),this.dd=t,null!==this.panel&&this.panel.S(),this.t("coversSeparators",i,t))}get sizing(){return this.cd}set sizing(t){const e=this.cd;e!==t&&(this.cd=t,null!==this.panel&&this.panel.c(),this.t("sizing",e,t))}Zb(){if(1===this.sizing){const t=this.Vs;return this.isRow?t.rowSizing:t.columnSizing}return this.sizing}get actual(){return this._}set actual(t){isNaN(this.de)?this._=Math.max(Math.min(this.La,t),this.Ca):this._=Math.max(Math.min(this.La,this.de),this.Ca)}get measured(){return this.Ai}set measured(t){this.Ai=t}get total(){return this._+this.computeEffectiveSpacing()}get position(){return this.at}set position(t){this.at=t}bind(t,e,i,n){return this.sf(t,e,i,n),this}bindTwoWay(t,e,i,n){const s=this.sf(t,e,i,n);return void 0===n&&s.makeTwoWay(),this}theme(t,e,i,n,s){return this.gh(t,e,i,n,s),this}themeData(t,e,i,n,s){return this.gh(t,e,i,n,s).ofData(),this}themeObject(t,e,i,n,s,o){return this.gh(t,e,i,n,s).ofObject(o),this}themeModel(t,e,i,n,s){return this.gh(t,e,i,n,s).ofModel(),this}sf(t,e,i,n){let s;return s="string"==typeof t?new je(t,e,i,n):t,this.X0(s),s}gh(t,e,i,n,s){let o;return o="string"==typeof t?new Ve(t,e,i,n,s):t,this.X0(o),o}X0(t){t.be=this;const i=this.panel;if(null!==i){const n=i.findBindingPanel();null!==n&&n.AA()&&e.o("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+t+" on "+i)}null===this.bs&&(this.bs=new l),this.bs.add(t)}}class Jt extends At{ot;ks;gd;Ta;Hi;Uo;Oo;Ht;md;pd;G;constructor(t,e){super(),this.ot=null,this.ks=null,this.gd="None",this.Ta="black",this.Hi="black",this.Uo=1,this.Oo=null,this.Ht=null,this.md=NaN,this.pd=NaN,this.G=null,"string"==typeof t?this.figure=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.ot=this.ot,t.ks=this.ks,t.gd=this.gd,t.Ta=this.Ta,t.Hi=this.Hi,t.Uo=this.Uo,null!==this.Oo&&(t.Oo=this.Oo.slice()),null!==this.Ht&&(this.Ht.fi?t.Ht=this.Ht:t.Ht=this.Ht.copy()),t.md=this.md,t.pd=this.pd,null!==this.G&&(t.G=this.G.copy())}Da(){return null===this.Ht?this.Ht=new Zt:this.Ht.fi&&(this.Ht=this.Ht.copy()),this.Ht}ah(){super.ah(),null!==this.Ht&&(this.Ht.fi=!0)}oi(t){t in C?this.geometryStretch=t:super.oi(t)}toString(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+u.as(this)}Ev(t,i){const n=this.pathPattern;n.ht(1/0,1/0);const s=n.measuredBounds;n.Ut(0,0,s.width,s.height);const o=this.geometry;t.save(),t.beginPath();const r=e.et();if(1===o.type)r.push(o.startX),r.push(o.startY),r.push(o.endX),r.push(o.endY),this.yd(t,i,r,n);else if(4===o.type){const s=o.figures.iterator;for(;s.next();){const o=s.value;r.length=0,r.push(o.startX),r.push(o.startY);let a=o.startX,l=o.startY,h=a,u=l;const c=o.segments.r,d=c.length;for(let s=0;s<d;s++){const d=c[s];switch(d.type){case 1:this.yd(t,i,r,n),r.length=0,r.push(d.endX),r.push(d.endY),a=d.endX,l=d.endY,h=a,u=l;break;case 2:r.push(d.endX),r.push(d.endY),a=d.endX,l=d.endY;break;case 3:S.vn(a,l,d.point1X,d.point1Y,d.point2X,d.point2Y,d.endX,d.endY,.5,r),a=d.endX,l=d.endY;break;case 4:S.Og(a,l,d.point1X,d.point1Y,d.endX,d.endY,.5,r),a=d.endX,l=d.endY;break;case 5:{const t=d.xo(o),e=t.length;if(0===e){r.push(d.centerX),r.push(d.centerY),a=d.centerX,l=d.centerY;break}for(let i=0;i<e;i++){const e=t[i];S.vn(a,l,e[2],e[3],e[4],e[5],e[6],e[7],.5,r),a=e[6],l=e[7]}break}case 6:{const t=d.Bh(o,a,l),e=t.length;if(0===e){r.push(d.endX),r.push(d.endY),a=d.endX,l=d.endY;break}for(let i=0;i<e;i++){const e=t[i];S.vn(a,l,e[2],e[3],e[4],e[5],e[6],e[7],.5,r),a=e[6],l=e[7]}break}default:e.o("Segment not of valid type: "+d.type)}d.isClosed&&(r.push(h),r.push(u),this.yd(t,i,r,n))}this.yd(t,i,r,n)}}else if(2===o.type)r.push(o.startX),r.push(o.startY),r.push(o.endX),r.push(o.startY),r.push(o.endX),r.push(o.endY),r.push(o.startX),r.push(o.endY),r.push(o.startX),r.push(o.startY),this.yd(t,i,r,n);else if(3===o.type){const e=new T;e.startX=o.endX,e.startY=(o.startY+o.endY)/2;const s=new A(5);s.startAngle=0,s.sweepAngle=360,s.centerX=(o.startX+o.endX)/2,s.centerY=(o.startY+o.endY)/2,s.radiusX=Math.abs(o.startX-o.endX)/2,s.radiusY=Math.abs(o.startY-o.endY)/2,e.add(s);const a=s.xo(e),l=a.length;if(0===l)r.push(s.centerX),r.push(s.centerY);else{let t=e.startX,i=e.startY;for(let e=0;e<l;e++){const n=a[e];S.vn(t,i,n[2],n[3],n[4],n[5],n[6],n[7],.5,r),t=n[6],i=n[7]}}this.yd(t,i,r,n)}e.J(r),t.restore(),t.clearContextCache(!1)}Bv(t){let e=t.measuredBounds.width;return t instanceof Jt&&(e-=t.strokeWidth),e<1&&(e=1),e}yd(t,i,n,s){const o=n.length;if(o<4)return;const r=s.measuredBounds,a=Math.max(1,r.width),l=r.height;let h=n[0],u=n[1],c=0,d=0,f=0,g=0,p=0,m=0,y=0,x=0;const v=e.et();for(let e=2;e<o;e+=2)c=n[e],d=n[e+1],f=c-h,g=d-u,0===f&&(f=.001),p=g/f,m=Math.atan2(g,f),y=Math.sqrt(f*f+g*g),v.push([f,m,p,y]),x+=y,h=c,u=d;h=n[0],u=n[1];const b=this.Bv(s);let w=b;const k=a/2;let S=0!==k,P=0,M=v[P];f=M[0],m=M[1],p=M[2],y=M[3];let C=0;for(;x>=.1;){if(0===C&&(S?(w=b,w-=k,x-=k,S=!1):w=b,0===w&&(w=1)),w>x)return w=x,void e.J(v);w>y?(C=w-y,w=y):C=0;let n=Math.sqrt(w*w/(1+p*p));if(f<0&&(n=-n),h+=n,u+=p*n,t.translate(h,u),t.rotate(m),t.translate(-a/2,-l/2),0===C&&s.dh(t,i),t.translate(a/2,l/2),t.rotate(-m),t.translate(-h,-u),x-=w,y-=w,0!==C){if(P++,P===v.length)return void e.J(v);M=v[P],f=M[0],m=M[1],p=M[2],y=M[3],w=C}}e.J(v)}dh(t,e){const i=t instanceof Rt;let n=this.Hi;const s=this.Ta;if(null===n&&null===s)return;const o=this.ot;if(null===o)return;t.commitTransform();const r=this.actualBounds,a=this.naturalBounds;null!==s&&this.rn(t,s,!0,!1,a,r);const l=this.part;let h=this.Uo;null!==n&&0===h&&null!==l&&(this.isPanelMain||l.findMainElement()===this)&&(h=l.Uv()),0===h&&(n=null),null!==n&&0!==h&&(this.rn(t,n,!1,!1,a,r),t.lineWidth=h,t.lineJoin=this.strokeJoin,t.lineCap=this.strokeCap,t.miterLimit=this.strokeMiterLimit);let u=!1;l&&e.getRenderingHint("drawShadows")&&(u=l.isShadowed),!1===t.Jr&&(u=!1);let c=!0;null!==n&&(null===s||"transparent"===s)&&(c=!1);let d=!1;const f=this.strokeDashArray;if(null!==f&&(d=!0,t.enableDash(f,this.strokeDashOffset)),1===o.type)t.beginPath(),t.moveTo(o.startX,o.startY),t.lineTo(o.endX,o.endY),null!==n&&t.strokeContext(),t.endPath();else if(2===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,l=Math.min(e,r),h=Math.min(i,a),d=Math.abs(r-e),f=Math.abs(a-i);t.beginPath(),t.rect(l,h,d,f),null!==s&&t.fillContext(s,!1,null),null!==n&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(3===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,l=Math.abs(r-e)/2,h=Math.abs(a-i)/2,d=Math.min(e,r)+l,f=Math.min(i,a)+h;t.beginPath(),t.moveTo(d,f-h),t.bezierCurveTo(d+S.Rn*l,f-h,d+l,f-S.Rn*h,d+l,f),t.bezierCurveTo(d+l,f+S.Rn*h,d+S.Rn*l,f+h,d,f+h),t.bezierCurveTo(d-S.Rn*l,f+h,d-l,f+S.Rn*h,d-l,f),t.bezierCurveTo(d-l,f-S.Rn*h,d-S.Rn*l,f-h,d,f-h),t.closePath(),null!==s&&t.fillContext(s,!1,null),null!==n&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(4===o.type){const e=o.figures,r=e.length;for(let o=0;o<r;o++){const r=e.r[o];i?this.buildPath(t,r):null===r.Ee&&(r.Ee=new Path2D,this.buildPath(r.Ee,r));const a=r.isFilled;u?r.isShadowed?(!0===a&&"transparent"!==s&&null!==s&&t.fillContext(s,r.isEvenOdd,r.Ee),null!==n&&(a&&c&&t.shadowsOff(),t.stroke(r.Ee),a&&c&&t.shadowsOn())):(t.shadowsOff(),a&&"transparent"!==s&&null!==s&&t.fillContext(s,r.isEvenOdd,r.Ee),null!==n&&t.stroke(r.Ee),t.shadowsOn()):(a&&null!==s&&t.fillContext(s,r.isEvenOdd,r.Ee),null!==n&&t.stroke(r.Ee)),t.endPath(o)}}d&&t.disableDash(),null!==this.pathPattern&&this.Ev(t,e)}buildPath(t,e){t instanceof Path2D||t.beginPath(),t.moveTo(e.startX,e.startY);const i=e.segments.r,n=i.length;let s=null;for(let o=0;o<n;o++){const n=i[o];switch(n.type){case 1:t.moveTo(n.endX,n.endY);break;case 2:t.lineTo(n.endX,n.endY);break;case 3:t.bezierCurveTo(n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY);break;case 4:t.quadraticCurveTo(n.point1X,n.point1Y,n.endX,n.endY);break;case 5:if(n.radiusX===n.radiusY){const i=null!==s?s.endX:e.startX,o=null!==s?s.endY:e.startY,r=Math.PI/180;t.arc(n.point1X,n.point1Y,n.radiusX,n.startAngle*r,(n.startAngle+n.sweepAngle)*r,n.sweepAngle<0,i,o)}else{const i=n.xo(e),s=i.length;if(0===s){t.lineTo(n.centerX,n.centerY);break}for(let e=0;e<s;e++){const n=i[e];0===e&&t.lineTo(n[0],n[1]),t.bezierCurveTo(n[2],n[3],n[4],n[5],n[6],n[7])}}break;case 6:{let i,o=0,r=0;if(null!==s&&5===s.type){i=s.xo(e);const a=i.length;if(0===a){t.lineTo(n.endX,n.endY);break}const l=i[a-1]||null;null!==l&&(o=l[6],r=l[7])}else o=null!==s?s.endX:e.startX,r=null!==s?s.endY:e.startY;i=n.Bh(e,o,r);const a=i.length;if(0===a){t.lineTo(n.endX,n.endY);break}for(let e=0;e<a;e++){const n=i[e];t.bezierCurveTo(n[2],n[3],n[4],n[5],n[6],n[7])}break}}n.isClosed&&t.closePath(),s=n}}Zc(t,e,i){if(!super.Zc(t,e,i)||null===this.Hi&&null===this.Ta||null===this.ot||null!==this.pathPattern)return!1;const n=this.svg.getElementsByTagName("path");return this.geometry.figures.length===n.length&&(t.currentPath=this.svg,this.dh(t,e),t.currentPath=null,!0)}$u(t){return null!==this.geometry&&this.geometry.figures.length>1||null!==this.pathPattern||super.$u(t)}b2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("path");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}getDocumentPoint(t,i){if(void 0===i&&(i=new y),t instanceof w){const n=t;n.isNoSpot()&&e.o("getDocumentPoint Spot must be a real, specific Spot, not: "+n.toString());const s=this.naturalBounds,o=this.strokeWidth;return i.i(n.x*(s.width+o)-o/2+s.x+n.offsetX,n.y*(s.height+o)-o/2+s.y+n.offsetY),this.Bs.gt(i),i}return i.set(t),this.Bs.gt(i),i}getDocumentBounds(t){void 0===t&&(t=new v);const e=this.naturalBounds,i=this.Bs,n=v.V(e.x,e.y,e.width,e.height),s=this.strokeWidth;n.inflate(s/2,s/2);const o=y.V(n.x,n.y).T(i);return t.i(o.x,o.y,0,0),o.i(n.right,n.y).T(i),t.unionNoCheck(o.x,o.y,0,0),o.i(n.right,n.bottom).T(i),t.unionNoCheck(o.x,o.y,0,0),o.i(n.x,n.bottom).T(i),t.unionNoCheck(o.x,o.y,0,0),v.e(n),y.e(o),t}ch(t,i){const n=this.geometry;if(null===n||null===this.fill&&null===this.stroke)return!1;const s=n.bounds;let o=this.strokeWidth/2;1===n.type&&!i&&(o+=2);const r=v.l();if(r.a(s),r.inflate(o+2,o+2),!r.containsPoint(t))return v.e(r),!1;const a=o+1e-4;if(1===n.type){if(null===this.stroke)return!1;const e=(n.startX-n.endX)*(t.x-n.endX)+(n.startY-n.endY)*(t.y-n.endY),i=(n.endX-n.startX)*(t.x-n.startX)+(n.endY-n.startY)*(t.y-n.startY);return!(e<0||i<0)&&(v.e(r),S.vi(n.startX,n.startY,n.endX,n.endY,o,t.x,t.y))}if(2===n.type){const e=n.startX,i=n.startY,s=n.endX,l=n.endY;if(r.x=Math.min(e,s),r.y=Math.min(i,l),r.width=Math.abs(s-e),r.height=Math.abs(l-i),null===this.fill){if(r.inflate(-a,-a),r.containsPoint(t))return v.e(r),!1;r.inflate(a,a)}null!==this.stroke&&r.inflate(o,o);const h=r.containsPoint(t);return v.e(r),h}if(3===n.type){const e=n.startX,i=n.startY,s=n.endX,o=n.endY;let l=Math.min(e,s),h=Math.min(i,o);let u=Math.abs(s-e)/2,c=Math.abs(o-i)/2;if(l=t.x-(l+u),h=t.y-(h+c),null===this.fill){if(u-=a,c-=a,u<=0||c<=0)return v.e(r),!1;if(l*l/(u*u)+h*h/(c*c)<=1)return v.e(r),!1;u+=a,c+=a}return null!==this.stroke&&(u+=a,c+=a),v.e(r),!(u<=0||c<=0)&&l*l/(u*u)+h*h/(c*c)<=1}if(4===n.type)return v.e(r),null===this.fill?n.EC(t.x,t.y,o):n.jk(t,o,this.strokeWidth>1,i);e.o("Unknown Geometry type: "+n.type)}Wu(t,i,n,s){const o=this.desiredSize,r=this.Uo;let a;if(t=Math.max(t,0),i=Math.max(i,0),null!==this.ks)a=this.geometry.bounds;else{const t=this.figure;let i=Jt.j2[t];if(void 0===i){let n=S.In[t];"string"==typeof n&&(n=S.In[n]),e.it(n)?(i=n(null,100,100),Jt.j2[t]=i):e.o("Unsupported Figure: "+t)}a=i.bounds}let l=a.width,h=a.height,u=a.width,c=a.height;switch(this.zs(!0)){case 0:n=0,s=0;break;case 2:u=Math.max(t-r,0),c=Math.max(i-r,0);break;case 5:u=Math.max(t-r,0),s=0;break;case 4:n=0,c=Math.max(i-r,0)}isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height);const d=this.maxSize,f=this.minSize;n=Math.max(n-r,f.width),s=Math.max(s-r,f.height),u=Math.min(d.width,u),c=Math.min(d.height,c),u=isFinite(u)?Math.max(n,u):Math.max(l,n),c=isFinite(c)?Math.max(s,c):Math.max(h,s);const g=this.hS();switch(g){case 0:break;case 2:l=u,h=c;break;case 6:{let t=Math.min(u/l,c/h);isFinite(t)||(t=1),l*=t,h*=t;break}default:e.o(g+" is not a valid geometryStretch.")}if(null!==this.ks){0===l&&(l=.001),0===h&&(h=.001);const t=(null!==this.ks?this.ks:this.ot).aF(l,h);this.ot=t}else(null===this.ot||!S.z(this.ot.rc,t-r)||!S.z(this.ot.lc,i-r))&&(this.ot=Jt.Vv(this,l,h));a=this.ot.bounds,t===1/0||i===1/0?this.Wn(a.x-r/2,a.y-r/2,0===t&&0===l?0:a.width+r,0===i&&0===h?0:a.height+r):this.Wn(-r/2,-r/2,u+r,c+r),o.isReal()?(u=o.width,c=o.height,u=Math.min(d.width,u),c=Math.min(d.height,c),u=Math.max(f.width,u),c=Math.max(f.height,c),this.zi.i(0,0,u,c)):this.zi.a(a)}hS(){const t=this.geometryStretch;return null!==this.ks?1===t?2:t:1===t?Jt.j2[this.figure].defaultStretch:t}fh(t,e,i,n){this.commonArrange(t,e,i,n)}getNearestIntersectionPoint(t,e,i){return this.Jc(t.x,t.y,e.x,e.y,i)}Jc(t,i,n,s,o){const r=this.T,a=1/(r.m11*r.m22-r.m12*r.m21),l=r.m22*a,h=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy),g=t*l+i*u+d,p=t*h+i*c+f,m=n*l+s*u+d,x=n*h+s*c+f,b=this.Uo/2;let w=this.ot;null===w&&(this.ht(1/0,1/0),w=this.ot);const k=w.bounds;let P=!1;if(1===w.type)if(this.strokeWidth<=1.5)P=S.On(w.startX,w.startY,w.endX,w.endY,g,p,m,x,o);else{let t=0,i=0;if(w.startX===w.endX)t=b,i=0;else{const e=(w.endY-w.startY)/(w.endX-w.startX);i=b/Math.sqrt(1+e*e),t=i*e}const n=e.et();let s=new y;S.On(w.startX+t,w.startY+i,w.endX+t,w.endY+i,g,p,m,x,s)&&n.push(s),s=new y,S.On(w.startX-t,w.startY-i,w.endX-t,w.endY-i,g,p,m,x,s)&&n.push(s),s=new y,S.On(w.startX+t,w.startY+i,w.startX-t,w.startY-i,g,p,m,x,s)&&n.push(s),s=new y,S.On(w.endX+t,w.endY+i,w.endX-t,w.endY-i,g,p,m,x,s)&&n.push(s);const r=n.length;if(0===r)return e.J(n),!1;P=!0;let a=1/0;for(let e=0;e<r;e++){const t=n[e],i=(t.x-g)**2+(t.y-p)**2;i<a&&(a=i,o.x=t.x,o.y=t.y)}e.J(n)}else if(2===w.type)P=S.dl(k.x-b,k.y-b,k.x+k.width+b,k.y+k.height+b,g,p,m,x,o);else if(3===w.type){const t=v.V(k.x,k.y,k.width,k.height).inflate(b,b);P=this.zv(t,g,p,m,x,o),v.e(t)}else if(4===w.type){let r=0,a=0,l=0,h=0;const u=y.l();let c=m-g,d=x-p,f=c*c+d*d,v=g,M=p;if(f>0&&k.contains(v,M)&&(u.x=v,u.y=M,this.containsPoint(u)))for(0!==c&&Math.abs(c)<.5?(d*=.5/c,c=.5):0!==d&&Math.abs(d)<.5&&(c*=.5/d,d=.5),v-=c,M-=d;k.contains(v,M);)v-=c,M-=d;const C=.6;o.x=m,o.y=x;for(let t=0;t<w.figures.count;t++){const i=w.figures.r[t],n=i.isFilled?v:g,s=i.isFilled?M:p,c=i.segments;r=i.startX,a=i.startY;let d=r,y=a;for(let t=0;t<c.count;t++){const g=c.r[t],p=g.type;l=g.endX,h=g.endY;let v=!1;switch(p){case 1:d=l,y=h;break;case 2:v=this.e1(r,a,l,h,n,s,m,x,u);break;case 3:v=S.Ig(r,a,g.point1X,g.point1Y,g.point2X,g.point2Y,l,h,n,s,m,x,C,u);break;case 4:v=S.Ig(r,a,r+2/3*(g.point1X-r),a+2/3*(g.point1Y-a),l+2/3*(g.point1X-l),h+2/3*(g.point1Y-h),l,h,n,s,m,x,C,u);break;case 5:case 6:{const t=5===g.type?g.xo(i):g.Bh(i,r,a),e=t.length;if(0===e){v=this.e1(r,a,5===g.type?g.centerX:g.endX,5===g.type?g.centerY:g.endY,n,s,m,x,u);break}let c=null;for(let i=0;i<e;i++){if(c=t[i],0===i&&this.e1(r,a,c[0],c[1],n,s,m,x,u)){const t=this.s1(n,s,u,f,o);t<f&&(f=t,P=!0)}if(S.Ig(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],n,s,m,x,C,u)){const t=this.s1(n,s,u,f,o);t<f&&(f=t,P=!0)}}l=c[6],h=c[7];break}default:e.o("Unknown Segment type: "+p)}if(r=l,a=h,v){const t=this.s1(n,s,u,f,o);t<f&&(f=t,P=!0)}if(g.isClosed&&(l=d,h=y,this.e1(r,a,l,h,n,s,m,x,u))){const t=this.s1(n,s,u,f,o);t<f&&(f=t,P=!0)}}}let N=n-t,T=s-i;const L=Math.sqrt(N*N+T*T);0!==L&&(N/=L,T/=L),o.x-=N*b,o.y-=T*b,y.e(u)}else e.o("Unknown Geometry type: "+w.type);return!!P&&(this.T.gt(o),!0)}s1(t,e,i,n,s){const o=i.x-t,r=i.y-e,a=o*o+r*r;return a<n?(s.x=i.x,s.y=i.y,a):n}e1(t,e,i,n,s,o,r,a,l){if(S.z(t,i)&&S.z(e,n)||S.z(s,r)&&S.z(o,a))return!1;let h=!1;const u=(s-r)*(e-n)-(o-a)*(t-i);if(0===u)return!1;if(l.x=((s*a-o*r)*(t-i)-(s-r)*(t*n-e*i))/u,l.y=((s*a-o*r)*(e-n)-(o-a)*(t*n-e*i))/u,(t>i?t-i:i-t)<(e>n?e-n:n-e)){const t=e<n?e:n,i=e<n?n:e;(l.y>t||S.z(l.y,t))&&(l.y<i||S.z(l.y,i))&&(h=!0)}else{const e=t<i?t:i,n=t<i?i:t;(l.x>e||S.z(l.x,e))&&(l.x<n||S.z(l.x,n))&&(h=!0)}return h}Xv(t,e,i){return!1!==this.pickable&&(i.nc(this.T),e?this.Yv(t,i):this.containedInRect(t,i))}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);let i=this.ot;null===i&&(this.ht(1/0,1/0),i=this.ot);const n=i.bounds,s=this.strokeWidth/2;let o=!1;const r=y.l();return r.i(n.x-s,n.y-s),t.containsPoint(e.gt(r))&&(r.i(n.x-s,n.bottom+s),t.containsPoint(e.gt(r))&&(r.i(n.right+s,n.bottom+s),t.containsPoint(e.gt(r))&&(r.i(n.right+s,n.y-s),t.containsPoint(e.gt(r))&&(o=!0)))),y.e(r),o}intersectsRect(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.T,t.containsRect(this.actualBounds)))return!0;const i=k.l();i.set(e),i.ww();const n=t.left,s=t.right,o=t.top,r=t.bottom,a=y.l();if(a.i(n,o),i.gt(a),this.ch(a,!0))return y.e(a),!0;if(a.i(s,o),i.gt(a),this.ch(a,!0))return y.e(a),!0;if(a.i(n,r),i.gt(a),this.ch(a,!0))return y.e(a),!0;if(a.i(s,r),i.gt(a),this.ch(a,!0))return y.e(a),!0;const l=y.l(),h=y.l();i.set(e),i.NC(this.T),i.ww(),l.x=s,l.y=o,l.T(i),a.x=n,a.y=o,a.T(i);let u=!1;return this.Fa(a,l,h)?u=!0:(a.x=s,a.y=r,a.T(i),this.Fa(a,l,h)?u=!0:(l.x=n,l.y=r,l.T(i),this.Fa(a,l,h)?u=!0:(a.x=n,a.y=o,a.T(i),this.Fa(a,l,h)&&(u=!0)))),y.e(a),k.e(i),y.e(l),y.e(h),u}Fa(t,e,i){if(!this.getNearestIntersectionPoint(t,e,i))return!1;const n=t.x,s=t.y,o=e.x,r=e.y,a=i.x,l=i.y;if(n===o){let t=0,e=0;return s<r?(t=s,e=r):(t=r,e=s),l>=t&&l<=e}{let t=0,e=0;return n<o?(t=n,e=o):(t=o,e=n),a>=t&&a<=e}}Yv(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.T,t.containsRect(this.actualBounds)))return!0;const i=t.left,n=t.right,s=t.top,o=t.bottom,r=y.l(),a=y.l(),l=y.l(),h=k.l();h.set(e),h.NC(this.T),h.ww(),a.x=n,a.y=s,a.T(h),r.x=i,r.y=s,r.T(h);let u=!1;return this.Fa(r,a,l)?u=!0:(r.x=n,r.y=o,r.T(h),this.Fa(r,a,l)?u=!0:(a.x=i,a.y=o,a.T(h),this.Fa(r,a,l)?u=!0:(r.x=i,r.y=s,r.T(h),this.Fa(r,a,l)&&(u=!0)))),k.e(h),y.e(r),y.e(a),y.e(l),u}xA(t,i,n){if(n&&null!==this.fill&&this.ch(t,!0))return!0;let s=t.distanceSquaredPoint(i);const o=s;this.strokeWidth>1.5&&(s=this.strokeWidth/2+Math.sqrt(s),s*=s);let r=this.ot;if(null===r&&(this.ht(1/0,1/0),r=this.ot,null===r))return!1;if(!n){const e=r.bounds,i=e.x,n=e.y,o=e.x+e.width,a=e.y+e.height;if(y.distanceSquared(t.x,t.y,i,n)<=s&&y.distanceSquared(t.x,t.y,o,n)<=s&&y.distanceSquared(t.x,t.y,i,a)<=s&&y.distanceSquared(t.x,t.y,o,a)<=s)return!0}function a(t,e){const i=t.length;for(let n=0;n<i;n+=2)if(e.distanceSquared(t[n],t[n+1])>s)return!0;return!1}const l=r.startX,h=r.startY,u=r.endX,c=r.endY;if(1===r.type){const e=y.distanceLineSegmentSquared(t.x,t.y,l,h,u,c),i=(u-l)*(t.x-l)+(c-h)*(t.y-h),n=(l-u)*(t.x-u)+(h-c)*(t.y-c);return e<=(i>=0&&n>=0?s:o)}if(2===r.type){let e=!1;return n&&(e=y.distanceLineSegmentSquared(t.x,t.y,l,h,l,c)<=s||y.distanceLineSegmentSquared(t.x,t.y,l,h,u,h)<=s||y.distanceLineSegmentSquared(t.x,t.y,u,h,u,c)<=s||y.distanceLineSegmentSquared(t.x,t.y,l,c,u,c)<=s),e}if(3===r.type){const e=(l+u)/2,i=(h+c)/2,o=t.x-e,r=t.y-i,a=Math.abs(u-l)/2,d=Math.abs(c-h)/2;if(0===a||0===d)return y.distanceLineSegmentSquared(t.x,t.y,l,h,u,c)<=s;if(n){const t=S.tF(a,d,o,r);return t*t<=s}return!(y.distanceSquared(o,r,-a,0)>=s||y.distanceSquared(o,r,0,-d)>=s||y.distanceSquared(o,r,0,d)>=s||y.distanceSquared(o,r,a,0)>=s)}if(4===r.type){const i=r.bounds,o=i.x,l=i.y,h=i.x+i.width,u=i.y+i.height;if(t.x>h&&t.x<o&&t.y>u&&t.y<l&&y.distanceLineSegmentSquared(t.x,t.y,o,l,o,u)>s&&y.distanceLineSegmentSquared(t.x,t.y,o,l,h,l)>s&&y.distanceLineSegmentSquared(t.x,t.y,h,u,o,u)>s&&y.distanceLineSegmentSquared(t.x,t.y,h,u,h,l)>s)return!1;const c=Math.sqrt(s);if(!n){const i=r.figures;for(let n=0;n<i.count;n++){const o=i.r[n];let r=o.startX,l=o.startY;if(t.distanceSquared(r,l)>s)return!1;const h=o.segments.r,u=h.length;for(let i=0;i<u;i++){const n=h[i];switch(n.type){case 1:case 2:if(r=n.endX,l=n.endY,t.distanceSquared(r,l)>s)return!1;break;case 3:{const i=e.et();S.vn(r,l,n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY,.8,i);const o=a(i,t);if(e.J(i),o||(r=n.endX,l=n.endY,t.distanceSquared(r,l)>s))return!1;break}case 4:{const i=e.et();S.Og(r,l,n.point1X,n.point1Y,n.endX,n.endY,.8,i);const o=a(i,t);if(e.J(i),o||(r=n.endX,l=n.endY,t.distanceSquared(r,l)>s))return!1;break}case 5:case 6:{const i=5===n.type?n.xo(o):n.Bh(o,r,l),h=i.length;if(0===h){if(r=5===n.type?n.centerX:n.endX,l=5===n.type?n.centerY:n.endY,t.distanceSquared(r,l)>s)return!1;break}let u=null;const c=e.et();for(let n=0;n<h;n++)if(u=i[n],c.length=0,S.vn(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],.8,c),a(c,t))return e.J(c),!1;e.J(c),null!==u&&(r=u[6],l=u[7]);break}default:e.o("Unknown Segment type: "+n.type)}}}return!0}if(null===this.fill?r.EC(t.x,t.y,c):r.jk(t,c,!0,!1))return!0}return!1}zv(t,e,i,n,s,o){if(0===t.width)return S.On(t.x,t.y,t.x,t.y+t.height,e,i,n,s,o);if(0===t.height)return S.On(t.x,t.y,t.x+t.width,t.y,e,i,n,s,o);{const r=t.width/2,a=t.height/2,l=t.x+r,h=t.y+a;let u=9999;if(e!==n&&(u=(i-s)/(e-n)),Math.abs(u)<9999){const t=i-h-u*(e-l);if(r*r*(u*u)+a*a-t*t<0)return o.x=NaN,o.y=NaN,!1;const n=Math.sqrt(r*r*(u*u)+a*a-t*t),s=(-r*r*u*t+r*a*n)/(a*a+r*r*(u*u))+l,c=(-r*r*u*t-r*a*n)/(a*a+r*r*(u*u))+l,d=u*(s-l)+t+h,f=u*(c-l)+t+h;Math.abs((e-s)**2)+Math.abs((i-d)**2)<Math.abs((e-c)**2)+Math.abs((i-f)**2)?(o.x=s,o.y=d):(o.x=c,o.y=f)}else{const t=a*a,n=e-l,s=t-t/(r*r)*(n*n);if(s<0)return o.x=NaN,o.y=NaN,!1;const u=Math.sqrt(s),c=h+u,d=h-u;Math.abs(c-i)<Math.abs(d-i)?(o.x=e,o.y=c):(o.x=e,o.y=d)}return!0}}Fv(){return this.Uo/2*this.strokeMiterLimit*this.getDocumentScale()}get geometry(){return null!==this.ot?this.ot:this.ks}set geometry(t){const e=this.ot,i=this.ks;if(e===t)return;null!==t?(this.ot=t.u(),this.ks=this.ot):(this.ot=null,this.ks=null);const n=this.part;if(null!==n&&n.cf(),this.c(),this.t("geometry",e||i,t),this.Wc()){const t=this.part;null!==t&&this.ba(t,"geometryString")}}get geometryString(){return null===this.geometry?"":this.geometry.toString()}set geometryString(t){const e=N.parse(t),i=e.normalize();this.geometry=e;const n=y.V(-i.x,-i.y);this.position=n,y.e(n)}get isGeometryPositioned(){return 0!==(1048576&this.n)}set isGeometryPositioned(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.c(),this.t("isGeometryPositioned",e,t))}ee(){this.ot=null}get fill(){return this.Ta}set fill(t){const e=this.Ta;e!==t&&(null!==t&&Ut.Qu(t,"Shape.fill"),t instanceof Ut&&t.u(),this.Ta=t,this.S(),this.t("fill",e,t))}get stroke(){return this.Hi}set stroke(t){const e=this.Hi;e!==t&&(null!==t&&Ut.Qu(t,"Shape.stroke"),t instanceof Ut&&t.u(),this.Hi=t,this.S(),this.t("stroke",e,t))}get strokeWidth(){return this.Uo}set strokeWidth(t){const i=this.Uo;if(i!==t)if(t>=0){this.Uo=t,this.c();const e=this.part;null!==e&&e.cf(),this.t("strokeWidth",i,t)}else e.W(t,"value >= 0",Jt,"strokeWidth:value")}p0(){return this.Uo}get strokeCap(){return null!==this.Ht?this.Ht.fp:"butt"}set strokeCap(t){const i=this.strokeCap;i!==t&&("string"!=typeof t||"butt"!==t&&"round"!==t&&"square"!==t?e.W(t,'"butt", "round", or "square"',Jt,"strokeCap"):(this.Da().fp=t,this.S(),this.t("strokeCap",i,t)))}get strokeJoin(){return null!==this.Ht?this.Ht.dp:"miter"}set strokeJoin(t){const i=this.strokeJoin;i!==t&&("string"!=typeof t||"miter"!==t&&"bevel"!==t&&"round"!==t?e.W(t,'"miter", "bevel", or "round"',Jt,"strokeJoin"):(this.Da().dp=t,this.S(),this.t("strokeJoin",i,t)))}get strokeMiterLimit(){return null!==this.Ht?this.Ht.gp:10}set strokeMiterLimit(t){const e=this.strokeMiterLimit;if(e!==t&&t>=1){this.Da().gp=t,this.S();const i=this.part;null!==i&&i.cf(),this.t("strokeMiterLimit",e,t)}}get strokeDashArray(){return this.Oo}set strokeDashArray(t){const i=this.Oo;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Jt,"strokeDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];(!(n>=0)||!isFinite(n))&&e.o("strokeDashArray:value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}this.Oo=t,this.S(),this.t("strokeDashArray",i,t)}}get strokeDashOffset(){return null!==this.Ht?this.Ht.mh:0}set strokeDashOffset(t){const e=this.strokeDashOffset;e!==t&&t>=0&&(this.Da().mh=t,this.S(),this.t("strokeDashOffset",e,t))}get figure(){return this.gd}set figure(t){const i=this.gd;if(i!==t){let n=S.In[t];if(e.it(n)?n=t:(n=S.In[t.toLowerCase()],n||e.o("Unknown Shape.figure: "+t)),i!==n){const t=this.part;null!==t&&t.cf(),this.gd=n,this.ks=null,this.ee(),this.c(),this.t("figure",i,n)}}}get toArrow(){return null!==this.Ot?this.Ot.mp:"None"}set toArrow(t){const i=this.toArrow;if(!0===t?t="Standard":!1===t&&(t=""),i!==t){const n=Jt.qA(t);null===n?e.o("Unknown Shape.toArrow: "+t):i!==n&&(null===this.Ot&&(this.Ot=new Ce),this.Ot.mp=n,this.ks=null,this.ee(),this.c(),this.WA(n),this.t("toArrow",i,n))}}get fromArrow(){return null!==this.Ot?this.Ot.pp:"None"}set fromArrow(t){const i=this.fromArrow;if(!0===t?t="Standard":!1===t&&(t=""),i!==t){const n=Jt.qA(t);null===n?e.o("Unknown Shape.fromArrow: "+t):i!==n&&(null===this.Ot&&(this.Ot=new Ce),this.Ot.pp=n,this.ks=null,this.ee(),this.c(),this.WA(n),this.t("fromArrow",i,n))}}WA(t){const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;this.tv();const i=w.MiddleRight;"None"!==this.toArrow?(this.segmentIndex=-1,this.alignmentFocus=i):"None"!==this.fromArrow&&(this.segmentIndex=0,this.alignmentFocus=new w(1-i.x,i.y))}get spot1(){return null!==this.Ht?this.Ht.En:w.Default}set spot1(t){const e=this.spot1;e.equals(t)||(t=t.P(),this.Da().En=t,this.c(),this.t("spot1",e,t))}get spot2(){return null!==this.Ht?this.Ht.Bn:w.Default}set spot2(t){const e=this.spot2;e.equals(t)||(t=t.P(),this.Da().Bn=t,this.c(),this.t("spot2",e,t))}get parameter1(){return this.md}set parameter1(t){const e=this.md;e!==t&&(this.md=t,this.ee(),this.c(),this.t("parameter1",e,t))}get parameter2(){return this.pd}set parameter2(t){const e=this.pd;e!==t&&(this.pd=t,this.ee(),this.c(),this.t("parameter2",e,t))}get naturalBounds(){return this.zi}bv(){const t=this.desiredSize;if(t.isReal()||null===this.ot)this.zi.i(0,0,t.width,t.height);else{const t=this.ot.bounds;this.zi.a(t)}}get pathPattern(){return null!==this.Ht?this.Ht.yp:null}set pathPattern(t){const e=this.pathPattern;e!==t&&(this.Da().yp=t,this.S(),this.t("pathPattern",e,t))}get geometryStretch(){return null!==this.Ht?this.Ht.wp:1}set geometryStretch(t){const e=this.geometryStretch;e!==t&&(this.Da().wp=t,this.c(),this.t("geometryStretch",e,t))}get interval(){return null!==this.G?this.G.uf:1}set interval(t){const e=this.interval;if(e!==(t=Math.round(t))&&0!==t&&isFinite(t)){null===this.G&&(this.G=new se),this.G.uf=t;const i=this.diagram;null!==i&&this.panel===i.grid&&i._l(),this.c();const n=this.panel;null!==n&&(n.ss=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.G?this.G.df:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new se),this.G.df=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.G?this.G.gf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new se),this.G.gf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedSkip(){return null!==this.G?this.G.mf:null}set graduatedSkip(t){const i=this.graduatedSkip;i!==t&&(null!==t&&e.k(t,Jt,"graduatedSkip"),null===this.G&&(this.G=new se),this.G.mf=t,this.c(),this.t("graduatedSkip",i,t))}static Vv(t,i,n){let s=null;if("None"!==t.toArrow)s=Jt.gn[t.toArrow];else if("None"!==t.fromArrow)s=Jt.gn[t.fromArrow];else{let o=S.In[t.figure];"string"==typeof o&&(o=S.In[o]),void 0===o&&e.o("Unknown Shape.figure: "+t.figure),s=o(t,i,n),s.rc=i,s.lc=n}if(null===s){const o=S.In.Rectangle;e.it(o)&&(s=o(t,i,n))}return s}static getFigureGenerators(){const t=new m;for(const e in S.In){if(e===e.toLowerCase())continue;const i=S.In[e];t.set(e,i)}return t.u(),t}static defineFigureGenerator(t,i){e.s(t,"string",Jt,"defineFigureGenerator:name"),"string"==typeof i||e.k(i,Jt,"defineFigureGenerator:func");const n=t.toLowerCase(),s=S.In;s[t]=i,s[n]=t}static isFigureDefined(t){return S.In.has(t)}static getArrowheadGeometries(){const t=new m;for(const e in S.Ug)if(void 0===Jt.gn[e]){const t=N.parse(S.Ug[e],!1);Jt.gn[e]=t;const i=e.toLowerCase();i!==e&&(Jt.gn[i]=e)}for(const e in Jt.gn){if(e===e.toLowerCase())continue;const i=Jt.gn[e];i instanceof N&&t.set(e,i)}return t.u(),t}static defineArrowheadGeometry(t,i){e.s(t,"string",Jt,"defineArrowheadGeometry:name");let n=null;"string"==typeof i?(e.s(i,"string",Jt,"defineArrowheadGeometry:pathstr"),n=N.parse(i,!1)):n=i;const s=t.toLowerCase();("none"===s||t===s)&&e.o("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+t);const o=Jt.gn;o[t]=n,o[s]=t}static isArrowheadDefined(t){return Jt.gn.has(t)}static gn=(()=>new n)();static j2=(()=>new n)();static qA(t){let e=Jt.gn[t];if(void 0===e){const i=t.toLowerCase();if("none"===i)return"None";if(e=Jt.gn[i],void 0===e){let t=null;for(const e in S.Ug)if(e.toLowerCase()===i){t=e;break}if(null!==t){const e=N.parse(S.Ug[t],!1);return Jt.gn[t]=e,i!==t&&(Jt.gn[i]=t),t}}}return"string"==typeof e?e:e instanceof N?t:null}}class Zt{fi;fp;dp;gp;mh;yp;wp;En;Bn;constructor(){this.fi=!1,this.fp="butt",this.dp="miter",this.gp=10,this.mh=0,this.yp=null,this.wp=1,this.En=w.Default,this.Bn=w.Default}copy(){const t=new Zt;return t.fp=this.fp,t.dp=this.dp,t.gp=this.gp,t.mh=this.mh,t.yp=this.yp,t.wp=this.wp,t.En=this.En.P(),t.Bn=this.Bn.P(),t}}var Qt=(t=>(t[t.None=0]="None",t[t.Fit=1]="Fit",t[t.DesiredSize=2]="DesiredSize",t[t.BreakAll=3]="BreakAll",t))(Qt||{}),te=(t=>(t[t.Clip=0]="Clip",t[t.Ellipsis=1]="Ellipsis",t))(te||{}),ee=(t=>(t[t.Trim=0]="Trim",t[t.None=1]="None",t))(ee||{});class ie extends At{ri;Hi;mn;ge;ui;y0;wd;G;rt;Tl;to;pn;Ce;Ti;yn;constructor(t,e){return super(),this.n|=2097152,this.ri="",this.Hi="black",this.mn="13px sans-serif",this.ge=0,this.ui=0,this.y0=0,this.wd=null,this.G=null,this.rt=null,this.Tl=0,this.to=null,this.pn=0,this.Ce=null,this.Ti=null,this.yn=null,"string"==typeof t?this.text=t:t&&Object.assign(this,t),e&&Object.assign(this,e),this}cloneProtected(t){super.cloneProtected(t),t.ri=this.ri,t.Hi=this.Hi,t.mn=this.mn,t.ge=this.ge,t.ui=this.ui,t.y0=this.y0,t.wd=this.wd,null!==this.G&&(t.G=this.G.copy()),null!==this.rt&&(this.rt.fi?t.rt=this.rt:t.rt=this.rt.copy()),t.Tl=this.Tl,t.to=this.to,t.pn=this.pn,t.Ce=this.Ce,t.Ti=this.Ti,t.yn=this.yn}wn(){return null===this.rt?this.rt=new ne:this.rt.fi&&(this.rt=this.rt.copy()),this.rt}ah(){super.ah(),null!==this.rt&&(this.rt.fi=!0)}Lv(t){this.n=6144|t.n,this.$t=t.opacity,this.Lt=t.background,this.is=t.desiredSize.P(),this.minSize=t.minSize.P(),this.maxSize=t.maxSize.P(),null!==t.wi?this.wi=t.wi.copy():this.wi=null,this.tt=t.scale,this.Yt=t.angle,this.stretch=t.stretch,this.jr=t.margin.P(),this.hi=t.alignment.P(),this.Hu=t.alignmentFocus.P(),this.segmentFraction=t.segmentFraction,this.segmentOffset=t.segmentOffset.P(),this.segmentOrientation=t.segmentOrientation,null!==t.si&&(this.si=t.si.copy()),this.shadowVisible=t.shadowVisible,this.ri=t.ri,this.Hi=t.Hi,this.mn=t.mn,null!==this.G&&(this.G=t.G.copy()),null!==t.rt&&(t.rt.fi?this.rt=t.rt:this.rt=t.rt.copy()),this.Tl=t.Tl}Nv(t){if(this.ri=t.text||"",this.Yt=t.labelAngle||0,this.ge=t.lineCount||0,this.Kv(t.lines),t.naturalBounds&&(this.zi=t.naturalBounds),t.actualBounds){const e=t.actualBounds;this.Ut(e.x,e.y,e.width,e.height)}}oi(t){t in Qt?this.wrap=t:super.oi(t)}toString(){return this.ri.length>22?'TextBlock("'+this.ri.substring(0,20)+'"...)':'TextBlock("'+this.ri+'")'}static getEllipsis(){return ie.xp}static setEllipsis(t){ie.xp=t,ie.o1=new n,ie.q2=0}static getBaseline(){return ie.l1}static setBaseline(t){ie.l1=t}static l1=null;static getUnderline(){return ie.h1}static setUnderline(t){ie.h1=t}static h1=null;static None=0;static WrapFit=1;static WrapDesiredSize=2;static WrapBreakAll=3;static OverflowClip=0;static OverflowEllipsis=1;static FormatTrim=0;static FormatNone=1;c(){super.c(),this.Ve(!0)}get font(){return this.mn}set font(t){const e=this.mn;e!==t&&(this.mn=t,this.to=null,this.c(),this.t("font",e,t))}static isValidFont(e){return!t.CSS||t.CSS.supports("font",e)}get text(){return this.ri}set text(t){const e=this.ri;e!==(t=null!=t?t.toString():"")&&(this.ri=t,this.c(),this.t("text",e,t))}get textAlign(){return null!==this.rt?this.rt.bp:"start"}set textAlign(t){const e=this.textAlign;e!==t&&("start"===t||"end"===t||"left"===t||"right"===t||"center"===t)&&(this.wn().bp=t,this.S(),this.t("textAlign",e,t))}get flip(){return null!==this.rt?this.rt.io:0}set flip(t){const e=this.flip;e!==t&&(this.wn().io=t,this.S(),this.t("flip",e,t))}get verticalAlignment(){return null!==this.rt?this.rt._r:w.Top}set verticalAlignment(t){const e=this.verticalAlignment;e.equals(t)||(t=t.P(),this.wn()._r=t,this.ef(),this.t("verticalAlignment",e,t))}get naturalBounds(){if(!this.zi.isReal()){const t=x.l();this.W2(this.ri,999999,t);let e=t.width;x.e(t);let i=this.JA(e);const n=this.desiredSize;isNaN(n.width)||(e=n.width),isNaN(n.height)||(i=n.height),this.zi.Fn(e,i)}return this.zi}get isMultiline(){return 0!==(2097152&this.n)}set isMultiline(t){const e=0!==(2097152&this.n);e!==t&&(this.n=2097152^this.n,this.c(),this.t("isMultiline",e,t))}get isUnderline(){return 0!==(4194304&this.n)}set isUnderline(t){const e=0!==(4194304&this.n);e!==t&&(this.n=4194304^this.n,this.Ve(!0),this.S(),this.t("isUnderline",e,t))}get isStrikethrough(){return 0!==(8388608&this.n)}set isStrikethrough(t){const e=0!==(8388608&this.n);e!==t&&(this.n=8388608^this.n,this.Ve(!0),this.S(),this.t("isStrikethrough",e,t))}get wrap(){return null!==this.rt?this.rt.kp:2}set wrap(t){const e=this.wrap;e!==t&&(this.wn().kp=t,this.c(),this.t("wrap",e,t))}get overflow(){return null!==this.rt?this.rt.Pp:0}set overflow(t){const e=this.overflow;e!==t&&(this.wn().Pp=t,this.c(),this.t("overflow",e,t))}get isOverflowed(){return 0!==(16777216&this.n)}J2(t){t?this.n|=16777216:this.n&=-16777217}get stroke(){return this.Hi}set stroke(t){const e=this.Hi;e!==t&&(null!==t&&Ut.Qu(t,"TextBlock.stroke"),t instanceof Ut&&t.u(),this.Hi=t,"string"!=typeof t&&this.Qc(),this.S(),this.t("stroke",e,t))}get lineCount(){return this.ge}get lineHeight(){return this.Sp()}get editable(){return 0!==(1048576&this.n)}set editable(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.t("editable",e,t))}get U2(){return 0!==(33554432&this.n)}set U2(t){this.n=33554432^this.n}get textEditor(){return null!==this.rt?this.rt.Mp:null}set textEditor(t){const e=this.textEditor;e!==t&&(this.wn().Mp=t,this.t("textEditor",e,t))}get errorFunction(){return null!==this.rt?this.rt.ns:null}set errorFunction(t){const i=this.errorFunction;i!==t&&(null!==t&&e.k(t,ie,"errorFunction"),this.wn().ns=t,this.t("errorFunction",i,t))}get interval(){return null!==this.G?this.G.uf:1}set interval(t){const e=this.interval;if(e!==(t=Math.round(t))&&0!==t&&isFinite(t)){null===this.G&&(this.G=new se),this.G.uf=t,this.c();const i=this.panel;null!==i&&(i.ss=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.G?this.G.df:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new se),this.G.df=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.G?this.G.gf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.G&&(this.G=new se),this.G.gf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedFunction(){return null!==this.G?this.G.Np:null}set graduatedFunction(t){const i=this.graduatedFunction;i!==t&&(null!==t&&e.k(t,ie,"graduatedFunction"),null===this.G&&(this.G=new se),this.G.Np=t,this.c(),this.t("graduatedFunction",i,t))}get graduatedSkip(){return null!==this.G?this.G.mf:null}set graduatedSkip(t){const i=this.graduatedSkip;i!==t&&(null!==t&&e.k(t,ie,"graduatedSkip"),null===this.G&&(this.G=new se),this.G.mf=t,this.c(),this.t("graduatedSkip",i,t))}dh(t,e){if(null===this.Hi||0===this.ri.length||null===this.mn)return;const i=this.naturalBounds,n=this.actualBounds,s=i.width,o=i.height,r=this.Sp();let a=t.textAlign=this.textAlign;const l=e.zu;"start"===a?a=l?"right":"left":"end"===a&&(a=l?"left":"right");const h=this.isUnderline,u=this.isStrikethrough;this.rn(t,this.Hi,!0,!1,i,n),(h||u)&&this.rn(t,this.Hi,!1,!1,i,n);let c=0;const d=s;let f=!1;e.Qt===t&&!(e.Qt instanceof Rt)&&!this.U2&&!0===e.getRenderingHint("textGreeking")&&r*this.da*e.scale<3&&(f=!0);const g=this.spacingAbove,p=this.spacingBelow;switch(this.flip){case 0:break;case 2:t.translate(s,0),t.scale(-1,1);break;case 1:t.translate(0,o),t.scale(1,-1);break;case 3:t.translate(s,o),t.scale(-1,-1)}t.commitTransform();const m=this.ge,y=(g+r+p)*m;if(o>y){const t=this.verticalAlignment;c=t.y*o-t.y*y+t.offsetY}if(1===m&&null!==this.yn){let e=this.ui;e>d&&(e=d),c+=g,this.$A(this.yn,t,0,c,d,r,e,f,a,h,u)}else if(null!==this.Ce&&null!==this.Ti)for(let x=0;x<m;x++){let e=this.Ce[x];e>d&&(e=d),c+=g,this.$A(this.Ti[x],t,0,c,d,r,e,f,a,h,u),c+=r+p}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-s,0);break;case 1:t.scale(1,-1),t.translate(0,-o);break;case 3:t.scale(-1,-1),t.translate(-s,-o)}}$A(t,e,i,n,s,o,r,a,l,h,u){let c=0;if(a){"left"===l?c=0:"right"===l?c=s-r:"center"===l&&(c=(s-r)/2);const t=e.globalAlpha;return e.globalAlpha=t/2,e.fillRect(i+c,n+o/4,r,o/2),void(e.globalAlpha=t)}"left"===l?c=0:"right"===l?c=s:"center"===l&&(c=s/2);const d=null!==ie.l1?ie.l1(this,o):.75*o;e.fillText(t,i+c,n+d);let f=o/20|0;if(0===f&&(f=1),"right"===l?c-=r:"center"===l&&(c-=r/2),h){const t=null!==ie.h1?ie.h1(this,o):.8*o;this.ZA(i+c,n+t,i+c+r,n+t,f,e),e instanceof Rt&&e.lastCreatedElement.classList.add("gojs-td")}if(u){let t=n+o-o/2.2|0;f%2!==0&&(t+=.5),this.ZA(i+c,t,i+c+r,t,f,e),e instanceof Rt&&e.lastCreatedElement.classList.add("gojs-td")}}ZA(t,e,i,n,s,o){o.beginPath(),o.lineWidth=s,o.moveTo(t,e),o.lineTo(i,n),o.stroke(),o.endPath()}Zc(t,e,i){if(!super.Zc(t,e,i))return!1;if(this.rn(t,this.Hi,!0,!1,this.naturalBounds,this.actualBounds),i){if(0===this.svg.getElementsByTagName("text").length)return!0;const e=this.svg.getElementsByClassName("gojs-td");for(let i=0;i<e.length;i++)t.setFillOrStrokeInPlace(e[i],!1)}else this.Gv(this.svg,this.text,t);return!0}Gv(t,e,i){t.innerHTML=e,i.setFillOrStrokeInPlace(t,!0)}$u(t){return!!(this.lineCount>1||this.isUnderline||this.isStrikethrough)||super.$u(t)}b2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("text");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}Hv(){this.pn=0,this.ui=0,this.to=null,this.Ce=null,this.Ti=null,this.yn=null}Wu(t,e,i,n){const s=this.ge;this.Tl=t,this.J2(!1);const o=this.mn;null!==ie.$r&&ie.QA!==o&&(ie.$r.font=o,ie.QA=o),this.Hv();let r=0,a=0;isNaN(this.desiredSize.width)?(r=this.jv(),r=Math.min(r,t/this.scale)):r=this.desiredSize.width,null!==this.panel&&(r=Math.min(r,this.panel.maxSize.width)),a=this.JA(r),a=isNaN(this.desiredSize.height)?Math.min(a,e/this.scale):this.desiredSize.height,this.qv(t,a),(1===this.wrap||isNaN(this.desiredSize.width))&&(r=isNaN(t)?this.ui:Math.min(t,this.ui)),r=Math.max(i,r),a=Math.max(n,a),this.zi.Fn(r,a),this.Wn(0,0,r,a),null!==this.svg&&s!==this.ge&&this.Ve(!0)}fh(t,e,i,n){this.commonArrange(t,e,i,n)}xn(t,e){null===this.yn?(this.yn=t,this.ui=e):((null===this.Ti||null===this.Ce)&&(this.Ti=[],this.Ce=[],this.Ti.push(this.yn),this.Ce.push(this.ui)),this.Ti.push(t),this.Ce.push(e),this.Ti.length>this.maxLines&&(this.n|=16777216))}W2(t,e,i){const n=0===this.formatting;n&&(t=t.trim());let s=0,o=0,r=0;const a=this.mn,l=this.spacingAbove+this.spacingBelow,h=Math.max(0,this.Sp()+l),u=1===this.overflow?this._A(a):0;if(this.ge>=this.maxLines)return void(null!==i&&i.i(0,h));let c=t;if(0===this.wrap){if(this.pn=1,o=this.getStringWidth(t),0===u||o<=e)return this.ui=Math.max(this.ui,o),this.xn(t,this.ui),void(null!==i&&i.i(o,h));let s=this.xd(c);c=c.substring(s.length);let a=this.xd(c);for(o=this.getStringWidth(s+a),r=0;a.length>0&&o<=e;){s+=a,c=c.substring(a.length),a=this.xd(c),r=o;let t=s+a;n&&(t=t.trim()),o=this.getStringWidth(t)}for(n&&(a=a.trim()),s+=a,e=Math.max(1,e-u);this.getStringWidth(s)>e&&s.length>1;)s=s.substring(0,s.length-1);return this.J2(!0),s+=ie.xp,r=this.getStringWidth(s),this.ui=r,this.xn(s,r),void(null!==i&&i.i(r,h))}let d=0;for(0===c.length&&(d=1,this.xn(c,0));c.length>0;){let t=this.xd(c);for(c=c.substring(t.length);this.getStringWidth(t)>e;){let i=1;for(o=this.getStringWidth(t.substring(0,i)),r=0;o<=e;)i++,r=o,o=this.getStringWidth(t.substring(0,i));let n=0;1===i?(n=o,s=Math.max(s,o)):(n=r,s=Math.max(s,r)),i--,i<1&&(i=1);const a=t.substring(0,i);if(this.xn(a,n),d++,t=t.substring(i),this.ge+d>this.maxLines)break}let i=this.xd(c);for(o=this.getStringWidth(t+i),r=0;i.length>0&&o<=e;){t+=i,c=c.substring(i.length),i=this.xd(c),r=o;let e=t+i;n&&(e=e.trim()),o=this.getStringWidth(e)}if(n&&(t=t.trim()),""===t)continue;"\xad"===t[t.length-1]&&(t=t.substring(0,t.length-1)+"\u2010");let a=0;if(0===i.length?(a=o,s=Math.max(s,o)):(r=this.getStringWidth(t),a=r,s=Math.max(s,r)),this.xn(t,a),d++,this.ge+d>this.maxLines)break}this.pn=Math.min(this.maxLines-this.ge,d),this.ui=Math.max(this.ui,s),null!==i&&i.i(this.ui,h*this.pn)}qv(t,e){if(0===this.ui||null===this.Ce||null===this.Ti||1!==this.overflow)return;const i=this.mn,n=1===this.overflow?this._A(i):0,s=this.spacingAbove+this.spacingBelow,o=Math.max(0,this.Sp()+s),r=Math.min(this.maxLines-1,Math.max(Math.floor(e/o+.01)-1,0));if(r+1>=this.Ti.length)return;this.J2(!0);let a=this.Ti[r];const l=Math.max(1,t-n);for(;this.getStringWidth(a)>l&&a.length>1;)a=a.substring(0,a.length-1);a+=ie.xp;const h=this.getStringWidth(a);this.Ti[r]=a,this.Ti=this.Ti.slice(0,r+1),this.Ce[r]=h,this.Ce=this.Ce.slice(0,r+1),this.pn=this.Ti.length,this.ui=Math.max(this.ui,h),this.ge=this.pn,1===this.ge&&(this.yn=this.Ti[0])}xd(t){if(3===this.wrap)return t.substring(0,1);let e=t.length,i=0;const n=ie.Wv;for(;i<e&&!n.test(t.charAt(i));)i++;for(1===this.formatting&&(e=Math.min(e,i+1));i<e&&n.test(t.charAt(i));)i++;return i>=t.length?t:t.substring(0,i)}getStringWidth(t){return null===ie.$r?8*t.length:ie.$r.measureText(t).width}Sp(){if(null!==this.to)return this.to;const t=this.mn;let e=0;return null===ie.$r?(e=16,this.to=e,e):(void 0!==ie.$2[t]&&ie.tT<5e3?e=ie.$2[t]:(e=1.3*ie.$r.measureText("M").width,ie.$2[t]=e,ie.tT++),this.to=e,e)}_A(t){if(null===ie.$r)return 6;let e=0;return void 0!==ie.o1[t]&&ie.q2<5e3?e=ie.o1[t]:(e=ie.$r.measureText(ie.xp).width,ie.o1[t]=e,ie.q2++),e}a1(t,e){return t.indexOf("\n",e)}JA(t){let e=this.ri.replace(/\r\n/g,"\n").replace(/\r/g,"\n");const i=this.spacingAbove+this.spacingBelow,n=Math.max(0,this.Sp()+i);if(0===e.length)return this.ui=0,this.ge=1,n;if(!this.isMultiline){const t=this.a1(e,0);t>=0&&(e=e.substring(0,t))}let s=0;this.ge=0;let o=0,r=-1,a=!1;for(;!a;){if(r=this.a1(e,o),-1===r&&(r=e.length,a=!0),o<=r){const i=e.substring(o,r);if(0!==this.wrap){this.pn=0;const e=x.l();this.W2(i,t,e),s+=e.height,x.e(e),this.ge+=this.pn}else this.W2(i,t,null),s+=n,this.ge++;this.ge===this.maxLines&&(a=!0)}o=r+1}return this.y0=s,s}jv(){let t=this.ri.replace(/\r\n/g,"\n").replace(/\r/g,"\n");if(0===t.length)return 8;if(this.isMultiline){let e=0,i=0,n=!1;for(;!n;){let s=this.a1(t,i);-1===s&&(s=t.length,n=!0);let o=t.substring(i,s);0===this.formatting&&(o=o.trim()),e=Math.max(e,this.getStringWidth(o)),i=s+1}return e}{const e=this.a1(t,0);return e>=0&&(t=t.substring(0,e)),this.getStringWidth(t)}}get textValidation(){return null!==this.rt?this.rt.Al:null}set textValidation(t){const i=this.textValidation;i!==t&&(null!==t&&e.k(t,ie,"textValidation"),this.wn().Al=t,this.t("textValidation",i,t))}get textEdited(){return null!==this.rt?this.rt.Cp:null}set textEdited(t){const i=this.textEdited;i!==t&&(null!==t&&e.k(t,ie,"textEdited"),this.wn().Cp=t,this.t("textEdited",i,t))}get spacingAbove(){return null!==this.rt?this.rt.Lp:0}set spacingAbove(t){const e=this.spacingAbove;e!==t&&(this.wn().Lp=t,this.c(),this.t("spacingAbove",e,t))}get spacingBelow(){return null!==this.rt?this.rt.Ap:0}set spacingBelow(t){const e=this.spacingBelow;e!==t&&(this.wn().Ap=t,this.c(),this.t("spacingBelow",e,t))}get formatting(){return null!==this.rt?this.rt.Tp:0}set formatting(t){const e=this.formatting;e!==t&&(this.wn().Tp=t,this.c(),this.t("formatting",e,t))}get maxLines(){return null!==this.rt?this.rt.Dp:1/0}set maxLines(t){const i=this.maxLines;i!==t&&((t=Math.floor(t))<=0&&e.W(t,"> 0",ie,"maxLines"),this.wn().Dp=t,this.c(),this.t("maxLines",i,t))}getMetrics(){return[this.ui,this.Tl,this.to,this.pn,this.Ce,this.Ti,this.yn]}Kv(t){void 0!==t&&(this.ui=t[0],this.Tl=t[1],this.to=t[2],this.pn=t[3],this.Ce=t[4],this.Ti=t[5],this.yn=t[6])}get metrics(){return{arrSize:null!==this.Ce?this.Ce:[this.ui],arrText:null!==this.Ti?this.Ti:[this.yn],maxLineWidth:this.ui,fontHeight:this.to}}get choices(){return this.wd}set choices(t){const e=this.wd;e!==t&&(this.wd=t,this.t("choices",e,t))}static Wv=(()=>new RegExp("[ \u200b\xad]"))();static $2=(()=>new n)();static tT=0;static o1=(()=>new n)();static q2=0;static xp="...";static QA="";static $r=(()=>vt.isUsingDOM()?new Bt(null).li:null)()}class ne{fi;ns;io;Tp;Dp;Pp;Lp;Ap;bp;Cp;Mp;Al;_r;kp;constructor(){this.fi=!1,this.ns=null,this.io=0,this.Tp=0,this.Dp=1/0,this.Pp=0,this.Lp=0,this.Ap=0,this.bp="start",this.Cp=null,this.Mp=null,this.Al=null,this._r=w.Top,this.kp=2}copy(){const t=new ne;return t.ns=this.ns,t.io=this.io,t.Tp=this.Tp,t.Dp=this.Dp,t.Pp=this.Pp,t.Lp=this.Lp,t.Ap=this.Ap,t.bp=this.bp,t.Cp=this.Cp,t.Mp=this.Mp,t.Al=this.Al,t._r=this._r,t.kp=this.kp,t}}class se{uf;df;gf;Np;mf;constructor(){this.uf=1,this.df=0,this.gf=1,this.Np=null,this.mf=null}copy(){const t=new se;return t.uf=this.uf,t.df=this.df,t.gf=this.gf,t.Np=this.Np,t.mf=this.mf,t}}var oe=(t=>(t[t.None=0]="None",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(oe||{});class re extends At{tl;dt;il;pf;ns;el;yf;io;wf;xf;Xb;constructor(t,e){super(),this.n|=2097152,this.tl=null,this.dt="",this.il=v.JD,this.pf=2,this.ns=null,this.el=null,this.yf=w.Center,this.io=0,this.wf=null,this.xf=null,this.Xb=null,"string"==typeof t?this.source=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.dt=this.dt,t.element=this.tl,t.il=this.il.P(),t.pf=this.pf,t.io=this.io,t.ns=this.ns,t.el=this.el,t.yf=this.yf.P(),t.xf=this.xf}oi(t){t in oe?this.imageStretch=t:super.oi(t)}toString(){return"Picture("+this.source+")#"+u.as(this)}get bf(){return 0!==(1048576&this.n)}set bf(t){this.bf!==t&&(this.n=1048576^this.n)}get Fp(){return 0!==(2097152&this.n)}set Fp(t){this.Fp!==t&&(this.n=2097152^this.n)}get hn(){return 0!==(4194304&this.n)}set hn(t){this.hn!==t&&(this.n=4194304^this.n)}static clearCache(t){void 0===t&&(t=""),e.s(t,"string",re,"clearCache:url"),""!==t?re.Rp[t]&&(delete re.Rp[t],re.c1--):(re.Rp=new n,re.c1=0)}static tA(t,e){e.iT||(e.f1=i=>{re.Jv(e,i),t.desiredSize.isReal()||(t.ue(!1),t.c())},e.u1=t=>re.$v(e,t),e.addEventListener("load",e.f1),e.addEventListener("error",e.u1),e.iT=!0)}static BR(t){t.f1&&t.removeEventListener("load",t.f1),t.u1&&t.removeEventListener("error",t.u1),delete t.f1,delete t.u1,delete t.iT}get element(){return this.tl}set element(t){const i=this.tl;if(this.Ve(!0),i!==t){this.bf=t instanceof HTMLCanvasElement;const n=t instanceof HTMLImageElement;null!==t&&!(n||t instanceof HTMLVideoElement||this.bf)&&e.o("Picture.element must be an instance of Image, Canvas, or Video, not: "+t);const s=this.diagram;null!==s&&s.YM(this),this.tl=t,null!==t&&n&&void 0===t.ts&&(t.ts=new u),null!==s&&n&&s.XM(this),this.t("element",i,t),this.S()}}IR(){const t=this.tl;if(null===t)return;const e=this.desiredSize.isReal();(this.bf||!0===t.complete)&&(t.o0&&(t.vp instanceof Event&&null!==this.ns?this.ns(this,t.vp):!0===t.hn&&!t.vp&&null!==this.el&&t.Z2&&this.el(this,t.Z2)),t.hn=!0),t.hn&&e&&null!==this.diagram&&this.diagram.Vu.add(this)}Zv(){if(null===this.tl)return void(this.wf=!1);const t=new Bt(null).li;try{t.drawImage(this.tl,0,0)}catch{this.Fp=!1}try{t.getImageData(0,0,1,1).data[3]&&(this.wf=!1),this.wf=!1}catch{this.wf=!0}}get source(){return this.dt}set source(t){const i=this.dt;if(i!==t){this.Ve(!0),e.s(t,"string",re,"source"),this.dt=t;let n=re.Rp;if(!vt.isUsingDOM())return void this.t("source",i,t);let s=null;if(void 0!==n[t])s=n[t];else if(""!==t){re.c1>30&&(re.clearCache(),n=re.Rp),s=e.hs("img"),s.o0=!0,re.tA(this,s);const i=this.xf;null!==i&&(s.crossOrigin=i(this)),s.src=t,n[t]=s,re.c1++}this.element=s,null!==s&&void 0===s.__goCache&&(s.__goCache=new ae),this.c(),this.S(),this.t("source",i,t)}}static Jv(t,e){let i;t.hn=!0,t.vp=!1;const n=t.ts.copy();if(null==n)return;const s=n.iterator;for(;s.next();){const n=s.value;n.S();const o=t.getAttribute("src")||"",r=n.Wl.get(o);if(null===r)continue;const a=r.length;for(let s=0;s<a;s++)i=r[s],i.desiredSize.isReal()||n.Vu.add(i),i.Ve(!0),n.requestUpdate(),t.o0&&(void 0===t.Z2&&(t.Z2=e),null!==i.el&&i.el(i,e))}t.ts.clear()}static $v(t,i){let n;t.vp=i;const s=t.ts.copy();if(null==s)return;const o=s.iterator;for(;o.next();){const s=o.value,r=t.getAttribute("src")||"",a=s.Wl.get(r);if(null===a)continue;const l=a.length,h=e.et();for(let t=0;t<l;t++)h.push(a[t]);if(t.o0)for(let t=0;t<l;t++)n=h[t],null!==n.ns&&n.ns(n,i);e.J(h)}t.ts.clear()}reloadSource(){if(""===this.source)return;re.clearCache(this.source);const t=this.source;this.source="",this.source=t}redraw(){this.S(),this.Ve(!0)}get sourceCrossOrigin(){return this.xf}set sourceCrossOrigin(t){if(this.xf!==t&&(null!==t&&e.k(t,re,"sourceCrossOrigin"),this.xf=t,null!==this.element)){const e=this.element.getAttribute("src");null===t&&"string"==typeof e?this.element.crossOrigin=null:null!==t&&(this.element.crossOrigin=t(this)),this.element.src=e}}get sourceRect(){return this.il}set sourceRect(t){const e=this.il;e.equals(t)||(t=t.P(),this.il=t,this.S(),this.t("sourceRect",e,t))}get imageStretch(){return this.pf}set imageStretch(t){const e=this.pf;e!==t&&(this.pf=t,this.S(),this.t("imageStretch",e,t))}get flip(){return this.io}set flip(t){const e=this.io;e!==t&&(this.io=t,this.S(),this.t("flip",e,t))}get imageAlignment(){return this.yf}set imageAlignment(t){const e=this.yf;e.equals(t)||(t=t.P(),this.yf=t,this.S(),this.t("imageAlignment",e,t))}get errorFunction(){return this.ns}set errorFunction(t){const i=this.ns;i!==t&&(null!==t&&e.k(t,re,"errorFunction"),this.ns=t,this.t("errorFunction",i,t))}get successFunction(){return this.el}set successFunction(t){const i=this.el;i!==t&&(null!==t&&e.k(t,re,"successFunction"),this.el=t,this.t("successFunction",i,t))}dh(t,e){const i=this.tl;if(null===i)return;const n=i.getAttribute("src");if(i instanceof HTMLImageElement&&(null===n||""===n)||i.vp instanceof Event&&t instanceof It)return;const s=t instanceof Rt,o=this.naturalBounds;let r=0,a=0;const l=this.bf;let h=l?+i.width:i.naturalWidth,u=l?+i.height:i.naturalHeight;if(void 0===h&&i.videoWidth&&(h=i.videoWidth),void 0===u&&i.videoHeight&&(u=i.videoHeight),0===h||0===u)return;const c=h,d=u;this.sourceRect.isReal()&&(r=this.il.x,a=this.il.y,h=this.il.width,u=this.il.height);let f=h,g=u;const p=this.pf,m=this.yf;switch(p){case 0:if(this.sourceRect.isReal())break;f>=o.width&&(r=r+m.offsetX+(f*m.x-o.width*m.x)),g>=o.height&&(a=a+m.offsetY+(g*m.y-o.height*m.y)),h=Math.min(o.width,f),u=Math.min(o.height,g);break;case 2:f=o.width,g=o.height;break;case 6:case 7:let t=0;6===p?(t=Math.min(o.height/g,o.width/f),f*=t,g*=t):7===p&&(t=Math.max(o.height/g,o.width/f),f*=t,g*=t,f>=o.width&&(r=(r+m.offsetX+(f*m.x-o.width*m.x)/f)*h),g>=o.height&&(a=(a+m.offsetY+(g*m.y-o.height*m.y)/g)*u),h*=1/(f/o.width),u*=1/(g/o.height),f=o.width,g=o.height)}const y=h*u,x=this.getDocumentScale()*e.scale,v=f*x*(g*x),b=y/v,w=i.__goCache;let k=null;const S=re.Qv;if(!s){if(i.hn&&void 0!==w&&c<8e3&&d<8e3&&v>4&&b>S*S){null===w.Vt&&(w.eT(4,c,d,i),w.eT(16,c,d,i));const t=w.Vt,e=t.length;for(let i=0;i<e&&t[i].bd*t[i].bd<b;i++)k=t[i]}if(!e.Uu&&(null===this.wf&&this.Zv(),this.wf))return}const P=f<o.width?m.offsetX+(o.width*m.x-f*m.x):0,M=g<o.height?m.offsetY+(o.height*m.y-g*m.y):0;switch(this.flip){case 0:break;case 2:t.translate(Math.min(o.width,f),0),t.scale(-1,1);break;case 1:t.translate(0,Math.min(o.height,g)),t.scale(1,-1);break;case 3:t.translate(Math.min(o.width,f),Math.min(o.height,g)),t.scale(-1,-1)}if(t.commitTransform(),e.getRenderingHint("pictureRatioOptimization")&&!e.ta&&void 0!==w&&null!==k&&1!==k.bd){t.save();const e=k.bd;try{t.drawImage(k.dt,r/e,a/e,Math.min(k.dt.width,h/e),Math.min(k.dt.height,u/e),P,M,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Rt&&(this.Xb=[r/e,a/e,Math.min(k.dt.width,h/e),Math.min(k.dt.height,u/e),P,M,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Fp=!1}t.restore()}else try{t.drawImage(i,r,a,h,u,P,M,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Rt&&(this.Xb=[r,a,h,u,P,M,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Fp=!1}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-Math.min(o.width,f),0);break;case 1:t.scale(1,-1),t.translate(0,-Math.min(o.height,g));break;case 3:t.scale(-1,-1),t.translate(-Math.min(o.width,f),-Math.min(o.height,g))}}get naturalBounds(){return this.zi}Wu(t,e,i,n){const s=this.desiredSize,o=this.zs(!0),r=this.tl,a=this.bf;let l=0,h=0;(a||!this.hn&&r&&r.complete)&&(this.hn=!0),null===r?(isFinite(s.width)||(t=i),isFinite(s.height)||(e=n)):(l=a?+r.width:r.naturalWidth,h=a?+r.height:r.naturalHeight),isFinite(s.width)||2===o||5===o?(isFinite(t)||(this.sourceRect.isReal()?t=this.sourceRect.width:null!==r&&(t=l)),i=0):null!==r&&!1!==this.hn&&(t=this.sourceRect.isReal()?this.sourceRect.width:l),isFinite(s.height)||2===o||4===o?(isFinite(e)||(this.sourceRect.isReal()?e=this.sourceRect.height:null!==r&&(e=h)),n=0):null!==r&&!1!==this.hn&&(e=this.sourceRect.isReal()?this.sourceRect.height:h),isFinite(s.width)&&(t=s.width),isFinite(s.height)&&(e=s.height);const u=this.maxSize,c=this.minSize;i=Math.max(i||0,c.width),n=Math.max(n||0,c.height),t=Math.min(u.width,t),e=Math.min(u.height,e),t=Math.max(i,t),e=Math.max(n,e),null!==r&&!r.complete&&(isFinite(t)||(t=0),isFinite(e)||(e=0)),this.zi.Fn(t,e),this.Wn(0,0,t,e)}fh(t,e,i,n){this.commonArrange(t,e,i,n)}static Rp=(()=>new n)();static c1=0;static Qv=4}class ae{Vt;constructor(){this.Vt=null}eT(t,e,i,n){null===this.Vt&&(this.Vt=[]);const s=new Bt(null),o=s.li,r=1/t;if(s.width=e/t,s.height=i/t,0===s.width||0===s.height)return;const a=new le(s.Tt,t);let l=n,h=1;if(this.Vt.length>0){const t=this.Vt[this.Vt.length-1];l=t.dt,h=t.bd}o.setTransform(r*h,0,0,r*h,0,0),o.commitTransform(),o.drawImage(l,0,0),this.Vt.push(a)}}class le{dt;bd;constructor(t,e){this.dt=t,this.bd=e}}class he{bi;Kg;constructor(){this.Kg=new N,this.bi=null}Ri(t){null!==t?(this.Kg=t,t.figures.clear()):this.Kg=new N,this.bi=null}hu(t,e,i,n,s,o){if(void 0!==n&&!0===n){const i=new A(1);i.endX=t,i.endY=e,this.bi.segments.add(i)}else this.bi=new T,this.bi.startX=t,this.bi.startY=e,this.bi.isFilled=i,this.bi.isEvenOdd=o||!1,this.Kg.figures.add(this.bi);void 0!==s&&(this.bi.isShadowed=s)}oF(){const t=this.bi.segments.length;t>0&&this.bi.segments.elt(t-1).close()}rF(){this.bi.segments.length>0&&(this.bi.isFilled=!0)}lF(t){this.bi.isShadowed=t}FE(t){this.bi.isEvenOdd=t}eF(t,e,i){void 0===i&&(i=!1);const n=new A(1);n.endX=t,n.endY=e,i&&n.close(),this.bi.segments.add(n)}rr(t,e,i){void 0===i&&(i=!1);const n=new A(2);n.endX=t,n.endY=e,i&&n.close(),this.bi.segments.add(n)}lr(t,e,i,n,s,o,r){void 0===r&&(r=!1);const a=new A(3);a.point1X=t,a.point1Y=e,a.point2X=i,a.point2Y=n,a.endX=s,a.endY=o,r&&a.close(),this.bi.segments.add(a)}Mw(t,e,i,n,s){void 0===s&&(s=!1);const o=new A(4);o.point1X=t,o.point1Y=e,o.endX=i,o.endY=n,s&&o.close(),this.bi.segments.add(o)}sF(t,e,i,n,s,o,r){void 0===o&&(o=0),void 0===r&&(r=!1);const a=new A(5);a.startAngle=t,a.sweepAngle=e,a.centerX=i,a.centerY=n,a.radiusX=s,a.radiusY=0!==o?o:s,r&&a.close(),this.bi.segments.add(a)}nF(t,e,i,n,s,o,r,a){void 0===a&&(a=!1);const l=new A(6,o,r,t,e,i,n,s);a&&l.close(),this.bi.segments.add(l)}static Q2=null;static RC(t){const e=he.Q2;if(null!==e)return he.Q2=null,e.Ri(t),e;{const e=new he;return e.Ri(t),e}}static vC(t){he.Q2=t}}{const t=function(t,e){const i=t.toLowerCase(),n=S.In;n[t]=e,n[i]=t};t("Rectangle",((t,e,i)=>{const n="r"+e+","+i;let s=S.nr[n];return void 0!==s||(s=new N(2),s.endX=e,s.endY=i,S.or<S.Vg&&(S.nr[n]=s,S.or++)),s})),t("Square",((t,e,i)=>{const n="s"+e+","+i;let s=S.nr[n];return void 0!==s||(s=new N(2),s.endX=e,s.endY=i,s.defaultStretch=6,S.or<S.Vg&&(S.nr[n]=s,S.or++)),s}));const e=(t,e,i,n,s)=>{(isNaN(n)||n<0)&&(n=5),isNaN(s)&&(s=15);const o="rr"+e+","+i+","+n+","+s;let r=S.nr[o];if(void 0!==r)return r;let a=n;1===(1&s)?(a=Math.min(a,2===(2&s)?e/3:e),a=Math.min(a,8===(8&s)?i/3:i)):a=0;const l=new T(a,0,!0);r=(new N).add(l);const h=w.TopLeft.copy(),u=w.BottomRight.copy();if(2===(2&s)){let t=n;t=Math.min(t,1===(1&s)?e/3:e),t=Math.min(t,4===(4&s)?i/3:i);const o=t*S.Rn;l.add(new A(2,e-t,0)).add(new A(3,e,t,e-o,0,e,o)),h.offsetY=o,u.offsetX=-o}else l.add(new A(2,e,0));if(4===(4&s)){let t=n;t=Math.min(t,8===(8&s)?e/3:e),t=Math.min(t,2===(2&s)?i/3:i);const o=t*S.Rn;l.add(new A(2,e,i-t)).add(new A(3,e-t,i,e,i-o,e-o,i)),u.offsetX=-o,u.offsetY=-o}else l.add(new A(2,e,i));if(8===(8&s)){let t=n;t=Math.min(t,4===(4&s)?e/3:e),t=Math.min(t,1===(1&s)?i/3:i);const o=t*S.Rn;l.add(new A(2,t,i)).add(new A(3,0,i-t,o,i,0,i-o)),h.offsetX=o,u.offsetY=-o}else l.add(new A(2,0,i));if(1===(1&s)){const t=a*S.Rn;l.add(new A(2,0,a)).add(new A(3,a,0,0,t,t,0).close()),h.offsetX=t,h.offsetY=t}else l.add(new A(2,0,0).close());return r.spot1=h,r.spot2=u,S.or<S.Vg&&(S.nr[o]=r,S.or++),r};t("RoundedRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN,o=t?t.parameter2:NaN;return e(t,i,n,s,o)})),t("Border","RoundedRectangle"),t("RoundedTopRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,3)})),t("RoundedBottomRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,12)})),t("RoundedLeftRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,9)})),t("RoundedRightRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,6)})),t("Ellipse",((t,e,i)=>{const n="e"+e+","+i;let s=S.nr[n];return void 0!==s||(s=new N(3),s.endX=e,s.endY=i,s.spot1=w.Vk,s.spot2=w.zk,S.or<S.Vg&&(S.nr[n]=s,S.or++)),s})),t("Circle",((t,e,i)=>{const n="c"+e+","+i;let s=S.nr[n];return void 0!==s||(s=new N(3),s.endX=e,s.endY=i,s.spot1=w.Vk,s.spot2=w.zk,s.defaultStretch=6,S.or<S.Vg&&(S.nr[n]=s,S.or++)),s})),t("TriangleRight",((t,e,i)=>(new N).add(new T(0,0).add(new A(2,e,.5*i)).add(new A(2,0,i).close())).setSpots(0,.25,.5,.75))),t("TriangleDown",((t,e,i)=>(new N).add(new T(0,0).add(new A(2,e,0)).add(new A(2,.5*e,i).close())).setSpots(.25,0,.75,.5))),t("TriangleLeft",((t,e,i)=>(new N).add(new T(e,i).add(new A(2,0,.5*i)).add(new A(2,e,0).close())).setSpots(.5,.25,1,.75))),t("TriangleUp",((t,e,i)=>(new N).add(new T(e,i).add(new A(2,0,i)).add(new A(2,.5*e,0).close())).setSpots(.25,.5,.75,1))),t("Triangle","TriangleUp"),t("Diamond",((t,e,i)=>(new N).add(new T(.5*e,0).add(new A(2,0,.5*i)).add(new A(2,.5*e,i)).add(new A(2,e,.5*i).close())).setSpots(.25,.25,.75,.75))),t("LineH",((t,e,i)=>{const n=new N(1);return n.startX=0,n.startY=i/2,n.endX=e,n.endY=i/2,n})),t("LineV",((t,e,i)=>{const n=new N(1);return n.startX=e/2,n.startY=0,n.endX=e/2,n.endY=i,n})),t("None","Rectangle"),t("BarH","Rectangle"),t("BarV","Rectangle"),t("MinusLine","LineH"),t("PlusLine",((t,e,i)=>(new N).add(new T(0,i/2,!1).add(new A(2,e,i/2)).add(new A(1,e/2,0)).add(new A(2,e/2,i))))),t("XLine",((t,e,i)=>(new N).add(new T(0,i,!1).add(new A(2,e,0)).add(new A(1,0,0)).add(new A(2,e,i))))),t("LineRight",((t,e,i)=>(new N).add(new T(.25*e,0,!1).add(new A(2,.75*e,.5*i)).add(new A(2,.25*e,i))))),t("LineDown",((t,e,i)=>(new N).add(new T(0,.25*i,!1).add(new A(2,.5*e,.75*i)).add(new A(2,e,.25*i))))),t("LineLeft",((t,e,i)=>(new N).add(new T(.75*e,0,!1).add(new A(2,.25*e,.5*i)).add(new A(2,.75*e,i))))),t("LineUp",((t,e,i)=>(new N).add(new T(0,.75*i,!1).add(new A(2,.5*e,.25*i)).add(new A(2,e,.75*i))))),t("Capsule",((t,e,i)=>{const n=new N;if(e<i){const s=e/2,o=new T(0,s,!0);n.add(o),o.add(new A(5,180,180,s,s,s,s)),o.add(new A(2,e,i-s)),o.add(new A(5,0,180,s,i-s,s,s)),o.add(new A(2,0,s));const r=isFinite(t.parameter1)?t.parameter1:.156*e;return n.spot1=new w(0,0,0,r),n.spot2=new w(1,1,0,-r),n}if(e>i){const s=i/2,o=new T(s,0,!0);n.add(o),o.add(new A(2,e-s,0)),o.add(new A(5,270,180,e-s,s,s,s)),o.add(new A(2,s,i)),o.add(new A(5,90,180,s,s,s,s));const r=isFinite(t.parameter1)?t.parameter1:.156*i;return n.spot1=new w(0,0,r,0),n.spot2=new w(1,1,-r,0),n}return n.type=3,n.endX=e,n.endY=i,n.spot1=w.Vk,n.spot2=w.zk,n}));const i=(t,e)=>new T(t,e,!1,!1),n=(t,e,i)=>t.add(new A(2,e,i)),s=(t,e,i)=>t.add(new A(1,e,i));t("Borders",((t,e,o)=>{let r=t?t.parameter1:NaN;isNaN(r)?r=10:r&=15;const a=new N;let l;return 10===r?(l=i(e,0),n(l,e,o),s(l,0,o),n(l,0,0)):5===r?(l=i(0,0),n(l,e,0),s(l,e,o),n(l,0,o)):1===r?(l=i(0,0),n(l,e,0),s(l,e,o)):2===r?(l=i(e,0),n(l,e,o)):4===r?(l=i(e,o),n(l,0,o)):8===r?(l=i(0,o),n(l,0,0),s(l,e,o)):3===r?(l=i(0,0),n(l,e,0),n(l,e,o)):6===r?(l=i(e,0),n(l,e,o),n(l,0,o)):12===r?(l=i(e,o),n(l,0,o),n(l,0,0)):9===r?(l=i(0,o),n(l,0,0),n(l,e,0)):7===r?(l=i(0,0),n(l,e,0),n(l,e,o),n(l,0,o)):14===r?(l=i(e,0),n(l,e,o),n(l,0,o),n(l,0,0)):13===r?(l=i(e,o),n(l,0,o),n(l,0,0),n(l,e,0)):11===r?(l=i(0,o),n(l,0,0),n(l,e,0),n(l,e,o)):15===r?(l=i(0,0),n(l,e,0),n(l,e,o),n(l,0,o),l.add(new A(2,0,0).close())):(l=i(0,0),s(l,e,o)),a.add(l),a}))}S.Ug={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"};var ue=(t=>(t[t.None=0]="None",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Shown=4]="Shown",t[t.Hidden=8]="Hidden",t[t.NodeSized=16]="NodeSized",t[t.GroupLayout=32]="GroupLayout",t[t.NodeReplaced=64]="NodeReplaced",t[t.Standard=127]="Standard",t[t.All=16777215]="All",t))(ue||{});class ce extends Yt{w;Vo;H;sl;nl;zo;ri;Xo;wh;Gs;Yo;kd;qS;sT;Op;Ip;constructor(t,e){let i;void 0===t||t instanceof Xt||"string"==typeof t?i=t:t&&(e=t),super(i),this.w=2408959,this.Vo="",this.H=null,this.sl="",this.nl=null,this.zo=null,this.ri="",this.Xo=null,this.wh=null,this.Gs=new y(NaN,NaN).u(),this.Yo=null,this.kd=NaN,this.qS=-1,this.sT=new v,this.Op=null,this.Ip=NaN,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.w=49152|-4097&this.w,t.Vo=this.Vo,null!==this.H&&(this.H.fi?t.H=this.H:t.H=this.H.copy()),t.sl=this.sl,t.zo=null,t.ri=this.ri,t.Gs.a(this.Gs),t.kd=this.kd}Ro(t){super.Ro(t),t.uh(),t.nl=null,t.Yo=null,t.Op=null}toString(){let t=e.Dn(this.constructor)+"#"+u.as(this);return null!==this.data&&(t+="("+e.toString(this.data)+")"),t}static LayoutNone=0;static LayoutAdded=1;static LayoutRemoved=2;static LayoutShown=4;static LayoutHidden=8;static LayoutNodeSized=16;static LayoutGroupLayout=32;static LayoutNodeReplaced=64;static LayoutStandard=127;static LayoutAll=16777215;ji(){return null===this.H?this.H=new de:this.H.fi&&(this.H=this.H.copy()),this.H}ah(){super.ah(),null!==this.H&&(this.H.fi=!0)}qc(t,e,i,n,s,o,r){const a=this.diagram;null!==a&&(3===t&&"elements"===e?s instanceof Yt?s.Yr((t=>{a.partManager.OM(t,a)})):s instanceof re&&a.XM(s):4===t&&"elements"===e&&(s instanceof Yt?s.Yr((t=>a.partManager.IM(t,a))):s instanceof re&&a.YM(s)),a.raiseChangedEvent(t,e,i,n,s,o,r))}updateTargetBindings(t){if(super.updateTargetBindings(t),null===this.data)return;const e=this.C.r,i=e.length;for(let s=0;s<i;s++){const t=e[s];t instanceof Yt&&t.Yr((t=>{null!==t.data&&t.updateTargetBindings()}))}const n=this.adornments;for(;n.next();)n.value.updateTargetBindings(t)}To(){if(super.To(),this.C2()){const t=this.C.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e instanceof Yt&&e.Yr((t=>t.To()))}}const t=this.adornments;for(;t.next();)t.value.To()}updateRelationshipsFromData(){null!==this.data&&this.diagram?.partManager.updateRelationshipsFromData(this)}get key(){const t=this.diagram;if(null!==t)return t.model.getKeyForNodeData(this.data)}get adornments(){return null===this.zo?s.instance:this.zo.iteratorValues}findAdornment(t){const e=this.zo;return null===e?null:e.get(t)}addAdornment(t,e){if(null===e)return;let i=null,n=this.zo;if(null!==n&&(i=n.get(t)),i!==e){if(null!==i){const t=i.diagram;null!==t&&t.remove(i)}null===n&&(n=new m,this.zo=n),e.Vo!==t&&(e.category=t),n.set(t,e);const s=this.diagram;if(null!==s){s.add(e);const t=e.adornedObject;if(null!==t){const i=t.findBindingPanel();null!==i&&(e.data=i.data)}}}}removeAdornment(t){const e=this.zo;if(null===e)return;const i=e.get(t);if(null!==i){const t=i.diagram;null!==t&&(t.remove(i),i.data=null)}e.delete(t),0===e.count&&(this.zo=null)}clearAdornments(){const t=this.zo;if(null===t)return;const i=e.et(),n=t.iterator;for(;n.next();){const t=n.key;i.push(t)}const s=i.length;for(let e=0;e<s;e++)this.removeAdornment(i[e]);e.J(i)}updateAdornments(){const t=this.diagram;if(null===t)return;this._v(t),this.tO(t);let e=this.adornments;for(;e.next();){const t=e.value;t.c(),t.hasPlaceholder()&&t.placeholder?.c()}for(e=this.adornments;e.next();)e.value.updateTargetBindings()}invalidateAdornments(){const t=this.diagram;null!==t&&(t.Ql(),!0!==this.nT()&&this.oT(!0))}WS(){!1!==this.nT()&&(this.updateAdornments(),this.oT(!1))}_v(t){const e="Selection";if(this.isSelected&&this.selectionAdorned){const i=this.selectionObject;if(null!==i&&this.actualBounds.isReal()&&this.isVisible()&&i.isVisibleObject()&&i.actualBounds.isReal()){let n=this.findAdornment(e);if(null===n){let e=this.selectionAdornmentTemplate;null===e&&(e=this.Nl()?t.linkSelectionAdornmentTemplate:this instanceof Ne?t.groupSelectionAdornmentTemplate:t.nodeSelectionAdornmentTemplate),n=e.copy(),null!==n&&(this.Nl()&&this.selectionObject===this.path&&(n.type=Yt.Link),n.adornedObject=i)}if(null!==n)return n.type===Yt.Link&&n.c(),void this.addAdornment(e,n)}}this.removeAdornment(e)}tO(t){const e=this;t.toolManager.mouseDownTools.each((t=>{t.isEnabled&&t.updateAdornments(e)})),t.toolManager.updateAdornments(e)}HS(t){this.Xo=t,null===t&&this.ZR()}get layer(){return this.Xo}get diagram(){const t=this.Xo;return null==t?null:t.diagram}get layerName(){return this.sl}set layerName(t){const e=this.sl;if(e===t)return;let i=this.diagram;if(null!==i&&(null===i.findLayer(t)||i.partManager.addsToTemporaryLayer))return;this.sl=t,null!==i&&i.invalidateDocumentBounds(),this.t("layerName",e,t);const n=this.layer;if(null===n||n.name===t||(i=n.diagram,null===i))return;const s=i.findLayer(t);if(null===s||s===n)return;let o=n.te(-1,this,!0);o>=0&&i.raiseChangedEvent(4,"parts",n,this,null,o,!0),o=s.Wh(99999999,this,!0),n.visible!==s.visible&&this.Ei(s.visible),o>=0&&i.raiseChangedEvent(3,"parts",s,null,this,!0,o);const r=this.layerChanged;if(null===r)return;const a=i.X;i.X=!0,r(this,n,s),i.X=a}get layerChanged(){return null!==this.H?this.H.Ep:null}set layerChanged(t){const i=this.layerChanged;i!==t&&(null!==t&&e.k(t,ce,"layerChanged"),this.ji().Ep=t,this.t("layerChanged",i,t))}get zOrder(){return this.kd}set zOrder(t){const e=this.kd;if(e===t)return;this.kd=t;const i=this.layer;null!==i&&i.bx(-1,this),this.t("zOrder",e,t);const n=this.diagram;null!==n&&n.S()}iO(){const t=this.layer;null!==t&&t.bx(-1,this)}d1(){if(!1!==this.th())return;this._2(!0),this.$c();const t=this.diagram;null!==t&&(t._m(this),t.requestUpdate())}rT(){if(this.w|=2097152,!1===this.th())return;const t=this.position,e=this.location;(!e.isReal()||!t.isReal())&&this.lT(t,e);const i=this.Ni,n=v.l().a(i);i.Nt(),i.x=t.x,i.y=t.y,i.u(),this.Ju(n,i),v.e(n),this._2(!1),this.$c()}Wn(t,e,i,n){const s=this.se;s.i(t,e,i,n),null===this.wi&&(this.wi=new k);const o=this.wi;o.Ri(),this.g0(o,t,e,i,n),this.wi=o,o.Xk()||o.vg(s)}g0(t,e,i,n,s){if(1!==this.tt&&t.tt(this.tt),0===this.Yt)return;let o=w.Center;this.locationSpot.isSpot()&&(o=this.locationSpot);const r=y.l();if(this.locationObject!==this){const t=this.locationObject,e=t.naturalBounds;r.setSpot(e.x,e.y,e.width,e.height,o),null!==t.wi&&t.wi.gt(r),r.offset(-t.measuredBounds.x,-t.measuredBounds.y);let i=t.panel;for(;null!==i&&i!==this;)null!==i.wi&&i.wi.gt(r),r.offset(-i.measuredBounds.x,-i.measuredBounds.y),i=i.panel}else r.setSpot(e,i,n,s,o);t.cs(this.Yt,r.x,r.y),y.e(r)}get locationObject(){if(null===this.Yo)if(this instanceof fe&&this.type!==Yt.Link&&this.hasPlaceholder())this.Yo=this.placeholder;else{const t=this.locationObjectName;if(""!==t){const e=this.findObject(t);this.Yo=null!==e?e:this}else this.Yo=this}return this.Yo?.visible?this.Yo:this}get minLocation(){return null!==this.H?this.H.Bp:y.gC}set minLocation(t){const e=this.minLocation;e.equals(t)||(t=t.P(),this.ji().Bp=t,this.t("minLocation",e,t))}get maxLocation(){return null!==this.H?this.H.Up:y.mC}set maxLocation(t){const e=this.maxLocation;e.equals(t)||(t=t.P(),this.ji().Up=t,this.t("maxLocation",e,t))}get locationObjectName(){return null!==this.H?this.H.Vp:""}set locationObjectName(t){const e=this.locationObjectName;e!==t&&(this.ji().Vp=t,this.Yo=null,this.c(),this.t("locationObjectName",e,t))}get locationSpot(){return null!==this.H?this.H.zp:w.TopLeft}set locationSpot(t){const e=this.locationSpot;e.equals(t)||(t=t.P(),this.ji().zp=t,this.c(),this.t("locationSpot",e,t))}move(t,e){!0===e?this.location=t:this.position=t}moveTo(t,e,i){const n=y.V(t,e);this.move(n,i),y.e(n)}isVisible(){if(!this.visible)return!1;const t=this.layer;if(null!==t){if(!t.visible)return!1;const e=t.diagram;if(null!==e&&e.animationManager.nx(this))return!0}const e=this.containingGroup;return!(null!==e&&(!e.isSubGraphExpanded||!e.isVisible()))}Ei(t){const e=this.diagram;t?(this.invalidateLayout(4),this.invalidateAdornments(),null!==e&&e._m(this)):(this.invalidateLayout(8),this.clearAdornments()),this.uh(),null!==e&&(e.invalidateDocumentBounds(),e.S())}findObject(t){if(this.name===t)return this;let e=this.Op;if(null===e&&(this.Op=e=new m),null!==e.get(t))return e.get(t);const i=super.findObject(t);return null!==i?(e.set(t,i),i):(e.set(t,null),null)}L0(){this.Op=null}getRelativePoint(t,e,i){void 0===i&&(i=new y);const n=e.isNoSpot()?w.Center:e,s=t.naturalBounds;if(i.i(s.width*n.x+n.offsetX,s.height*n.y+n.offsetY),null===t||t===this)return i;t.T.gt(i);let o=t.panel;for(;null!==o&&o!==this;)o.T.gt(i),o=o.panel;return null!==this.wi&&this.wi.gt(i),i.offset(-this.se.x,-this.se.y),i}getDocumentBounds(t){return void 0===t&&(t=new v),t.a(this.actualBounds)}ensureBounds(){this.ht(1/0,1/0),this.Ut()}IA(t){const e=this.locationSpot,i=this.locationObject;let n=i.naturalBounds;n.isReal()||(n=v.Fg);const s=i instanceof Jt?i.strokeWidth:0;if(t.setSpot(0,0,n.width+s,n.height+s,e),i!==this){t.offset(-s/2,-s/2),i.T.gt(t);let e=i.panel;for(;null!==e&&e!==this;)e.T.gt(t),e=e.panel}return null!==this.wi&&this.wi.gt(t),t.offset(-this.se.x,-this.se.y),t}qh(t,e){const i=void 0===e?this.sT:e,n=this.eO(),s=2*n;if(!this.isShadowed)return i.i(t.x-1-n,t.y-1-n,t.width+2+s,t.height+2+s),i;let o=t.x,r=t.y,a=t.width,l=t.height;const h=this.shadowBlur,u=this.shadowOffset;return a+=h,l+=h,o-=h/2,r-=h/2,u.x>0?a+=u.x:(o+=u.x,a-=u.x),u.y>0?l+=u.y:(r+=u.y,l-=u.y),i.i(o-1,r-1,a+2,l+2),i}Uv(){return this.type===Yt.Link&&this instanceof fe&&"Selection"===this.category&&this.adornedObject instanceof Jt&&this.adornedPart.findMainElement()===this.adornedObject?this.adornedObject.strokeWidth:0}eO(){return isNaN(this.Ip)&&(this.Ip=this.YA()),this.Ip}cf(){this.Ip=NaN}Ut(){if(!1===this._e())return void this.rT();this.Jn(!1);const t=this.Ni,e=v.l();e.a(t);const i=this.Ml();this.fh(0,0,this.se.width,this.se.height);const n=this.position;this.lT(n,this.location),t.Nt(),t.x=n.x,t.y=n.y,t.u(),this.Ju(e,t),e.equals(t)?this.ps(i):this.ke()&&(!S.f(e.width,t.width)||!S.f(e.height,t.height))&&this.qS>=0&&this.invalidateLayout(16),v.e(e),this._2(!1)}Ju(t,e){const i=this.diagram;if(null===i)return;let n=!1;if(!1===i._h&&t.isReal()){const s=v.l();s.a(i.documentBounds),s.subtractMargin(i.padding),t.x>s.x&&t.y>s.y&&t.right<s.right&&t.bottom<s.bottom&&e.x>s.x&&e.y>s.y&&e.right<s.right&&e.bottom<s.bottom&&(n=!0),v.e(s)}(!0===this.sO()||!t.equals(e))&&this.GL(n,i),i.S(),(t.isReal()||e.isReal())&&!t.equalsApproxClose(e)&&(this instanceof pe&&!i.undoManager.isUndoingRedoing&&this.invalidateConnectedLinks(),this.uh())}get location(){return this.Gs}set location(t){const e=t.x,i=t.y,n=this.Gs;(n.x!==e&&(!isNaN(n.x)||!isNaN(e))||n.y!==i&&(!isNaN(n.y)||!isNaN(i)))&&(t=t.copy(),this.nO(t,n)&&this.t("location",n,t.copy()))}nO(t,e){if(this.Nl())return!1;if(this.Gs=t,this.w|=2097152,!1===this._e()){this.d1();const i=this.at;if(i.isReal()){const n=this.diagram;if(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing){const s=i.copy();i.i(i.x+(t.x-e.x),i.y+(t.y-e.y)),this.hT(n,i,s.x,s.y),this.t("position",s,i.copy())}}}return!0}S2(t,e,i){if(this.Nl()||!t.isReal())return!1;const n=this.diagram;if(null!==n&&this.hT(n,t,e,i),this.at=t,this.w&=-2097153,this.Gs.isReal()&&(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing)){const n=this.Gs;this.Gs=new y(n.x+(t.x-e),n.y+(t.y-i)),this.t("location",n,this.Gs.copy())}return!1===this.th()&&!1===this._e()&&(this.d1(),this.rT()),!0}hT(t,e,i,n){if(null===t||this instanceof fe)return;const s=t.animationManager;s.pi&&s.dL(this,new y(i,n),e,!1)}bc(t,e,i){const n=this.Gs,s=this.at;if(i){if(n.x===t&&n.y===e)return;this.th()||this._e()?s.i(NaN,NaN):s.i(s.x+t-n.x,s.y+e-n.y),n.i(t,e)}else{if(s.x===t&&s.y===e)return;n.i(n.x+t-s.x,n.y+e-s.y),s.i(t,e)}this.d1()}M2(){this.w&=-2097153,this.d1()}lT(t,e){const i=this.IA(y.l()),n=this.diagram,s=e.isReal(),o=t.isReal();s&&o?2097152&this.w?this.aT(t,e,n,i):this.cT(t,e,n,i):s?this.aT(t,e,n,i):o&&this.cT(t,e,n,i),this.w|=2097152,y.e(i),this.$c()}aT(t,e,i,n){const s=t.x,o=t.y;if(t.i(e.x-n.x,e.y-n.y),null!==i){const e=i.animationManager,n=e.defaultAnimation.isAnimating;!n&&e.pi&&!(this instanceof fe)&&e.dL(this,new y(s,o),t,!1),!n&&(t.x!==s||t.y!==o)&&this.t("position",new y(s,o),t.copy())}}cT(t,e,i,n){const s=e.copy();e.i(t.x+n.x,t.y+n.y),!e.equals(s)&&null!==i&&this.t("location",s,e.copy())}GL(t,e){this.p2(!1),this instanceof pe&&e.WM(this),!this.layer.isTemporary&&!t&&e.invalidateDocumentBounds();const i=this.Ni,n=e.viewportBounds;n.isReal()?this.Ml()?(i.intersectsRectPlus(n,10)||this.ps(!1),this.updateAdornments()):this.isVisible()&&i.intersectsRect(n)?(this.ps(!0),this.updateAdornments()):this.invalidateAdornments():e.Ic=!0}Xr(){return!0}ke(){return!0}Nl(){return!1}Xs(){return!0}hasPlaceholder(){return!1}get category(){return this.Vo}set category(t){const e=this.Vo;if(e===t)return;null!==this.svg&&(this.svg.remove(),this.Ve(!0));const i=this.diagram,n=this.data;let s=null;if(null!==i&&null!==n&&!(this instanceof fe)){const t=i.model.undoManager;t.isEnabled&&!t.isUndoingRedoing&&(s=this.clone(),s.C.addAll(this.C))}if(this.Vo=t,this.t("category",e,t),null===i||null===n||this instanceof fe){if(this instanceof fe){const t=this.adornedPart;if(null!==t){const i=t.zo;null!==i&&i.delete(e),t.addAdornment(this.category,this)}}}else{const o=i.model;if(o.undoManager.isUndoingRedoing)return;if(this.Nl()){i.partManager.setLinkCategoryForData(n,t);const s=i.partManager.findLinkTemplateForCategory(t);if(null!==s){s.Et();const i=s.copy();null!==i&&this.tN(i,e,t)}}else{null!==o&&o.setCategoryForNodeData(n,t);const s=i.partManager.findTemplateForNodeData(n,t);if(null!==s){s.Et();const i=s.copy();if(null!==i&&!(i instanceof be)){const n=this.location.copy();this.tN(i,e,t),this.location.isReal()||(this.location=n)}}}if(null!==s){const t=this.clone();t.C.addAll(this.C),this.t("self",s,t)}}}get self(){return this}set self(t){this.tN(t,this.category,t.category)}static fT=!1;tN(t,i,n){t.constructor!==this.constructor&&(ce.fT||(ce.fT=!0,e.ni('Should not change the class of the Part when changing category from "'+i+'" to "'+n+'"'),e.ni("  Old class: "+e.Dn(this.constructor)+", new class: "+e.Dn(t.constructor)+", part: "+this.toString()))),this.clearAdornments();const s=this.data,o=this.layerName,r=this.isSelected,a=this.isHighlighted;let l=!0,h=!0,u=!1;this instanceof pe&&(l=this.isTreeLeaf,h=this.isTreeExpanded,u=this.wasTreeExpanded),t.Ro(this),t.cloneProtected(this),this.Vo=n,null!==this.svg&&(this.svg.remove(),this.svg=null,this.Ve(!0)),this.c(),this.S();const c=this.diagram;let d=!0;null!==c&&(d=c.skipsUndoManager,c.skipsUndoManager=!0),this._t=s,this.w=r?4096|this.w:-4097&this.w,this.w=a?524288|this.w:-524289&this.w,this instanceof pe&&(this.v=l?4|this.v:-5&this.v,this.v=h?1|this.v:-2&this.v,this.v=u?2|this.v:-3&this.v),null!==s&&this.updateTargetBindings();const f=this.layerName;f!==o&&(this.sl=o,this.layerName=f),null!==c&&(c.skipsUndoManager=d),this.ke()&&this.invalidateLayout(64)}canCopy(){if(!this.copyable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowCopy)return!1;const e=t.diagram;return null===e||!!e.allowCopy}canDelete(){if(!this.deletable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowDelete)return!1;const e=t.diagram;return null===e||!!e.allowDelete}canEdit(){if(!this.textEditable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowTextEdit)return!1;const e=t.diagram;return null===e||!!e.allowTextEdit}canGroup(){if(!this.groupable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowGroup)return!1;const e=t.diagram;return null===e||!!e.allowGroup}canMove(){if(!this.movable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowMove)return!1;const e=t.diagram;return null===e||!!e.allowMove}canReshape(){if(!this.reshapable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowReshape)return!1;const e=t.diagram;return null===e||!!e.allowReshape}canResize(){if(!this.resizable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowResize)return!1;const e=t.diagram;return null===e||!!e.allowResize}canRotate(){if(!this.rotatable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRotate)return!1;const e=t.diagram;return null===e||!!e.allowRotate}canSelect(){if(!this.selectable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowSelect)return!1;const e=t.diagram;return null===e||!!e.allowSelect}get copyable(){return 0!==(1&this.w)}set copyable(t){const e=0!==(1&this.w);e!==t&&(this.w=1^this.w,this.t("copyable",e,t))}get deletable(){return 0!==(2&this.w)}set deletable(t){const e=0!==(2&this.w);e!==t&&(this.w=2^this.w,this.t("deletable",e,t))}get textEditable(){return 0!==(4&this.w)}set textEditable(t){const e=0!==(4&this.w);e!==t&&(this.w=4^this.w,this.t("textEditable",e,t),this.invalidateAdornments())}get groupable(){return 0!==(8&this.w)}set groupable(t){const e=0!==(8&this.w);e!==t&&(this.w=8^this.w,this.t("groupable",e,t))}get movable(){return 0!==(16&this.w)}set movable(t){const e=0!==(16&this.w);e!==t&&(this.w=16^this.w,this.t("movable",e,t))}get selectionAdorned(){return 0!==(32&this.w)}set selectionAdorned(t){const e=0!==(32&this.w);e!==t&&(this.w=32^this.w,this.t("selectionAdorned",e,t),this.invalidateAdornments())}get isInDocumentBounds(){return 0!==(64&this.w)}set isInDocumentBounds(t){const e=0!==(64&this.w);if(e!==t){this.w=64^this.w;const i=this.diagram;null!==i&&i.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t)}}get isLayoutPositioned(){return 0!==(128&this.w)}set isLayoutPositioned(t){const e=0!==(128&this.w);e!==t&&(this.w=128^this.w,this.t("isLayoutPositioned",e,t),this.invalidateLayout(t?4:8))}get selectable(){return 0!==(256&this.w)}set selectable(t){const e=0!==(256&this.w);e!==t&&(this.w=256^this.w,this.t("selectable",e,t),this.invalidateAdornments())}get reshapable(){return 0!==(512&this.w)}set reshapable(t){const e=0!==(512&this.w);e!==t&&(this.w=512^this.w,this.t("reshapable",e,t),this.invalidateAdornments())}get resizable(){return 0!==(1024&this.w)}set resizable(t){const e=0!==(1024&this.w);e!==t&&(this.w=1024^this.w,this.t("resizable",e,t),this.invalidateAdornments())}get rotatable(){return 0!==(2048&this.w)}set rotatable(t){const e=0!==(2048&this.w);e!==t&&(this.w=2048^this.w,this.t("rotatable",e,t),this.invalidateAdornments())}get isSelected(){return 0!==(4096&this.w)}set isSelected(t){const e=0!==(4096&this.w);if(e!==t){const i=this.diagram;if(t){if(!this.canSelect())return;if(null!==i){const t=i.maxSelectionCount;if(i.selection.count>=t)return}}this.w=4096^this.w;let n=!1;if(null!==i){n=i.skipsUndoManager,i.skipsUndoManager=!0;const e=i.selection;e.Nt(),t?e.add(this):e.delete(this),e.u()}this.t("isSelected",e,t),this.invalidateAdornments();const s=this.selectionChanged;null!==s&&s(this),null!==i&&(i.requestUpdate(),i.skipsUndoManager=n)}}get isHighlighted(){return 0!==(524288&this.w)}set isHighlighted(t){const e=0!==(524288&this.w);if(e!==t){this.w=524288^this.w;const i=this.diagram;if(null!==i){const e=i.highlighteds;e.Nt(),t?e.add(this):e.delete(this),e.u()}this.t("isHighlighted",e,t),this.S();const n=this.highlightedChanged;null!==n&&n(this)}}get isShadowed(){return 0!==(8192&this.w)}set isShadowed(t){const e=0!==(8192&this.w);e!==t&&(this.w=8192^this.w,this.Ve(!0),this.t("isShadowed",e,t),this.S())}nT(){return 0!==(16384&this.w)}oT(t){t?this.w|=16384:this.w&=-16385}th(){return 0!==(32768&this.w)}_2(t){t?this.w|=32768:this.w&=-32769}sO(){return 0!==(65536&this.w)}p2(t){t?this.w|=65536:this.w&=-65537}Ml(){return 0!==(131072&this.w)}ps(t){t?this.w|=131072:this.w&=-131073}uT(){return 0!==(1048576&this.w)}g1(t){t?this.w|=1048576:this.w&=-1048577}get isAnimated(){return 0!==(262144&this.w)}set isAnimated(t){const e=0!==(262144&this.w);e!==t&&(this.w=262144^this.w,this.t("isAnimated",e,t))}get highlightedChanged(){return null!==this.H?this.H.Xp:null}set highlightedChanged(t){const i=this.highlightedChanged;i!==t&&(null!==t&&e.k(t,ce,"highlightedChanged"),this.ji().Xp=t,this.t("highlightedChanged",i,t))}get selectionObjectName(){return null!==this.H?this.H.Yp:""}set selectionObjectName(t){const e=this.selectionObjectName;e!==t&&(this.ji().Yp=t,this.nl=null,this.t("selectionObjectName",e,t))}get selectionAdornmentTemplate(){return null!==this.H?this.H.Kp:null}set selectionAdornmentTemplate(t){const e=this.selectionAdornmentTemplate;e!==t&&(null!==t&&t.Et(),this.ji().Kp=t,this.t("selectionAdornmentTemplate",e,t))}get selectionObject(){if(null===this.nl){const t=this.selectionObjectName;if(null!==t&&""!==t){const e=this.findObject(t);this.nl=null!==e?e:this}else if(this instanceof be){const t=this.path;this.nl=null!==t?t:this}else this.nl=this}return this.nl}get selectionChanged(){return null!==this.H?this.H.Gp:null}set selectionChanged(t){const i=this.selectionChanged;i!==t&&(null!==t&&e.k(t,ce,"selectionChanged"),this.ji().Gp=t,this.t("selectionChanged",i,t))}get resizeAdornmentTemplate(){return null!==this.H?this.H.Hp:null}set resizeAdornmentTemplate(t){const e=this.resizeAdornmentTemplate;e!==t&&(this.ji().Hp=null!==t?t.Et():null,this.t("resizeAdornmentTemplate",e,t))}get resizeObjectName(){return null!==this.H?this.H.jp:""}set resizeObjectName(t){const e=this.resizeObjectName;e!==t&&(this.ji().jp=t,this.t("resizeObjectName",e,t))}get resizeObject(){const t=this.resizeObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get resizeCellSize(){return null!==this.H?this.H.qp:x.pw}set resizeCellSize(t){const e=this.resizeCellSize;e.equals(t)||(t=t.P(),this.ji().qp=t,this.t("resizeCellSize",e,t))}get rotateAdornmentTemplate(){return null!==this.H?this.H.Wp:null}set rotateAdornmentTemplate(t){const e=this.rotateAdornmentTemplate;e!==t&&(this.ji().Wp=null!==t?t.Et():null,this.t("rotateAdornmentTemplate",e,t))}get rotateObjectName(){return null!==this.H?this.H.Jp:""}set rotateObjectName(t){const e=this.rotateObjectName;e!==t&&(this.ji().Jp=t,this.t("rotateObjectName",e,t))}get rotateObject(){const t=this.rotateObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get rotationSpot(){return null!==this.H?this.H.$p:w.Default}set rotationSpot(t){const e=this.rotationSpot;e.equals(t)||(t=t.P(),this.ji().$p=t,this.t("rotationSpot",e,t))}get text(){return this.ri}set text(t){const e=this.ri;e!==t&&(this.ri=t,this.t("text",e,t))}get containingGroup(){return this.wh}set containingGroup(t){if(this.ke()){const i=this.wh;if(i!==t){null!==t&&(this===t||t.isMemberOf(this))&&(this===t&&e.o("Cannot make a Group a member of itself: "+this.toString()),e.o("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+t.toString())),this.invalidateLayout(2);const n=this.diagram;if(null!==i?i.iN(this):this instanceof Ne&&null!==n&&n.Vr.delete(this),this.wh=t,null!==t?t.eN(this):this instanceof Ne&&null!==n&&n.Vr.add(this),this.invalidateLayout(1),null!==n&&n.X){const e=this.data,i=n.model;if(null!==e&&i.jc()){const n=null!==t?t.data:null;i.setGroupForData(e,i.getKeyForNodeData(n))}}const s=this.containingGroupChanged;if(null!==s){let e=!0;null!==n&&(e=n.X,n.X=!0),s(this,i,t),null!==n&&(n.X=e)}if(this instanceof Ne){const t=new u;ce.nh(t,this,!0,0,!0);const e=t.iterator;for(;e.next();){const t=e.value;if(t instanceof pe){const e=t.linksConnected;for(;e.next();)e.value.Pd()}}}if(this instanceof pe){const t=this.linksConnected;for(;t.next();)t.value.Pd();const e=this.labeledLink;null!==e&&e.Pd()}this.t("containingGroup",i,t),null!==t&&t.iO()}}else e.o("cannot set the Part.containingGroup of a Link or Adornment")}uh(){const t=this.containingGroup;null!==t&&(t.hasPlaceholder()&&t.placeholder?.c(),t.c(),t.invalidateConnectedLinks())}S(){const t=this.diagram;null!==t&&!this._e()&&!this.th()&&this.isVisible()&&this.Ni.isReal()&&t.S(this.qh(this.Ni))}c(){if(this.Ao())return;super.c();const t=this.diagram;null!==t&&(t._m(this),this instanceof pe&&null!==this.labeledLink&&this.labeledLink.ef(),t.requestUpdate(!0))}ef(t){if(this._e())return;const e=this.diagram;null!==e&&(e._m(this),this instanceof pe&&this.invalidateConnectedLinks(),e.requestUpdate()),this.Jn(!0)}Rm(t){if(!t){const t=this.wh;null!==t&&t.eN(this)}}vm(t){if(!t){const t=this.wh;null!==t&&t.iN(this)}}Xc(){const t=this.data;if(null!==t){const e=this.diagram;if(null!==e){const i=e.model;null!==i&&i.removeNodeData(t)}}}get containingGroupChanged(){return null!==this.H?this.H.Zp:null}set containingGroupChanged(t){const i=this.containingGroupChanged;i!==t&&(null!==t&&e.k(t,ce,"containingGroupChanged"),this.ji().Zp=t,this.t("containingGroupChanged",i,t))}findSubGraphLevel(){return this.sN(this)}sN(t){const e=t.containingGroup;if(null!==e)return 1+this.sN(e);if(t instanceof pe){const e=t.labeledLink;if(null!==e)return this.sN(e)}return 0}findTopLevelPart(){return this.nN(this)}nN(t){const e=t.containingGroup;if(null!==e)return this.nN(e);if(t instanceof pe){const e=t.labeledLink;if(null!==e)return this.nN(e)}return t}get isTopLevel(){return!(null!==this.containingGroup||this instanceof pe&&null!==this.labeledLink)}isMemberOf(t){return t instanceof Ne&&this.oN(this,t)}oN(t,e){if(t===e||null===e)return!1;const i=t.containingGroup;if(null!==i&&(i===e||this.oN(i,e)))return!0;if(t instanceof pe){const i=t.labeledLink;if(null!==i)return this.oN(i,e)}return!1}findCommonContainingGroup(t){if(null===t)return null;if(this===t)return this.containingGroup;let e=this;for(;null!==e;){if(e instanceof Ne&&e.g1(!0),e instanceof pe){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}let i=null;for(e=t;null!==e;){if(e.uT()){i=e;break}if(e instanceof pe){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}for(e=this;null!==e;){if(e instanceof Ne&&e.g1(!1),e instanceof pe){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}return i}get layoutConditions(){return null!==this.H?this.H.Qp:127}set layoutConditions(t){const e=this.layoutConditions;e!==t&&(this.ji().Qp=t,this.t("layoutConditions",e,t))}canLayout(){if(!this.isLayoutPositioned||!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary||this instanceof pe&&this.isLinkLabel)}oO(t){if(!this.isLayoutPositioned||!(t&this.layoutConditions))return!1;const e=this.layer;if(null!==e&&e.isTemporary||this instanceof pe&&this.isLinkLabel)return!1;const i=this.diagram;return!(null!==i&&i.undoManager.isUndoingRedoing)}invalidateLayout(t){if(void 0===t&&(t=16777215),!this.oO(t))return;const e=this.wh;if(null!==e){const i=e.layout;null!==i?i.invalidateLayout():e.invalidateLayout(t)}else{const t=this.diagram;if(null!==t){const e=t.layout;null!==e&&e.invalidateLayout()}}}HL(){if(!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary)}static nh(t,e,i,n,s,o){if(void 0===o&&(o=null),!t.has(e)&&(null===o||o(e))&&!(e instanceof fe))if(t.add(e),e instanceof pe){if(i&&e instanceof Ne){const r=e.memberParts;for(;r.next();){const e=r.value;ce.nh(t,e,i,n,s,o)}}if(!1!==s){const r=e.linksConnected;for(;r.next();){const e=r.value;if(t.has(e))continue;const a=e.fromNode,l=e.toNode,h=null===a||t.has(a),u=null===l||t.has(l);(s?h&&u:h||u)&&ce.nh(t,e,i,n,s,o)}}if(n>1){const r=e.findTreeChildrenNodes();for(;r.next();){const e=r.value;ce.nh(t,e,i,n-1,s,o)}}}else if(e instanceof be){const r=e.labelNodes;for(;r.next();){const e=r.value;ce.nh(t,e,i,n,s,o)}}}get dragComputation(){return null!==this.H?this.H._p:null}set dragComputation(t){const i=this.dragComputation;i!==t&&(null!==t&&e.k(t,ce,"dragComputation"),this.ji()._p=t,this.t("dragComputation",i,t))}get shadowOffset(){return null!==this.H?this.H.ty:y.pC}set shadowOffset(t){const e=this.shadowOffset;e.equals(t)||(t=t.P(),this.ji().ty=t,this.S(),this.t("shadowOffset",e,t))}get shadowColor(){return null!==this.H?this.H.iy:"gray"}set shadowColor(t){const e=this.shadowColor;e!==t&&(this.ji().iy=t,this.S(),this.t("shadowColor",e,t))}get shadowBlur(){return null!==this.H?this.H.un:4}set shadowBlur(t){const e=this.shadowBlur;e!==t&&(this.ji().un=t,this.S(),this.t("shadowBlur",e,t))}}class de{fi;Ep;Zp;Kp;Yp;Gp;Xp;Hp;jp;qp;Wp;Jp;$p;Vp;zp;Bp;Up;_p;Qp;ty;iy;un;constructor(){this.fi=!1,this.Ep=null,this.Zp=null,this.Kp=null,this.Yp="",this.Gp=null,this.Xp=null,this.Hp=null,this.jp="",this.qp=x.pw,this.Wp=null,this.Jp="",this.$p=w.Default,this.Vp="",this.zp=w.TopLeft,this.Bp=y.gC,this.Up=y.mC,this._p=null,this.Qp=127,this.ty=y.pC,this.iy="gray",this.un=4}copy(){const t=new de;return t.Ep=this.Ep,t.Zp=this.Zp,t.Kp=this.Kp,t.Yp=this.Yp,t.Gp=this.Gp,t.Xp=this.Xp,t.Hp=this.Hp,t.jp=this.jp,t.qp=this.qp.P(),t.Wp=this.Wp,t.Jp=this.Jp,t.$p=this.$p.P(),t.Vp=this.Vp,t.zp=this.zp.P(),t.Bp=this.Bp.P(),t.Up=this.Up.P(),t._p=this._p,t.Qp=this.Qp,t.ty=this.ty.P(),t.iy=this.iy,t.un=this.un,t}}class fe extends ce{us;Ft;sS;nS;hf;constructor(t,e){let i;void 0===t||t instanceof Xt||"string"==typeof t?i=t:t&&(e=t),super(i),this.w&=-257,this.sl="Adornment",this.us=null,this.sS=0,this.nS=!1,this.Ft=null,this.hf=null,e&&Object.assign(this,e)}toString(){const t=this.adornedPart;return"Adornment("+this.category+")"+(null!==t?t.toString():"")}updateRelationshipsFromData(){}sd(t){const e=this.adornedObject;if(!(e instanceof Jt))return;const i=e.part;if(!(i instanceof be))return;const n=i.path;let s=n.geometry;i.sd(t),s=n.geometry;const o=this.C.r,r=o.length;for(let a=0;a<r;a++){const t=o[a];t.isPanelMain&&t instanceof Jt&&(t.ot=s)}}hasPlaceholder(){return null!==this.Ft&&this.Ft.isVisibleObject()}get placeholder(){return this.Ft}get adornedObject(){return this.us}set adornedObject(t){const e=this.adornedPart;let i=null;null!==t&&(i=t.part),null!==e&&(null===t||e!==i)&&e.removeAdornment(this.category),this.us=t,null!==i&&i.addAdornment(this.category,this)}get adornedPart(){const t=this.us;return null!==t?t.part:null}Xr(){const t=this.us;if(null===t)return!0;const e=t.part;return null===e||!e._e()}ke(){return!1}get containingGroup(){return null}qc(t,e,i,n,s,o,r){if(3===t&&"elements"===e){if(s instanceof Te)null===this.Ft&&(this.Ft=s);else if(s instanceof Yt){const t=s.findInVisualTree((t=>t instanceof Te));t instanceof Te&&null===this.Ft&&(this.Ft=t)}}else 4===t&&"elements"===e&&null!==this.Ft&&(n===this.Ft||n instanceof Yt&&this.Ft.isContainedBy(n))&&(this.Ft=null);super.qc(t,e,i,n,s,o,r)}updateAdornments(){}Xc(){}}var ge=(t=>(t[t.None=0]="None",t[t.Evenly=1]="Evenly",t[t.Packed=2]="Packed",t))(ge||{});class pe extends ce{v;Rt;kf;ol;xh;ne;ti;constructor(t,e){let i;void 0===t||t instanceof Xt||"string"==typeof t?i=t:t&&(e=t),super(i),this.v=13,this.Rt=null,this.ti=new l,this.kf=null,this.ol=null,this.ne=null,this.xh=!1,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.v=this.v,null!==this.Rt&&(this.Rt.fi?t.Rt=this.Rt:t.Rt=this.Rt.copy())}Ro(t){super.Ro(t),t.invalidateConnectedLinks(),t.ol=this.ol,t.ne=null}static SpreadingNone=0;static SpreadingEvenly=1;static SpreadingPacked=2;rl(){return null===this.Rt?this.Rt=new me:this.Rt.fi&&(this.Rt=this.Rt.copy()),this.Rt}ah(){super.ah(),null!==this.Rt&&(this.Rt.fi=!0)}dT(t){null!==t&&(null===this.ol&&(this.ol=new u),this.ol.add(t))}gT(t){null!==t&&null!==this.ol&&this.ol.delete(t)}mT(t,e,i){if(null===t||null===this.ol)return null;const n=this.ol.iterator;for(;n.next();){const s=n.value;if(s.ey===this&&s.m1===t&&s.rN===e&&s.lN===i||s.ey===t&&s.m1===this&&s.rN===i&&s.lN===e)return s}return null}invalidateLinkBundle(t,e,i){null==e&&(e=""),null==i&&(i="");const n=this.mT(t,e,i);null!==n&&n.Sd()}qc(t,e,i,n,s,o,r){(3===t&&"elements"===e||4===t&&"elements"===e)&&(this.ne=null),super.qc(t,e,i,n,s,o,r)}invalidateConnectedLinks(t){const e=this.linksConnected;for(;e.next();){const i=e.value;void 0!==t&&t.has(i)||(this.qi(i.fromPort),this.qi(i.toPort),i.invalidateRoute())}}bA(t){const e=this.linksConnected;for(;e.next();){const i=e.value;i.fromPort!==t&&i.toPort!==t||(this.qi(i.fromPort),this.qi(i.toPort),i.invalidateRoute())}}qi(t){if(null===t)return;const e=t.Gu;null!==e&&e.Sd();const i=t.part,n=i.containingGroup;null!==n&&!i.isVisible()&&n.qi(n.port)}Xr(){return!0}get portSpreading(){return null!==this.Rt?this.Rt.ny:1}set portSpreading(t){const e=this.portSpreading;if(e!==t){this.rl().ny=t,this.t("portSpreading",e,t);const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;this.invalidateConnectedLinks()}}get avoidable(){return 0!==(8&this.v)}set avoidable(t){const e=0!==(8&this.v);if(e!==t){this.v=8^this.v;const i=this.diagram;null!==i&&i.WM(this),this.t("avoidable",e,t)}}get avoidableMargin(){return null!==this.Rt?this.Rt.ly:b.PC}set avoidableMargin(t){"number"==typeof t&&(t=new b(t));const e=this.avoidableMargin;if(!e.equals(t)){t=t.P(),this.rl().ly=t;const i=this.diagram;null!==i&&i.WM(this),this.t("avoidableMargin",e,t)}}canAvoid(){return this.avoidable&&!this.isLinkLabel}getAvoidableRect(t){return t.set(this.actualBounds),t.addMargin(this.avoidableMargin),t}findVisibleNode(){let t=this;for(;null!==t&&!t.isVisible();)t=t.containingGroup;return t}isVisible(){if(!super.isVisible())return!1;let t=!0,e=1;const i=this.diagram;if(null!==i){if(i.animationManager.nx(this))return!0;t=i.isTreePathToChildren,e=i.treeCollapsePolicy}if(1===e){const t=this.findTreeParentNode();if(null!==t&&!t.isTreeExpanded)return!1}else if(2===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,n=!1;for(;e.next();){const s=e.value;if(s.isTreeLink){i=!0;const e=t?s.fromNode:s.toNode;if(e&&e.isTreeExpanded){n=!0;break}}}if(i&&!n)return!1}else if(3===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,n=!1;for(;e.next();){const s=e.value;if(s.isTreeLink){i=!0;const e=t?s.fromNode:s.toNode;if(e&&!e.isTreeExpanded){n=!0;break}}}if(i&&n)return!1}const n=this.labeledLink;return null===n||n.isVisible()}Ei(t){super.Ei(t);const e=this.linksConnected;for(;e.next();){const i=e.value;if(t&&null!==this.containingGroup){const t=i.getOtherNode(this);null!==t&&!t.isMemberOf(this.containingGroup)&&i.invalidateRoute()}i.Ei(t)}}get linksConnected(){return this.ti.iterator}findExternalTreeLinksConnected(){const t=new u,e=new u;return this.pT(this,t,e),e.iterator}pT(t,e,i){if(null===t||e.has(t))return;e.add(t);let n=!0;const s=this.diagram;null!==s&&(n=s.isTreePathToChildren),t.linksConnected.each((s=>{s.isTreeLink?(n?s.fromNode===t:s.toNode===t)&&this.pT(n?s.toNode:s.fromNode,e,i):i.add(s)}))}findLinksConnected(t){if(void 0===t&&(t=null),null===t)return this.ti.iterator;const e=new r(this.ti),i=this;return e.predicate=e=>e.fromNode===i&&e.fromPortId===t||e.toNode===i&&e.toPortId===t,e}findLinksOutOf(t){void 0===t&&(t=null);const e=new r(this.ti),i=this;return e.predicate=e=>e.fromNode===i&&(null===t||e.fromPortId===t),e}findLinksInto(t){void 0===t&&(t=null);const e=new r(this.ti),i=this;return e.predicate=e=>e.toNode===i&&(null===t||e.toPortId===t),e}findNodesConnected(t){void 0===t&&(t=null);let e=null,i=null;const n=this.ti.iterator;for(;n.next();){const s=n.value;if(s.fromNode===this){if(null===t||s.fromPortId===t){const t=s.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}else if(s.toNode===this&&(null===t||s.toPortId===t)){const t=s.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):s.instance}findNodesOutOf(t){void 0===t&&(t=null);let e=null,i=null;const n=this.ti.iterator;for(;n.next();){const s=n.value;if(s.fromNode===this&&(null===t||s.fromPortId===t)){const t=s.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):s.instance}findNodesInto(t){void 0===t&&(t=null);let e=null,i=null;const n=this.ti.iterator;for(;n.next();){const s=n.value;if(s.toNode===this&&(null===t||s.toPortId===t)){const t=s.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):s.instance}findLinksBetween(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const n=new r(this.ti),s=this;return n.predicate=n=>n.fromNode===s&&n.toNode===t&&(null===e||n.fromPortId===e)&&(null===i||n.toPortId===i)||n.fromNode===t&&n.toNode===s&&(null===i||n.fromPortId===i)&&(null===e||n.toPortId===e),n}findLinksTo(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const n=new r(this.ti),s=this;return n.predicate=n=>!(n.fromNode!==s||n.toNode!==t||null!==e&&n.fromPortId!==e||null!==i&&n.toPortId!==i),n}get linkConnected(){return null!==this.Rt?this.Rt.hy:null}set linkConnected(t){const i=this.linkConnected;i!==t&&(null!==t&&e.k(t,pe,"linkConnected"),this.rl().hy=t,this.t("linkConnected",i,t))}get linkDisconnected(){return null!==this.Rt?this.Rt.ay:null}set linkDisconnected(t){const i=this.linkDisconnected;i!==t&&(null!==t&&e.k(t,pe,"linkDisconnected"),this.rl().ay=t,this.t("linkDisconnected",i,t))}get linkValidation(){return null!==this.Rt?this.Rt.Sl:null}set linkValidation(t){const i=this.linkValidation;i!==t&&(null!==t&&e.k(t,pe,"linkValidation"),this.rl().Sl=t,this.t("linkValidation",i,t))}p1(t,e){this.qi(e);const i=this.ti.has(t);if(i||this.ti.add(t),!i||t.fromNode===t.toNode){const i=this.linkConnected;if(null!==i){let n=!0;const s=this.diagram;null!==s&&(n=s.X,s.X=!0),i(this,t,e),null!==s&&(s.X=n)}}if(!i){if(!t.isTreeLink)return;const e=t.fromNode,i=t.toNode;if(null!==e&&null!==i&&e!==i){let t=!0;const n=this.diagram;null!==n&&(t=n.isTreePathToChildren);const s=t?i:e,o=t?e:i;if(s.xh||(s.xh=o),o.isTreeLeaf){if(null!==n&&n.undoManager.isUndoingRedoing)return;t?e===o&&(o.isTreeLeaf=!1):i===o&&(o.isTreeLeaf=!1)}}}}w1(t,e){this.qi(e);const i=this.ti.delete(t);let n=null;if(i||t.toNode===t.fromNode){const i=this.linkDisconnected;if(n=this.diagram,null!==i){let s=!0;null!==n&&(s=n.X,n.X=!0),i(this,t,e),null!==n&&(n.X=s)}}if(i){if(!t.isTreeLink)return;let e=!0;null!==n&&(e=n.isTreePathToChildren);const i=e?t.toNode:t.fromNode,s=e?t.fromNode:t.toNode;if(null!==i&&(i.xh=!1),null!==s&&!s.isTreeLeaf)if(0===s.ti.count){if(s.xh=null,null!==n&&n.undoManager.isUndoingRedoing)return;s.isTreeLeaf=!0}else s.r0()}}r0(){if(this.xh=!1,0===this.ti.count)return;let t=!0;const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;null!==e&&(t=e.isTreePathToChildren);const i=this.ti.iterator;for(;i.next();){const e=i.value;if(e.isTreeLink)if(t){if(e.fromNode===this)return void(this.isTreeLeaf=!1)}else if(e.toNode===this)return void(this.isTreeLeaf=!1)}this.isTreeLeaf=!0}updateRelationshipsFromData(){const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}Rm(t){if(super.Rm(t),!t){this.r0();const t=this.kf;null!==t&&t.yT(this)}}vm(t){if(super.vm(t),!t){const t=this.kf;null!==t&&t.wT(this)}}Xc(){if(this.ti.count>0){const t=this.diagram;if(null!==t){const e=null===t.commandHandler||t.commandHandler.deletesConnectedLinks,i=this.ti.copy().iterator;for(;i.next();){const n=i.value;e?t.remove(n):(n.fromNode===this&&(n.fromNode=null),n.toNode===this&&(n.toNode=null))}}}this.labeledLink=null,super.Xc()}get isLinkLabel(){return null!==this.kf}get labeledLink(){return this.kf}set labeledLink(t){const e=this.kf;if(e!==t){const i=this.diagram,n=this.data;if(null!==e){if(e.wT(this),null!==i&&null!==n&&!i.undoManager.isUndoingRedoing){const t=e.data,s=i.model;if(null!==t&&s.Ra()){const e=s.getKeyForNodeData(n);void 0!==e&&s.removeLabelKeyForLinkData(t,e)}}this.containingGroup=null}if(this.kf=t,null!==t){if(t.yT(this),null!==i&&null!==n&&!i.undoManager.isUndoingRedoing){const e=t.data,s=i.model;if(null!==e&&s.Ra()){const t=s.getKeyForNodeData(n);void 0!==t&&s.addLabelKeyForLinkData(e,t)}}this.containingGroup=t.containingGroup}this.ef(),this.t("labeledLink",e,t)}}findVisiblePort(t){let e=t;for(;null!==e&&(!e.actualBounds.isReal()||!e.isVisibleObject());)e=e.panel;return null===e?this.port:e}findPort(t){if(null===this.ne){if(""===t&&!1===this.fn)return this;this.xT()}let e=this.ne.get(t);return null!==e||""!==t&&(e=this.ne.get(""),null!==e)?e:this}get port(){return this.findPort("")}get ports(){return null===this.ne&&this.xT(),this.ne.iteratorValues}xT(){null===this.ne?this.ne=new m:this.ne.clear(),this.walkVisualTreeFrom(this,((t,e)=>t.LA(e))),0===this.ne.count&&this.ne.set("",this)}LA(t){const e=t.portId;null!==e&&null!==this.ne&&this.ne.set(e,t)}N2(t,i){const n=t.portId;if(null!==n){null!==this.ne&&this.ne.delete(n);const t=this.diagram;if(null!==t&&i){let i=null;const s=this.findLinksConnected(n);for(;s.next();){const t=s.value;null===i&&(i=e.et()),i.push(t)}if(null!==i){for(let e=0;e<i.length;e++){const n=i[e];t.remove(n)}e.J(i)}}}}isInTreeOf(t){if(null===t||t===this)return!1;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);let n=this;const s=t;let o;if(e)for(;n!==s;){o=null;const t=n.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.fromNode,o!==n&&o!==this))break}if(o===this||null===o||o===n)return!1;n=o}else for(;n!==s;){o=null;const t=n.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.toNode,o!==n&&o!==this))break}if(o===this||null===o||o===n)return!1;n=o}return!0}findTreeRoot(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i,n=this;if(t)for(;;){i=null;const t=n.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.fromNode,i!==n&&i!==this))break}if(i===this)return this;if(null===i||i===n)return n;n=i}else for(;;){i=null;const t=n.ti.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.toNode,i!==n&&i!==this))break}if(i===this)return this;if(null===i||i===n)return n;n=i}}findCommonTreeParent(t){if(null===t)return null;if(this===t)return this;let e=this;for(;null!==e;)e.g1(!0),e=e.findTreeParentNode();let i=null;for(e=t;null!==e;){if(e.uT()){i=e;break}e=e.findTreeParentNode()}for(e=this;null!==e;)e.g1(!1),e=e.findTreeParentNode();return i}findTreeParentLink(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=this.ti.iterator;if(t)for(;i.next();){const t=i.value;if(t.isTreeLink&&t.fromNode!==this)return t}else for(;i.next();){const t=i.value;if(t.isTreeLink&&t.toNode!==this)return t}return null}findTreeParentNode(){const t=this.xh;if(null===t)return null;if(t instanceof pe)return t;const e=this.diagram,i=null===e||e.isTreePathToChildren,n=this.ti.iterator;for(;n.next();){const t=n.value;if(!t.isTreeLink)continue;const e=i?t.fromNode:t.toNode;if(e!==this)return this.xh=e,e}return this.xh=null,null}findTreeParentChain(){const t=new u;return function t(e,i){i.add(e);const n=e.findTreeParentLink();if(null!==n){i.add(n);const s=e.findTreeParentNode();if(null===s)return;t(s,i)}}(this,t),t}findTreeLevel(){return this.rO(this)}rO(t){let e=0,i=t.findTreeParentNode();for(;null!==i&&i!==t;)i=i.findTreeParentNode(),e++;return e}findTreeChildrenLinks(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=new r(this.ti),n=this;return i.predicate=t?t=>!(!t.isTreeLink||t.fromNode!==n):t=>!(!t.isTreeLink||t.toNode!==n),i}findTreeChildrenNodes(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i=null,n=null;const r=this.ti.iterator;if(t)for(;r.next();){const t=r.value;if(t.isTreeLink&&t.fromNode===this){const e=t.toNode;null!==i?i.add(e):null!==n&&n!==e?(i=new l,i.add(n),i.add(e)):n=e}}else for(;r.next();){const t=r.value;if(t.isTreeLink&&t.toNode===this){const e=t.fromNode;null!==i?i.add(e):null!==n&&n!==e?(i=new l,i.add(n),i.add(e)):n=e}}return null!==i?i.iterator:null!==n?new o(n):s.instance}findTreeParts(t){void 0===t&&(t=1/0),e.s(t,"number",pe,"findTreeParts:level");const i=new u;return ce.nh(i,this,!1,t,!0),i}collapseTree(t){void 0===t&&(t=1),t<1&&(t=1);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new u;i.add(this),this.bT(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}bT(t,e,i,n,s,o){if(i>1){const r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const l=a.getOtherNode(this);null!==l&&l!==this&&!t.has(l)&&(t.add(l),l.bT(t,e,i-1,n,s,o))}}else this.kT(t,e,n,s,o)}kT(t,e,i,n,s){const o=n===this||this.isTreeExpanded,r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const l=a.getOtherNode(this);if(null!==l&&l!==this){const r=t.has(l);if(r||t.add(l),o){const t=e?l.findNodesInto():l.findNodesOutOf(),s=this;t.all((t=>t===s||!t.isTreeExpanded))&&i.Lc(l,n),l.uh(),l.Ei(!1)}l.isTreeExpanded&&(l.wasTreeExpanded=l.isTreeExpanded,r||l.kT(t,e,i,n,s))}}this.isTreeExpanded=!1}expandTree(t){void 0===t&&(t=2),t<2&&(t=2);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new u;i.add(this),this.PT(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}PT(t,e,i,n,s,o){const r=s!==this&&this.isTreeExpanded,a=e?this.findLinksOutOf():this.findLinksInto();for(;a.next();){const l=a.value;if(!l.isTreeLink)continue;r||l.Se||l.invalidateRoute();const h=l.getOtherNode(this);if(null!==h&&h!==this&&!t.has(h)){if(t.add(h),!r){h.Ei(!0),h.uh();const t=e?h.findNodesInto():h.findNodesOutOf(),i=this;t.all((t=>t===i||!t.isTreeExpanded))&&n.Cc(h,s)}(i>2||h.wasTreeExpanded)&&(h.wasTreeExpanded=!1,h.PT(t,e,i-1,n,s,o))}}this.isTreeExpanded=!0}get isTreeExpanded(){return 0!==(1&this.v)}set isTreeExpanded(t){const e=0!==(1&this.v);if(e!==t){this.v=1^this.v;const i=this.diagram;this.t("isTreeExpanded",e,t);const n=this.treeExpandedChanged;if(null!==n){let t=!0;null!==i&&(t=i.X,i.X=!0),n(this),null!==i&&(i.X=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return void this.Ei(t);t?this.expandTree():this.collapseTree()}}get wasTreeExpanded(){return 0!==(2&this.v)}set wasTreeExpanded(t){const e=0!==(2&this.v);e!==t&&(this.v=2^this.v,this.t("wasTreeExpanded",e,t))}get treeExpandedChanged(){return null!==this.Rt?this.Rt.cy:null}set treeExpandedChanged(t){const i=this.treeExpandedChanged;i!==t&&(null!==t&&e.k(t,pe,"treeExpandedChanged"),this.rl().cy=t,this.t("treeExpandedChanged",i,t))}get isTreeLeaf(){return 0!==(4&this.v)}set isTreeLeaf(t){const e=0!==(4&this.v);e!==t&&(this.v=4^this.v,this.t("isTreeLeaf",e,t))}get isTreeRoot(){return null===this.findTreeParentLink()}}class me{fi;hy;ay;Sl;cy;ly;ny;fy;uy;eh;gy;constructor(){this.fi=!1,this.hy=null,this.ay=null,this.Sl=null,this.cy=null,this.ly=b.PC,this.ny=1,this.fy=null,this.uy=null,this.eh=null,this.gy=null}copy(){const t=new me;return t.hy=this.hy,t.ay=this.ay,t.Sl=this.Sl,t.cy=this.cy,t.ly=this.ly.P(),t.ny=this.ny,t.fy=this.fy,t.uy=this.uy,t.eh=this.eh,t.gy=this.gy,t}}var ye=(t=>(t[t.None=0]="None",t[t.End=17]="End",t[t.Scale=18]="Scale",t[t.Stretch=19]="Stretch",t))(ye||{}),xe=(t=>(t[t.Normal=1]="Normal",t[t.Orthogonal=2]="Orthogonal",t[t.AvoidsNodes=6]="AvoidsNodes",t[t.AvoidsNodesStraight=7]="AvoidsNodesStraight",t))(xe||{}),ve=(t=>(t[t.None=0]="None",t[t.Bezier=9]="Bezier",t[t.JumpGap=10]="JumpGap",t[t.JumpOver=11]="JumpOver",t))(ve||{});class be extends ce{Mt;eo;so;Md;no;oo;Nd;Pf;Cd;Ld;Ad;va;Td;Hs;xi;ll;xr;Sf;Ko;hN;aN;b1;cN;fN;Oa;k1;ot;Go;static Ia=null;static Ea=null;hf;uN;dN;constructor(t){super(Yt.Link),this.Mt=8,this.eo=null,this.so="",this.Md=null,this.no=null,this.oo="",this.Nd=null,this.Pf=0,this.Cd=0,this.Ld=0,this.Ad=NaN,this.va=1,this.Td=.5,this.Hs=null,this.xi=(new l).u(),this.ll=null,this.xr=null,this.Sf=new v,this.ot=new N,this.Ko=null,this.Go=null,this.hN=null,this.aN=null,this.uN=0,this.dN=0,this.b1=new y,this.cN=null,this.fN=null,this.Oa=null,this.k1=NaN,this.ct=null,this.hf=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Mt=-113&this.Mt,t.so=this.so,t.Md=this.Md,t.oo=this.oo,t.Nd=this.Nd,t.Pf=this.Pf,t.Cd=this.Cd,t.Ld=this.Ld,t.Ad=this.Ad,t.va=this.va,t.Td=this.Td,null!==this.ct&&(t.ct=this.ct.copy())}Ro(t){super.Ro(t),this.so=t.so,this.oo=t.oo,t.ll=null,t.invalidateRoute(),t.Go=this.Go;const e=t.fromPort;null!==e&&t.fromNode.qi(e);const i=t.toPort;null!==i&&t.toNode.qi(i)}oi(t){t in xe||t in ve||t in ye?be.gN(t)?this.routing=t:9===t||10===t||11===t?this.curve=t:17===t||18===t||19===t?this.adjusting=t:1===t||0===t||e.o("Unknown Link enum value for a Link property: "+t):super.oi(t)}static Normal=1;static Orthogonal=2;static AvoidsNodes=6;static AvoidsNodesStraight=7;static None=0;static Bezier=9;static JumpGap=10;static JumpOver=11;static End=17;static Scale=18;static Stretch=19;static OrientAlong=21;static OrientPlus90=22;static OrientMinus90=23;static OrientOpposite=24;static OrientUpright=25;static OrientPlus90Upright=26;static OrientMinus90Upright=27;static OrientUpright45=28;static lO=8;static hO=16;static aO=14;static Ba=8;Ue(){return null===this.ct&&(this.ct=new Me),this.ct}xv(t,i,n){const s=t.segmentIndex,o=t.segmentFraction;let r=t.alignmentFocus;const a=t.segmentOrientation,l=t.segmentOffset;let h=0,u=0,c=0,d=0;if(isNaN(s)){const i=this.ot,n=e.et();i.getPointAndAngleAlongPath(o,n);const s=y.V(n[0],n[1]);if(s.add(this.getPoint(0)),1===i.type)s.offset(-i.startX,-i.startY);else{const t=i.figures.first();s.offset(-t.startX,-t.startY)}d=n[2],0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),h=s.x,u=s.y,y.e(s),e.J(n)}else if(s<-i||s>=i){const e=y.l();this.OA(e),d=this.midAngle,0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),h=e.x,u=e.y,y.e(e)}else{let e,r,l=0;if(s>=0?(e=n.r[s],r=s<i-1?n.r[s+1]:e):(l=i+s,e=n.r[l],r=l>0?n.r[l-1]:e),e.equalsApprox(r)){let t,o;s>=0?(t=s>0?n.r[s-1]:e,o=s<i-2?n.r[s+2]:r):(t=l<i-1?n.r[l+1]:e,o=l>1?n.r[l-2]:r);const a=t.distanceSquaredPoint(e),h=r.distanceSquaredPoint(o);d=a>h+10?s>=0?t.directionPoint(e):e.directionPoint(t):h>a+10?s>=0?r.directionPoint(o):o.directionPoint(r):s>=0?t.directionPoint(o):o.directionPoint(t)}else d=s>=0?e.directionPoint(r):r.directionPoint(e);0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),h=e.x+(r.x-e.x)*o,u=e.y+(r.y-e.y)*o}if(r.isNone())return void(t.location=new y(h,u));r.isNoSpot()&&(r=w.Center);const f=k.l();f.Ri(),f.tt(t.scale,t.scale),f.cs(t.angle,0,0);const g=t.naturalBounds,p=v.V(0,0,g.width,g.height),m=y.l();m.setRectSpot(p,r),f.gt(m);let x=-m.x,b=-m.y;const S=g.width,P=g.height,M=y.l();M.a(l);const C=isNaN(l.x),N=isNaN(l.y);if(C||N){const t=S/2+3,e=P/2+3,i=d>=45&&d<=135,n=d>=225&&d<=315;0===a&&(i||n)?(M.x=N?t:l.y,M.y=C?e:l.x,i?s>=0||isNaN(s)&&o<.5||C&&(M.y=-e):n&&((s>=0||isNaN(s)&&o<.5)&&C&&(M.y=-e),N&&(M.x=-t))):(C&&(s>=0||isNaN(s)&&o<.5?M.x=t:M.x=-t),N&&(M.y=-e),M.rotate(d))}else M.rotate(d);h+=M.x,u+=M.y,f.vg(p),x+=p.x,b+=p.y;const T=y.V(h+x,u+b);t.move(T),y.e(T),y.e(M),y.e(m),v.e(p),k.e(f)}Xr(){let t=this.fromNode;if(null!==t){const e=t.findVisibleNode();if(null!==e&&(t=e),t._e()||t.th())return!1}let e=this.toNode;if(null!==e){const t=e.findVisibleNode();if(null!==t&&(e=t),e._e()||e.th())return!1}return!0}S2(t,e,i){return!1}M2(){}ke(){return!1}computeAngle(t,e,i){return be.computeAngle(e,i)}static computeAngle(t,e){let i=0;switch(t){default:case 0:i=0;break;case 21:i=e;break;case 22:i=e+90;break;case 23:i=e-90;break;case 24:i=e+180;break;case 25:i=S.Bg(e),i>90&&i<270&&(i-=180);break;case 26:i=S.Bg(e+90),i>90&&i<270&&(i-=180);break;case 27:i=S.Bg(e-90),i>90&&i<270&&(i-=180);break;case 28:if(i=S.Bg(e),i>45&&i<135||i>225&&i<315)return 0;i>90&&i<270&&(i-=180)}return S.Bg(i)}get fromNode(){return this.eo}set fromNode(t){const e=this.eo;if(e!==t){const i=this.fromPort;null!==e&&(this.no!==e&&e.w1(this,i),this.my(),this.invalidateLayout(2)),this.eo=t,null!==t&&this.Ei(t.isVisible()),this.Ko=null,this.invalidateRoute();const n=this.diagram;null!==n&&n.X&&n.partManager.setFromNodeForLink(this,t,e);const s=this.fromPort,o=this.fromPortChanged;if(null!==o){let t=!0;null!==n&&(t=n.X,n.X=!0),o(this,i,s),null!==n&&(n.X=t)}null!==t&&(this.no!==t&&t.p1(this,s),this.yy(),this.invalidateLayout(1)),this.t("fromNode",e,t),this.Pd()}}get fromPortId(){return this.so}set fromPortId(t){const e=this.so;if(e!==t){const i=this.fromPort;null!==i&&this.fromNode?.qi(i),this.my(),this.so=t;const n=this.fromPort;null!==n&&this.fromNode?.qi(n);const s=this.diagram;if(null!==s){const e=this.data,i=s.model;null!==e&&i.Ra()&&i.setFromPortIdForLinkData(e,t)}if(i!==n){this.Ko=null,this.invalidateRoute();const t=this.fromPortChanged;if(null!==t){let e=!0;null!==s&&(e=s.X,s.X=!0),t(this,i,n),null!==s&&(s.X=e)}}this.yy(),this.t("fromPortId",e,t)}}get fromPort(){const t=this.eo;if(null===t)return null;const e=this.so;return t.findPort(e)}get fromPortChanged(){return this.Md}set fromPortChanged(t){const i=this.Md;i!==t&&(null!==t&&e.k(t,be,"fromPortChanged"),this.Md=t,this.t("fromPortChanged",i,t))}get toNode(){return this.no}set toNode(t){const e=this.no;if(e!==t){const i=this.toPort;null!==e&&(this.eo!==e&&e.w1(this,i),this.my(),this.invalidateLayout(2)),this.no=t,null!==t&&this.Ei(t.isVisible()),this.Ko=null,this.invalidateRoute();const n=this.diagram;null!==n&&n.X&&n.partManager.setToNodeForLink(this,t,e);const s=this.toPort,o=this.toPortChanged;if(null!==o){let t=!0;null!==n&&(t=n.X,n.X=!0),o(this,i,s),null!==n&&(n.X=t)}null!==t&&(this.eo!==t&&t.p1(this,s),this.yy(),this.invalidateLayout(1)),this.t("toNode",e,t),this.Pd()}}get toPortId(){return this.oo}set toPortId(t){const e=this.oo;if(e!==t){const i=this.toPort;null!==i&&this.toNode?.qi(i),this.my(),this.oo=t;const n=this.toPort;null!==n&&this.toNode?.qi(n);const s=this.diagram;if(null!==s){const e=this.data,i=s.model;null!==e&&i.Ra()&&i.setToPortIdForLinkData(e,t)}if(i!==n){this.Ko=null,this.invalidateRoute();const t=this.toPortChanged;if(null!==t){let e=!0;null!==s&&(e=s.X,s.X=!0),t(this,i,n),null!==s&&(s.X=e)}}this.yy(),this.t("toPortId",e,t)}}get toPort(){const t=this.no;if(null===t)return null;const e=this.oo;return t.findPort(e)}get toPortChanged(){return this.Nd}set toPortChanged(t){const i=this.Nd;i!==t&&(null!==t&&e.k(t,be,"toPortChanged"),this.Nd=t,this.t("toPortChanged",i,t))}get fromSpot(){return null!==this.ct?this.ct.ga:w.Default}set fromSpot(t){const e=this.fromSpot;if(!e.equals(t)){if(t=t.P(),this.Ue().ga=t,this.t("fromSpot",e,t),e.isSide()||t.isSide()){const t=this.fromNode;null!==t&&t.qi(this.fromPort)}this.invalidateRoute()}}get fromEndSegmentLength(){return null!==this.ct?this.ct.pa:NaN}set fromEndSegmentLength(t){const i=this.fromEndSegmentLength;if(i!==t){if(t<0&&e.W(t,">= 0",be,"fromEndSegmentLength"),this.Ue().pa=t,this.t("fromEndSegmentLength",i,t),this.computeSpot(!0,this.fromPort).isSide()){const t=this.fromNode;null!==t&&t.qi(this.fromPort)}this.invalidateRoute()}}get fromShortLength(){return null!==this.ct?this.ct.wa:NaN}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Ue().wa=t,this.ee(),this.t("fromShortLength",e,t))}get toSpot(){return null!==this.ct?this.ct.ma:w.Default}set toSpot(t){const e=this.toSpot;if(!e.equals(t)){if(t=t.P(),this.Ue().ma=t,this.t("toSpot",e,t),e.isSide()||t.isSide()){const t=this.toNode;null!==t&&t.qi(this.toPort)}this.invalidateRoute()}}get toEndSegmentLength(){return null!==this.ct?this.ct.ya:NaN}set toEndSegmentLength(t){const i=this.toEndSegmentLength;if(i!==t){if(t<0&&e.W(t,">= 0",be,"toEndSegmentLength"),this.Ue().ya=t,this.t("toEndSegmentLength",i,t),this.computeSpot(!1,this.toPort).isSide()){const t=this.toNode;null!==t&&t.qi(this.toPort)}this.invalidateRoute()}}get toShortLength(){return null!==this.ct?this.ct.xa:NaN}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Ue().xa=t,this.ee(),this.t("toShortLength",e,t))}Pd(){const t=this.fromNode,e=this.toNode;let i=null;if(i=null!==t?null!==e?t.findCommonContainingGroup(e):t.containingGroup:null!==e?e.containingGroup:null,this.cO(i),this.isLabeledLink){const t=this.labelNodes;for(;t.next();){t.value.containingGroup=i}}}cO(t){const e=this.wh;if(e!==t){null!==e&&e.iN(this),this.wh=t,null!==t&&t.eN(this);const i=this.containingGroupChanged;if(null!==i){let n=!0;const s=this.diagram;null!==s&&(n=s.X,s.X=!0),i(this,e,t),null!==s&&(s.X=n)}this.Se&&(this.cN===e||this.fN===e)&&this.invalidateRoute()}}uh(){const t=this.containingGroup;null!==t&&this.fromNode!==t&&this.toNode!==t&&t.computesBoundsIncludingLinks&&super.uh()}getOtherNode(t){const e=this.fromNode;return t===e?this.toNode:e}getOtherPort(t){const e=this.fromPort;return t===e?this.toPort:e}get isLabeledLink(){return null!==this.Hs&&this.Hs.count>0}get labelNodes(){return null===this.Hs?s.instance:this.Hs.iterator}yT(t){null===this.Hs&&(this.Hs=new u),this.Hs.add(t),this.c()}wT(t){null!==this.Hs&&(this.Hs.delete(t),this.c())}Rm(t){if(super.Rm(t),this.Ua()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.eo;let e=null;null!==t&&(e=this.fromPort,t.p1(this,e));const i=this.no;let n=null;null!==i&&(n=this.toPort,(i!==t||n!==e)&&i.p1(this,n)),this.yy()}}vm(t){if(super.vm(t),this.Ua()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.eo;let e=null;null!==t&&(e=this.fromPort,t.w1(this,e));const i=this.no;let n=null;null!==i&&(n=this.toPort,(i!==t||n!==e)&&i.w1(this,n)),this.my()}}Xc(){if(this.Se=!0,null!==this.Hs){const t=this.diagram;if(null!==t){const e=this.Hs.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}if(null!==this.data){const t=this.diagram;null!==t&&t.partManager.mN(this)}}updateRelationshipsFromData(){if(null===this.data)return;const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}move(t,e){const i=e?this.location:this.position;let n=i.x;isNaN(n)&&(n=0);let s=i.y;isNaN(s)&&(s=0);const o=t.x-n,r=t.y-s;if(!0===e)super.move(t,!1);else{const t=y.V(i.x+o,i.y+r);super.move(t,!1),y.e(t)}this.cr(o,r);const a=this.labelNodes;for(;a.next();){const t=a.value,e=t.position;t.moveTo(e.x+o,e.y+r)}}get relinkableFrom(){return 0!==(1&this.Mt)}set relinkableFrom(t){const e=0!==(1&this.Mt);e!==t&&(this.Mt=1^this.Mt,this.t("relinkableFrom",e,t),this.invalidateAdornments())}get relinkableTo(){return 0!==(2&this.Mt)}set relinkableTo(t){const e=0!==(2&this.Mt);e!==t&&(this.Mt=2^this.Mt,this.t("relinkableTo",e,t),this.invalidateAdornments())}canRelinkFrom(){if(!this.relinkableFrom)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}canRelinkTo(){if(!this.relinkableTo)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}get resegmentable(){return 0!==(4&this.Mt)}set resegmentable(t){const e=0!==(4&this.Mt);e!==t&&(this.Mt=4^this.Mt,this.t("resegmentable",e,t),this.invalidateAdornments())}get isTreeLink(){return 0!==(8&this.Mt)}set isTreeLink(t){const e=0!==(8&this.Mt);e!==t&&(this.Mt=8^this.Mt,this.t("isTreeLink",e,t),null!==this.fromNode&&this.fromNode.r0(),null!==this.toNode&&this.toNode.r0())}get path(){const t=this.findMainElement();return t instanceof Jt?t:null}get routeBounds(){return this.updateRoute(),this.fO(this.Sf)}fO(t){let e=1/0,i=1/0;const n=this.pointsCount;if(0===n)return t.i(NaN,NaN,0,0),t;if(1===n){const n=this.getPoint(0);e=Math.min(n.x,e),i=Math.min(n.y,i),t.i(n.x,n.y,0,0)}else if(2===n){const n=this.getPoint(0),s=this.getPoint(1);e=Math.min(n.x,s.x),i=Math.min(n.y,s.y),t.i(n.x,n.y,0,0),t.unionPoint(s)}else if(9===this.computeCurve()&&n>=3&&!this.isOrthogonal){let s=this.getPoint(0);if(e=s.x,i=s.y,t.i(e,i,0,0),3===n){const n=this.getPoint(1);e=Math.min(n.x,e),i=Math.min(n.y,i);const o=this.getPoint(2);e=Math.min(o.x,e),i=Math.min(o.y,i),S.ou(s.x,s.y,n.x,n.y,n.x,n.y,o.x,o.y,.5,t)}else for(let o=3;o<n;o+=3){const r=this.getPoint(o-2);o+3>=n&&(o=n-1);const a=this.getPoint(o-1),l=this.getPoint(o);S.ou(s.x,s.y,r.x,r.y,a.x,a.y,l.x,l.y,.5,t),e=Math.min(l.x,e),i=Math.min(l.y,i),s=l}}else{const s=this.getPoint(0),o=this.getPoint(1);e=Math.min(s.x,o.x),i=Math.min(s.y,o.y),t.i(s.x,s.y,0,0),t.unionPoint(o);for(let r=2;r<n;r++){const n=this.getPoint(r);e=Math.min(n.x,e),i=Math.min(n.y,i),t.unionPoint(n)}}return this.b1.i(e-t.x,i-t.y),t}get midPoint(){return this.updateRoute(),this.computeMidPoint(new y)}OA(t){return this.updateRoute(),this.computeMidPoint(t)}computeMidPoint(t){const e=this.pointsCount;if(0===e)return t.a(y.Ok),t;if(1===e)return t.a(this.getPoint(0)),t;if(2===e){const e=this.getPoint(0),i=this.getPoint(1);return t.i((e.x+i.x)/2,(e.y+i.y)/2),t}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve())){this.ot.getPointAlongPath(.5,t),t.add(this.getPoint(0));const e=this.ot.figures.first();return t.offset(-e.startX,-e.startY),t}if(9===this.computeCurve()){if(3===e){const e=this.getPoint(0),i=this.getPoint(1),n=this.getPoint(2);return S.AC(e.x,e.y,i.x,i.y,i.x,i.y,n.x,n.y,t),t}const i=(e-1)/3|0,n=3*(i/2|0);if(i%2===1){const e=this.getPoint(n),i=this.getPoint(n+1),s=this.getPoint(n+2),o=this.getPoint(n+3);return S.AC(e.x,e.y,i.x,i.y,s.x,s.y,o.x,o.y,t),t}return t.a(this.getPoint(n)),t}const i=this.flattenedLengths,n=this.flattenedTotalLength;let s=0,o=0,r=0;for(;s<n/2&&o<e&&(r=i[o],!(s+r>n/2));)s+=r,o++;const a=this.getPoint(o),l=this.getPoint(o+1);if(Math.abs(a.x-l.x)<1)a.y>l.y?t.i(a.x,a.y-(n/2-s)):t.i(a.x,a.y+(n/2-s));else if(Math.abs(a.y-l.y)<1)a.x>l.x?t.i(a.x-(n/2-s),a.y):t.i(a.x+(n/2-s),a.y);else{const e=(n/2-s)/r,i=e*(l.x-a.x),o=e*(l.y-a.y);t.i(a.x+i,a.y+o)}return t}get midAngle(){return this.updateRoute(),this.computeMidAngle()}computeMidAngle(){const t=this.pointsCount;if(t<2)return NaN;if(2===t){const t=this.getPoint(0),e=this.getPoint(1);return t.directionPoint(e)}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve()))return this.ot.getAngleAlongPath(.5);if(9===this.computeCurve()&&t>=4){const e=(t-1)/3|0;let i=3*(e/2|0);if(e%2===1){i=Math.floor(i);const t=this.getPoint(i),e=this.getPoint(i+1),n=this.getPoint(i+2),s=this.getPoint(i+3);return S.QD(t.x,t.y,e.x,e.y,n.x,n.y,s.x,s.y)}if(i>0&&i+1<t){const t=this.getPoint(i-1),e=this.getPoint(i+1);return t.directionPoint(e)}}const e=this.flattenedLengths,i=this.flattenedTotalLength;let n=0,s=0,o=0;for(;n<i/2&&s<t&&(o=e[s],!(n+o>i/2));)n+=o,s++;const r=this.getPoint(s),a=this.getPoint(s+1);if(Math.abs(r.x-a.x)<1&&Math.abs(r.y-a.y)<1){if(s>0&&s+2<t){const t=this.getPoint(s-1),e=this.getPoint(s+2);return t.directionPoint(e)}}else{if(Math.abs(r.x-a.x)<1)return r.y>a.y?270:90;if(Math.abs(r.y-a.y)<1)return r.x>a.x?180:0}return r.directionPoint(a)}get flattenedLengths(){return null!==this.Oa?this.Oa:(this.Se||this.P1(),this.uO())}get flattenedTotalLength(){let t=this.k1;if(isNaN(t)){const e=this.flattenedLengths,i=e.length;t=0;for(let n=0;n<i;n++)t+=e[n];this.k1=t}return t}uO(){null===this.Oa?this.Oa=[]:this.Oa.length=0;const t=this.Oa,e=this.pointsCount;for(let i=0;i<e-1;i++){let e=0;const n=this.getPoint(i),s=this.getPoint(i+1);S.z(n.x,s.x)?(e=s.y-n.y,e<0&&(e=-e),t.push(e)):S.z(n.y,s.y)?(e=s.x-n.x,e<0&&(e=-e),t.push(e)):(e=Math.sqrt(n.distanceSquaredPoint(s)),t.push(e))}return t}get points(){return this.xi}set points(t){const i=this.xi;if(i===t)return;let n=null;if(Array.isArray(t)){const i=t;let s=i.length%2===0;if(s)for(let t=0;t<i.length;t++)if("number"!=typeof i[t]||isNaN(i[t])){s=!1;break}if(s){n=new l;for(let t=0;t<i.length/2;t++){const e=new y(i[2*t],i[2*t+1]).u();n.add(e)}}else{let t=!0;for(let n=0;n<i.length;n++){const s=i[n];if(!e.K(s)||"number"!=typeof s.x||isNaN(s.x)||"number"!=typeof s.y||isNaN(s.y)){t=!1;break}}if(t){n=new l;for(let t=0;t<i.length;t++){const e=i[t];n.add(new y(e.x,e.y).u())}}}}else if(t instanceof l){n=t.copy();const e=n.iterator;for(;e.next();)e.value.u()}else e.o("Link.points value is not an instance of List or Array: "+t);if(null===n)return;n.u(),this.xi=n,this.ee(),this.P1();const s=this.diagram;null!==s&&(!s.Uh&&!s.undoManager.isUndoingRedoing&&s.wx.add(this),s.animationManager.pi&&s.animationManager.US(this,n)),this.t("points",i,n)}get pointsCount(){return this.xi.count}getPoint(t){return this.xi.r[t]}setPoint(t,e){this.xi.setElt(t,e)}setPointAt(t,e,i){this.xi.setElt(t,new y(e,i))}insertPoint(t,e){this.xi.insertAt(t,e)}insertPointAt(t,e,i){this.xi.insertAt(t,new y(e,i))}addPoint(t){this.xi.add(t)}addPointAt(t,e){this.xi.add(new y(t,e))}removePoint(t){this.xi.removeAt(t)}clearPoints(){this.xi.clear()}cr(t,e){if(0===t&&0===e)return;if(0===this.pointsCount)return this.defaultFromPoint&&this.defaultFromPoint.offset(t,e),void(this.defaultToPoint&&this.defaultToPoint.offset(t,e));const i=this.Se,n=new l,s=this.xi.iterator;for(;s.next();){const i=s.value;n.add(new y(i.x+t,i.y+e).u())}n.u();const o=this.xi;this.xi=n;const r=this.diagram;isNaN(t)||isNaN(e)||null!==r&&r.animationManager.pi?this.c():(this.Gs.i(this.Gs.x+t,this.Gs.y+e),this.at.i(this.at.x+t,this.at.y+e),this.ef()),i?this.P1():(this.defaultFromPoint&&(this.defaultFromPoint=this.getPoint(0)),this.defaultToPoint&&(this.defaultToPoint=this.getPoint(this.pointsCount-1))),null!==r&&r.animationManager.pi&&r.animationManager.US(this,n),this.t("points",o,n)}startRoute(){null===this.ll&&(this.ll=this.xi,this.xi=this.xi.copy())}commitRoute(){if(null===this.ll)return;const t=this.ll,e=this.xi;let i=1/0,n=1/0;const s=t.r,o=s.length;for(let c=0;c<o;c++){const t=s[c];i=Math.min(t.x,i),n=Math.min(t.y,n)}let r=1/0,a=1/0;const l=e.r,h=l.length;for(let c=0;c<h;c++){const t=l[c];r=Math.min(t.x,r),a=Math.min(t.y,a),t.u()}if(e.u(),h===o)for(let c=0;c<h;c++){const t=s[c],e=l[c];if(t.x-i!==e.x-r||t.y-n!==e.y-a){this.ee();break}}else this.ee();this.ll=null;const u=this.diagram;null!==u&&u.animationManager.pi&&u.animationManager.US(this,e),this.P1(),this.t("points",t,e)}rollbackRoute(){null!==this.ll&&(this.xi=this.ll,this.ll=null)}BF(){null!==this.xr&&(this.points=this.xr,this.xr=null)}P1(){0!==this.xi.count?(this.Se=!0,this.Oa=null,this.k1=NaN,this.defaultFromPoint=this.getPoint(0),this.defaultToPoint=this.getPoint(this.pointsCount-1),this.S1(!1)):this.Se=!1}invalidateRoute(){if(this.suspendsRouting)return;const t=this.path;if(null===t)return;const e=this.diagram;if(e){if(e.wx.has(this)||e.undoManager.isUndoingRedoing)return;const t=e.animationManager;if(t.isTicking&&!t.isAnimating)return;null!==this.xr&&!t.isTicking&&(this.xr=null)}this.Se=!1,this.c(),t.c()}get Se(){return 0!==(16&this.Mt)}set Se(t){0!==(16&this.Mt)!==t&&(this.Mt=16^this.Mt)}get suspendsRouting(){return 0!==(32&this.Mt)}set suspendsRouting(t){0!==(32&this.Mt)!==t&&(this.Mt=32^this.Mt)}get wy(){return 0!==(64&this.Mt)}set wy(t){0!==(64&this.Mt)!==t&&(this.Mt=64^this.Mt)}get pN(){return 0!==(512&this.Mt)}set pN(t){0!==(512&this.Mt)!==t&&(this.Mt=512^this.Mt)}get defaultFromPoint(){return this.hN}set defaultFromPoint(t){this.hN=null!==t?t.copy():null}get defaultToPoint(){return this.aN}set defaultToPoint(t){this.aN=null!==t?t.copy():null}updateRoute(){if(this.Se||this.wy)return;let t=!0;try{this.wy=!0,this.startRoute(),t=this.computePoints()}catch{this.wy=!1,this.rollbackRoute()}finally{this.wy=!1,t?this.commitRoute():this.rollbackRoute()}}computePoints(){const t=this.diagram;if(null===t)return!1;let e=this.fromNode,i=null;if(null===e?(be.Ia||(be.Ia=new pe,be.Ia.desiredSize=x.sc,be.Ia.ensureBounds()),this.defaultFromPoint&&(be.Ia.location=this.defaultFromPoint,be.Ia.ensureBounds(),e=be.Ia,i=be.Ia)):i=this.fromPort,null!==i&&!e.isVisible()){const t=e.findVisibleNode();null!==t&&t!==e?(e=t,i=t.port):e=t}if(this.cN=e,null===e||!e.location.isReal()||null===i||(i=e.findVisiblePort(i),null===i))return!1;let n=this.toNode,s=null;if(null===n?(be.Ea||(be.Ea=new pe,be.Ea.desiredSize=x.sc,be.Ea.ensureBounds()),this.defaultToPoint&&(be.Ea.location=this.defaultToPoint,be.Ea.ensureBounds(),n=be.Ea,s=be.Ea)):s=this.toPort,null!==s&&!n.isVisible()){const t=n.findVisibleNode();null!==t&&t!==n?(n=t,s=t.port):n=t}if(this.fN=n,null===n||!n.location.isReal()||null===s||(s=n.findVisiblePort(s),null===s))return!1;const o=this.pointsCount,r=this.computeSpot(!0,i),a=this.computeSpot(!1,s),l=this.Dd(r),h=this.Dd(a),u=i===s&&null!==i,c=this.isOrthogonal;let d=9===this.curve;u&&!c?(d=!0,this.Ko=!0):this.Ko=!1;const f=0===this.computeAdjusting()||u;if(!c&&!u&&l&&h){let t=!1;if(!f&&o>=3){let l=this.getLinkPoint(e,i,r,!0,!1,n,s),h=this.getLinkPoint(n,s,a,!1,!1,e,i);t=this.adjustPoints(0,l,o-1,h),t&&(l=this.getLinkPoint(e,i,r,!0,!1,n,s),h=this.getLinkPoint(n,s,a,!1,!1,e,i),this.adjustPoints(0,l,o-1,h))}t||(this.clearPoints(),d?this.dO(e,i,r,n,s,a):this.gO(e,i,r,n,s,a))}else{const t=this.isAvoiding;f&&(c&&t||u)&&this.clearPoints();const d=u?this.computeCurviness():0,g=this.getLinkPoint(e,i,r,!0,c,n,s);let p=0,m=0,x=0;if(c||!l||u){let t=this.computeEndSegmentLength(e,i,r,!0);if(x=this.getLinkDirection(e,i,g,r,!0,c,n,s),u&&(l||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(x-=c?90:30,d<0&&(x-=180)),x<0?x+=360:x>=360&&(x-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===x?p=t:90===x?m=t:180===x?p=-t:270===x?m=-t:(p=t*Math.cos(x*Math.PI/180),m=t*Math.sin(x*Math.PI/180)),r.isNoSpot()&&u){const t=i.getDocumentPoint(w.Center,y.l()),n=y.V(t.x+1e3*p,t.y+1e3*m);this.getLinkPointFromPoint(e,i,t,n,!0,g),y.e(t),y.e(n)}}const v=this.getLinkPoint(n,s,a,!1,c,e,i);let b=0,k=0,S=0;if(c||!h||u){let t=this.computeEndSegmentLength(n,s,a,!1);if(S=this.getLinkDirection(n,s,v,a,!1,c,e,i),u&&(h||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(S+=c?0:30,d<0&&(S+=180)),S<0?S+=360:S>=360&&(S-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===S?b=t:90===S?k=t:180===S?b=-t:270===S?k=-t:(b=t*Math.cos(S*Math.PI/180),k=t*Math.sin(S*Math.PI/180)),a.isNoSpot()&&u){const t=s.getDocumentPoint(w.Center,y.l()),e=y.V(t.x+1e3*b,t.y+1e3*k);this.getLinkPointFromPoint(n,s,t,e,!1,v),y.e(t),y.e(e)}}let P=g;(c||!l||u)&&(P=new y(g.x+p,g.y+m));let M=v;(c||!h||u)&&(M=new y(v.x+b,v.y+k)),!f&&!c&&l&&o>3&&this.adjustPoints(0,g,o-2,M)?this.setPoint(o-1,v):!f&&!c&&h&&o>3&&this.adjustPoints(1,P,o-1,v)?this.setPoint(0,g):!f&&(c?o>=6:o>4)&&this.adjustPoints(1,P,o-2,M)?(this.setPoint(0,g),this.setPoint(o-1,v)):(this.clearPoints(),this.addPoint(g),(c||!l||u)&&this.addPoint(P),c&&this.addOrthoPoints(P,x,M,S,e,n),(c||!h||u)&&this.addPoint(M),this.addPoint(v))}return t.addInvalidRoute(this),!0}yN(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?(e.x>=t.x?e.x=t.x+9e9:e.x=t.x-9e9,e.y=t.y):(e.y>=t.y?e.y=t.y+9e9:e.y=t.y-9e9,e.x=t.x),e}getLinkPointFromPoint(t,e,i,n,s,o){if(void 0===o&&(o=new y),null===t||null===e)return o.a(i),o;if(!t.isVisible()){const i=t.findVisibleNode();null!==i&&i!==t&&(e=(t=i).port)}let r=0,a=0,l=0,h=0,u=null,c=e.panel;if(null!==c&&!c.an()&&(c=c.panel),null===c)r=n.x,a=n.y,l=i.x,h=i.y;else{u=c.Bs;const t=1/(u.m11*u.m22-u.m12*u.m21),e=u.m22*t,s=-u.m12*t,o=-u.m21*t,d=u.m11*t,f=t*(u.m21*u.dy-u.m22*u.dx),g=t*(u.m12*u.dx-u.m11*u.dy);r=n.x*e+n.y*o+f,a=n.x*s+n.y*d+g,l=i.x*e+i.y*o+f,h=i.x*s+i.y*d+g}return e.Jc(r,a,l,h,o),null!==u&&o.T(u),o}mO(t,e){const i=t.Gu;return null!==i?i.ST(e):null}M1(t){if(null===t)return null;let e=t.Gu;return null===e&&(e=new Se(t.part,t),t.Gu=e),e.ST(this)}getLinkPoint(t,e,i,n,s,o,r,a){if(void 0===a&&(a=new y),i.isSpot()&&!this.Dd(i))return e.getDocumentPoint(i,a),a;if(i.isSide()){const l=this.M1(e);if(null!==l){const h=l.Fd;if(a.a(h),s&&7===this.routing){const h=this.M1(r);if(null!==h&&l.Mf<h.Mf){const l=y.l(),h=y.l(),u=new v(e.getDocumentPoint(w.TopLeft,l),e.getDocumentPoint(w.BottomRight,h)),c=this.computeSpot(!n,r),d=this.getLinkPoint(o,r,c,!n,s,t,e,h);(i.includesSide(w.LeftSide)||i.includesSide(w.RightSide))&&d.y>=u.y&&d.y<=u.y+u.height?a.y=d.y:(i.includesSide(w.TopSide)||i.includesSide(w.BottomSide))&&d.x>=u.x&&d.x<=u.x+u.width&&(a.x=d.x),y.e(l),y.e(h)}}return a}}const l=e.getDocumentPoint(this.N1(i,n),y.l());let h=null;if(this.pointsCount>(s?6:2))h=n?this.getPoint(1):this.getPoint(this.pointsCount-2),s&&(h=this.yN(l,h.copy()));else{const t=this.computeSpot(!n,r),e=y.l();h=r.getDocumentPoint(this.N1(t,!n),e),s&&(h=this.yN(l,h)),y.e(e)}return this.getLinkPointFromPoint(t,e,l,h,n,a),y.e(l),a}getLinkDirection(t,e,i,n,s,o,r,a){let l=this.pO(t,e,i,n,s,o,r,a);if(r&&n.isNoSpot()&&r.isMemberOf(t)&&(l+=180,l>=360&&(l-=360)),this.Dd(n)||null===e)return l;const h=e.getDocumentAngle();return 0===h||(45<=h&&h<135?l+=90:135<=h&&h<225?l+=180:225<=h&&h<315&&(l+=270),l>=360&&(l-=360)),l}pO(t,e,i,n,s,o,r,a){if(n.isSpot())return n.x>n.y?n.x>1-n.y?0:n.x<1-n.y?270:315:n.x<n.y?n.x>1-n.y?90:n.x<1-n.y?180:135:n.x<.5?225:n.x>.5?45:0;if(n.isSide()){const t=this.M1(e);if(null===t)return n.includesSide(w.TopSide)?270:n.includesSide(w.BottomSide)?90:n.includesSide(w.LeftSide)?180:0;switch(t.me){case 1:return 270;case 2:return 180;default:case 4:return 0;case 8:return 90}}if(null===e||null===a)return 0;const l=e.getDocumentPoint(w.Center,y.l());let h=null;if(this.pointsCount>(o?6:2))h=s?this.getPoint(1):this.getPoint(this.pointsCount-2),h=o?this.yN(l,h.copy()):i;else{const t=y.l();h=a.getDocumentPoint(w.Center,t),y.e(t)}let u=0;return u=Math.abs(h.x-l.x)>Math.abs(h.y-l.y)?h.x>=l.x?0:180:h.y>=l.y?90:270,y.e(l),u}computeEndSegmentLength(t,e,i,n){if(null!==e&&i.isSide()){const t=this.M1(e);if(null!==t)return t.C1}let s=NaN;return s=n?this.fromEndSegmentLength:this.toEndSegmentLength,null!==e&&isNaN(s)&&(s=n?e.fromEndSegmentLength:e.toEndSegmentLength),isNaN(s)&&(s=10),s}computeSpot(t,e){return void 0===e&&(e=null),t?this.yO(e||this.fromPort):this.wO(e||this.toPort)}yO(t){if(null===t)return w.Center;let e=this.fromSpot;return e.isDefault()&&(e=t.fromSpot),e===w.Default?w.None:e}wO(t){if(null===t)return w.Center;let e=this.toSpot;return e.isDefault()&&(e=t.toSpot),e===w.Default?w.None:e}Dd(t){return t===w.None||.5===t.x&&.5===t.y}N1(t,e){return.5===t.x&&.5===t.y?t:w.Center}computeOtherPoint(t,e){if(0!==this.computeAdjusting()&&this.pointsCount>4)return this.computeMidPoint(new y);{const t=this.mO(e,this);return null!==t?t.Fd:e.getDocumentPoint(w.Center)}}computeShortLength(t){if(t){let t=this.fromShortLength;if(isNaN(t)){const e=this.fromPort;null!==e&&(t=e.fromShortLength)}return isNaN(t)?0:t}{let t=this.toShortLength;if(isNaN(t)){const e=this.toPort;null!==e&&(t=e.toShortLength)}return isNaN(t)?0:t}}Tm(t,e,i,n,s,o){if(!1===this.pickable)return!1;let r;if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===o?(r=k.l(),r.Ri()):r=o,r.nc(this.T),this.containedInRect(t,r))return this.X2(e,i,s),void 0===o&&k.e(r),!0;if(this.intersectsRect(t,r)){let a=!1;if(!this.af){const o=this.C.r;for(let l=o.length;l--;){const h=o[l];if(!h.visible&&h!==this.locationObject)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;const d=h,f=k.l();if(f.set(r),d instanceof Yt?a=d.Tm(t,e,i,n,s,f):this.path===d?d instanceof Jt&&(a=d.Xv(t,n,f)):a=d.wA(t,n,f),a){let t=d;null!==e&&(t=e(d)),t&&(null===i||i(t))&&s.add(t)}k.e(f)}}return void 0===o&&k.e(r),a||null!==this.background}return void 0===o&&k.e(r),!1}get isOrthogonal(){return 2===(2&this.va)}static gN(t){return 2===(2&t)}get isAvoiding(){return 4===(4&this.va)}computeCurve(){if(null===this.Ko){const t=this.fromPort,e=null!==t&&t===this.toPort,i=this.isOrthogonal;this.Ko=e&&!i}return this.Ko?9:this.curve}computeCorner(){if(9===this.curve)return 0;let t=this.corner;return(isNaN(t)||t<0)&&(t=10),t}findMidLabel(){const t=this.path,e=this.C.r,i=e.length;for(let s=0;s<i;s++){const i=e[s];if(i!==t&&!i.isPanelMain&&(i.segmentIndex===-1/0||isNaN(i.segmentIndex)))return i}const n=this.labelNodes;for(;n.next();){const t=n.value;if(t.segmentIndex===-1/0||isNaN(t.segmentIndex))return t}return null}computeSpacing(){if(!this.isVisible())return 0;let t=be.aO;t=Math.max(t,this.computeThickness());const e=this.fromPort,i=this.toPort;if(null!==e&&null!==i){const n=this.findMidLabel();if(null!==n){const s=n.naturalBounds,o=n.margin,r=isNaN(s.width)?30:s.width*n.scale+o.left+o.right,a=isNaN(s.height)?14:s.height*n.scale+o.top+o.bottom,l=n.segmentOrientation;if(21===l||25===l||24===l)t=Math.max(t,a);else if(23===l||27===l||22===l||26===l)t=Math.max(t,r);else{const n=e.getDocumentPoint(w.Center).directionPoint(i.getDocumentPoint(w.Center))/180*Math.PI;t=Math.max(t,Math.abs(Math.sin(n)*r)+Math.abs(Math.cos(n)*a)+1)}9===this.curve&&(t*=1.333)}}return t}arrangeBundledLinks(t,e){if(e)for(let i=0;i<t.length;i++){const e=t[i];0===e.computeAdjusting()&&e.invalidateRoute()}}computeCurviness(){let t=this.curviness;if(isNaN(t)){t=be.hO;const i=this.Go;if(null!==i){const n=e.et();let s=0;const o=i.js;for(let t=0;t<o.length;t++){const e=o[t].computeSpacing();n.push(e),s+=e}let r=-s/2;for(let e=0;e<o.length;e++){if(o[e]===this){t=r+n[e]/2;break}r+=n[e]}i.ey===this.fromNode&&(t=-t),e.J(n)}}return t}computeThickness(){if(!this.isVisible())return 0;const t=this.path;return null!==t?Math.max(t.strokeWidth,1):1}hasCurviness(){return!isNaN(this.curviness)||null!==this.Go}gO(t,e,i,n,s,o){const r=this.getLinkPoint(t,e,i,!0,!1,n,s),a=this.getLinkPoint(n,s,o,!1,!1,t,e);if(this.hasCurviness()){const t=a.x-r.x,e=a.y-r.y,i=this.computeCurviness(),n=i,s=r.x+t/2,o=r.y+e/2;let l=s,h=o;if(S.f(e,0))t>0?h-=n:h+=n;else{const r=-t/e;let a=Math.sqrt(n*n/(r*r+1));i<0&&(a=-a),l=(e<0?-1:1)*a+s,h=r*(l-s)+o}this.addPoint(r),this.addPointAt(l,h),this.addPoint(a)}else{this.addPoint(r),this.addPoint(a);const l=v.l();e.getDocumentBounds(l);const h=l.containsPoint(a);s.getDocumentBounds(l);const u=l.containsPoint(r);if(h||u){const l=e.getDocumentPoint(this.N1(i,!0),new y);this.setPoint(0,this.getLinkPointFromPoint(t,e,l,a,!0,l));const h=s.getDocumentPoint(this.N1(o,!1),new y);this.setPoint(1,this.getLinkPointFromPoint(n,s,h,r,!1,h))}v.e(l)}}dO(t,e,i,n,s,o){const r=this.getLinkPoint(t,e,i,!0,!1,n,s),a=this.getLinkPoint(n,s,o,!1,!1,t,e),l=a.x-r.x,h=a.y-r.y,u=this.computeCurviness();let c=0,d=0,f=r.x+l/3,g=r.y+h/3,p=f,m=g;S.f(h,0)?l>0?m-=u:m+=u:(c=-l/h,d=Math.sqrt(u*u/(c*c+1)),u<0&&(d=-d),p=(h<0?-1:1)*d+f,m=c*(p-f)+g),f=r.x+2*l/3,g=r.y+2*h/3;let y=f,x=g;S.f(h,0)?l>0?x-=u:x+=u:(y=(h<0?-1:1)*d+f,x=c*(y-f)+g),this.clearPoints(),this.addPoint(r),this.addPointAt(p,m),this.addPointAt(y,x),this.addPoint(a),this.setPoint(0,this.getLinkPoint(t,e,i,!0,!1,n,s)),this.setPoint(3,this.getLinkPoint(n,s,o,!1,!1,t,e))}adjustPoints(t,e,i,n){let s=this.computeAdjusting();if(this.isOrthogonal){if(18===s)return!1;19===s&&(s=17)}switch(s){case 18:return this.xO(t,e,i,n);case 19:return this.bO(t,e,i,n);case 17:return this.kO(t,e,i,n);default:return!1}}xO(t,e,i,n){const s=this.getPoint(t),o=this.getPoint(i);if(s.equalsApprox(e)&&o.equalsApprox(n))return!0;const r=s.x,a=s.y;let l=o.x-r,h=o.y-a;const u=Math.sqrt(l*l+h*h);if(S.z(u,0))return!0;let c=0;S.z(l,0)?c=h<0?-Math.PI/2:Math.PI/2:(c=Math.atan(h/Math.abs(l)),l<0&&(c=Math.PI-c));const d=e.x,f=e.y,g=n.x-d,p=n.y-f,m=Math.sqrt(g*g+p*p);let y=0;S.z(g,0)?y=p<0?-Math.PI/2:Math.PI/2:(y=Math.atan(p/Math.abs(g)),g<0&&(y=Math.PI-y));const x=m/u,v=y-c;this.setPoint(t,e);for(let b=t+1;b<i;b++){const t=this.getPoint(b);l=t.x-r,h=t.y-a;const e=Math.sqrt(l*l+h*h);if(S.z(e,0))continue;let i=0;S.z(l,0)?i=h<0?-Math.PI/2:Math.PI/2:(i=Math.atan(h/Math.abs(l)),l<0&&(i=Math.PI-i));const n=i+v,s=e*x,o=d+s*Math.cos(n),u=f+s*Math.sin(n);this.setPointAt(b,o,u)}return this.setPoint(i,n),!0}bO(t,e,i,n){const s=this.getPoint(t),o=this.getPoint(i);if(s.equalsApprox(e)&&o.equalsApprox(n))return!0;const r=s.x,a=s.y,l=o.x,h=o.y,u=(l-r)**2+(h-a)**2,c=e.x,d=e.y,f=n.x,g=n.y;let p=0,m=1;f-c!==0?(p=(g-d)/(f-c),m=Math.sqrt(1+1/(p*p))):p=9e9,this.setPoint(t,e);for(let y=t+1;y<i;y++){const t=this.getPoint(y),e=t.x,i=t.y;let n=.5;0!==u&&(n=((r-e)*(r-l)+(a-i)*(a-h))/u);const s=r+n*(l-r),o=a+n*(h-a);let x=Math.sqrt((e-s)**2+(i-o)**2);i<p*(e-s)+o&&(x=-x),p>0&&(x=-x);const v=c+n*(f-c),b=d+n*(g-d);if(0!==p){const t=v+x/m,e=b-(t-v)/p;this.setPointAt(y,t,e)}else this.setPointAt(y,v,b+x)}return this.setPoint(i,n),!0}kO(t,e,i,n){if(this.isOrthogonal){let s=this.getPoint(t),o=this.getPoint(t+1),r=this.getPoint(t+2),a=o.x,l=o.y;const h=a,u=l;S.f(s.y,o.y)?S.f(o.x,r.x)?l=e.y:S.f(o.y,r.y)&&(a=e.x):S.f(s.x,o.x)&&(S.f(o.y,r.y)?a=e.x:S.f(o.x,r.x)&&(l=e.y)),this.setPointAt(t+1,a,l),s=this.getPoint(i),o=this.getPoint(i-1),r=this.getPoint(i-2);let c=o.x,d=o.y;const f=c,g=d;if(S.f(s.y,o.y)?S.f(o.x,r.x)?d=n.y:S.f(o.y,r.y)&&(c=n.x):S.f(s.x,o.x)&&(S.f(o.y,r.y)?c=n.x:S.f(o.x,r.x)&&(d=n.y)),this.setPointAt(i-1,c,d),this.WL())return this.setPointAt(t+1,h,u),this.setPointAt(i-1,f,g),!1}return this.setPoint(t,e),this.setPoint(i,n),!0}addOrthoPoints(t,e,i,n,s,o){e<0?e+=360:e>=360&&(e-=360),n<0?n+=360:n>=360&&(n-=360);const r=n;e=e>=315||e<45?0:45<=e&&e<135?90:135<=e&&e<225?180:270,n=n>=315||n<45?0:45<=n&&n<135?90:135<=n&&n<225?180:270;const a=t,l=i,h=s.actualBounds.copy(),u=o.actualBounds.copy();if(!h.isReal()||!u.isReal())return;h.inflate(be.Ba,be.Ba),u.inflate(be.Ba,be.Ba),h.unionPoint(t),u.unionPoint(i);const c=y.l(),d=y.l();0===e?l.x>a.x||270===n&&l.y<a.y&&u.right>a.x||90===n&&l.y>a.y&&u.right>a.x?(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),180===n?(c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1),d.x=c.x,d.y=l.y):270===n&&l.y<a.y||90===n&&l.y>a.y?(a.x<u.left?c.x=this.computeMidOrthoPosition(a.x,a.y,u.left,l.y,!1):a.x<u.right&&(270===n&&a.y<u.top||90===n&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):c.x=u.right,d.x=c.x,d.y=l.y):0===n&&a.x<u.left&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<l.y?c.y=Math.min(l.y,u.top):c.y=Math.max(l.y,u.bottom),d.y=c.y)):(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),(180===n||90===n&&l.y<h.top||270===n&&l.y>h.bottom)&&(180===n&&(u.containsPoint(a)||h.containsPoint(l))?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):l.y<a.y&&(180===n||90===n)?c.y=this.computeMidOrthoPosition(a.x,h.top,l.x,Math.max(l.y,u.bottom),!0):l.y>a.y&&(180===n||270===n)&&(c.y=this.computeMidOrthoPosition(a.x,h.bottom,l.x,Math.min(l.y,u.top),!0)),d.x=l.x,d.y=c.y),c.y>h.top&&c.y<h.bottom&&(l.x>=h.left&&l.x<=a.x||a.x<=u.right&&a.x>=l.x?(90===n||270===n)&&(c.i(Math.max((a.x+l.x)/2,a.x),a.y),d.i(c.x,l.y)):(270===n||(0===n||180===n)&&l.y<a.y?c.y=Math.min(l.y,0===n?h.top:Math.min(h.top,u.top)):c.y=Math.max(l.y,0===n?h.bottom:Math.max(h.bottom,u.bottom)),d.x=l.x,d.y=c.y))):180===e?l.x<a.x||270===n&&l.y<a.y&&u.left<a.x||90===n&&l.y>a.y&&u.left<a.x?(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),0===n?(c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1),d.x=c.x,d.y=l.y):270===n&&l.y<a.y||90===n&&l.y>a.y?(a.x>u.right?c.x=this.computeMidOrthoPosition(a.x,a.y,u.right,l.y,!1):a.x>u.left&&(270===n&&a.y<u.top||90===n&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):c.x=u.left,d.x=c.x,d.y=l.y):180===n&&a.x>u.right&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<l.y?c.y=Math.min(l.y,u.top):c.y=Math.max(l.y,u.bottom),d.y=c.y)):(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),(0===n||90===n&&l.y<h.top||270===n&&l.y>h.bottom)&&(0===n&&(u.containsPoint(a)||h.containsPoint(l))?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):l.y<a.y&&(0===n||90===n)?c.y=this.computeMidOrthoPosition(a.x,h.top,l.x,Math.max(l.y,u.bottom),!0):l.y>a.y&&(0===n||270===n)&&(c.y=this.computeMidOrthoPosition(a.x,h.bottom,l.x,Math.min(l.y,u.top),!0)),d.x=l.x,d.y=c.y),c.y>h.top&&c.y<h.bottom&&(l.x<=h.right&&l.x>=a.x||a.x>=u.left&&a.x<=l.x?(90===n||270===n)&&(c.i(Math.min((a.x+l.x)/2,a.x),a.y),d.i(c.x,l.y)):(270===n||(0===n||180===n)&&l.y<a.y?c.y=Math.min(l.y,180===n?h.top:Math.min(h.top,u.top)):c.y=Math.max(l.y,180===n?h.bottom:Math.max(h.bottom,u.bottom)),d.x=l.x,d.y=c.y))):90===e?l.y>a.y||180===n&&l.x<a.x&&u.bottom>a.y||0===n&&l.x>a.x&&u.bottom>a.y?(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),270===n?(c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0),d.x=l.x,d.y=c.y):180===n&&l.x<a.x||0===n&&l.x>a.x?(a.y<u.top?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,u.top,!0):a.y<u.bottom&&(180===n&&a.x<u.left||0===n&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):c.y=u.bottom,d.x=l.x,d.y=c.y):90===n&&a.y<u.top&&a.x>u.left&&a.x<u.right&&(a.x<l.x?c.x=Math.min(l.x,u.left):c.x=Math.max(l.x,u.right),c.y=a.y,d.x=c.x)):(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),(270===n||0===n&&l.x<h.left||180===n&&l.x>h.right)&&(270===n&&(u.containsPoint(a)||h.containsPoint(l))?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):l.x<a.x&&(270===n||0===n)?c.x=this.computeMidOrthoPosition(h.left,a.y,Math.max(l.x,u.right),l.y,!1):l.x>a.x&&(270===n||180===n)&&(c.x=this.computeMidOrthoPosition(h.right,a.y,Math.min(l.x,u.left),l.y,!1)),d.x=c.x,d.y=l.y),c.x>h.left&&c.x<h.right&&(l.y>=h.top&&l.y<=a.y||a.y<=u.bottom&&a.y>=l.y?(0===n||180===n)&&(c.i(a.x,Math.max((a.y+l.y)/2,a.y)),d.i(l.x,c.y)):(180===n||(90===n||270===n)&&l.x<a.x?c.x=Math.min(l.x,90===n?h.left:Math.min(h.left,u.left)):c.x=Math.max(l.x,90===n?h.right:Math.max(h.right,u.right)),d.x=c.x,d.y=l.y))):l.y<a.y||180===n&&l.x<a.x&&u.top<a.y||0===n&&l.x>a.x&&u.top<a.y?(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),90===n?(c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0),d.x=l.x,d.y=c.y):180===n&&l.x<a.x||0===n&&l.x>=a.x?(a.y>u.bottom?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,u.bottom,!0):a.y>u.top&&(180===n&&a.x<u.left||0===n&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):c.y=u.top,d.x=l.x,d.y=c.y):270===n&&a.y>u.bottom&&a.x>u.left&&a.x<u.right&&(a.x<l.x?c.x=Math.min(l.x,u.left):c.x=Math.max(l.x,u.right),c.y=a.y,d.x=c.x)):(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),(90===n||0===n&&l.x<h.left||180===n&&l.x>h.right)&&(90===n&&(u.containsPoint(a)||h.containsPoint(l))?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):l.x<a.x&&(90===n||0===n)?c.x=this.computeMidOrthoPosition(h.left,a.y,Math.max(l.x,u.right),l.y,!1):l.x>a.x&&(90===n||180===n)&&(c.x=this.computeMidOrthoPosition(h.right,a.y,Math.min(l.x,u.left),l.y,!1)),d.x=c.x,d.y=l.y),c.x>h.left&&c.x<h.right&&(l.y<=h.bottom&&l.y>=a.y||a.y>=u.top&&a.y<=l.y?(0===n||180===n)&&(c.i(a.x,Math.min((a.y+l.y)/2,a.y)),d.i(l.x,c.y)):(180===n||(90===n||270===n)&&l.x<a.x?c.x=Math.min(l.x,270===n?h.left:Math.min(h.left,u.left)):c.x=Math.max(l.x,270===n?h.right:Math.max(h.right,u.right)),d.x=c.x,d.y=l.y))),this.pN=n!==r,this.uN=e,this.dN=n,this.addPoint(c.copy()),this.addPoint(d.copy()),y.e(c),y.e(d)}computeMidOrthoPosition(t,e,i,n,s){let o=0;return this.hasCurviness()&&!this.computeSpot(!0,this.fromPort).isSide()&&!this.computeSpot(!1,this.toPort).isSide()&&(o=this.computeCurviness()),s?(e+n)/2+o:(t+i)/2+o}WL(){if(null===this.diagram||!this.isAvoiding||this.diagram.animationManager.isTicking)return!1;const t=this.points.r,e=t.length;if(e<4)return!1;const i=this.diagram.getPositions(!1,this.containingGroup,null);for(let n=1;n<e-2;n++){const e=t[n],s=t[n+1];if(!i.isUnoccupied(Math.min(e.x,s.x),Math.min(e.y,s.y),Math.abs(e.x-s.x),Math.abs(e.y-s.y)))return!0}return!1}findClosestSegment(t){const e=t.x,i=t.y;let n=this.getPoint(0),s=this.getPoint(1),o=y.distanceLineSegmentSquared(e,i,n.x,n.y,s.x,s.y),r=0;for(let a=1;a<this.pointsCount-1;a++){n=this.getPoint(a+1);const t=y.distanceLineSegmentSquared(e,i,s.x,s.y,n.x,n.y);s=n,t<o&&(r=a,o=t)}return r}ee(){this.bh=!1,this.c()}get bh(){return 0!==(128&this.Mt)}set bh(t){0!==(128&this.Mt)!==t&&(this.Mt=128^this.Mt)}get geometry(){if(!this.bh){if(this.updateRoute(),this.pointsCount<2)return this.bh=!0,this.ot;this.ot=this.makeGeometry()}return this.ot}sd(t){if(!t){if(!1===this.Se)return;const t=this.findMainElement();if(this.bh&&(null===t||null!==t.geometry))return}this.pointsCount<2?this.bh=!0:this.ot=this.makeGeometry();const e=this.path;if(null===e)return;e.ot=this.ot;const i=this.C.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];t!==e&&t.isPanelMain&&t instanceof Jt&&(t.ot=this.ot)}}PO(t){return this.Ua()&&t.Jl.has(this)&&(0!==this.Sf.width||0!==this.Sf.height)&&(t.animationManager.isAnimating||t.currentTool!==t.toolManager)}makeGeometry(){const t=this.ot,e=this.pointsCount;let i=!1;const n=this.diagram;null!==n&&this.PO(n)&&(i=!0);let s=0,o=0,r=this.getPoint(0).copy();const a=r.copy(),l=this.xi.r,h=this.computeCurve();if(9===h&&e>=3&&!S.z(this.smoothness,0))if(3===e){let t=this.getPoint(1);s=Math.min(r.x,t.x),o=Math.min(r.y,t.y),t=this.getPoint(2),s=Math.min(s,t.x),o=Math.min(o,t.y)}else if(this.isOrthogonal){for(let t=0;t<e;t++){const e=l[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}s=a.x,o=a.y}else{for(let t=3;t<e;t+=3){t+3>=e&&(t=e-1);const i=this.getPoint(t);a.x=Math.min(i.x,a.x),a.y=Math.min(i.y,a.y)}s=a.x,o=a.y}else{for(let t=0;t<e;t++){const e=l[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}s=a.x,o=a.y}if(s-=this.b1.x,o-=this.b1.y,r.x-=s,r.y-=o,2!==e||this.Ua()){t.type=4;const n=he.RC(t);if(0!==this.computeShortLength(!0)&&(r=this.Nf(r,!0,a)),n.hu(r.x,r.y,!1,!1),9===h&&e>=3&&!S.z(this.smoothness,0))if(3===e){const t=this.getPoint(1),e=t.x-s,i=t.y-o;let r=this.getPoint(2).copy();r.x-=s,r.y-=o,0!==this.computeShortLength(!1)&&(r=this.Nf(r,!1,a)),n.lr(e,i,e,i,r.x,r.y)}else if(this.isOrthogonal){const t=y.V(s,o),e=y.l();e.a(this.getPoint(1));const i=y.V(s,o),r=y.V(s,o);let a=this.getPoint(0),l=null;const h=this.smoothness/3;for(let f=1;f<this.pointsCount-1;f++){l=this.getPoint(f);const u=a,c=l,d=this.getPoint(this.wN(l,f,!1));S.z(u.x,c.x)&&S.z(c.x,d.x)||S.z(u.y,c.y)&&S.z(c.y,d.y)||(this.SO(u,c,d,h,i,r),(1===f||2===f&&S.z(a.x,this.getPoint(0).x)&&S.z(a.y,this.getPoint(0).y))&&(e.x=.5*(a.x+l.x),e.y=.5*(a.y+l.y)),n.lr(e.x-s,e.y-o,i.x-s,i.y-o,l.x-s,l.y-o),t.set(i),e.set(r),a=l)}let u=a.x,c=a.y,d=this.getPoint(this.pointsCount-1);0!==this.computeShortLength(!1)&&(d=this.Nf(d.copy(),!1,y.wo)),u=.5*(u+d.x),c=.5*(c+d.y),n.lr(r.x-s,r.y-o,u-s,c-o,d.x-s,d.y-o),y.e(t),y.e(e),y.e(i),y.e(r)}else for(let t=3;t<e;t+=3){const i=this.getPoint(t-2);t+3>=e&&(t=e-1);const r=this.getPoint(t-1);let a=this.getPoint(t);t===e-1&&0!==this.computeShortLength(!1)&&(a=this.Nf(a.copy(),!1,y.wo)),n.lr(i.x-s,i.y-o,r.x-s,r.y-o,a.x-s,a.y-o)}else{const t=y.l();t.a(this.getPoint(0));const r=y.l();r.a(t);const a=this.computeCorner();let l=1,h=0;for(;l<e;){l=this.wN(t,l,l>1);let u=this.getPoint(l);if(l>=e-1){if(t.equals(u)){if(0===h)for(l=1;l<e;)r.a(t),u=this.getPoint(l++),this.xn(n,-s,-o,t,u,i),t.a(u)}else 0!==this.computeShortLength(!1)&&(u=this.Nf(u.copy(),!1,y.wo)),this.xn(n,-s,-o,t,u,i);break}h=this.wN(u,l+1,l<e-3);const c=this.getPoint(h);this.MO(n,-s,-o,t,u,c,t,r,a,i),r.a(u),l=h}y.e(t)}return he.vC(n),this.bh=!0,t}{let e=this.getPoint(1).copy();return e.x-=s,e.y-=o,0!==this.computeShortLength(!0)&&(r=this.Nf(r,!0,a)),0!==this.computeShortLength(!1)&&(e=this.Nf(e,!1,a)),t.type=1,t.startX=r.x,t.startY=r.y,t.endX=e.x,t.endY=e.y,this.bh=!0,t}}L1(t,e,i,n){let s=i-t;if(isNaN(s)||s===1/0||s===-1/0)return NaN;s<0&&(s=-s);let o=n-e;return isNaN(o)||o===1/0||o===-1/0?NaN:(o<0&&(o=-o),S.z(s,0)?o:S.z(o,0)?s:Math.sqrt(s*s+o*o))}SO(t,e,i,n,s,o){isNaN(n)&&(n=this.smoothness/3);const r=t.x,a=t.y,l=e.x,h=e.y,u=i.x,c=i.y,d=n*this.L1(r,a,l,h),f=n*this.L1(l,h,u,c);if(S.z(a,h)&&S.z(l,u)&&(l>r?c>h?(s.x=l-d,s.y=h-d,o.x=l+f,o.y=h+f):(s.x=l-d,s.y=h+d,o.x=l+f,o.y=h-f):c>h?(s.x=l+d,s.y=h-d,o.x=l-f,o.y=h+f):(s.x=l+d,s.y=h+d,o.x=l-f,o.y=h-f)),S.z(r,l)&&S.z(h,c)&&(h>a?u>l?(s.x=l-d,s.y=h-d,o.x=l+f,o.y=h+f):(s.x=l+d,s.y=h-d,o.x=l-f,o.y=h+f):u>l?(s.x=l-d,s.y=h+d,o.x=l+f,o.y=h-f):(s.x=l+d,s.y=h+d,o.x=l-f,o.y=h-f)),S.z(r,l)&&S.z(l,u)||S.z(a,h)&&S.z(h,c)){const t=.5*(r+u),e=.5*(a+c);s.x=t,s.y=e,o.x=t,o.y=e}}Nf(t,e,i){const n=this.pointsCount;if(n<2)return t;if(e){const e=this.getPoint(1),s=e.x-i.x,o=e.y-i.y,r=this.L1(t.x,t.y,s,o);if(0===r)return t;const a=2===n?.5*r:r;let l=this.computeShortLength(!0);l>a&&(l=a);const h=l*(s-t.x)/r,u=l*(o-t.y)/r;t.x+=h,t.y+=u}else{const e=this.getPoint(n-2),s=e.x-i.x,o=e.y-i.y,r=this.L1(t.x,t.y,s,o);if(0===r)return t;const a=2===n?.5*r:r;let l=this.computeShortLength(!1);l>a&&(l=a);const h=l*(t.x-s)/r,u=l*(t.y-o)/r;t.x-=h,t.y-=u}return t}wN(t,e,i){const n=this.pointsCount;let s=t;for(;S.z(t.x,s.x)&&S.z(t.y,s.y);){if(e>=n)return n-1;s=this.getPoint(e++)}if(!S.z(t.x,s.x)&&!S.z(t.y,s.y))return e-1;let o=s;for(;S.z(t.x,s.x)&&S.z(s.x,o.x)&&(!i||(t.y>=s.y?s.y>=o.y:s.y<=o.y))||S.z(t.y,s.y)&&S.z(s.y,o.y)&&(!i||(t.x>=s.x?s.x>=o.x:s.x<=o.x));){if(e>=n)return n-1;o=this.getPoint(e++)}return e-2}MO(t,e,i,n,s,o,r,a,l,h){if(S.f(n.y,s.y)&&S.f(s.x,o.x)){let u=Math.min(l,Math.abs(s.x-a.x)/2);const c=Math.min(u,Math.abs(o.y-s.y)/2);if(u=c,S.f(u,0))return this.xn(t,e,i,n,s,h),void r.a(s);let d=s.x;const f=s.y,g=d;let p=f;s.x>n.x?(d=s.x-u,p=o.y>s.y?s.y+c:s.y-c):(d=s.x+u,p=o.y>s.y?s.y+c:s.y-c);const m=y.V(d,f);this.xn(t,e,i,n,m,h),y.e(m),t.Mw(s.x+e,s.y+i,g+e,p+i),r.i(g,p)}else if(S.f(n.x,s.x)&&S.f(s.y,o.y)){let u=Math.min(l,Math.abs(s.y-a.y)/2);const c=Math.min(u,Math.abs(o.x-s.x)/2);if(u=c,S.f(c,0))return this.xn(t,e,i,n,s,h),void r.a(s);const d=s.x;let f=s.y,g=d;const p=f;s.y>n.y?(f=s.y-u,g=o.x>s.x?s.x+c:s.x-c):(f=s.y+u,g=o.x>s.x?s.x+c:s.x-c);const m=y.V(d,f);this.xn(t,e,i,n,m,h),y.e(m),t.Mw(s.x+e,s.y+i,g+e,p+i),r.i(g,p)}else this.xn(t,e,i,n,s,h),r.a(s)}computeJumpLength(){return 10}xn(t,e,i,n,s,o){if(o||!this.Ua())t.rr(s.x+e,s.y+i);else{const o=this.computeJumpLength(),r=o/2,a=[];let l=0;this.isVisible()&&(l=this.NO(n,s,a));let h=n.x,u=n.y;if(l>0)if(S.f(n.y,s.y))if(n.x<s.x){let c=0;for(;c<l;){const d=Math.max(n.x,Math.min(a[c++]-r,s.x-o));t.rr(d+e,s.y+i),h=d+e,u=s.y+i;let f=Math.min(d+o,s.x);for(;c<l;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,s.x)}const g=s.y-o+i,p=f+e,m=s.y+i;10===this.curve?t.hu(p,m,!1,!1):t.lr(h,g,p,g,p,m),h=p,u=m}}else{let c=l-1;for(;c>=0;){const l=Math.min(n.x,Math.max(a[c--]+r,s.x+o));t.rr(l+e,s.y+i),h=l+e,u=s.y+i;let d=Math.max(l-o,s.x);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,s.x)}const f=s.y-o+i,g=d+e,p=s.y+i;10===this.curve?t.hu(g,p,!1,!1):t.lr(h,f,g,f,g,p),h=g,u=p}}else if(S.f(n.x,s.x))if(n.y<s.y){let c=0;for(;c<l;){const d=Math.max(n.y,Math.min(a[c++]-r,s.y-o));t.rr(s.x+e,d+i),h=s.x+e,u=d+i;let f=Math.min(d+o,s.y);for(;c<l;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,s.y)}const g=s.x-o+e,p=s.x+e,m=f+i;10===this.curve?t.hu(p,m,!1,!1):t.lr(g,u,g,m,p,m),h=p,u=m}}else{let c=l-1;for(;c>=0;){const l=Math.min(n.y,Math.max(a[c--]+r,s.y+o));t.rr(s.x+e,l+i),h=s.x+e,u=l+i;let d=Math.max(l-o,s.y);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,s.y)}const f=s.x-o+e,g=s.x+e,p=d+i;10===this.curve?t.hu(g,p,!1,!1):t.lr(f,u,f,p,g,p),h=g,u=p}}t.rr(s.x+e,s.y+i)}}NO(t,e,i){const n=this.diagram;if(null===n||t.equals(e))return 0;const s=n.layers;for(;s.next();){const n=s.value;if(null!==n&&n.visible){const s=n.jS(),o=s.length;for(let n=0;n<o;n++){const o=s[n];if(!(o instanceof be))continue;if(o===this)return i.length>0&&i.sort(((t,e)=>t-e)),i.length;if(!o.isVisible()||!o.Ua())continue;const r=o.routeBounds;if(!r.isReal()||!this.routeBounds.intersectsRect(r)||this.usesSamePort(o))continue;const a=o.path;null!==a&&a.isVisibleObject()&&this.CO(t,e,i,o)}}}return i.length>0&&i.sort(((t,e)=>t-e)),i.length}CO(t,e,i,n){const s=S.f(t.y,e.y),o=n.pointsCount;let r=n.getPoint(0);const a=y.l();for(let l=1;l<o;l++){const h=n.getPoint(l);if(l<o-1){const t=n.getPoint(l+1);if(r.y===h.y&&h.y===t.y){if(h.x>r.x&&t.x>=h.x||h.x<r.x&&t.x<=h.x)continue}else if(r.x===h.x&&h.x===t.x&&(h.y>r.y&&t.y>=h.y||h.y<r.y&&t.y<=h.y))continue}this.LO(t,e,r,h,a)&&(s?i.push(a.x):i.push(a.y)),r=h}y.e(a)}LO(t,e,i,n,s){const o=t.x,r=t.y,a=e.x,l=e.y,h=i.x,u=i.y,c=n.x,d=n.y;if(S.f(o,a)){if(!S.f(r,l)&&S.f(u,d)&&Math.min(r,l)<u&&Math.max(r,l)>u&&Math.min(h,c)<o&&Math.max(h,c)>o&&!S.f(h,c))return s.x=o,s.y=u,!0}else if(S.f(r,l)&&S.f(h,c)&&Math.min(o,a)<h&&Math.max(o,a)>h&&Math.min(u,d)<r&&Math.max(u,d)>r&&!S.f(u,d))return s.x=h,s.y=r,!0;return s.x=0,s.y=0,!1}get firstPickIndex(){return this.pointsCount<=2?0:this.isOrthogonal||!this.Dd(this.computeSpot(!0))?1:0}get lastPickIndex(){const t=this.pointsCount;return 0===t?0:t<=2?t-1:this.isOrthogonal||!this.Dd(this.computeSpot(!1))?t-2:t-1}Ua(){const t=this.curve;return 11===t||10===t}S1(t){if(t||this.Ua()){const t=this.diagram;null!==t&&!t.animationManager.isTicking&&!t.Jl.has(this)&&(0!==this.Sf.width||0!==this.Sf.height)&&t.Jl.set(this,this.Sf.copy())}}invalidateOtherJumpOvers(t){const e=this.layer;if(null===e||!e.visible||e.isTemporary)return;const i=e.diagram;if(null===i||i.animationManager.isTicking)return;let n=!1;const s=i.layers;for(;s.next();){const i=s.value;if(i.visible)if(i===e){n=!0;let e=!1;const s=i.jS(),o=s.length;for(let i=0;i<o;i++){const n=s[i];n instanceof be&&(n===this?e=!0:e&&this.MT(n,t))}}else if(n){const e=i.jS(),n=e.length;for(let i=0;i<n;i++){const n=e[i];n instanceof be&&this.MT(n,t)}}}}MT(t,e){if(null===t||!t.bh||!t.Se||!t.Ua())return;const i=t.routeBounds;i.isReal()&&(!this.routeBounds.intersectsRect(i)&&!e.intersectsRect(i)||this.usesSamePort(t)||t.ee())}usesSamePort(t){const e=this.pointsCount,i=t.pointsCount;if(e>0&&i>0){const n=this.getPoint(0),s=t.getPoint(0);if(n.equalsApprox(s))return!0;const o=this.getPoint(e-1),r=t.getPoint(i-1);if(o.equalsApprox(r)||n.equalsApprox(r)||o.equalsApprox(s))return!0}else if(this.fromNode===t.fromNode||this.toNode===t.toNode||this.fromNode===t.toNode||this.toNode===t.fromNode)return!0;return!1}isVisible(){if(!super.isVisible())return!1;const t=this.containingGroup;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);const n=this.fromNode;if(null!==n){if(this.isTreeLink&&e&&!n.isTreeExpanded)return!1;if(n===t)return!0;let i=n;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const s=n.findVisibleNode();if(null===s||s===t)return!1}const s=this.toNode;if(null!==s){if(this.isTreeLink&&!e&&!s.isTreeExpanded)return!1;if(s===t)return!0;let i=s;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const n=s.findVisibleNode();if(null===n||n===t)return!1}return!0}Ei(t){if(super.Ei(t),t&&this.S1(!1),null!==this.Go&&this.Go.Sd(),null!==this.Hs){const e=this.Hs.iterator;for(;e.next();)e.value.Ei(t)}}get adjusting(){return this.Pf}set adjusting(t){const e=this.Pf;e!==t&&(this.Pf=t,this.t("adjusting",e,t))}computeAdjusting(){return this.isAvoiding&&null!==this.diagram&&this.diagram.animationManager.defaultAnimation.isAnimating?17:this.Pf}get corner(){return this.Cd}set corner(t){const e=this.Cd;e!==t&&(this.Cd=t,this.ee(),this.t("corner",e,t))}get curve(){return this.Ld}set curve(t){const e=this.Ld;e!==t&&(this.Ld=t,this.invalidateRoute(),this.ee(),this.S1(10===e||11===e||10===t||11===t),this.t("curve",e,t))}get curviness(){return this.Ad}set curviness(t){const e=this.Ad;e!==t&&(this.Ad=t,this.invalidateRoute(),this.ee(),this.t("curviness",e,t))}get routing(){return this.va}set routing(t){const e=this.va;e!==t&&(this.va=t,this.isAvoiding&&null!==this.diagram&&(this.diagram.Vm=!0),this.Ko=null,this.invalidateRoute(),this.S1(be.gN(e)||be.gN(t)),this.t("routing",e,t))}get smoothness(){return this.Td}set smoothness(t){const e=this.Td;e!==t&&(this.Td=t,this.ee(),this.t("smoothness",e,t))}yy(){const t=this.eo;if(null===t)return;const e=this.no;if(null===e||!isNaN(this.curviness))return;const i=this.so,n=this.oo;let s=null,o=null;const r=t.ti.r,a=r.length;for(let l=0;l<a;l++){const a=r[l];(a.eo!==t||a.so!==i||a.no!==e||a.oo!==n)&&(a.eo!==e||a.so!==n||a.no!==t||a.oo!==i)||(null===o?o=a:(null===s&&(s=[],s.push(o)),s.push(a)))}if(null!==s){let o=t.mT(e,i,n);null===o&&(o=new we(t,i,e,n),t.dT(o),e.dT(o)),o.js=s;for(let t=0;t<s.length;t++){s[t].Go=o}o.Sd()}}my(){const t=this.Go;if(null!==t){if(!isNaN(this.curviness))return;this.Go=null;const e=t.js.indexOf(this);e>=0&&(t.js.splice(e,1),t.Sd())}}Nl(){return!0}get key(){const t=this.diagram;if(null!==t&&t.model.Ra())return t.model.getKeyForLinkData(this.data)}}class we{Do;Is;ey;rN;m1;lN;js;constructor(t,e,i,n){u.Gi(this),this.Do=!1,this.Is=!1,this.ey=t,this.rN=e,this.m1=i,this.lN=n,this.js=[]}Sd(){if(!this.Do){const t=this.js;if(t.length>0){const e=t[0].diagram;null!==e&&(e.yM.add(this),this.Is=e.undoManager.isUndoingRedoing)}}this.Do=!0}FM(){if(this.Do){this.Do=!1;const t=this.js;if(t.length>0){const e=t[0],i=e.diagram,n=null===i||i.Uh&&!this.Is;this.Is=!1,e.arrangeBundledLinks(t,n),1===t.length&&(e.Go=null,t.length=0)}0===t.length&&(this.ey.gT(this),this.m1.gT(this))}}}class ke{oe;re;Va;za;di;gi;Vt;kh;Ph;fa;GM;Do;xy;Kc;HM;jM;constructor(t){u.Gi(this),this.fa=null,this.GM=null,this.Do=!0,this.xy=!1,this.oe=1,this.re=1,this.Va=-1,this.za=-1,this.di=t.width,this.gi=t.height,this.Vt=[],this.kh=0,this.Ph=0,this.Kc=11,this.HM=2*this.Kc,this.jM=2*this.Kc}static qs=0;static Xa=1;static Rd=999999;static xN=(()=>ke.Rd+1)();static bN=(()=>ke.Rd+2)();Cb(t){if(t.width<=0||t.height<=0)return;const e=t.x,i=t.y,n=t.x+t.width,s=t.y+t.height;this.oe=Math.floor((e-this.di)/this.di)*this.di,this.re=Math.floor((i-this.gi)/this.gi)*this.gi,this.Va=Math.ceil((n+2*this.di)/this.di)*this.di,this.za=Math.ceil((s+2*this.gi)/this.gi)*this.gi;const o=1+(0|Math.ceil((this.Va-this.oe)/this.di)),r=1+(0|Math.ceil((this.za-this.re)/this.gi));if(0===this.Vt.length||this.kh<o-1||this.Ph<r-1){const t=[];for(let e=0;e<=o;e++)t[e]=new Uint32Array(r);this.Vt=t,this.kh=o-1,this.Ph=r-1}this.AO(ke.xN)}get bounds(){return new v(this.oe,this.re,this.Va-this.oe,this.za-this.re)}get cellWidth(){return this.di}set cellWidth(t){t>0&&t!==this.di&&(this.di=t,this.Cb(this.bounds))}get cellHeight(){return this.gi}set cellHeight(t){t>0&&t!==this.gi&&(this.gi=t,this.Cb(this.bounds))}vd(t,e){return this.oe<=t&&t<=this.Va&&this.re<=e&&e<=this.za}ro(t,e){if(!this.vd(t,e))return ke.xN;t-=this.oe,t/=this.di,e-=this.re;const i=0|t,n=0|(e/=this.gi);return this.Vt[i][n]}UR(t,e,i,n){if(!this.vd(t,e))return;const s=(t-this.oe)/this.di|0,o=(e-this.re)/this.gi|0,r=(t+i-this.oe)/this.di|0,a=(e+n-this.re)/this.gi|0,l=Math.min(r,this.kh),h=Math.min(a,this.Ph);for(let u=s;u<=l;u++){const t=this.Vt[u];if(t.fill)t.fill(ke.qs,o,h+1);else for(let e=o;e<=h;e++)t[e]=ke.qs}}AO(t){for(let e=0;e<=this.kh;e++){const i=this.Vt[e];if(i.fill)i.fill(t);else for(let e=0;e<=this.Ph;e++)i[e]=t}}rA(){for(let t=0;t<=this.kh;t++){const e=this.Vt[t];for(let t=0;t<=this.Ph;t++)e[t]>=ke.Xa&&(e[t]=ke.xN)}}TO(t,e){return this.ro(t,e)===ke.qs}isUnoccupied(t,e,i,n){if(t>this.Va||t+i<this.oe||e>this.za||e+n<this.re)return!0;let s=(t-this.oe)/this.di|0,o=(e-this.re)/this.gi|0,r=Math.max(0,i)/this.di+1|0,a=Math.max(0,n)/this.gi+1|0;if(s<0&&(r+=s,s=0),o<0&&(a+=o,o=0),r<0||a<0)return!0;const l=0|Math.min(s+r-1,this.kh),h=0|Math.min(o+a-1,this.Ph);for(let u=s;u<=l;u++){const t=this.Vt[u];for(let e=o;e<=h;e++)if(t[e]===ke.qs)return!1}return!0}maxAvoidsLinksSpaceH(t,e,i,n){if(t>this.Va||e<this.oe||i>this.za||i<this.re)return 0;const s=(t-this.oe)/this.di|0,o=(e-this.oe)/this.di|0,r=(i-this.re)/this.gi|0,a=n/this.gi+1|0;let l;for(l=0;l<a/2;l++){let t=!1;for(let e=s;e<=o;e++)if(this.Vt[e][r+l]===ke.qs||this.Vt[e][r-l]===ke.qs){t=!0;break}if(t)return Math.max(0,(2*l-1)*this.gi)}return n}maxAvoidsLinksSpaceV(t,e,i,n){if(t>this.za||e<this.re||i>this.Va||i<this.oe)return 0;const s=(t-this.re)/this.gi|0,o=(e-this.re)/this.gi|0,r=(i-this.oe)/this.di|0,a=n/this.di+1|0;let l;for(l=0;l<a/2;l++){let t=!1;for(let e=s;e<=o;e++)if(this.Vt[r+l][e]===ke.qs||this.Vt[r-l][e]===ke.qs){t=!0;break}if(t)return Math.max(0,(2*l-1)*this.di)}return n}DO(t,e,i,n,s,o,r,a){t|=0,e|=0;let l=this.Vt[t][e];if(l>=ke.Xa&&l<ke.Rd)for(n?e+=i:t+=i,l+=1;s<=t&&t<=o&&r<=e&&e<=a;){if(l>=this.Vt[t][e])break;this.Vt[t][e]=l,l+=1,n?e+=i:t+=i}return n?e:t}lo(t,e,i,n,s,o,r,a){if(t<s||t>o||e<r||e>a)return;const l=this.DO(t,e,i,n,s,o,r,a);if(n)if(i>0)for(let h=e+i;h<l;h+=i)this.lo(t,h,1,!n,s,o,r,a),this.lo(t,h,-1,!n,s,o,r,a);else for(let h=e+i;h>l;h+=i)this.lo(t,h,1,!n,s,o,r,a),this.lo(t,h,-1,!n,s,o,r,a);else if(i>0)for(let h=t+i;h<l;h+=i)this.lo(h,e,1,!n,s,o,r,a),this.lo(h,e,-1,!n,s,o,r,a);else for(let h=t+i;h>l;h+=i)this.lo(h,e,1,!n,s,o,r,a),this.lo(h,e,-1,!n,s,o,r,a)}A1(t,e,i,n,s,o,r,a,l,h){let u=0|t,c=0|e,d=ke.qs,f=ke.Xa;for(this.Vt[u][c]=f;d===ke.qs&&u>r&&u<a&&c>l&&c<h;)f+=1,this.Vt[u][c]=f,o?c+=s:u+=s,d=this.Vt[u][c];return o?c:u}T1(t,e,i,n,s,o,r,a,l,h){let u=0|i,c=0|n,d=ke.qs;const f=ke.Rd;for(this.Vt[u][c]=f;d===ke.qs&&u>r&&u<a&&c>l&&c<h;)this.Vt[u][c]=f,o?c+=s:u+=s,d=this.Vt[u][c]}NT(t,i,n,s,o,r){this.xy=!1;let a=t.x,l=t.y;if(!this.vd(a,l))return;a-=this.oe,a/=this.di,l-=this.re,l/=this.gi;let h=n.x,u=n.y;if(!this.vd(h,u))return;if(h-=this.oe,h/=this.di,u-=this.re,u/=this.gi,Math.abs(a-h)<=1&&Math.abs(l-u)<=1)return void(this.xy=!0);let c=o.x,d=o.y,f=o.x+o.width,g=o.y+o.height;c-=this.oe,c/=this.di,d-=this.re,d/=this.gi,f-=this.oe,f/=this.di,g-=this.re,g/=this.gi;const p=Math.max(0,Math.min(this.kh,0|c)),m=Math.min(this.kh,Math.max(0,0|f)),y=Math.max(0,Math.min(this.Ph,0|d)),x=Math.min(this.Ph,Math.max(0,0|g)),v=90,b=270,w=this.Vt,k=0|a,S=0|l,P=0|h,M=0|u,C=0===i||i===v?1:-1,N=i===v||i===b;w[k][S]===ke.qs?(this.A1(k,S,P,M,C,N,p,m,y,x),this.A1(k,S,P,M,1,!N,p,m,y,x),this.A1(k,S,P,M,-1,!N,p,m,y,x)):this.A1(k,S,P,M,C,N,k,S,k,S),w[P][M]===ke.qs?(this.T1(k,S,P,M,0===s||s===v?1:-1,s===v||s===b,p,m,y,x),this.T1(k,S,P,M,1,!(s===v||s===b),p,m,y,x),this.T1(k,S,P,M,-1,!(s===v||s===b),p,m,y,x)):this.T1(k,S,P,M,C,N,P,M,P,M);const T=e.et();if(r&&this.CT(P,M,s,k,S,T)){(T[0]!==P||T[1]!==M)&&(T.unshift(M),T.unshift(P)),(T[T.length-2]!==k||T[T.length-1]!==S)&&(T.push(k),T.push(S));let t=ke.Xa,e=T[T.length-2],i=T[T.length-1];w[e][i]=t++;for(let n=T.length-4;n>=0;n-=2){e=T[n+2],i=T[n+3];const s=T[n],o=T[n+1];for(;s>e?e++:s<e?e--:o>i?i++:o<i&&i--,w[e][i]=t++,e!==s||i!==o;);}}else this.lo(k,S,1,!1,p,m,y,x),this.lo(k,S,-1,!1,p,m,y,x),this.lo(k,S,1,!0,p,m,y,x),this.lo(k,S,-1,!0,p,m,y,x);e.J(T)}CT(t,e,i,n,s,o){const r=this.Vt;let a=t,l=e;for(;;){if(a===n&&l===s)return!0;let t=a,e=l;if(0===i){if(!(t<n))break;t++}else if(90===i){if(!(e<s))break;e++}else if(180===i){if(!(t>n))break;t--}else{if(!(e>s))break;e--}const o=r[t][e];if(0===o||o===ke.bN)break;a=t,l=e}for(;;){let h=i,u=a,c=l;0===i?c<s?(h=90,c++):c>s&&(h=270,c--):90===i?u<n?(h=0,u++):u>n&&(h=180,u--):180===i?c<s?(h=90,c++):c>s&&(h=270,c--):u<n?(h=0,u++):u>n&&(h=180,u--);const d=r[u][c];if(h!==i&&0!==d&&d!==ke.bN){if(o.push(a),o.push(l),this.CT(a,l,h,n,s,o))return!0;o.pop(),o.pop()}if(r[a][l]=ke.bN,0===i){if(a===t)return!1;a--}else if(90===i){if(l===e)return!1;l--}else if(180===i){if(a===t)return!1;a++}else{if(l===e)return!1;l++}}}}class Se{Me;hl;os;Od;constructor(t,e){u.Gi(this),this.Me=t,this.hl=e,this.os=[],this.Od=!1}toString(){const t=this.os;let e=this.Me.toString()+" "+t.length.toString()+":";for(let i=0;i<t.length;i++){const n=t[i];null!==n&&(e+="\n  "+n.toString())}return e}FO(t,e,i,n){const s=e.offsetY;switch(s){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}let o=i;switch(s){case 9:return o>180?270:90;case 6:return o>90&&o<=270?180:0}const r=180*Math.atan2(t.height,t.width)/Math.PI;switch(s){case 3:return o>r&&o<=180+r?180:270;case 5:return o>180-r&&o<=360-r?270:0;case 12:return o>r&&o<=180+r?90:0;case 10:return o>180-r&&o<=360-r?180:90;case 7:return o>90&&o<=180+r?180:o>180+r&&o<=360-r?270:0;case 13:return o>180&&o<=360-r?270:o>r&&o<=180?90:0;case 14:return o>r&&o<=180-r?90:o>180-r&&o<=270?180:0;case 11:return o>180-r&&o<=180+r?180:o>180+r?270:90}return n&&15!==s&&(o-=15,o<0&&(o+=360)),o>r&&o<180-r?90:o>=180-r&&o<=180+r?180:o>180+r&&o<360-r?270:0}Sd(){this.os.length=0}ST(t){let e=this.os;0===e.length&&(this.RO(),e=this.os);for(let i=0;i<e.length;i++){const n=e[i];if(null!==n&&n.Ge===t)return n}return null}RO(){if(!this.Od){const t=this.Od;this.Od=!0;let e,i=null;const n=this.Me,s=n instanceof Ne?n:null;if(null===s||s.isSubGraphExpanded)e=n.isTreeExpanded?n.findLinksConnected(this.hl.portId):n.findExternalTreeLinksConnected();else{if(!s.actualBounds.isReal())return this.Od=t,this.os;i=s,e=i.findExternalLinksConnected()}this.os.length=0;let o=0;const r=this.hl.getDocumentPoint(w.TopLeft,y.l()),a=this.hl.getDocumentPoint(w.BottomRight,y.l()),l=v.V(r.x,r.y,0,0);l.unionPoint(a),y.e(r),y.e(a);const h=y.V(l.x+l.width/2,l.y+l.height/2),u=this.hl.getDocumentAngle(),c=e.iterator;for(;c.next();){const t=c.value;if(!t.isVisible()||t.fromPort===t.toPort)continue;const e=t.fromPort===this.hl||null!==t.fromNode&&null!==i&&t.fromNode.isMemberOf(i),n=t.computeSpot(e,this.hl);if(!n.isSide())continue;let s;if(s=e?t.toPort:t.fromPort,null===s)continue;let r=s.part;if(null===r)continue;const a=r.findVisibleNode();null!==a&&a!==r&&(r=a,s=r.port);const d=t.computeOtherPoint(r,s);let f=h.directionPoint(d);f-=u,f<0?f+=360:f>=360&&(f-=360);const g=this.FO(l,n,f,t.isOrthogonal);let p=0;0===g?(p=4,f>180&&(f-=360)):90===g?(p=8,f>270&&(f-=360)):180===g?p=2:(p=1,f<90&&(f+=360));let m=this.os[o];void 0===m?(m=new Pe(t,f,p),this.os[o]=m):(m.Ge=t,m.Yt=f,m.me=p),m.D1.set(d),o++}y.e(h),this.vO();const d=this.os.length;let f=-1,g=0;for(o=0;o<d;o++){const t=this.os[o];void 0!==t&&(t.me!==f&&(f=t.me,g=0),t.Id=g,g++)}for(f=-1,g=0,o=d-1;o>=0;o--){const t=this.os[o];void 0!==t&&(t.me!==f&&(f=t.me,g=t.Id+1),t.Mf=g)}this.OO(this.os),this.IO(this.os),this.Od=t,v.e(l)}return this.os}EO(t,e){return t===e?0:null===t?-1:null===e?1:t.me<e.me?-1:t.me>e.me?1:t.Yt<e.Yt?-1:t.Yt>e.Yt?1:0}vO(){this.os.sort(Se.prototype.EO)}OO(t){const e=this.hl,i=this.Me.portSpreading,n=y.l(),s=y.l(),o=y.l(),r=y.l();e.getDocumentPoint(w.TopLeft,n),e.getDocumentPoint(w.TopRight,s),e.getDocumentPoint(w.BottomRight,o),e.getDocumentPoint(w.BottomLeft,r);let a=0,l=0,h=0,u=0;if(2===i)for(let y=0;y<t.length;y++){const e=t[y];if(null===e)continue;const i=e.Ge.computeThickness();switch(e.me){case 8:h+=i;break;case 2:u+=i;break;case 1:a+=i;break;default:l+=i}}let c=0,d=0,f=1,g=s,p=o,m=0,x=0;for(let y=0;y<t.length;y++){const e=t[y];if(null===e)continue;if(c!==e.me){switch(c=e.me,c){case 8:g=o,p=r;break;case 2:g=r,p=n;break;case 1:g=n,p=s;break;default:g=s,p=o}switch(m=p.x-g.x,x=p.y-g.y,c){case 8:h>Math.abs(m)?(f=Math.abs(m)/h,h=Math.abs(m)):f=1;break;case 2:u>Math.abs(x)?(f=Math.abs(x)/u,u=Math.abs(x)):f=1;break;case 1:a>Math.abs(m)?(f=Math.abs(m)/a,a=Math.abs(m)):f=1;break;default:l>Math.abs(x)?(f=Math.abs(x)/l,l=Math.abs(x)):f=1}d=0}const v=e.Fd;if(2===i){let t=e.Ge.computeThickness();switch(t*=f,v.set(g),c){case 8:v.x=g.x+m/2+h/2-d-t/2;break;case 2:v.y=g.y+x/2+u/2-d-t/2;break;case 1:v.x=g.x+m/2-a/2+d+t/2;break;default:v.y=g.y+x/2-l/2+d+t/2}d+=t}else{let t=.5;1===i&&(t=(e.Id+1)/(e.Mf+1)),v.x=g.x+m*t,v.y=g.y+x*t}}y.e(n),y.e(s),y.e(o),y.e(r)}IO(t){for(let e=0;e<t.length;e++){const i=t[e];null!==i&&(i.C1=this.BO(i))}}BO(t){const e=t.Ge,i=e.fromPort===this.hl,n=e.computeEndSegmentLength(this.Me,this.hl,w.None,i);let s=t.Id;if(s<0)return n;const o=t.Mf;if(o<=1||!e.isOrthogonal)return n;const r=t.D1,a=t.Fd;(2===t.me||8===t.me)&&(s=o-1-s);const l=be.lO,h=2===t.me||4===t.me;return(h?r.y<a.y:r.x<a.x)?n+s*l:(h?r.y===a.y:r.x===a.x)?n:n+(o-1-s)*l}}class Pe{Ge;Yt;me;D1;Id;Mf;Fd;C1;constructor(t,e,i){this.Ge=t,this.Yt=e,this.me=i,this.D1=new y,this.Id=0,this.Mf=0,this.Fd=new y,this.C1=0}toString(){return this.Ge.toString()+" "+this.Yt.toString()+" "+this.me.toString()+":"+this.Id.toString()+"/"+this.Mf.toString()+" "+this.Fd.toString()+" "+this.C1.toString()+" "+this.D1.toString()}}class Me{ga;ma;pa;ya;wa;xa;v0;F0;O0;R0;constructor(){this.ga=w.Default,this.ma=w.Default,this.pa=NaN,this.ya=NaN,this.wa=NaN,this.xa=NaN,this.v0=null,this.F0=null,this.O0=1/0,this.R0=1/0}copy(){const t=new Me;return t.ga=this.ga.P(),t.ma=this.ma.P(),t.pa=this.pa,t.ya=this.ya,t.wa=this.wa,t.xa=this.xa,t.v0=this.v0,t.F0=this.F0,t.O0=this.O0,t.R0=this.R0,t}}class Ce{M0;N0;C0;S0;mp;pp;constructor(){this.M0=-1/0,this.N0=0,this.C0=y.wo,this.S0=0,this.mp="None",this.pp="None"}copy(){const t=new Ce;return t.M0=this.M0,t.N0=this.N0,t.C0=this.C0.P(),t.S0=this.S0,t.mp=this.mp,t.pp=this.pp,t}}class Ne extends pe{Ed;Ft;aa;l0;si;ie;constructor(t,e){let i;void 0===t||t instanceof Xt||"string"==typeof t?i=t:t&&(e=t),super(i),this.v=4608|this.v,this.Ed=new u,this.Ft=null,this.ie=new Le,this.ie.group=this,this.aa=new u,this.l0=null,this.si=null,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),this.v=-32769&this.v;const e=t.findInVisualTree((t=>t instanceof Te));t.Ft=e instanceof Te?e:null,null!==this.ie?(t.ie=this.ie.copy(),t.ie.group=t):(null!==t.ie&&(t.ie.group=null),t.ie=null),null!==this.si&&(t.si=this.si.copy())}Ro(t){super.Ro(t);const e=t.findSubGraphParts(),i=t.memberParts;for(;i.next();){const t=i.value;if(t.c(),t.invalidateLayout(8),t.clearAdornments(),t instanceof pe)t.invalidateConnectedLinks(e);else if(t instanceof be){const i=t.labelNodes;for(;i.next();)i.value.invalidateConnectedLinks(e)}}}qc(t,i,n,s,o,r,a){if(3===t&&"elements"===i){if(o instanceof Te)null===this.Ft?this.Ft=o:this.Ft!==o&&e.o("Cannot insert a second Placeholder into the visual tree of a Group.");else if(o instanceof Yt){const t=o.findInVisualTree((t=>t instanceof Te));t instanceof Te&&(null===this.Ft?this.Ft=t:this.Ft!==t&&e.o("Cannot insert a second Placeholder into the visual tree of a Group."))}}else 4===t&&"elements"===i&&null!==this.Ft&&(s===this.Ft||s instanceof Yt&&this.Ft.isContainedBy(s))&&(this.Ft=null);super.qc(t,i,n,s,o,r,a)}Ju(t,e){if(super.Ju(t,e),this.isClipping&&this.type!==Yt.Spot&&this.isSubGraphExpanded){let t=this.resizeObject;t instanceof Yt&&(t=t.findMainElement()),null===this.si&&(this.si=new v),t.getDocumentBounds(this.si),t instanceof Jt&&this.si.inflate(-t.strokeWidth,-t.strokeWidth)}}fh(t,e,i,n){this.hasPlaceholder()&&(this.Yo=this.placeholder),super.fh(t,e,i,n)}ensureBounds(){this.isSubGraphExpanded&&this.memberParts.each((t=>{t.ensureBounds()})),super.ensureBounds()}Xr(){if(!super.Xr())return!1;const t=this.memberParts;for(;t.next();){const e=t.value;if(e instanceof pe){if(!e.isVisible())continue;if(e._e())return!1}else if(e instanceof be){if(!e.isVisible())continue;if(e._e()&&e.fromNode!==this&&e.toNode!==this)return!1}}return!0}hasPlaceholder(){return null!==this.Ft&&this.Ft.isVisibleObject()&&this.isSubGraphExpanded}get placeholder(){return this.Ft}get computesBoundsAfterDrag(){return 0!==(2048&this.v)}set computesBoundsAfterDrag(t){const e=0!==(2048&this.v);e!==t&&(this.v=2048^this.v,this.t("computesBoundsAfterDrag",e,t))}get computesBoundsIncludingLinks(){return 0!==(4096&this.v)}set computesBoundsIncludingLinks(t){const e=0!==(4096&this.v);e!==t&&(this.v=4096^this.v,this.t("computesBoundsIncludingLinks",e,t))}get computesBoundsIncludingLocation(){return 0!==(8192&this.v)}set computesBoundsIncludingLocation(t){const e=0!==(8192&this.v);e!==t&&(this.v=8192^this.v,this.t("computesBoundsIncludingLocation",e,t))}get handlesDragDropForMembers(){return 0!==(16384&this.v)}set handlesDragDropForMembers(t){const e=0!==(16384&this.v);e!==t&&(this.v=16384^this.v,this.t("handlesDragDropForMembers",e,t))}get avoidableMembers(){return 0!==(131072&this.v)}set avoidableMembers(t){const e=0!==(131072&this.v);e!==t&&(this.v=131072^this.v,this.t("avoidableMembers",e,t))}get memberParts(){return this.Ed.iterator}eN(t){if(this.Ed.add(t)){t instanceof Ne&&this.aa.add(t);const e=this.memberAdded;if(null!==e){let i=!0;const n=this.diagram;null!==n&&(i=n.X,n.X=!0),e(this,t),null!==n&&(n.X=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Ei(!1)}if(t instanceof be&&!this.computesBoundsIncludingLinks)return;let e=this.Ft;null===e&&(e=this),e.c()}iN(t){if(this.Ed.delete(t)){t instanceof Ne&&this.aa.delete(t);const e=this.memberRemoved;if(null!==e){let i=!0;const n=this.diagram;null!==n&&(i=n.X,n.X=!0),e(this,t),null!==n&&(n.X=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Ei(!0)}if(t instanceof be&&!this.computesBoundsIncludingLinks)return;let e=this.Ft;null===e&&(e=this),e.c()}Xc(){if(this.Ed.count>0){const t=this.diagram;if(null!==t){const e=this.Ed.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}super.Xc()}get layout(){return this.ie}set layout(t){const i=this.ie;if(i!==t){null!==t&&null!==t.diagram&&t.diagram.layout===t&&e.o("A layout cannot be both the Diagram.layout and a Group.layout: "+t),null!==i&&(i.diagram=null,i.group=null),this.ie=t;const n=this.diagram;null!==t&&(t.diagram=n,t.group=this),null!==n&&(n.Ur=!0),this.t("layout",i,t),null!==n&&n.requestUpdate()}}get memberAdded(){return null!==this.Rt?this.Rt.fy:null}set memberAdded(t){const i=this.memberAdded;i!==t&&(null!==t&&e.k(t,Ne,"memberAdded"),this.rl().fy=t,this.t("memberAdded",i,t))}get memberRemoved(){return null!==this.Rt?this.Rt.uy:null}set memberRemoved(t){const i=this.memberRemoved;i!==t&&(null!==t&&e.k(t,Ne,"memberRemoved"),this.rl().uy=t,this.t("memberRemoved",i,t))}get memberValidation(){return null!==this.Rt?this.Rt.eh:null}set memberValidation(t){const i=this.memberValidation;i!==t&&(null!==t&&e.k(t,Ne,"memberValidation"),this.rl().eh=t,this.t("memberValidation",i,t))}canAddMembers(t){const e=this.diagram;if(null===e)return!1;const i=e.commandHandler,n=i.g2(t).iterator;for(;n.next();){const t=n.value;if(!i.isValidMember(this,t))return!1}return!0}addMembers(t,e){const i=this.diagram;if(null===i)return!1;const n=i.commandHandler;let s=!0;const o=n.g2(t).iterator;for(;o.next();){const t=o.value;!e||n.isValidMember(this,t)?t.containingGroup=this:s=!1}return s}get ungroupable(){return 0!==(256&this.v)}set ungroupable(t){const e=0!==(256&this.v);e!==t&&(this.v=256^this.v,this.t("ungroupable",e,t))}canUngroup(){if(!this.ungroupable)return!1;const t=this.layer;if(null===t||!t.allowUngroup)return!1;const e=t.diagram;return!(null!==e&&!e.allowUngroup)}invalidateConnectedLinks(t){const e=this.UO();if(super.invalidateConnectedLinks(t),e)return;this.XL(!0);const i=this.findExternalLinksConnected();for(;i.next();){const e=i.value;if(void 0!==t&&t.has(e))continue;const n=e.fromNode;if(null!==n&&n!==this&&n.isMemberOf(this)&&!n.isVisible())n.qi(e.fromPort),n.qi(e.toPort),e.invalidateRoute();else{const t=e.toNode;null!==t&&t!==this&&t.isMemberOf(this)&&!t.isVisible()&&(t.qi(e.fromPort),t.qi(e.toPort),e.invalidateRoute())}}}findExternalLinksConnected(){const t=null!==this.diagram&&this.diagram.SM;if(t&&null!==this.l0)return this.l0.iterator;const e=this.findSubGraphParts();e.add(this);const i=new u,n=e.iterator;for(;n.next();){const t=n.value;if(!(t instanceof pe))continue;const s=t.linksConnected;for(;s.next();){const t=s.value;e.has(t)||i.add(t)}}return t&&(this.l0=i),i.iterator}findExternalNodesConnected(){const t=this.findSubGraphParts();t.add(this);const e=new u,i=t.iterator;for(;i.next();){const n=i.value;if(!(n instanceof pe))continue;const s=n.linksConnected;for(;s.next();){const i=s.value,n=i.fromNode;null!==n&&(!t.has(n)||n===this)&&e.add(n);const o=i.toNode;null!==o&&(!t.has(o)||o===this)&&e.add(o)}}return e.iterator}RE(){const t=new u;return function t(e,i){null!==e&&(i.add(e),t(e.containingGroup,i))}(this,t),t}findSubGraphParts(){const t=new u;return ce.nh(t,this,!0,0,!0),t.delete(this),t}Ei(t){super.Ei(t);const e=this.memberParts;for(;e.next();)e.value.Ei(t)}collapseSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.LT(e,t,this),t.isCollapsingExpanding=!1}LT(t,e,i){const n=this.memberParts;for(;n.next();){const s=n.value;if(s.Ei(!1),s instanceof Ne&&s.isSubGraphExpanded&&(s.wasSubGraphExpanded=s.isSubGraphExpanded,s.LT(t,e,i)),s instanceof pe)s.invalidateConnectedLinks(t),e.Lc(s,i);else if(s instanceof be){const e=s.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!1}expandSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.AT(e,t,this),t.isCollapsingExpanding=!1}AT(t,e,i){const n=this.memberParts;for(;n.next();){const s=n.value;if(s.Ei(!0),s instanceof Ne&&s.wasSubGraphExpanded&&(s.wasSubGraphExpanded=!1,s.AT(t,e,i)),s instanceof pe)s.invalidateConnectedLinks(t);else if(s instanceof be){const e=s.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!0}get isSubGraphExpanded(){return 0!==(512&this.v)}set isSubGraphExpanded(t){const e=0!==(512&this.v);if(e!==t){this.v=512^this.v;const i=this.diagram;this.t("isSubGraphExpanded",e,t);const n=this.subGraphExpandedChanged;if(null!==n){let t=!0;null!==i&&(t=i.X,i.X=!0),n(this),null!==i&&(i.X=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return null!==this.Ft&&this.Ft.c(),void this.memberParts.each((t=>t.updateAdornments()));t?this.expandSubGraph():this.collapseSubGraph()}}get wasSubGraphExpanded(){return 0!==(1024&this.v)}set wasSubGraphExpanded(t){const e=0!==(1024&this.v);e!==t&&(this.v=1024^this.v,this.t("wasSubGraphExpanded",e,t))}get subGraphExpandedChanged(){return null!==this.Rt?this.Rt.gy:null}set subGraphExpandedChanged(t){const i=this.subGraphExpandedChanged;i!==t&&(null!==t&&e.k(t,Ne,"subGraphExpandedChanged"),this.rl().gy=t,this.t("subGraphExpandedChanged",i,t))}move(t,e){void 0===e&&(e=!1);const i=e?this.location:this.position,n=i.x,s=i.y,o=t.x,r=t.y;if((n===o||isNaN(n)&&isNaN(o))&&(s===r||isNaN(s)&&isNaN(r)))return;const a=o-(isNaN(n)?0:n),l=r-(isNaN(s)?0:s),h=y.l();super.move(t,e);const c=new u,d=this.findSubGraphParts().iterator;for(;d.next();){const t=d.value;t instanceof be&&(t.suspendsRouting&&c.add(t),(t.Se||t.fromNode!==this&&t.toNode!==this)&&(t.suspendsRouting=!0))}for(d.reset();d.next();){const t=d.value;if(t.Nl()||t instanceof pe&&t.isLinkLabel)continue;const e=t.position,i=t.location;e.isReal()?(h.x=e.x+a,h.y=e.y+l,t.position=h):i.isReal()&&(h.x=i.x+a,h.y=i.y+l,t.location=h)}for(d.reset();d.next();){const t=d.value;if(!(t instanceof be)||(t.suspendsRouting=c.has(t),!t.Se&&(t.fromNode===this||t.toNode===this)))continue;const e=t.position;h.x=e.x+a,h.y=e.y+l,h.isReal()?t.move(h):t.invalidateRoute()}y.e(h)}UO(){return 0!==(65536&this.v)}XL(t){0!==(65536&this.v)!==t&&(this.v=65536^this.v)}get ca(){return 0!==(32768&this.v)}set ca(t){0!==(32768&this.v)!==t&&(this.v=32768^this.v)}}class Te extends At{Zt;Bd;constructor(t){super(),this.Zt=b.Rg,this.Bd=new v(NaN,NaN,NaN,NaN),t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Zt=this.Zt.P(),t.Bd=this.Bd.copy()}ch(t){if(null===this.background)return!1;const e=this.naturalBounds;return v.contains(0,0,e.width,e.height,t.x,t.y)}Wu(t,i,n,s){const o=this.part;if((null===o||!(o instanceof Ne)&&!(o instanceof fe))&&e.o("Placeholder is not inside a Group or Adornment."),o instanceof Ne){const t=this.computeBorder(this.Bd),e=this.minSize,i=isFinite(e.width)?Math.max(e.width,t.width):t.width,n=isFinite(e.height)?Math.max(e.height,t.height):t.height,s=this.zi;s.Fn(i||0,n||0),this.Wn(0,0,s.width,s.height);const r=o.memberParts;let a=!1;for(;r.next();)if(r.value.isVisible()){a=!0;break}const l=o.diagram;if(a&&null!==l&&!l.animationManager.ES(o)&&!isNaN(t.x)&&!isNaN(t.y)){const e=y.l();e.setRectSpot(t,o.locationSpot),o.location=e,y.e(e)}}else{const t=o,e=this.zi,i=this.Zt,n=i.left+i.right,s=i.top+i.bottom,r=t.adornedObject,a=r.getDocumentAngle();t.angle=a;let l=0;r instanceof Jt&&(l=r.strokeWidth);const h=r.getDocumentScale(),u=r.naturalBounds,c=(u.width+l)*h,d=(u.height+l)*h;if(t.type!==Yt.Link){const e="Selection"===t.category?w.TopLeft:t.locationSpot,i=r.getDocumentPoint(e,y.l());t.location=i,y.e(i)}if(isNaN(c)||isNaN(d)){const t=r.getDocumentPoint(w.TopLeft,y.l()),o=v.V(t.x,t.y,0,0);o.unionPoint(r.getDocumentPoint(w.BottomRight,t)),o.unionPoint(r.getDocumentPoint(w.TopRight,t)),o.unionPoint(r.getDocumentPoint(w.BottomLeft,t)),e.Fn(o.width+n||0,o.height+s||0),this.Wn(-i.left,-i.top,e.width,e.height),y.e(t),v.e(o)}else e.Fn(c+n||0,d+s||0),this.Wn(-i.left,-i.top,e.width,e.height)}}fh(t,e,i,n){this.actualBounds.i(t,e,i,n)}computeBorder(t){const e=this.part,i=e.diagram,n=null===i||!i.animationManager.isAnimating;if(null!==i&&e instanceof Ne&&!e.layer.isTemporary&&e.computesBoundsAfterDrag&&this.Bd.isReal()){const n=i.toolManager.findTool("Dragging");if(n===i.currentTool){const i=n.computeBorder(e,this.Bd,t);if(null!==i)return i}}const s=v.l(),o=this.computeMemberBounds(s),r=this.Zt;return e instanceof Ne&&!e.isSubGraphExpanded?t.i(o.x-r.left,o.y-r.top,0,0):t.i(o.x-r.left,o.y-r.top,Math.max(o.width+r.left+r.right,0),Math.max(o.height+r.top+r.bottom,0)),v.e(s),n&&e instanceof Ne&&e.computesBoundsIncludingLocation&&e.location.isReal()&&t.unionPoint(e.location),t}computeMemberBounds(t){if(!(this.part instanceof Ne))return t.i(0,0,0,0),t;const e=this.part;let i=1/0,n=1/0,s=-1/0,o=-1/0;const r=e.memberParts;for(;r.next();){const t=r.value;if(!t.isVisible()||t instanceof be&&(!e.computesBoundsIncludingLinks||t.Ao()||t.fromNode===e||t.toNode===e))continue;const a=t.actualBounds;a.left<i&&(i=a.left),a.top<n&&(n=a.top),a.right>s&&(s=a.right),a.bottom>o&&(o=a.bottom)}if(isFinite(i)&&isFinite(n))t.i(i,n,s-i,o-n);else{const i=e.location;t.i(i.x,i.y,0,0)}return t}get padding(){return this.Zt}set padding(t){"number"==typeof t&&(t=new b(t));const e=this.Zt;e.equals(t)||(t=t.P(),this.Zt=t,this.t("padding",e,t),this.c())}}class Le{N;fa;Ud;yr;Vd;zd;No;al;Xd;Yd;ho;constructor(t){u.Gi(this),this.N=null,this.fa=null,this.Ud=!0,this.yr=!0,this.Vd=!1,this.zd=new y(0,0).u(),this.No=!0,this.al=null,this.Xd=null,this.Yd=!1,this.ho=null,t&&Object.assign(this,t)}cloneProtected(t){t.Ud=this.Ud,t.yr=this.yr,t.Vd=this.Vd,t.zd.a(this.zd),t.No=this.No,t.al=this.al,t.Xd=this.Xd,t.Yd=!0}copy(){const t=new this.constructor;return this.cloneProtected(t),t}oi(t){e.ir(this,t)}toString(){let t=e.Dn(this.constructor);return t+="(",null!==this.group&&(t+=" in "+this.group),null!==this.diagram&&(t+=" for "+this.diagram),t+=")",t}get diagram(){return this.N}set diagram(t){this.N=t}get group(){return this.fa}set group(t){this.fa!==t&&(this.fa=t,null!==t&&(this.N=t.diagram))}get isOngoing(){return this.Ud}set isOngoing(t){this.Ud!==t&&(e.s(t,"boolean",Le,"isOngoing"),this.Ud=t)}get isInitial(){return this.yr}set isInitial(t){e.s(t,"boolean",Le,"isInitial"),this.yr=t,t||(this.Yd=!0)}get isViewportSized(){return this.Vd}set isViewportSized(t){this.Vd!==t&&(e.s(t,"boolean",Le,"isViewportSized"),this.Vd=t,t&&this.invalidateLayout())}get isRouting(){return this.No}set isRouting(t){this.No!==t&&(e.s(t,"boolean",Le,"isRouting"),this.No=t)}get isRealtime(){return this.al}set isRealtime(t){this.al!==t&&(null!==t&&e.s(t,"boolean",Le,"isRealtime"),this.al=t)}get isValidLayout(){return this.Yd}set isValidLayout(t){if(this.Yd!==t&&(e.s(t,"boolean",Le,"isValidLayout"),this.Yd=t,!t)){const t=this.diagram;null!==t&&(t.Ur=!0)}}invalidateLayout(){if(this.isValidLayout){const t=this.diagram;if(null===t||t.undoManager.isUndoingRedoing)return;const e=t.animationManager;if(e.isTicking)return;e.defaultAnimation.isAnimating&&e.stopAnimation(),(this.isOngoing&&t.Uh||this.isInitial&&!t.Uh)&&(this.isValidLayout=!1,t.requestUpdate())}}get network(){return this.ho}set network(t){this.ho!==t&&(this.ho=t,null!==t&&(t.layout=this))}createNetwork(){return new Ae(this)}makeNetwork(t){const e=this.createNetwork();return t instanceof vt?(e.addParts(t.nodes,!0),e.addParts(t.links,!0)):t instanceof Ne?e.addParts(t.memberParts):e.addParts(t.iterator),e}updateParts(){this.isValidLayout=!0;let t=this.diagram;if(null===t&&null!==this.network){const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value.node;if(null!==i&&(t=i.diagram,null!==t))break}}try{null!==t&&t.startTransaction("Layout"),this.commitLayout()}finally{null!==t&&t.commitTransaction("Layout")}}commitLayout(){if(null===this.network)return;const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();if(this.isRouting){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}}doLayout(t){const e=new u;if(t instanceof vt?(this.Sh(e,t.nodes,!0,this.ca,!0,!1,!0),this.Sh(e,t.parts,!0,this.ca,!0,!1,!0)):t instanceof Ne?this.Sh(e,t.memberParts,!1,this.ca,!0,!1,!0):e.addAll(t.iterator),e.count>0){const t=this.diagram;null!==t&&t.startTransaction("Layout"),this.doMinimalNoNetworkLayout(e),null!==t&&t.commitTransaction("Layout")}this.isValidLayout=!0}doMinimalNoNetworkLayout(t){const e=t.count,i=Math.ceil(Math.sqrt(e));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const n=this.arrangementOrigin.x;let s=n,o=this.arrangementOrigin.y,r=0,a=0;const l=t.iterator;for(;l.next();){const t=l.value;t.ensureBounds();const e=t.measuredBounds,h=e.width,u=e.height;t.moveTo(s,o),t instanceof Ne&&(t.ca=!1),s+=Math.max(h,50)+20,a=Math.max(a,Math.max(u,50)),r>=i-1?(r=0,s=n,o+=a+20,a=0):r++}}ca(t){return!!(!t.location.isReal()&&!t.position.isReal()||t instanceof Ne&&t.ca)}Sh(t,e,i,n,s,o,r){const a=e.iterator;for(;a.next();){const e=a.value;if((!i||e.isTopLevel)&&(null===n||n(e))&&e.canLayout())if(s&&e instanceof pe){if(e.isLinkLabel)continue;e instanceof Ne&&null===e.layout?this.Sh(t,e.memberParts,!1,n,s,o,r):(e.ensureBounds(),t.add(e))}else o&&e instanceof be?t.add(e):r&&e.ke()&&!(e instanceof pe)&&(e.ensureBounds(),t.add(e))}}getLayoutBounds(t,e){const i=this.boundsComputation;return null!==i?(e||(e=new v),i(t,this,e)):!e&&t.margin.equalTo(0,0,0,0)?t.actualBounds:(e||(e=new v),e.set(t.actualBounds),e.addMargin(t.margin),e)}get boundsComputation(){return this.Xd}set boundsComputation(t){this.Xd!==t&&(null!==t&&e.k(t,Le,"boundsComputation"),this.Xd=t,this.invalidateLayout())}collectParts(t){const e=new u;return t instanceof vt?(this.Sh(e,t.nodes,!0,null,!0,!0,!0),this.Sh(e,t.links,!0,null,!0,!0,!0),this.Sh(e,t.parts,!0,null,!0,!0,!0)):t instanceof Ne?this.Sh(e,t.memberParts,!1,null,!0,!0,!0):this.Sh(e,t.iterator,!1,null,!0,!0,!0),e}get arrangementOrigin(){return this.zd}set arrangementOrigin(t){this.zd.equals(t)||(this.zd.a(t),this.invalidateLayout())}initialOrigin(t){const e=this.group;if(null!==e){if(e.hasPlaceholder()){const i=e.placeholder,n=i.getDocumentPoint(w.TopLeft);(isNaN(n.x)||isNaN(n.y))&&n.set(t);const s=i.padding;return n.x+=s.left,n.y+=s.top,n}{const i=e.position.copy();return(isNaN(i.x)||isNaN(i.y))&&i.set(t),i}}return t}}class Ae{ie;ao;bn;by;ky;constructor(t){u.Gi(this),this.ie=t,this.ao=new u,this.bn=new u,this.by=new m,this.ky=new m}clear(){if(this.ao){const t=this.ao.iterator;for(;t.next();)t.value.clear()}if(this.bn){const t=this.bn.iterator;for(;t.next();)t.value.clear()}this.ao=new u,this.bn=new u,this.by=new m,this.ky=new m}toString(t){void 0===t&&(t=0);let e="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(t<=0)return e;if(e+=" vertexes: "+this.ao.count+" edges: "+this.bn.count,t>1){const i=this.ao.iterator;for(;i.next();){e+="\n    "+i.value.toString(t-1)}const n=this.bn.iterator;for(;n.next();){e+="\n    "+n.value.toString(t-1)}}return e}get layout(){return this.ie}set layout(t){null!==t&&(this.ie=t)}get vertexes(){return this.ao}get edges(){return this.bn}createVertex(){return new De(this)}createEdge(){return new Fe(this)}addParts(t,i,n){if(null===t)return;void 0===i&&(i=!1),e.s(i,"boolean",Ae,"addParts:toplevelonly"),void 0===n&&(n=null),null===n&&(n=t=>{if(t instanceof pe)return!t.isLinkLabel;if(t instanceof be){const e=t.fromNode;if(null===e||e.isLinkLabel)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel)}return!1});const s=t.iterator;for(;s.next();){const t=s.value;if(t instanceof pe&&(!i||t.isTopLevel)&&t.canLayout()&&n(t))if(t instanceof Ne&&null===t.layout)this.addParts(t.memberParts,!1);else{if(null!==this.findVertex(t))continue;const e=this.createVertex();e.node=t,this.addVertex(e)}}for(s.reset();s.next();){const t=s.value;if(!(t instanceof be)||i&&!t.isTopLevel||!t.canLayout()||!n(t)||null!==this.findEdge(t))continue;const e=t.fromNode,o=t.toNode;if(null===e||null===o||e===o)continue;const r=this.findGroupVertex(e),a=this.findGroupVertex(o);this.linkVertexes(r,a,t)}}findGroupVertex(t){const e=t.findVisibleNode();if(null===e)return null;let i=this.findVertex(e);if(null!==i)return i;let n=e.containingGroup;for(;null!==n;){if(i=this.findVertex(n),null!==i)return i;n=n.containingGroup}return null}addVertex(t){this.ao.add(t);const e=t.node;null!==e&&this.by.set(e,t),t.network=this}addNode(t){let e=this.findVertex(t);return null===e&&(e=this.createVertex(),e.node=t,this.addVertex(e)),e}deleteVertex(t){if(this.TT(t)){let e=t.Ho;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}e=t.jo;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}}}TT(t){const e=this.ao.delete(t);if(e){const e=t.node;null!==e&&this.by.delete(e)}return e}deleteNode(t){const e=this.findVertex(t);null!==e&&this.deleteVertex(e)}findVertex(t){return this.by.get(t)}addEdge(t){this.kN(t);const e=t.toVertex;null!==e&&e.addSourceEdge(t);const i=t.fromVertex;null!==i&&i.addDestinationEdge(t)}kN(t){this.bn.add(t);const e=t.link;null!==e&&null===this.findEdge(e)&&this.ky.set(e,t),t.network=this}addLink(t){const e=t.fromNode,i=t.toNode;let n=this.findEdge(t);return null===n?(n=this.createEdge(),n.link=t,null!==e&&(n.fromVertex=this.addNode(e)),null!==i&&(n.toVertex=this.addNode(i)),this.addEdge(n)):(n.fromVertex=null!==e?this.addNode(e):null,n.toVertex=null!==i?this.addNode(i):null),n}deleteEdge(t){const e=t.toVertex;null!==e&&e.deleteSourceEdge(t);const i=t.fromVertex;null!==i&&i.deleteDestinationEdge(t),this.PN(t)}PN(t){const e=this.bn.delete(t);if(e){const e=t.link;null!==e&&this.ky.delete(e)}return e}deleteLink(t){const e=this.findEdge(t);null!==e&&this.deleteEdge(e)}findEdge(t){return this.ky.get(t)}linkVertexes(t,e,i){if(null===t||null===e)return null;if(t.network===this&&e.network===this){const n=this.createEdge();return n.link=i,n.fromVertex=t,n.toVertex=e,this.addEdge(n),n}return null}reverseEdge(t){const e=t.fromVertex,i=t.toVertex;null===e||null===i||(e.deleteDestinationEdge(t),i.deleteSourceEdge(t),t.reverseEdge(),e.addSourceEdge(t),i.addDestinationEdge(t))}deleteSelfEdges(){const t=e.et(),i=this.bn.iterator;for(;i.next();){const e=i.value;e.fromVertex===e.toVertex&&t.push(e)}const n=t.length;for(let e=0;e<n;e++)this.deleteEdge(t[e]);e.J(t)}deleteArtificialVertexes(){const t=e.et(),i=this.ao.iterator;for(;i.next();){const e=i.value;null===e.node&&null===e.data&&t.push(e)}let n=t.length;for(let e=0;e<n;e++)this.deleteVertex(t[e]);const s=e.et(),o=this.bn.iterator;for(;o.next();){const t=o.value;null===t.link&&null===t.data&&s.push(t)}n=s.length;for(let e=0;e<n;e++)this.deleteEdge(s[e]);e.J(t),e.J(s)}deleteUselessEdges(){const t=e.et(),i=this.bn.iterator;for(;i.next();){const e=i.value;(null===e.fromVertex||null===e.toVertex)&&t.push(e)}const n=t.length;for(let e=0;e<n;e++)this.deleteEdge(t[e]);e.J(t)}isSingleton(t){return!(t.Ho.count>0||t.jo.count>0)}splitIntoSubNetworks(t){void 0===t&&(t=!0),t&&(this.deleteArtificialVertexes(),this.deleteUselessEdges(),this.deleteSelfEdges());const e=new l;let i=!0;for(;i;){i=!1;const t=this.ao.iterator;for(;t.next();){const n=t.value;if(this.isSingleton(n))continue;const s=this.layout.createNetwork();e.add(s),this.VO(s,n),i=!0;break}}return e.sort(((t,e)=>null===t||null===e||t===e?0:e.vertexes.count-t.vertexes.count)),e}VO(t,e){if(null===e)return;const i=new l;for(i.add(e);i.count>0;){const e=i.first();if(i.removeAt(0),!e||e.network===t)continue;this.TT(e),t.addVertex(e);let n=e.sourceEdges;for(;n.next();){const e=n.value;e.network!==t&&(this.PN(e),t.kN(e),e.fromVertex&&i.add(e.fromVertex))}for(n=e.destinationEdges;n.next();){const e=n.value;e.network!==t&&(this.PN(e),t.kN(e),e.toVertex&&i.add(e.toVertex))}}}findAllParts(){const t=new u,e=this.ao.iterator;for(;e.next();){const i=e.value;i.node&&t.add(i.node)}const i=this.bn.iterator;for(;i.next();){const e=i.value;e.link&&t.add(e.link)}return t}}class De{ho;_t;Me;Le;He;Ho;jo;constructor(t){u.Gi(this),this.ho=t,this.Le=new v(0,0,10,10).u(),this.He=new y(5,5).u(),this._t=null,this.Me=null,this.Ho=new l,this.jo=new l}clear(){this._t=null,this.Me=null,this.Ho=new l,this.jo=new l}toString(t){void 0===t&&(t=0);let e="LayoutVertex#"+u.as(this);if(t>0&&(e+=null!==this.node?"("+this.node.toString()+")":"",t>1)){let t="",i=!0,n=this.Ho.iterator;for(;n.next();){i?i=!1:t+=",",t+=n.value.toString(0)}let s="";for(i=!0,n=this.jo.iterator;n.next();){i?i=!1:s+=",",s+=n.value.toString(0)}e+=" sources: "+t+" destinations: "+s}return e}get co(){return this.Ho.uC}get qo(){return this.jo.uC}get data(){return this._t}set data(t){if(this._t=t,null!==t&&t.bounds){const e=t.bounds,i=e.x,n=e.y,s=e.width,o=e.height;this.He.i(s/2,o/2),this.Le.i(i,n,s,o)}}get node(){return this.Me}set node(t){if(this.Me!==t){if(this.Me=t,null===t)return;t.ensureBounds();const e=this.network.layout,i=v.l(),n=e.getLayoutBounds(t,i);let s=n.x,o=n.y;const r=n.width,a=n.height;if(isNaN(s)&&(s=0),isNaN(o)&&(o=0),this.Le.i(s,o,r,a),v.e(i),!(t instanceof Ne)){const e=t.locationObject.getDocumentPoint(w.Center);if(e.isReal())return void this.He.i(e.x-s,e.y-o)}this.He.i(r/2,a/2)}}get bounds(){return this.Le}set bounds(t){this.Le.equals(t)||this.Le.a(t)}get focus(){return this.He}set focus(t){this.He.equals(t)||this.He.a(t)}get centerX(){return this.Le.x+this.He.x}set centerX(t){const e=this.Le;e.x+this.He.x!==t&&(e.Nt(),e.x=t-this.He.x,e.u())}get centerY(){return this.Le.y+this.He.y}set centerY(t){const e=this.Le;e.y+this.He.y!==t&&(e.Nt(),e.y=t-this.He.y,e.u())}get focusX(){return this.He.x}set focusX(t){const e=this.He;e.x!==t&&(e.Nt(),e.x=t,e.u())}get focusY(){return this.He.y}set focusY(t){const e=this.He;e.y!==t&&(e.Nt(),e.y=t,e.u())}get x(){return this.Le.x}set x(t){const e=this.Le;e.x!==t&&(e.Nt(),e.x=t,e.u())}get y(){return this.Le.y}set y(t){const e=this.Le;e.y!==t&&(e.Nt(),e.y=t,e.u())}get width(){return this.Le.width}set width(t){const e=this.Le;e.width!==t&&(e.Nt(),e.width=t,e.u())}get height(){return this.Le.height}set height(t){const e=this.Le;e.height!==t&&(e.Nt(),e.height=t,e.u())}commit(){const t=this._t;if(null!==t){const i=this.bounds,n=t.bounds;return void(e.K(n)?(n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height):t.bounds=i.copy())}const i=this.node;if(null!==i){const t=this.bounds;if(!(i instanceof Ne)){const e=v.l();i.ensureBounds();const n=this.network.layout.getLayoutBounds(i,e),s=i.locationObject.getDocumentPoint(w.Center);if(n.isReal()&&s.isReal())return i.moveTo(t.x+this.focusX-(s.x-n.x)+i.margin.left,t.y+this.focusY-(s.y-n.y+i.margin.top)),void v.e(e);v.e(e)}i.moveTo(t.x+i.margin.left,t.y+i.margin.top)}}addSourceEdge(t){null!==t&&(this.Ho.has(t)||this.Ho.add(t))}deleteSourceEdge(t){null!==t&&this.Ho.delete(t)}addDestinationEdge(t){null!==t&&(this.jo.has(t)||this.jo.add(t))}deleteDestinationEdge(t){null!==t&&this.jo.delete(t)}get network(){return this.ho}set network(t){this.ho=t}get sourceVertexes(){const t=new u,e=this.sourceEdges;for(;e.next();){const i=e.value;i.fromVertex&&t.add(i.fromVertex)}return t.iterator}get destinationVertexes(){const t=new u,e=this.destinationEdges;for(;e.next();){const i=e.value;i.toVertex&&t.add(i.toVertex)}return t.iterator}get vertexes(){const t=new u;let e=this.sourceEdges;for(;e.next();){const i=e.value;i.fromVertex&&t.add(i.fromVertex)}for(e=this.destinationEdges;e.next();){const i=e.value;i.toVertex&&t.add(i.toVertex)}return t.iterator}get sourceEdges(){return this.Ho.iterator}get destinationEdges(){return this.jo.iterator}get edges(){const t=new l;let e=this.sourceEdges;for(;e.next();){const i=e.value;t.add(i)}for(e=this.destinationEdges;e.next();){const i=e.value;t.add(i)}return t.iterator}get edgesCount(){return this.Ho.count+this.jo.count}static standardComparer(t,e){const i=t.Me,n=e.Me;if(i){if(n){const t=i.text,e=n.text;return t<e?-1:t>e?1:0}return 1}return null!==n?-1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.Me,n=e.Me;if(null!==i){if(null!==n){const t=i.text.toLocaleLowerCase(),e=n.text.toLocaleLowerCase(),s=t.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=e.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<s.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(s[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==s[r].localeCompare(o[r]))return s[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===s[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==n?-1:0}return 1}return null!==e?-1:0}}class Fe{ho;_t;Ge;je;qe;constructor(t){u.Gi(this),this.ho=t,this._t=null,this.Ge=null,this.je=null,this.qe=null}clear(){this._t=null,this.Ge=null,this.je=null,this.qe=null}toString(t){void 0===t&&(t=0);let e="LayoutEdge#"+u.as(this);return t>0&&(e+=null!==this.Ge?"("+this.Ge.toString()+")":"",t>1&&(e+=" "+(this.je?this.je.toString():"null")+" --\x3e "+(this.qe?this.qe.toString():"null"))),e}reverseEdge(){const t=this.je;this.je=this.qe,this.qe=t}commit(){}getOtherVertex(t){return this.qe===t?this.je:this.je===t?this.qe:null}get network(){return this.ho}set network(t){this.ho=t}get data(){return this._t}set data(t){this._t!==t&&(this._t=t)}get link(){return this.Ge}set link(t){this.Ge!==t&&(this.Ge=t)}get fromVertex(){return this.je}set fromVertex(t){this.je!==t&&(this.je=t)}get toVertex(){return this.qe}set toVertex(t){this.qe!==t&&(this.qe=t)}}var Oe=(t=>(t[t.Position=0]="Position",t[t.Location=1]="Location",t))(Oe||{}),Ee=(t=>(t[t.LeftToRight=10]="LeftToRight",t[t.RightToLeft=11]="RightToLeft",t))(Ee||{}),Re=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t))(Re||{});class Be extends Le{Kd;Gd;ko;kn;hi;Xi;pe;ye;constructor(t){super(),this.isViewportSized=!0,this.Kd=NaN,this.Gd=NaN,this.ko=new x(NaN,NaN).u(),this.kn=new x(10,10).u(),this.hi=1,this.Xi=10,this.pe=22,this.ye=Be.standardComparer,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Kd=this.Kd,t.Gd=this.Gd,t.ko.a(this.ko),t.kn.a(this.kn),t.hi=this.hi,t.Xi=this.Xi,t.pe=this.pe,t.ye=this.ye}oi(t){t in Re?this.sorting=t:t in Ee?this.arrangement=t:t in Oe?this.alignment=t:super.oi(t)}doLayout(t){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.collectParts(t),i=this.diagram,n=e.copy().iterator;for(;n.next();){const t=n.value;if(!t.Nl()||null===t.fromNode&&null===t.toNode){if(t.ensureBounds(),t instanceof Ne){const i=t.memberParts;for(;i.next();){const t=i.value;e.delete(t)}}}else e.delete(t)}const s=e.toArray();if(0===s.length)return;switch(this.sorting){case 20:break;case 21:s.reverse();break;case 22:s.sort(this.comparer);break;case 23:s.sort(this.comparer),s.reverse()}let o=this.wrappingColumn;isNaN(o)&&(o=0);let r=this.wrappingWidth;if(isNaN(r)&&null!==i){const t=i.viewportBounds,e=i.padding;r=Math.max(t.width-e.left-e.right,0)}else r=Math.max(this.wrappingWidth,0);o<=0&&r<=0&&(o=1);let a=this.spacing.width;isFinite(a)||(a=0);let l=this.spacing.height;isFinite(l)||(l=0),null!==i&&i.startTransaction("Layout");const h=[];switch(this.alignment){case 0:this.zO(s,r,o,a,l,h);break;case 1:this.XO(s,r,o,a,l,h)}let u=0,c=0,d=0;for(let f=0;f<h.length;f++){const t=h[f];u=Math.min(u,t.x),c=Math.min(c,t.y),d=Math.max(d,t.x+t.width)}11===this.arrangement?this.commitLayers(h,new y(u+a/2-(d+u),c-l/2)):this.commitLayers(h,new y(u-a/2,c-l/2)),null!==i&&i.commitTransaction("Layout"),this.isValidLayout=!0}zO(t,e,i,n,s,o){const r=v.l();let a=Math.max(this.cellSize.width,1);if(!isFinite(a)){a=0;for(let e=0;e<t.length;e++){const i=t[e],n=this.getLayoutBounds(i,r);a=Math.max(a,n.width)}}a+=n,a=Math.max(a,1);let l=Math.max(this.cellSize.height,1);if(!isFinite(l)){l=0;for(let e=0;e<t.length;e++){const i=t[e],n=this.getLayoutBounds(i,r);l=Math.max(l,n.height)}}l+=s,l=Math.max(l,1);const h=this.arrangement,u=this.arrangementOrigin.x;let c=u,d=this.arrangementOrigin.y,f=0,g=0;for(let p=0;p<t.length;p++){const m=t[p],y=this.getLayoutBounds(m,r),x=Math.ceil((y.width+n)/a)*a,b=Math.ceil((y.height+s)/l)*l;let w=0;if(11===h)w=Math.abs(c-y.width);else w=c+y.width;(i>0&&f>i-1||e>0&&f>0&&w-u>e)&&(o.push(new v(0,d,e+n,g)),f=0,c=u,d+=g,g=0),g=Math.max(g,b);let k=0;if(11===h)k=-y.width;else k=0;if(11===(m.moveTo(c+k+m.margin.left,d+m.margin.top),h))c-=x;else c+=x;f++}o.push(new v(0,d,e+n,g)),v.e(r)}XO(t,e,i,n,s,o){const r=v.l();let a=Math.max(this.cellSize.width,1),l=0,h=0,u=0;const c=y.l();for(let y=0;y<t.length;y++){const e=t[y],i=this.getLayoutBounds(e,r),n=e.getRelativePoint(e.locationObject,e.locationSpot,c);l=Math.max(l,n.x),h=Math.max(h,i.width-n.x),u=Math.max(u,n.y)}const d=this.arrangement;if(11===d)l+=n;else h+=n;a=isFinite(a)?Math.max(a+n,1):Math.max(l+h,1);const f=this.arrangementOrigin.x;let g=f,p=this.arrangementOrigin.y,m=0;e>=l&&(e-=l);let x=0,b=0;const w=Math.max(this.cellSize.height,1);u=0;let k=0,P=!0;const M=y.l();for(let y=0;y<t.length;y++){const l=t[y],h=this.getLayoutBounds(l,r),C=l.getRelativePoint(l.locationObject,l.locationSpot,c);if(m>0)switch(d){case 11:{let t=(g-f-(h.width-C.x))/a;t=S.z(Math.round(t),t)?Math.round(t):Math.floor(t),g=t*a+f;break}default:{let t=(g-f+C.x)/a;t=S.z(Math.round(t),t)?Math.round(t):Math.ceil(t),g=t*a+f;break}}else if(11===d)x=g+C.x+h.width;else x=g-C.x;let N=0;if(11===d)N=-(g+C.x)+x;else N=g+h.width-C.x-x;if(i>0&&m>i-1||e>0&&m>0&&N>e){o.push(new v(0,P?p-u:p,e+n,k+u+s));for(let e=0;e<m&&y!==m;e++){const i=t[y-m+e],n=i.getRelativePoint(i.locationObject,i.locationSpot,M);i.moveTo(i.position.x,i.position.y+u-n.y)}k+=s,p+=P?k:k+u,u=0,k=0,m=0,g=f,P=!1}if(11===(g===f&&(b=11===d?Math.max(b,h.width-C.x):Math.min(b,-C.x)),u=Math.max(u,C.y),k=Math.max(k,h.height-C.y),isFinite(w)&&(k=Math.max(k,Math.max(h.height,w)-C.y)),P?l.moveTo(g-C.x,p-C.y):l.moveTo(g-C.x,p),d))g-=C.x+n;else g+=h.width-C.x+n;m++}if(o.push(new v(0,p,e+n,(P?k:k+u)+s)),t.length!==m)for(let y=0;y<m;y++){const e=t[t.length-m+y],i=e.getRelativePoint(e.locationObject,e.locationSpot,c);e.moveTo(e.position.x,e.position.y+u-i.y)}if(y.e(c),y.e(M),11===d)for(let y=0;y<o.length;y++){const t=o[y];t.width+=b,t.x-=b}else for(let y=0;y<o.length;y++){const t=o[y];t.x>b&&(t.width+=t.x-b,t.x=b)}v.e(r)}commitLayers(t,e){}get wrappingWidth(){return this.Kd}set wrappingWidth(t){this.Kd!==t&&(e.s(t,"number",Be,"wrappingWidth"),(t>0||isNaN(t))&&(this.Kd=t,this.isViewportSized=isNaN(t),this.invalidateLayout()))}get wrappingColumn(){return this.Gd}set wrappingColumn(t){this.Gd!==t&&(e.s(t,"number",Be,"wrappingColumn"),(t>0||isNaN(t))&&(this.Gd=t,this.invalidateLayout()))}get cellSize(){return this.ko}set cellSize(t){this.ko.equals(t)||(this.ko.a(t),this.invalidateLayout())}get spacing(){return this.kn}set spacing(t){this.kn.equals(t)||(this.kn.a(t),this.invalidateLayout())}get alignment(){return this.hi}set alignment(t){this.hi!==t&&(1===t||0===t)&&(this.hi=t,this.invalidateLayout())}get arrangement(){return this.Xi}set arrangement(t){this.Xi!==t&&(10===t||11===t)&&(this.Xi=t,this.invalidateLayout())}get sorting(){return this.pe}set sorting(t){this.pe!==t&&(20===t||21===t||22===t||23===t)&&(this.pe=t,this.invalidateLayout())}get comparer(){return this.ye}set comparer(t){this.ye!==t&&(e.k(t,Be,"comparer"),this.ye=t,this.invalidateLayout())}static standardComparer(t,e){const i=t.text,n=e.text;return i<n?-1:i>n?1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.text.toLocaleLowerCase(),n=e.text.toLocaleLowerCase(),s=i.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=n.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<s.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(s[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==s[r].localeCompare(o[r]))return s[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===s[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==e?-1:0}static Position=0;static Location=1;static LeftToRight=10;static RightToLeft=11;static Forward=20;static Reverse=21;static Ascending=22;static Descending=23}class Ie{Hd;js;Ct;fo;jd;qd;N;SN;constructor(){this.Hd=new u,this.js=new u,this.Ct=new u,this.fo=new m,this.jd=new m,this.qd=new m,this.N=null,this.SN=!1}clear(){this.Hd.clear(),this.js.clear(),this.Ct.clear(),this.fo.clear(),this.jd.clear(),this.qd.clear()}So(t){this.N=t}Wh(t){if(t instanceof pe){if(this.Hd.add(t),t instanceof Ne){const e=t.containingGroup;null===e?this.diagram.Vr.add(t):e.aa.add(t);const i=t.layout;null!==i&&(i.diagram=this.diagram)}}else t instanceof be?(this.js.add(t),t.isAvoiding&&(this.diagram.Vm=!0)):t instanceof fe||this.Ct.add(t);const e=t.data;null!==e&&(t instanceof fe||(t instanceof be?this.DT(e,t):this.fo.set(e,t)))}te(t){if(t.clearAdornments(),t instanceof pe){if(this.Hd.delete(t),t instanceof Ne){const e=t.containingGroup;null===e?this.diagram.Vr.delete(t):e.aa.delete(t);const i=t.layout;null!==i&&(i.diagram=null)}}else t instanceof be?this.js.delete(t):t instanceof fe||this.Ct.delete(t);const e=t.data;null!==e&&(t instanceof fe||(t instanceof be?this.FT(e,t):this.fo.delete(e)))}DT(t,e){this.jd.set(t,e)}FT(t,e){this.jd.delete(t)}rebuildParts(){const t=this.diagram;if(null===t)return;const i=t.nodeTemplateMap.iterator;for(;i.next();){const t=i.value,n=i.key;(!t.ke()||t instanceof Ne)&&e.o(`Invalid node template in Diagram.nodeTemplateMap: template for "${n}" must be a Node or a simple Part, not a Group or Link: ${t}`)}const n=t.groupTemplateMap.iterator;for(;n.next();){const t=n.value,i=n.key;t instanceof Ne||e.o(`Invalid group template in Diagram.groupTemplateMap: template for "${i}" must be a Group, not a normal Node or Link: ${t}`)}const s=t.linkTemplateMap.iterator;for(;s.next();){const t=s.value,i=s.key;t instanceof be||e.o(`Invalid link template in Diagram.linkTemplateMap: template for "${i}" must be a Link, not a normal Node or simple Part: ${t}`)}const o=e.et(),r=t.selection.iterator;for(;r.next();){const t=r.value.data;t&&o.push(t)}const a=e.et(),l=t.highlighteds.iterator;for(;l.next();){const t=l.value.data;t&&a.push(t)}const h=e.et(),u=this.nodes.iterator;for(;u.next();){const t=u.value;null!==t.data&&(h.push(t.data),h.push(t.location))}const c=this.links.iterator;for(;c.next();){const t=c.value;null!==t.data&&(h.push(t.data),h.push(t.location))}const d=this.parts.iterator;for(;d.next();){const t=d.value;null!==t.data&&(h.push(t.data),h.push(t.location))}this.RT(),this.VM();for(let e=0;e<o.length;e++){const t=this.findPartForData(o[e]);null!==t&&(t.isSelected=!0)}for(let e=0;e<a.length;e++){const t=this.findPartForData(a[e]);null!==t&&(t.isHighlighted=!0)}for(let e=0;e<h.length;e+=2){const t=this.findPartForData(h[e]);null!==t&&(t.location=h[e+1])}e.J(o),e.J(a),e.J(h)}VM(){const t=this.diagram.model;this.Py(t.nodeDataArray)}Py(t,e){const i=this.diagram.model;t.forEach((t=>{i.containsNodeData(t)&&this.vT(t,!1)})),t.forEach((t=>{i.containsNodeData(t)&&this.F1(t)})),!1!==e&&this.diagram.Nb(!1)}vT(t,e){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.fo.has(t))return null;void 0===e&&(e=!0);const i=this.YO(t);return null!==i&&e&&this.F1(t),i}YO(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.fo.has(t))return null;const e=this.KO(t),i=this.findTemplateForNodeData(t,e);if(null!==i){i.Et();const n=i.copy();if(null!==n){const i=this.diagram.fe;return this.diagram.fe=!0,n.Vo=e,n._t=t,this.addsToTemporaryLayer&&(n.sl="Tool"),this.diagram.add(n),n._t=null,n.data=t,this.diagram.fe=i,n}}return null}insertLink(t,e,i,n){return null}F1(t){}KO(t){return this.diagram.model.getCategoryForNodeData(t)}static OT=!1;static IT=!1;findTemplateForNodeData(t,i){const n=this.diagram,s=n.model;let o=null;return s.jc()&&s.isGroupForData(t)?(o=n.groupTemplateMap.get(i),null===o&&(o=n.groupTemplateMap.get(""),null===o&&(Ie.IT||(Ie.IT=!0,e.ni('No Group template found for category "'+i+'"'),e.ni("  Using default group template")),o=n.pM))):(o=n.nodeTemplateMap.get(i),null===o&&(o=n.nodeTemplateMap.get(""),null===o&&(Ie.OT||(Ie.OT=!0,e.ni('No Node template found for category "'+i+'"'),e.ni("  Using default node template")),o=n.dM))),o}getLinkCategoryForData(t){return""}setLinkCategoryForData(t,e){}setFromNodeForLink(t,e,i){}setToNodeForLink(t,e,i){}static ET=!1;findLinkTemplateForCategory(t){const i=this.diagram;let n=i.linkTemplateMap.get(t);return null===n&&(n=i.linkTemplateMap.get(""),null===n&&(Ie.ET||(Ie.ET=!0,e.ni('No Link template found for category "'+t+'"'),e.ni("  Using default link template")),n=i.gM)),n}Rv(t,e,i){t instanceof be?(null!==e&&this.FT(e,t),null!==i&&this.DT(i,t)):t instanceof ce&&(null!==e&&this.fo.delete(e),null!==i&&this.fo.set(i,t))}RT(){const t=this.diagram.model;this.MN(t.nodeDataArray)}MN(t){t.forEach((t=>{this.R1(t)}))}R1(t){const e=this.findPartForData(t);null!==e&&(this.diagram.EM(e,!1),this.NN(e))}NN(t){}mN(t){}findPartForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.fo.get(e):null}findNodeForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);if(null===e)return null;const i=this.fo.get(e);return i instanceof pe?i:null}findLinkForKey(t){return null}findPartForData(t){if(null===t)return null;let e=this.fo.get(t);return null!==e||(e=this.jd.get(t)),e}findNodeForData(t){if(null===t)return null;const e=this.fo.get(t);return e instanceof pe?e:null}findLinkForData(t,e){return null===t?null:this.jd.get(t)}findNodesByExample(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];const s=new u,o=this.Hd.iterator;for(;o.next();){const t=o.value,i=t.data;if(null!==i)for(let n=0;n<arguments.length;n++){const o=arguments[n];if(e.K(o)&&this.CN(i,o)){s.add(t);break}}}return s.iterator}findLinksByExample(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];const s=new u,o=this.js.iterator;for(;o.next();){const t=o.value,i=t.data;if(null!==i)for(let n=0;n<arguments.length;n++){const o=arguments[n];if(e.K(o)&&this.CN(i,o)){s.add(t);break}}}return s.iterator}CN(t,e){for(const i in e){const n=t[i],s=e[i];if(Array.isArray(s)){if(!Array.isArray(n))return!1;const t=n,e=s;if(t.length<e.length)return!1;for(let i=0;i<t.length;i++){const n=t[i],s=e[i];if(void 0!==s&&!this.BT(n,s))return!1}}else if(!this.BT(n,s))return!1}return!0}BT(t,i){if(e.it(i)){if(!i(t))return!1}else if(i instanceof RegExp){if(!t||!i.test(t.toString()))return!1}else if(e.K(t)&&e.K(i)){if(!this.CN(t,i))return!1}else if(t!==i)return!1;return!0}doModelDataChanged(t){if(t.model===this.diagram.model&&this.diagram.X){this.diagram.X=!1;try{const e=t.change;""===t.modelChange&&null!==t.object&&2===e&&this.Sy(t.object,t.propertyName)}finally{this.diagram.X=!0}}}doModelChanged(t){const i=this.diagram;if(!i||t.model!==i.model)return;const n=t.change;if(i.OR(t),i.X){i.X=!1;try{const s=t.modelChange;if(""!==s)if(2===n){if("nodeCategory"===s){const e=t.object;if(null!==e){const i=this.findPartForData(e),n=t.newValue;null!==i&&"string"==typeof n&&(i.category=n)}}else if("nodeDataArray"===s){const e=t.oldValue;this.MN(e);const i=t.newValue;this.Py(i)}i.isModified=!0}else if(3===n){const n=t.newValue;"nodeDataArray"===s&&e.K(n)&&this.vT(n),i.isModified=!0}else if(4===n){const n=t.oldValue;"nodeDataArray"===s&&e.K(n)&&this.R1(n),i.isModified=!0}else 1===n&&("SourceChanged"===s?null!==t.object?this.Sy(t.object,t.propertyName):(this.updateAllRelationshipsFromData(),this.updateAllTargetBindings()):"ModelDisplaced"===s&&this.rebuildParts());else if(2===n){const e=t.propertyName,n=t.object;n===i.model?("nodeKeyProperty"===e||"nodeCategoryProperty"===e)&&(i.undoManager.isUndoingRedoing||this.rebuildParts()):null!==n&&this.Sy(n,e),i.isModified=!0}else(3===n||4===n)&&(this.GO(t,i.model),i.isModified=!0)}finally{i.X=!0}}}updateAllTargetBindings(t){void 0===t&&(t="");let e=this.parts.iterator;for(;e.next();)e.value.updateTargetBindings(t);for(e=this.nodes.iterator;e.next();)e.value.updateTargetBindings(t);for(e=this.links.iterator;e.next();)e.value.updateTargetBindings(t)}updateAllThemeBindings(){let t=this.parts.iterator;for(;t.next();)t.value.To();for(t=this.nodes.iterator;t.next();)t.value.To();for(t=this.links.iterator;t.next();)t.value.To()}updateAllRelationshipsFromData(){const t=this.diagram.model,e=new u,i=t.nodeDataArray;for(let o=0;o<i.length;o++){const t=i[o];e.add(t)}const n=[];this.nodes.each((t=>{null!==t.data&&!e.has(t.data)&&n.push(t.data)})),this.parts.each((t=>{null!==t.data&&!e.has(t.data)&&n.push(t.data)})),n.forEach((e=>t.UT(e,!1)));for(let o=0;o<i.length;o++){const e=i[o];null===this.findPartForData(e)&&t.VT(e,!1)}this.zT();let s=this.parts.iterator;for(;s.next();)s.value.updateRelationshipsFromData();for(s=this.nodes.iterator;s.next();)s.value.updateRelationshipsFromData();for(s=this.links.iterator;s.next();)s.value.updateRelationshipsFromData()}zT(){}updateRelationshipsFromData(t){}Sy(t,i){if("string"==typeof i){const n=this.findPartForData(t);if(null!==n)n.updateTargetBindings(i);else{const n=this.HO(t);if(null!==n&&n.length>0){for(let e=0;e<n.length;e++)n[e].updateTargetBindings(i);const t=n[0].part;if(null!==t){const e=t.adornments;for(;e.next();)e.value.updateTargetBindings(i)}e.J(n)}}t===this.diagram.model.modelData&&this.updateAllTargetBindings(i)}}HO(t){let i=null;const n=this.qd.iterator;for(;n.next();){const s=n.value;for(let n=0;n<s.length;n++){const o=s[n].findItemPanelForData(t);null!==o&&(null===i&&(i=e.et()),i.push(o))}if(null!==i)break}return i}LN(t){return this.qd.get(t)}GO(t,e){const i=t.object;if(!Array.isArray(i))return;const n=3===t.change,s=n?t.newParam:t.oldParam,o=n?t.newValue:t.oldValue,r=this.LN(i);if(Array.isArray(r))for(let a=0;a<r.length;a++){const t=r[a];n?t.i1(o,s,!0):t.Ov(s)}}OM(t,e){null!==e&&t.Yr((t=>e.KL(t)));const i=t.yh;if(Array.isArray(i)){const e=this.LN(i);if(null===e)this.qd.set(i,[t]);else{for(let i=0;i<e.length;i++)if(e[i]===t)return;e.push(t)}}}IM(t,e){t.Yr((t=>e.ER(t)));const i=t.yh;if(Array.isArray(i)){const e=this.LN(i);if(null!==e)for(let n=0;n<e.length;n++)if(e[n]===t)return e.splice(n,1),void(0===e.length&&this.qd.delete(i))}}copyParts(t,e,i){void 0===i&&(i=!1);const n=new m;if(Array.isArray(t))for(let o=0;o<t.length;o++)this.v1(t[o],e,n,i);else{const s=t.iterator;for(;s.next();)this.v1(s.value,e,n,i)}if(null!==e){const t=e.model,i=e.s0().dragsLink,s=new u,o=new m,r=n.iterator;for(;r.next();){const a=r.value;if(a instanceof be)!i&&(null===a.fromNode||null===a.toNode)&&s.add(a);else if(a instanceof pe&&null!==a.data)if(t.pm()){const i=a,s=r.key,l=s.findTreeParentNode();if(null!==l){const r=n.get(l);if(null!==r){t.setParentKeyForNodeData(i.data,t.getKeyForNodeData(r.data));const n=e.findLinkForData(i.data),a=s.findTreeParentLink();null!==a&&null!==n&&o.set(a,n)}}}else if(t.Sb()){const i=a,s=r.key,l=t.isRelatedKeysPathTo?s.findNodesOutOf():s.findNodesInto();for(;l.next();){const r=l.value,a=n.get(r);if(null!==a){t.addRelatedKeyForNodeData(i.data,a.key);const n=e.partManager.findLinkForData(i.data,a.key),l=this.findLinkForData(s.data,r.key);null!==l&&null!==n&&o.set(l,n)}else t.removeRelatedKeyForNodeData(i.data,r.key)}}}if(s.count>0&&e.removeParts(s,!1),o.count>0){const t=o.iterator;for(;t.next();){const e=t.key,i=t.value;n.set(e,i)}}}if(null!==e&&null!==this.diagram){const t=e.model,i=t.afterCopyFunction;if(null!==i){const e=new m;n.each((t=>{null!==t.key.data&&e.set(t.key.data,t.value.data)}));const s=this.diagram.model;i(e,t,s)}}const s=n.iterator;for(;s.next();)s.value.updateTargetBindings();return n}v1(t,e,i,n){if(null===t||n&&!t.canCopy())return null;if(i.has(t))return i.get(t);const s=this.AN(t,e);if(!(s instanceof ce))return null;if(s.isSelected=!1,s.isHighlighted=!1,i.set(t,s),t instanceof pe){const o=t.linksConnected;for(;o.next();){const e=o.value;if(e.fromNode===t){const t=i.get(e);null!==t&&(t.fromNode=s)}if(e.toNode===t){const t=i.get(e);null!==t&&(t.toNode=s)}}if(t instanceof Ne&&s instanceof Ne){const o=t.memberParts;for(;o.next();){const t=o.value,r=this.v1(t,e,i,n);r instanceof be||null!==r&&(r.containingGroup=s)}}}else if(t instanceof be&&s instanceof be){const o=t.fromNode;if(null!==o){const t=i.get(o);null!==t&&(s.fromNode=t)}const r=t.toNode;if(null!==r){const t=i.get(r);null!==t&&(s.toNode=t)}const a=t.labelNodes;for(;a.next();){const t=a.value,o=this.v1(t,e,i,n);null!==o&&o instanceof pe&&(o.labeledLink=s)}}return s}AN(t,i){let n=null;const s=t.data;if(null!==s&&null!==i){const o=i.model;if(!(t instanceof be)){const t=o.copyNodeData(s);e.K(t)&&(o.addNodeData(t),n=i.findPartForData(t))}}else if(t.Et(),n=t.copy(),null!==n){const t=this.diagram;if(null!==i)i.add(n);else if(null!==s&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const i=t.model;let o=null;n instanceof be||(o=i.copyNodeData(s)),e.K(o)&&(n.data=o)}}return n}get nodes(){return this.Hd}get links(){return this.js}get parts(){return this.Ct}get diagram(){return this.N}get addsToTemporaryLayer(){return this.SN}set addsToTemporaryLayer(t){this.SN=t}}var ze=(t=>(t[t.OneWay=1]="OneWay",t[t.TwoWay=2]="TwoWay",t))(ze||{});class je{n;TN;Ya;Cf;Nh;Lf;Af;Tf;E1;be;ad;ff;constructor(t,i,n,s){u.Gi(this),void 0===t?t="":e.s(t,"string",je,"constructor:targetprop"),void 0===i?i=t:e.s(i,"string",je,"constructor:sourceprop"),void 0===n?n=null:null!==n&&e.k(n,je,"constructor:conv"),this.TN=-1,this.be=null,this.Ya=t,this.ad=0,this.ff=0,this.Cf=null,this.Nh=i,this.Lf=n,void 0===s?(this.Af=1,this.Tf=null):(this.Af=2,this.Tf=s),this.E1=new u,this.n=2}copy(){const t=new this.constructor;return this.cloneProtected(t),t}cloneProtected(t){t.Ya=this.Ya,t.ad=this.ad,t.ff=this.ff,t.Cf=this.Cf,t.Nh=this.Nh,t.Lf=this.Lf,t.Af=this.Af,t.Tf=this.Tf,t.n=-2&this.n}static OneWay=1;static TwoWay=2;static parseEnum(t,i){return e.k(t,je,"parseEnum:ctor"),n=>{let s=parseInt(n);return isNaN(s)&&(s=e.Eh(t,n),null===s)?i:s}}oi(t){t in ze?this.mode=t:e.ir(this,t)}static toString(t){return e.toString(t)}toString(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.targetId?" "+this.targetId:"")+" "+ze[this.mode]+")"}u(){return this.n=1|this.n,this}get targetId(){return this.TN}set targetId(t){this.h&&e.L(this),this.TN=t}get targetProperty(){return this.Ya}set targetProperty(t){this.h&&e.L(this),e.s(t,"string",je,"targetProperty"),this.Ya=t}get sourceProperty(){return this.Nh}set sourceProperty(t){this.h&&e.L(this),e.s(t,"string",je,"sourceProperty"),this.Nh=t}get h(){return 0!==(1&this.n)}get isToData(){return 0!==(2&this.n)}get isToObject(){return 0!==(4&this.n)}get isToModel(){return 0!==(8&this.n)}get isToTheme(){return 0!==(16&this.n)}get DN(){return this.isToTheme&&!(this.isToData||this.isToObject||this.isToModel)}qu(){return!1}get sourceName(){return this.Cf}set sourceName(t){this.h&&e.L(this),null!==t&&e.s(t,"string",je,"sourceName"),this.Cf=t,this.n=null!==t?-3&this.n|4:2|this.n}get converter(){return this.Lf}set converter(t){this.h&&e.L(this),null!==t&&e.k(t,je,"converter"),this.Lf=t}get backConverter(){return this.Tf}set backConverter(t){this.h&&e.L(this),null!==t&&e.k(t,je,"backConverter"),this.Tf=t}get mode(){return this.Af}set mode(t){this.h&&e.L(this),this.isToTheme&&2===t&&e.o("Theme Bindings cannot be TwoWay."),this.Af=t}makeTwoWay(t){return this.isToTheme&&e.o("Theme Bindings cannot be TwoWay."),this.mode=2,t&&(e.k(t,je,"makeTwoWay"),this.backConverter=t),this}ofObject(t){return this.h&&e.L(this),void 0===t&&(t=""),this.sourceName=t,this}ofModel(){return this.h&&e.L(this),this.n=-3&this.n&-5|8,this.Cf=null,this}yA(t,e){const i=this.sourceName;let n=null;return n=null===i||""===i?t:"/"===i?e.part:"."===i?e:".."===i?e.panel:t.findObject(i),n}check(t){const i=this.Ya,n=this.Nh,s=this.Lf;(this.qu()&&null===s&&null===this.Ch&&""===i||null===s&&""===i)&&e.ni("Binding error: target property is the empty string: "+this.toString()),this.qu()&&this.DN&&""===n&&null===s&&null===this.Ch&&e.ni("Binding error: theme bindings require a source property when not using a converter: "+this.toString()),t&&"string"==typeof i&&(!e.it(["setAttribute"])&&i.length>0&&"_"!==i[0]&&!e.uw(t,i)?e.ni("Binding error: undefined target property: "+i+" on "+t.toString()):"name"===i&&t instanceof At&&e.ni("Binding error: cannot modify GraphObject.name on "+t.toString()))}updateTarget(t,e,i,n){const s=this.Nh;if(void 0!==i&&""!==s&&s!==i)return;const o=this.Ya,r=this.Lf;let a=e;if(""!==s&&!this.DN&&(a=n?n.yt(e,s):Ue.yt(e,s)),void 0===a)return;const l=t.diagram?.themeManager;if(null===r){if(""!==o){if(this.qu()&&(a=this.jT(l,a,t,o),void 0===a))return;n?n.Z(t,o,a):(e instanceof At||e instanceof $t)&&Ue.Z(t,o,a)}}else try{if(""!==o){let i=r(a,t);if(this.qu()&&(i=this.jT(l,i,t,o),void 0===i))return;n?n.Z(t,o,i):(e instanceof At||e instanceof $t)&&Ue.Z(t,o,i)}else r(a,t)}catch{}}updateSource(t,e,i,n){if(2!==this.Af)return;const s=this.Ya;if(void 0!==i&&s!==i)return;const o=this.Nh,r=this.Tf,a=null!==n?n.diagram:null,l=null!==a?a.model:null;let h=t;if(""!==s&&(h=l?l.yt(t,s):Ue.yt(t,s)),void 0!==h&&!this.E1.has(t))try{if(this.E1.add(t),null===r){if(""!==o)null!==l?l.setDataProperty(e,o,h):(e instanceof At||e instanceof $t)&&(e[o]=h);else if(null!==l&&null!==n&&n.itemIndex>=0&&null!==n.panel&&Array.isArray(n.panel.itemArray)){const t=n.itemIndex,e=n.panel.itemArray;l.removeArrayItem(e,t),l.insertArrayItem(e,t,h)}}else try{if(""!==o){const t=r(h,e,l);null!==l?l.setDataProperty(e,o,t):(e instanceof At||e instanceof $t)&&(e[o]=t)}else{const t=r(h,e,l);if(void 0!==t&&null!==l&&null!==n&&n.itemIndex>=0&&null!==n.panel&&Array.isArray(n.panel.itemArray)){const e=n.itemIndex,i=n.panel.itemArray;l.removeArrayItem(i,e),l.insertArrayItem(i,e,t)}}}catch{}}finally{this.E1.delete(t)}}}class Ve extends je{Ny;Ch;Ka;constructor(t,e,i,n,s){super(t,e,n),null==i&&(i=""),void 0===s&&(s=null),this.Ny=i,this.Ch=s,this.Ka=null,this.n=16}cloneProtected(t){super.cloneProtected(t),t.Ny=this.Ny,t.Ch=this.Ch,t.Ka=this.Ka}qu(){return!0}get themeSource(){return this.Ny}set themeSource(t){this.h&&e.L(this),null!==t&&e.s(t,"string",Ve,"themeSource"),this.Ny=t,this.Ka=null,this.n=null!==t?16|this.n:-17&this.n}get themeConverter(){return this.Ch}set themeConverter(t){this.h&&e.L(this),null!==t&&e.k(t,Ve,"themeConverter"),this.Ch=t}ofData(){return this.h&&e.L(this),this.n=2|this.n,this.Cf=null,this}jT(t,i,n,s){if(!t||(this.DN&&(i=this.Nh),!i&&0!==i))return;let o=this.themeSource;null!==this.Ka?o=this.Ka:"string"==typeof o&&o.includes(".")&&(this.Ka=o.split("."),o=this.Ka);let r=t.findValue(i,o,s);return void 0===r&&e.ni(`Theme warning: ${i} could not be found when setting target property ${s}.`),e.it(this.Ch)&&(r=this.Ch(r,n)),r}}class Ue{Pt;$d;Lo;FN;Te;mi;Lh;Df;Ff;Zd;Qd;_d;tg;Cy;Ga;Wo;Ly;Co;B1;constructor(t,e){if(u.Gi(this),this.Pt="",this.$d="",this.Lo=!1,this.FN={},this.Te=[],this.mi=new m,this.Lh="key",this.Df=null,this.Ff=null,this.Zd=!1,this.Qd=!1,this._d=!1,this.tg=null,this.Cy=100,this.Ga="category",this.Wo=new m,this.Ly=[],this.Co=!1,this.B1=null,this.undoManager=new B,void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){t.Pt=this.Pt,t.$d=this.$d,t.Lo=this.Lo,t.Lh=this.Lh,t.Df=this.Df,t.Ff=this.Ff,t.Zd=this.Zd,t.Qd=this.Qd,t._d=this._d,t.tg=this.tg,t.Cy=this.Cy,t.Ga=this.Ga}copy(){const t=new this.constructor;return this.cloneProtected(t),t}clear(){this.Te=[],this.mi.clear(),this.Wo.clear(),this.undoManager.clear()}toString(t){if(void 0===t&&(t=0),t>1)return this.toJson();{let i=(""!==this.name?this.name:"")+" Model";if(t>0){i+="\n node data:";const t=this.nodeDataArray,n=t.length;for(let s=0;s<n;s++){const n=t[s];i+=" "+this.getKeyForNodeData(n)+":"+e.toString(n)}}return i}}toIncrementalData(t){1!==t.change&&e.o("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+t.toString());const i=t.object;if(!t.isTransactionFinished||!(i instanceof R))return null;const n=this.qT(i);return this.RN(i,"FinishedUndo"===t.propertyName,n)}RN(t,e,i){const n=this;let s=!1;const o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===n)if("nodeDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(n.containsNodeData(t.object))r.add(t.object);else if(2!==t.change||n.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(i.has(t.object))i.get(t.object).each((t=>{n.containsNodeData(t)&&r.add(t)}));else{if(t.object instanceof Ue||n.Ra()&&n.containsLinkData(t.object))return;n.WT(t.object).each((t=>{r.add(t)}))}}else s=!0}));const l=new u;o.each((t=>{l.add(n.getKeyForNodeData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(n.getKeyForNodeData(t)),e&&r.add(t)}));const c=n.cloneDeep(r.toArray());let d=null;return s&&(null===d&&(d={}),d.modelData=this.cloneDeep(this.modelData)),l.count>0&&(null===d&&(d={}),e?d.removedNodeKeys=l.toArray():d.insertedNodeKeys=l.toArray()),c.length>0&&(null===d&&(d={}),d.modifiedNodeData=c),h.count>0&&(null===d&&(d={}),e?d.insertedNodeKeys=h.toArray():d.removedNodeKeys=h.toArray()),d}cloneDeep(t){return this.ig(t,!0)}ig(t,i,n,s){if(!e.K(t))return t;n||(n=new m);const o=n.get(t);if(o)return o;let r;if(Array.isArray(t)){r=[],n.set(t,r);for(let e=0;e<t.length;e++){const i=t[e];r.push(this.ig(i,!1,n,s))}}else if(t instanceof y||t instanceof x||t instanceof v||t instanceof b||t instanceof w)r=t.copy(),n.set(t,r);else{if(t instanceof Ut||t instanceof N)return t;if(t instanceof l)r=(new l).addAll(this.ig(t.toArray(),!1,n,s)),n.set(t,r);else if(t instanceof u)r=(new u).addAll(this.ig(t.toArray(),!1,n,s)),n.set(t,r);else if(t instanceof m)r=(new m).addAll(this.ig(t.toArray(),!1,n,s)),n.set(t,r);else if(t instanceof Date)r=new Date(t),n.set(t,r);else if(t instanceof RegExp)r=new RegExp(t),n.set(t,r),r.lastIndex=t.lastIndex;else if(Ue.vN(null,"",t))r=t;else if(e.it(t.copy))r=t.copy(),n.set(t,r);else{r={},n.set(t,r);for(const e in t){if("__gohashid"===e)continue;const i=t[e];r[e]=this.ig(i,!1,n,s)}}}return r}De(t){return JSON.stringify(t).replace(/[\u007F-\uFFFF]/g,(t=>{const e="0000"+t.charCodeAt(0).toString(16);return"\\u"+e.substring(e.length-4)}))}eg(){let t="";return""!==this.name&&(t+=',\n  "name": '+this.De(this.name)),""!==this.dataFormat&&(t+=',\n  "dataFormat": '+this.De(this.dataFormat)),this.isReadOnly&&(t+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(t+=',\n  "nodeKeyProperty": '+this.De(this.nodeKeyProperty)),this.copiesArrays&&(t+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(t+=',\n  "copiesArrayObjects": true'),this.copiesKey&&(t+=',\n  "copiesKey": true'),100!==this.pointsDigits&&(t+=',\n  "pointsDigits": '+this.pointsDigits.toString()),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(t+=',\n  "nodeCategoryProperty": '+this.De(this.nodeCategoryProperty)),t}Ay(t){t.name&&(this.name=t.name),t.dataFormat&&(this.dataFormat=t.dataFormat),t.isReadOnly&&(this.isReadOnly=!0),t.nodeKeyProperty&&(this.nodeKeyProperty=t.nodeKeyProperty),t.copiesArrays&&(this.copiesArrays=!0),t.copiesArrayObjects&&(this.copiesArrayObjects=!0),void 0!==t.copiesKey&&(this.copiesKey=t.copiesKey),void 0!==t.pointsDigits&&(this.pointsDigits=parseInt(t.pointsDigits)),t.nodeCategoryProperty&&(this.nodeCategoryProperty=t.nodeCategoryProperty)}JT(){const t=this.modelData;return',\n  "modelData": '+this.$T(t)}ZT(t){const i=t.modelData;e.K(i)&&(this.replaceJsonObjects(i),this.modelData=i)}ON(){const t=this.modelData;let e=!1;for(const n in t)if(!this.U1(t,n,t[n])){e=!0;break}let i="";return e&&(i=this.JT()),i+',\n  "nodeDataArray": '+this.Ah(this.nodeDataArray,!0)}IN(t){this.ZT(t);const e=t.nodeDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.nodeDataArray=e)}EN(t,i,n){if(t===i)return!0;if(typeof t!=typeof i||e.it(t)||e.it(i))return!1;if(Array.isArray(t)&&Array.isArray(i)){if(n.get(t)===i)return!0;if(n.set(t,i),t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(!this.EN(t[e],i[e],n))return!1;return!0}if(e.K(t)&&e.K(i)){if(n.get(t)===i)return!0;n.set(t,i);for(const e in t){const s=t[e];if(this.U1(t,e,s))continue;const o=i[e];if(void 0===o||!this.EN(s,o,n))return!1}for(const e in i){const s=i[e];if(this.U1(i,e,s))continue;const o=t[e];if(void 0===o||!this.EN(o,s,n))return!1}return!0}return!1}static QT=',\n  "insertedNodeKeys": ';static jO=',\n  "modifiedNodeData": ';static _T=',\n  "removedNodeKeys": ';qT(t){let e=new m;const i=(t,i)=>{const n=i.part;if(!n)return;const s=n.data;if(t===s)return;let o=e.get(t);null===o?(o=new u,o.add(s),e.set(t,o)):o.add(s)};return t.changes.each((t=>{if(null!==t.diagram){const e=t.change;if(2===e){const e=t.object.panel;if(e){const t=e.data;t&&i(t,e)}}else if(3===e||4===e){const e=t.object,n=e.itemArray;n&&i(n,e)}}})),e}WT(t){const e=new u;for(let i=0;i<this.nodeDataArray.length;i++){const n=this.nodeDataArray[i];this.V1(t,n,n,e)}return e}V1(t,i,n,s){if(Array.isArray(i))for(let e=0;e<i.length;e++){const o=i[e];if(o===t)return s.add(n),!0;if(this.V1(t,o,n,s))return!0}else if(e.K(i)&&Object.getPrototypeOf(i)===Object.prototype)for(const e in i){const o=i[e];if(o===t)return s.add(n),!0;if(this.V1(t,o,n,s))return!0}return!1}BN(t,e,i){const n=this;let s=!1;const o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===n)if("nodeDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(n.containsNodeData(t.object))r.add(t.object);else if(2!==t.change||n.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(i.has(t.object))i.get(t.object).each((t=>{n.containsNodeData(t)&&r.add(t)}));else{if(t.object instanceof Ue||n.Ra()&&n.containsLinkData(t.object))return;n.WT(t.object).each((t=>{r.add(t)}))}}else s=!0}));const l=new u;o.each((t=>{l.add(n.getKeyForNodeData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(n.getKeyForNodeData(t)),e&&r.add(t)}));let c="";return s&&(c+=this.JT()),l.count>0&&(c+=(e?Ue._T:Ue.QT)+this.Ah(l.toArray(),!0)),r.count>0&&(c+=Ue.jO+this.Ah(r.toArray(),!0)),h.count>0&&(c+=(e?Ue.QT:Ue._T)+this.Ah(h.toArray(),!0)),c}Ty(t){(void 0!==t.name&&t.name!==this.name||void 0!==t.dataFormat&&t.dataFormat!==this.dataFormat||void 0!==t.isReadOnly&&t.isReadOnly!==this.isReadOnly||void 0!==t.nodeKeyProperty&&t.nodeKeyProperty!==this.nodeKeyProperty||void 0!==t.copiesArrays&&t.copiesArrays!==this.copiesArrays||void 0!==t.copiesArrayObjects&&t.copiesArrayObjects!==this.copiesArrayObjects||void 0!==t.copiesKey&&t.copiesKey!==this.copiesKey||void 0!==t.nodeCategoryProperty&&t.nodeCategoryProperty!==this.nodeCategoryProperty)&&e.o("applyIncrementalJson cannot change Model properties"),this.ZT(t);const i=t.insertedNodeKeys,n=t.modifiedNodeData,s=new m;if(Array.isArray(n))for(let e=0;e<n.length;e++){const t=n[e],i=this.getKeyForNodeData(t);null!=i&&s.set(i,t)}if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e];let n=this.findNodeDataForKey(t);if(null===n){n=s.get(t)||this.copyNodeData({}),this.setKeyForNodeData(n,t),this.addNodeData(n)}}}if(Array.isArray(n)){const t=n.length;for(let e=0;e<t;e++){const t=n[e],i=this.getKeyForNodeData(t),s=this.findNodeDataForKey(i);if(null!==s){for(const e in t)"__gohashid"===e||e===this.nodeKeyProperty||(this.mm()||this.Sb())&&e===this.nodeIsGroupProperty||this.setDataProperty(s,e,t[e]);this.sg(t,s)}}}const o=t.removedNodeKeys;if(Array.isArray(o)){const t=o.length;for(let e=0;e<t;e++){const t=o[e],i=this.findNodeDataForKey(t);null!==i&&this.removeNodeData(i)}}}toIncrementalJson(t,i){1!==t.change&&e.o("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+t.toString());const n=t.object;if(!t.isTransactionFinished||!(n instanceof R))return'{ "incremental": 0 }';void 0===i&&(i=e.Dn(this));const s=this.qT(n),o=this.BN(n,"FinishedUndo"===t.propertyName,s);return'{ "class": '+this.De(i)+', "incremental": 1'+this.eg()+o+"}"}toIncrementalJSON(t,e){return this.toIncrementalJson(t,e)}toJson(t){return void 0===t&&(t=e.Dn(this)),'{ "class": '+this.De(t)+this.eg()+this.ON()+"}"}toJSON(t){return this.toJson(t)}applyIncrementalJson(i){let n=null;if("string"==typeof i)try{n=t.JSON.parse(i)}catch{}else e.K(i)?n=i:e.o("Unable to modify a Model from: "+i);const s=n.incremental;"number"!=typeof s&&e.o("Unable to apply non-incremental changes to Model: "+i),0!==s&&(this.startTransaction("applyIncrementalJson"),this.Ty(n),this.commitTransaction("applyIncrementalJson"))}applyIncrementalJSON(t){return this.applyIncrementalJson(t)}static fromJson(i,n){void 0===n&&(n=null);let s=null;if("string"==typeof i)try{s=t.JSON.parse(i)}catch{}else e.K(i)?s=i:e.o("Unable to construct a Model from: "+i);if(null===n){const t=Ue.qO(s);null===t||t instanceof Ue?n=t:e.o("Unable to construct a Model of declared class: "+s.class)}return null===n&&(n=Ue.tD()),n.Ay(s),n.IN(s),n}static fromJSON(t,e){return this.fromJson(t,e)}static tD(){return new Ue}static qO(i){let n=null,s=i.class;if("string"==typeof s)try{let i=null;0===s.indexOf("go.")?i=Ue.UN(s.substring(3)):(i=Ue.UN(s),null===i&&(i=t[s])),e.it(i)&&(n=new i)}catch{}return n}replaceJsonObjects(t){if(Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];e.K(i)&&this.iD(t,n,this.replaceJsonObjects(i))}}else if(e.K(t)){for(const i in t){const n=t[i];if(e.K(n)){const e=this.replaceJsonObjects(n);if(t[i]=e,"points"===i&&Array.isArray(e)){let n=e.length%2===0;for(let t=0;t<e.length;t++)if("number"!=typeof e[t]){n=!1;break}if(n){const n=new l;for(let t=0;t<e.length/2;t++)n.add(new y(e[2*t],e[2*t+1]));n.u(),t[i]=n}}}}return this.WO(t)}return t}writeJsonValue(t){return void 0===t?"undefined":null===t?"null":!0===t?"true":!1===t?"false":"string"==typeof t?this.De(t):"number"==typeof t?t===1/0?"9e9999":t===-1/0?"-9e9999":isNaN(t)?'{"class":"NaN"}':t.toString():t instanceof Boolean||t instanceof String||t instanceof Number?this.writeJsonValue(t.valueOf()):t instanceof Date?'{"class":"Date", "value":"'+t.toJSON()+'"}':Array.isArray(t)?this.Ah(t):e.K(t)?this.$T(t):e.it(t)?"null":'"'+t.toString()+'"'}Ah(t,e){void 0===e&&(e=!1);const n=t.length;if(n<=0)return"[]";const s=new i;s.add("["),e&&n>1&&s.add("\n");for(let i=0;i<n;i++){const n=t[i];void 0!==n&&(i>0&&(s.add(","),e&&s.add("\n")),s.add(this.writeJsonValue(n)))}return e&&n>1&&s.add("\n"),s.add("]"),s.toString()}U1(t,i,n){return!(void 0!==n&&"__gohashid"!==i&&"_"!==i[0]&&!e.it(n))}Yi(t){return isNaN(t)?"NaN":t===1/0?"9e9999":t===-1/0?"-9e9999":t}$T(t){const e=t;if(e instanceof y)t={class:"go.Point",x:this.Yi(e.x),y:this.Yi(e.y)};else if(e instanceof x)t={class:"go.Size",width:this.Yi(e.width),height:this.Yi(e.height)};else if(e instanceof v)t={class:"go.Rect",x:this.Yi(e.x),y:this.Yi(e.y),width:this.Yi(e.width),height:this.Yi(e.height)};else if(e instanceof b)t={class:"go.Margin",top:this.Yi(e.top),right:this.Yi(e.right),bottom:this.Yi(e.bottom),left:this.Yi(e.left)};else if(e instanceof w)t=e.isSpot()?{class:"go.Spot",x:this.Yi(e.x),y:this.Yi(e.y),offsetX:this.Yi(e.offsetX),offsetY:this.Yi(e.offsetY)}:{class:"go.Spot",enum:e.toString()};else if(e instanceof Ut){if(t={class:"go.Brush",type:zt[e.type]},1===e.type?t.color=e.color:(2===e.type||3===e.type)&&(t.start=e.start,t.end=e.end,3===e.type&&(0!==e.startRadius&&(t.startRadius=this.Yi(e.startRadius)),isNaN(e.endRadius)||(t.endRadius=this.Yi(e.endRadius)))),null!==e.colorStops){const i={},n=e.colorStops.iterator;for(;n.next();){const t=n.key,e=n.value;i[t]=e}t.colorStops=i}}else if(e instanceof N)t={class:"go.Geometry",type:M[e.type]},0!==e.startX&&(t.startX=this.Yi(e.startX)),0!==e.startY&&(t.startY=this.Yi(e.startY)),0!==e.endX&&(t.endX=this.Yi(e.endX)),0!==e.endY&&(t.endY=this.Yi(e.endY)),e.spot1.equals(w.TopLeft)||(t.spot1=e.spot1),e.spot2.equals(w.BottomRight)||(t.spot2=e.spot2),4===e.type&&(t.path=N.stringify(e));else if(Ue.vN(null,"",e))return"{}";let i="{",n=!0;for(const s in t){const e=this.yt(t,s);if(!this.U1(t,s,e))if(n?n=!1:i+=",",i+=this.De(s)+":","points"===s&&e instanceof l){let t="[";const n=e.iterator;for(;n.next();){const e=n.value;t.length>1&&(t+=","),t+=this.eD(e.x),t+=",",t+=this.eD(e.y)}t+="]",i+=t}else i+=this.writeJsonValue(e)}return i+="}",i}eD(t){if(t===1/0)return"9e9999";if(t===-1/0)return"-9e9999";if(isNaN(t))return"0";const e=this.pointsDigits;return e>16?t.toString():t.toFixed(e)}get pointsDigits(){return this.Cy}set pointsDigits(t){t<0?t=0:t>100&&(t=100),this.Cy=t}Ki(t){return"number"==typeof t?t:"NaN"===t?NaN:"9e9999"===t?1/0:"-9e9999"===t?-1/0:parseFloat(t)}WO(t){if(!e.K(t))return t;let i=t.class||"";if("string"!=typeof i||""===i)return t;if("NaN"===i)return NaN;if("Date"===i)return new Date(t.value);if(0!==i.indexOf("go."))return t;i=i.substring(3);let n=t;if("Point"===i)n=new y(this.Ki(t.x),this.Ki(t.y));else if("Size"===i)n=new x(this.Ki(t.width),this.Ki(t.height));else if("Rect"===i)n=new v(this.Ki(t.x),this.Ki(t.y),this.Ki(t.width),this.Ki(t.height));else if("Margin"===i)n=new b(this.Ki(t.top),this.Ki(t.right),this.Ki(t.bottom),this.Ki(t.left));else if("Spot"===i)n="string"==typeof t.enum?w.parse(t.enum):new w(this.Ki(t.x),this.Ki(t.y),this.Ki(t.offsetX),this.Ki(t.offsetY));else if("Brush"===i){const i=new Ut;i.type=e.Eh(zt,t.type)??1,"string"==typeof t.color&&(i.color=t.color),t.start instanceof w&&(i.start=t.start),t.end instanceof w&&(i.end=t.end),"number"==typeof t.startRadius&&(i.startRadius=this.Ki(t.startRadius)),"number"==typeof t.endRadius&&(i.endRadius=this.Ki(t.endRadius));const s=t.colorStops;if(e.K(s))for(const t in s){const e=parseFloat(t);i.addColorStop(e,s[t])}n=i}else if("Geometry"===i){let i=null;i="string"==typeof t.path?N.parse(t.path):new N,i.type=e.Eh(M,t.type)??1,"number"==typeof t.startX&&(i.startX=this.Ki(t.startX)),"number"==typeof t.startY&&(i.startY=this.Ki(t.startY)),"number"==typeof t.endX&&(i.endX=this.Ki(t.endX)),"number"==typeof t.endY&&(i.endY=this.Ki(t.endY)),t.spot1 instanceof w&&(i.spot1=t.spot1),t.spot2 instanceof w&&(i.spot2=t.spot2),n=i}else if("EnumValue"===i){let i=t.classType;0===i.indexOf("go.")&&(i=i.substring(3));const s=Ue.UN(i);e.it(s)&&(n=e.Eh(s,t.name))}return n}get name(){return this.Pt}set name(t){const i=this.Pt;i!==t&&(e.s(t,"string",Ue,"name"),this.Pt=t,this.t("name",i,t))}get dataFormat(){return this.$d}set dataFormat(t){const i=this.$d;i!==t&&(e.s(t,"string",Ue,"dataFormat"),this.$d=t,this.t("dataFormat",i,t))}get isReadOnly(){return this.Lo}set isReadOnly(t){const i=this.Lo;i!==t&&(e.s(t,"boolean",Ue,"isReadOnly"),this.Lo=t,this.t("isReadOnly",i,t))}get modelData(){return this.FN}set modelData(t){const i=this.modelData;i!==t&&(e.ec(t,Ue,"modelData"),this.containsNodeData(t)&&e.o("Model.modelData Object must not be used by the rest of the model: "+t),this.FN=t,this.t("modelData",i,t),this.updateTargetBindings(t))}addChangedListener(t){return e.k(t,Ue,"addChangedListener:listener"),this.Ly.push(t),this}removeChangedListener(t){e.k(t,Ue,"removeChangedListener:listener");const i=this.Ly.indexOf(t);i>=0&&this.Ly.splice(i,1)}UM(t){this.skipsUndoManager||this.undoManager.handleChanged(t),this.sD(t)}sD(t){this.Ly.forEach((e=>e(t)))}uF(t){this.sD(t)}raiseChangedEvent(t,e,i,n,s,o,r){this.vt("",t,e,i,n,s,o,r)}raiseChanged(t,e,i,n,s){this.vt("",2,t,this,e,i,n,s)}t(t,e,i,n,s){this.vt("",2,t,this,e,i,n,s)}raiseDataChanged(t,e,i,n,s,o){this.vt("",2,e,t,i,n,s,o)}vt(t,e,i,n,s,o,r,a){void 0===r&&(r=null),void 0===a&&(a=null);const l=new E;l.model=this,l.change=e,l.modelChange=t,l.propertyName=i,l.object=n,l.oldValue=s,l.oldParam=r,l.newValue=o,l.newParam=a,this.UM(l)}get undoManager(){return this.B1}set undoManager(t){const e=this.B1;e!==t&&(null!==e&&e.removeModel(this),this.B1=t,null!==t&&t.addModel(this))}get skipsUndoManager(){return this.Co}set skipsUndoManager(t){e.s(t,"boolean",Ue,"skipsUndoManager"),this.Co=t}changeState(t,i){if(null!==t&&t.model===this)if(2===t.change){const e=t.object,n=t.propertyName,s=t.getValue(i);if(n===this.nodeKeyProperty&&this.containsNodeData(e)){const n=t.getValue(!i);void 0!==n&&this.mi.delete(n),void 0!==s&&this.mi.set(s,e)}this.Z(e,n,s)}else if(3===t.change){const n=t.newParam;if("nodeDataArray"===t.modelChange){const s=t.newValue;if(e.K(s)&&"number"==typeof n){const t=this.getKeyForNodeData(s);i?(this.Te[n]===s&&this.uo(this.Te,n),void 0!==t&&this.mi.delete(t)):(this.Te[n]!==s&&this.Jo(this.Te,n,s),void 0!==t&&this.mi.set(t,s))}}else if(""===t.modelChange){let e=t.object;if(e&&!Array.isArray(e)&&t.propertyName&&(e=this.yt(e,t.propertyName)),Array.isArray(e)&&"number"==typeof n){const s=t.newValue;i?this.uo(e,n):this.Jo(e,n,s)}}else e.o("unknown ChangeType.Insert modelChange: "+t.toString())}else if(4===t.change){const n=t.oldParam;if("nodeDataArray"===t.modelChange){const s=t.oldValue;if(e.K(s)&&"number"==typeof n){const t=this.getKeyForNodeData(s);i?(this.Te[n]!==s&&this.Jo(this.Te,n,s),void 0!==t&&this.mi.set(t,s)):(this.Te[n]===s&&this.uo(this.Te,n),void 0!==t&&this.mi.delete(t))}}else if(""===t.modelChange){let e=t.object;if(e&&!Array.isArray(e)&&t.propertyName&&(e=this.yt(e,t.propertyName)),Array.isArray(e)&&"number"==typeof n){const s=t.oldValue;i?this.Jo(e,n,s):this.uo(e,n)}}else e.o("unknown ChangeType.Remove modelChange: "+t.toString())}else 1===t.change||e.o("unknown ChangedEvent: "+t.toString())}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const n=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let s=!1;try{t(this),s=!0}finally{s?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=n}}updateTargetBindings(t,e){void 0===e&&(e=""),this.vt("SourceChanged",1,e,t,null,null)}get nodeKeyProperty(){return this.Lh}set nodeKeyProperty(t){const i=this.Lh;i!==t&&(this.Pn(t,Ue,"nodeKeyProperty"),""===t&&e.o("Model.nodeKeyProperty may not be the empty string"),this.mi.count>0&&e.o("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Lh=t,this.t("nodeKeyProperty",i,t))}Pn(t,i,n){"string"!=typeof t&&!e.it(t)&&e.Zi(t,"string or function",i,n)}getKeyForNodeData(t){if(null===t)return;const i=this.Lh;if(""===i)return;const n=this.yt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("Key value for node data "+t+" is not a number or a string: "+n)}}setKeyForNodeData(t,i){if((null==i||!this.isKeyType(i))&&e.Zi(i,"number or string",Ue,"setKeyForNodeData:key"),null===t)return;const n=this.Lh;if(""===n)return;if(!this.containsNodeData(t))return void this.Z(t,n,i);const s=this.yt(t,n);if(s!==i){if(null!==this.findNodeDataForKey(i))return;this.Z(t,n,i),void 0!==s&&this.mi.delete(s),this.mi.set(i,t),this.vt("nodeKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n),this.Dy(s,i)}}get makeUniqueKeyFunction(){return this.Df}set makeUniqueKeyFunction(t){const i=this.Df;i!==t&&(null!==t&&e.k(t,Ue,"makeUniqueKeyFunction"),this.Df=t,this.t("makeUniqueKeyFunction",i,t))}isKeyType(t){return"number"==typeof t||"string"==typeof t}containsNodeData(t){if(null===t)return!1;const e=this.getKeyForNodeData(t);return void 0!==e&&this.mi.get(e)===t}findNodeDataForKey(t){return null===t&&e.o("Model.findNodeDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.mi.get(t):null}get nodeDataArray(){return this.Te}set nodeDataArray(t){const i=this.Te;if(i!==t){this.VN(t,Ue,"nodeDataArray"),this.mi.clear(),this.zN();const n=t.length;for(let i=0;i<n;i++){const n=t[i];e.K(n)||e.o("Model.nodeDataArray must only contain Objects, not: "+n),n===this.modelData&&e.o("nodeDataArray Objects must not be the shared Model.modelData")}this.Te=t;const s=new l;for(let e=0;e<n;e++){const i=t[e],n=this.getKeyForNodeData(i);void 0===n||null!==this.mi.get(n)?s.add(i):this.mi.set(n,i)}const o=s.iterator;for(;o.next();){const t=o.value;this.makeNodeDataKeyUnique(t);const e=this.getKeyForNodeData(t);void 0!==e&&this.mi.set(e,t)}this.vt("nodeDataArray",2,"nodeDataArray",this,i,t);for(let e=0;e<n;e++){const i=t[e];this.ng(i),this.og(i)}}}z1(t){return void 0!==t&&this.mi.has(t)}makeNodeDataKeyUnique(t){if(null===t)return;const e=this.Lh;if(""===e)return;let i=this.getKeyForNodeData(t);if(void 0!==i&&!this.z1(i))return;const n=this.Df;if(null===n||(i=n(this,t),null==i||this.z1(i))){if("string"==typeof i){let n=2;for(;this.z1(i+n);)n++;this.Z(t,e,i+n)}else if(void 0===i||"number"==typeof i){let i=-this.mi.count-1;for(;this.z1(i);)i--;this.Z(t,e,i)}}else this.Z(t,e,i)}addNodeData(t){null!==t&&(t===this.modelData&&e.o("Model.addNodeData cannot add the shared Model.modelData Object"),this.containsNodeData(t)||this.VT(t,!0))}VT(t,i){let n=this.getKeyForNodeData(t);if(void 0===n)this.makeNodeDataKeyUnique(t),n=this.getKeyForNodeData(t);else{if(this.mi.get(n)===t)return;this.makeNodeDataKeyUnique(t),n=this.getKeyForNodeData(t)}void 0===n&&e.o("Model.makeNodeDataKeyUnique failed on "+t+".  Data not added to Model."),this.mi.set(n,t);let s=null;i&&(s=this.Te.length,this.Jo(this.Te,s,t)),this.vt("nodeDataArray",3,"nodeDataArray",this,null,t,null,s),this.ng(t),this.og(t)}addNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addNodeData(t)}}}removeNodeData(t){null!==t&&this.UT(t,!0)}UT(t,e){const i=this.getKeyForNodeData(t);void 0!==i&&this.mi.delete(i);let n=null;if(e){if(n=this.Te.indexOf(t),n<0)return;this.uo(this.Te,n)}this.vt("nodeDataArray",4,"nodeDataArray",this,t,null,n,null),this.Fy(t)}removeNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeNodeData(t)}}}mergeNodeDataArray(t){if(t===this.nodeDataArray||!Array.isArray(t))return;const e=new u;e.addAll(this.mi.iteratorKeys);const i=new u,n=t.length;for(let o=0;o<n;o++){const e=t[o],n=this.getKeyForNodeData(e);if(void 0!==n){i.add(n);const t=this.findNodeDataForKey(n);if(t===e)continue;if(null!==t)this.assignAllDataProperties(t,e),this.sg(e,t);else{const t=this.cloneDeep(e);this.setKeyForNodeData(t,n),this.addNodeData(t)}}else{const t=this.cloneDeep(e);this.addNodeData(t),i.add(this.getKeyForNodeData(t))}}const s=e.iterator;for(;s.next();){const t=s.value;if(!i.has(t)){const e=this.findNodeDataForKey(t);e&&this.removeNodeData(e)}}}Dy(t,e){if(void 0===e)return;const i=this.My(t);i instanceof u&&this.Wo.set(e,i)}zN(){}ng(t){}og(t){}Fy(t){}Js(t,e){if(void 0===t)return;let i=this.Wo.get(t);null===i&&(i=new u,this.Wo.set(t,i)),i.add(e)}Ws(t,e){if(void 0===t)return;const i=this.Wo.get(t);i instanceof u&&(null==e?this.Wo.delete(t):(i.delete(e),0===i.count&&this.Wo.delete(t)))}My(t){if(void 0===t)return null;const e=this.Wo.get(t);return e instanceof u?e:null}vE(t){void 0===t?this.Wo.clear():this.Wo.delete(t)}get copyNodeDataFunction(){return this.Ff}set copyNodeDataFunction(t){const i=this.Ff;i!==t&&(null!==t&&e.k(t,Ue,"copyNodeDataFunction"),this.Ff=t,this.t("copyNodeDataFunction",i,t))}get copiesArrays(){return this.Zd}set copiesArrays(t){const i=this.Zd;i!==t&&(null!==t&&e.s(t,"boolean",Ue,"copiesArrays"),this.Zd=t,this.t("copiesArrays",i,t))}get copiesArrayObjects(){return this.Qd}set copiesArrayObjects(t){const i=this.Qd;i!==t&&(null!==t&&e.s(t,"boolean",Ue,"copiesArrayObjects"),this.Qd=t,this.t("copiesArrayObjects",i,t))}get copiesKey(){return this._d}set copiesKey(t){const i=this._d;i!==t&&(null!==t&&e.s(t,"boolean",Ue,"copiesKey"),this._d=t,this.t("copiesKey",i,t))}copyNodeData(t){if(null===t)return null;let i=null;const n=this.Ff;return i=null!==n?n(t,this):this.X1(t,!0),e.K(i),i}X1(t,i){if(e.K(t)){if(Array.isArray(t)){if(this.copiesArrays){const e=t,i=[];for(let t=0;t<e.length;t++){const n=e[t],s=this.X1(n,this.copiesArrayObjects);i.push(s)}return i}return t}if(t instanceof y||t instanceof x||t instanceof v||t instanceof b||t instanceof w)return t.copy();if(i){const i=t,n=i.constructor,s=n?new n:{},o=this.copiesKey||"string"!=typeof this.nodeKeyProperty?null:this.nodeKeyProperty;for(const t in i){if("__gohashid"===t){s.__gohashid=void 0;continue}if(t===o){s[o]=void 0;continue}const n=this.yt(i,t);if(e.K(n))if(Ue.vN(i,t,n))this.Z(s,t,n);else{const e=this.X1(n,!1);this.Z(s,t,e)}else s[t]=n}return s}return t}return t}get afterCopyFunction(){return this.tg}set afterCopyFunction(t){const i=this.tg;i!==t&&(null!==t&&e.k(t,Ue,"afterCopyFunction"),this.tg=t,this.t("afterCopyFunction",i,t))}static vN(t,i,n){const s=e.Dn(n);return n instanceof Ue||n instanceof B||n instanceof R||n instanceof E||n instanceof At||n instanceof $t||n instanceof vt||n instanceof EventTarget||"Layer"===s||"RowColumnDefinition"===s||s.indexOf("Animation")>=0||s.indexOf("Tool")>=0||s.indexOf("CommandHandler")>=0||s.indexOf("Layout")>=0}static nD=!1;setDataProperty(t,i,n){if(this.containsNodeData(t)){if(i===this.nodeKeyProperty)return void this.setKeyForNodeData(t,n);if(i===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,n)}else!Ue.nD&&t instanceof At&&(Ue.nD=!0,e.ni('Model.setDataProperty is modifying a GraphObject, "'+t.toString()+'"'),e.ni("  Is that really your intent?"));const s=this.yt(t,i);s!==n&&(this.Z(t,i,n),this.raiseDataChanged(t,i,s,n))}set(t,e,i){this.setDataProperty(t,e,i)}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t);for(const n in e)"__gohashid"!==n&&(i&&n===this.nodeKeyProperty||this.setDataProperty(t,n,e[n]))}addArrayItem(t,e){this.insertArrayItem(t,-1,e)}insertArrayItem(t,e,i){e<0&&(e=t.length),t=this.Jo(t,e,i),this.vt("",3,"",t,null,i,null,e)}removeArrayItem(t,i){void 0===i&&(i=-1),t===this.Te&&e.o("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===i&&(i=t.length-1);const n=t[i];t=this.uo(t,i),this.vt("",4,"",t,n,null,i,null)}get nodeCategoryProperty(){return this.Ga}set nodeCategoryProperty(t){const e=this.Ga;e!==t&&(this.Pn(t,Ue,"nodeCategoryProperty"),this.Ga=t,this.t("nodeCategoryProperty",e,t))}getCategoryForNodeData(t){if(null===t)return"";const i=this.Ga;if(""===i)return"";const n=this.yt(t,i);return void 0===n?"":"string"==typeof n?n:void e.o("getCategoryForNodeData found a non-string category for "+t+": "+n)}setCategoryForNodeData(t,i){if(e.s(i,"string",Ue,"setCategoryForNodeData:cat"),null===t)return;const n=this.Ga;if(""===n)return;if(!this.containsNodeData(t))return void this.Z(t,n,i);let s=this.yt(t,n);void 0===s&&(s=""),s!==i&&(this.Z(t,n,i),this.vt("nodeCategory",2,n,t,s,i))}sg(t,e){this.setCategoryForNodeData(e,this.getCategoryForNodeData(t))}get type(){return"Model"}pm(){return!1}mm(){return!1}Sb(){return!1}Ra(){return!1}Vw(){return!1}jc(){return!1}static CM(){return new Ue}yt(t,e){return Ue.yt(t,e)}static yt(t,i){if(!t||!i)return null;let n;try{e.it(i)?n=i(t):e.it(t.getAttribute)?(n=t.getAttribute(i),null===n&&(n=void 0)):n=t[i]}catch{}return n}Z(t,e,i){Ue.Z(t,e,i)}static Z(t,i,n){if(t&&i){try{e.it(i)?i(t,n):e.it(t.setAttribute)?t.setAttribute(i,n):t[i]=n}catch{}return t}}VN(t,i,n){Array.isArray(t)||e.Zi(t,"Array",i,n)}iD(t,e,i){return t[e]=i,t}Jo(t,e,i){return e>=t.length?t.push(i):t.splice(e,0,i),t}uo(t,e){return e>=t.length?t.pop():t.splice(e,1),t}static UN(e){return Ue.XN[e]?Ue.XN[e]:void 0!==t.go&&t.go[e]?t.go[e]:null}static cl(t,e){Ue.XN[e]=t}static XN={};static#t=(()=>(Ue.cl(Ut,"Brush"),Ue.cl(N,"Geometry"),Ue.cl(b,"Margin"),Ue.cl(y,"Point"),Ue.cl(v,"Rect"),Ue.cl(x,"Size"),Ue.cl(w,"Spot"),Ue.cl(Ue,"Model")))()}Ue.fromJSON=Ue.fromJson=Ue.fromJson;class Xe extends Ue{Ps;$o;Di;Th;Rf;vf;Cl;go;mo;Ha;ja;qa;$s;Of;Sn;rg;constructor(t,e,i){if(super(),this.Ps=[],this.$o=new u,this.Di=new m,this.Th="",this.Rf=null,this.vf=null,this.Cl=null,this.go="from",this.mo="to",this.Ha="",this.ja="",this.qa="category",this.$s="",this.Of="isGroup",this.Sn="group",this.rg=!1,void 0!==e&&(this.linkDataArray=e),void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:i=t),i){Object.assign(this,i);const t=i.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Th=this.Th,t.Rf=this.Rf,t.vf=this.vf,t.go=this.go,t.mo=this.mo,t.Ha=this.Ha,t.ja=this.ja,t.qa=this.qa,t.$s=this.$s,t.Of=this.Of,t.Sn=this.Sn,t.rg=this.rg}clear(){this.Ps=[],this.Di.clear(),this.$o.clear(),super.clear()}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" GraphLinksModel";if(t>0){e+="\n node data:";let t=this.nodeDataArray,i=t.length,n=0;for(n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+je.toString(i)}for(e+="\n link data:",t=this.linkDataArray,i=t.length,n=0;n<i;n++){const i=t[n];e+=" "+this.Ae(i,!0)+"--\x3e"+this.Ae(i,!1)}}return e}}RN(t,e,i){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}let n=super.RN(t,e,i);const s=this,o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===s)if("linkDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(s.containsLinkData(t.object))r.add(t.object);else if(null!==t.object)if(null!==t.object&&i.has(t.object))i.get(t.object).each((t=>{s.containsLinkData(t)&&r.add(t)}));else{if(t.object instanceof Ue||s.containsNodeData(t.object))return;s.oD(t.object).each((t=>r.add(t)))}}));const l=new u;o.each((t=>{l.add(s.getKeyForLinkData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(s.getKeyForLinkData(t)),e&&r.add(t)}));const c=s.cloneDeep(r.toArray());return l.count>0&&(null===n&&(n={}),e?n.removedLinkKeys=l.toArray():n.insertedLinkKeys=l.toArray()),c.length>0&&(null===n&&(n={}),n.modifiedLinkData=c),h.count>0&&(null===n&&(n={}),e?n.insertedLinkKeys=h.toArray():n.removedLinkKeys=h.toArray()),n}eg(){const t=super.eg();let e="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(e+=',\n  "linkCategoryProperty": '+this.De(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(e+=',\n  "linkKeyProperty": '+this.De(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(e+=',\n  "linkFromKeyProperty": '+this.De(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(e+=',\n  "linkToKeyProperty": '+this.De(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(e+=',\n  "linkFromPortIdProperty": '+this.De(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(e+=',\n  "linkToPortIdProperty": '+this.De(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(e+=',\n  "linkLabelKeysProperty": '+this.De(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(e+=',\n  "nodeIsGroupProperty": '+this.De(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(e+=',\n  "nodeGroupKeyProperty": '+this.De(this.nodeGroupKeyProperty)),t+e}Ay(t){super.Ay(t),t.linkKeyProperty&&(this.linkKeyProperty=t.linkKeyProperty),t.linkFromKeyProperty&&(this.linkFromKeyProperty=t.linkFromKeyProperty),t.linkToKeyProperty&&(this.linkToKeyProperty=t.linkToKeyProperty),t.linkFromPortIdProperty&&(this.linkFromPortIdProperty=t.linkFromPortIdProperty),t.linkToPortIdProperty&&(this.linkToPortIdProperty=t.linkToPortIdProperty),t.linkCategoryProperty&&(this.linkCategoryProperty=t.linkCategoryProperty),t.linkLabelKeysProperty&&(this.linkLabelKeysProperty=t.linkLabelKeysProperty),t.nodeIsGroupProperty&&(this.nodeIsGroupProperty=t.nodeIsGroupProperty),t.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=t.nodeGroupKeyProperty)}ON(){return super.ON()+(',\n  "linkDataArray": '+this.Ah(this.linkDataArray,!0))}IN(t){super.IN(t);const e=t.linkDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.linkDataArray=e)}rD=',\n  "insertedLinkKeys": ';JO=',\n  "modifiedLinkData": ';lD=',\n  "removedLinkKeys": ';oD(t){const e=new u;for(let i=0;i<this.linkDataArray.length;i++){const n=this.linkDataArray[i];this.V1(t,n,n,e)}return e}BN(t,e,i){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}const n=super.BN(t,e,i),s=this,o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===s)if("linkDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(s.containsLinkData(t.object))r.add(t.object);else if(null!==t.object)if(null!==t.object&&i.has(t.object))i.get(t.object).each((t=>{s.containsLinkData(t)&&r.add(t)}));else{if(t.object instanceof Ue||s.containsNodeData(t.object))return;s.oD(t.object).each((t=>r.add(t)))}}));const l=new u;o.each((t=>{l.add(s.getKeyForLinkData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(s.getKeyForLinkData(t)),e&&r.add(t)}));let c=n;return l.count>0&&(c+=(e?this.lD:this.rD)+this.Ah(l.toArray(),!0)),r.count>0&&(c+=this.JO+this.Ah(r.toArray(),!0)),h.count>0&&(c+=(e?this.rD:this.lD)+this.Ah(h.toArray(),!0)),c}Ty(t){(void 0!==t.linkCategoryProperty&&t.linkCategoryProperty!==this.linkCategoryProperty||void 0!==t.linkKeyProperty&&t.linkKeyProperty!==this.linkKeyProperty||void 0!==t.linkFromKeyProperty&&t.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==t.linkToKeyProperty&&t.linkToKeyProperty!==this.linkToKeyProperty||void 0!==t.linkFromPortIdProperty&&t.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==t.linkToPortIdProperty&&t.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==t.linkLabelKeysProperty&&t.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==t.nodeIsGroupProperty&&t.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==t.nodeGroupKeyProperty&&t.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&e.o("applyIncrementalJson cannot change Model properties"),super.Ty(t);const i=t.insertedLinkKeys;if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e];let n=this.findLinkDataForKey(t);null===n&&(n=this.copyLinkData({}),this.setKeyForLinkData(n,t),this.addLinkData(n))}}const n=t.modifiedLinkData;if(Array.isArray(n)){const t=n.length;for(let e=0;e<t;e++){const t=n[e],i=this.getKeyForLinkData(t),s=this.findLinkDataForKey(i);if(null!==s){for(const e in t)"__gohashid"===e||e===this.linkKeyProperty||this.setDataProperty(s,e,t[e]);this.hD(t,s)}}}const s=t.removedLinkKeys;if(Array.isArray(s)){const t=s.length;for(let e=0;e<t;e++){const t=s[e],i=this.findLinkDataForKey(t);null!==i&&this.removeLinkData(i)}}}changeState(t,i){if(null!==t&&t.model===this){if(2===t.change){const e=t.object,n=t.propertyName;if(n===this.linkKeyProperty&&this.containsLinkData(e)){const s=t.getValue(i),o=t.getValue(!i);return void 0!==o&&this.Di.delete(o),void 0!==s&&this.Di.set(s,e),void this.Z(e,n,s)}}else if(3===t.change){let n=t.newParam;if("linkDataArray"===t.modelChange){const s=t.newValue;if(e.K(s)&&"number"==typeof n){const t=this.getKeyForLinkData(s);i?(this.$o.delete(s),this.Ps[n]===s&&this.uo(this.linkDataArray,n),void 0!==t&&this.Di.delete(t)):(this.$o.add(s),this.Ps[n]!==s&&this.Jo(this.Ps,n,s),void 0!==t&&this.Di.set(t,s))}return}if("linkLabelKeys"===t.modelChange){const e=t.object,s=this.getLabelKeysForLinkData(e);return void(Array.isArray(s)&&"number"==typeof n&&(i?(n=s.indexOf(t.newValue),n>=0&&this.uo(s,n)):s.indexOf(t.newValue)<0&&this.Jo(s,n,t.newValue)))}}else if(4===t.change){let n=t.oldParam;if("linkDataArray"===t.modelChange){const s=t.oldValue;if(e.K(s)&&"number"==typeof n){const t=this.getKeyForLinkData(s);i?(this.$o.add(s),this.Ps[n]!==s&&this.Jo(this.Ps,n,s),void 0!==t&&this.Di.set(t,s)):(this.$o.delete(s),this.Ps[n]===s&&this.uo(this.linkDataArray,n),void 0!==t&&this.Di.delete(t))}return}if("linkLabelKeys"===t.modelChange){const e=t.object,s=this.getLabelKeysForLinkData(e);return void(Array.isArray(s)&&"number"==typeof n&&(i?s.indexOf(t.oldValue)<0&&this.Jo(s,n,t.oldValue):(n=s.indexOf(t.oldValue),n>=0&&this.uo(s,n))))}}super.changeState(t,i)}}get archetypeNodeData(){return this.Cl}set archetypeNodeData(t){const i=this.Cl;i!==t&&(null!==t&&e.ec(t,Xe,"archetypeNodeData"),this.Cl=t,this.t("archetypeNodeData",i,t))}YN(t){if(void 0===t)return;const e=this.Cl;if(null!==e){let i=this.findNodeDataForKey(t);null===i&&(i=this.copyNodeData(e),this.Z(i,this.nodeKeyProperty,t),this.addNodeData(i))}return t}get linkFromKeyProperty(){return this.go}set linkFromKeyProperty(t){const e=this.go;e!==t&&(this.Pn(t,Xe,"linkFromKeyProperty"),this.go=t,this.t("linkFromKeyProperty",e,t))}getFromKeyForLinkData(t){return this.Ae(t,!0)}setFromKeyForLinkData(t,e){this.Wd(t,e,!0)}get linkToKeyProperty(){return this.mo}set linkToKeyProperty(t){const e=this.mo;e!==t&&(this.Pn(t,Xe,"linkToKeyProperty"),this.mo=t,this.t("linkToKeyProperty",e,t))}getToKeyForLinkData(t){return this.Ae(t,!1)}setToKeyForLinkData(t,e){this.Wd(t,e,!1)}Ae(t,i){if(null===t)return;const n=i?this.go:this.mo;if(""===n)return;const s=this.yt(t,n);if(void 0!==s){if(this.isKeyType(s))return s;e.o((i?"FromKey":"ToKey")+" value for link data "+t+" is not a number or a string: "+s)}}Wd(t,i,n){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.Zi(i,"number or string",Xe,n?"setFromKeyForLinkData:key":"setToKeyForLinkData:key"),null===t)return;const s=n?this.go:this.mo;if(""===s)return;if(i=this.YN(i),!this.containsLinkData(t))return void this.Z(t,s,i);const o=this.yt(t,s);o!==i&&(this.Ws(o,t),this.Z(t,s,i),null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt(n?"linkFromKey":"linkToKey",2,s,t,o,i),"string"==typeof s&&this.updateTargetBindings(t,s))}get linkFromPortIdProperty(){return this.Ha}set linkFromPortIdProperty(t){const e=this.Ha;e!==t&&(this.Pn(t,Xe,"linkFromPortIdProperty"),this.Ha=t,this.t("linkFromPortIdProperty",e,t))}getFromPortIdForLinkData(t){return this.O1(t,!0)}setFromPortIdForLinkData(t,e){this.Jd(t,e,!0)}get linkToPortIdProperty(){return this.ja}set linkToPortIdProperty(t){const e=this.ja;e!==t&&(this.Pn(t,Xe,"linkToPortIdProperty"),this.ja=t,this.t("linkToPortIdProperty",e,t))}getToPortIdForLinkData(t){return this.O1(t,!1)}setToPortIdForLinkData(t,e){this.Jd(t,e,!1)}O1(t,e){if(null===t)return"";const i=e?this.Ha:this.ja;if(""===i)return"";const n=this.yt(t,i);return void 0===n?"":n}Jd(t,i,n){if(e.s(i,"string",Xe,n?"setFromPortIdForLinkData:portname":"setToPortIdForLinkData:portname"),null===t)return;const s=n?this.Ha:this.ja;if(""===s)return;if(!this.containsLinkData(t))return void this.Z(t,s,i);let o=this.yt(t,s);void 0===o&&(o=""),o!==i&&(this.Z(t,s,i),this.vt(n?"linkFromPortId":"linkToPortId",2,s,t,o,i),"string"==typeof s&&this.updateTargetBindings(t,s))}get linkLabelKeysProperty(){return this.$s}set linkLabelKeysProperty(t){const e=this.$s;e!==t&&(this.Pn(t,Xe,"linkLabelKeysProperty"),this.$s=t,this.t("linkLabelKeysProperty",e,t))}getLabelKeysForLinkData(t){if(null===t)return Xe.EmptyArray;const e=this.$s;if(""===e)return Xe.EmptyArray;const i=this.yt(t,e);return void 0===i?Xe.EmptyArray:i}setLabelKeysForLinkData(t,e){if(this.VN(e,Xe,"setLabelKeysForLinkData:arr"),null===t)return;const i=this.$s;if(""===i)return;if(!this.containsLinkData(t))return void this.Z(t,i,e);let n=this.yt(t,i);if(void 0===n&&(n=Xe.EmptyArray),n!==e){if(Array.isArray(n)){const e=n.length;for(let i=0;i<e;i++){const e=n[i];this.Ws(e,t)}}this.Z(t,i,e);const s=e.length;for(let i=0;i<s;i++){const n=e[i];null===this.findNodeDataForKey(n)&&this.Js(n,t)}this.vt("linkLabelKeys",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i)}}addLabelKeyForLinkData(t,i){if(null==i||(this.isKeyType(i)||e.Zi(i,"number or string",Xe,"addLabelKeyForLinkData:key"),null===t))return;const n=this.$s;if(""===n)return;const s=this.yt(t,n);if(void 0===s){const e=[];e.push(i),this.setLabelKeysForLinkData(t,e)}else if(Array.isArray(s)){let e=s.indexOf(i);if(e>=0)return;e=s.length,s.push(i),this.containsLinkData(t)&&(null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt("linkLabelKeys",3,n,t,null,i,null,e))}else e.o(n+" property is not an Array; cannot addLabelKeyForLinkData: "+t)}removeLabelKeyForLinkData(t,i){if(null==i||(this.isKeyType(i)||e.Zi(i,"number or string",Xe,"removeLabelKeyForLinkData:key"),null===t))return;const n=this.$s;if(""===n)return;const s=this.yt(t,n);if(Array.isArray(s)){const e=s.indexOf(i);if(e<0)return;this.uo(s,e),this.containsLinkData(t)&&(this.Ws(i,t),this.vt("linkLabelKeys",4,n,t,i,null,e,null))}else void 0!==s&&e.o(n+" property is not an Array; cannot removeLabelKeyforLinkData: "+t)}get linkDataArray(){return this.Ps}set linkDataArray(t){const i=this.Ps;if(i!==t){this.VN(t,Xe,"linkDataArray"),this.Di.clear();const n=t.length;for(let i=0;i<n;i++){const n=t[i];e.K(n)||e.o("GraphLinksModel.linkDataArray must only contain Objects, not: "+n)}if(this.Ps=t,""!==this.linkKeyProperty){const e=new l;for(let s=0;s<n;s++){const i=t[s],n=this.getKeyForLinkData(i);void 0===n||null!==this.Di.get(n)?e.add(i):this.Di.set(n,i)}const i=e.iterator;for(;i.next();){const t=i.value;this.makeLinkDataKeyUnique(t);const e=this.getKeyForLinkData(t);void 0!==e&&this.Di.set(e,t)}}const s=new u;for(let e=0;e<n;e++){const i=t[e];s.add(i)}this.$o=s,this.vt("linkDataArray",2,"linkDataArray",this,i,t);for(let e=0;e<n;e++){const i=t[e];this.KN(i)}}}get linkKeyProperty(){return this.Th}set linkKeyProperty(t){const e=this.Th;if(e!==t){this.Pn(t,Xe,"linkKeyProperty"),this.Th=t,this.Di.clear();const i=this.linkDataArray.length;for(let t=0;t<i;t++){const e=this.linkDataArray[t];let i=this.getKeyForLinkData(e);void 0===i&&(this.makeLinkDataKeyUnique(e),i=this.getKeyForLinkData(e)),void 0!==i&&this.Di.set(i,e)}this.t("linkKeyProperty",e,t)}}getKeyForLinkData(t){if(null===t)return;const i=this.Th;if(""===i)return;const n=this.yt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("Key value for link data "+t+" is not a number or a string: "+n)}}setKeyForLinkData(t,i){if((null==i||!this.isKeyType(i))&&e.Zi(i,"number or string",Xe,"setKeyForLinkData:key"),null===t)return;const n=this.Th;if(""===n)return;if(!this.containsLinkData(t))return void this.Z(t,n,i);const s=this.yt(t,n);if(s!==i){if(null!==this.findLinkDataForKey(i))return;this.Z(t,n,i),void 0!==s&&this.Di.delete(s),this.Di.set(i,t),this.vt("linkKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}get makeUniqueLinkKeyFunction(){return this.Rf}set makeUniqueLinkKeyFunction(t){const i=this.Rf;i!==t&&(null!==t&&e.k(t,Xe,"makeUniqueLinkKeyFunction"),this.Rf=t,this.t("makeUniqueLinkKeyFunction",i,t))}findLinkDataForKey(t){return null===t&&e.o("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.Di.get(t):null}Y1(t){return void 0!==t&&this.Di.has(t)}makeLinkDataKeyUnique(t){if(null===t)return;const e=this.Th;if(""===e)return;let i=this.getKeyForLinkData(t);if(void 0!==i&&!this.Y1(i))return;const n=this.Rf;if(null===n||(i=n(this,t),null==i||this.Y1(i))){if("string"==typeof i){let n=2;for(;this.Y1(i+n);)n++;this.Z(t,e,i+n)}else if(void 0===i||"number"==typeof i){let i=-this.Di.count-1;for(;this.Y1(i);)i--;this.Z(t,e,i)}}else this.Z(t,e,i)}containsLinkData(t){return null!==t&&this.$o.has(t)}addLinkData(t){null!==t&&(this.containsLinkData(t)||this.HT(t,!0))}HT(t,i){if(""!==this.linkKeyProperty){let i=this.getKeyForLinkData(t);if(void 0===i)this.makeLinkDataKeyUnique(t),i=this.getKeyForLinkData(t);else{if(this.Di.get(i)===t)return;this.makeLinkDataKeyUnique(t),i=this.getKeyForLinkData(t)}void 0===i&&e.o("GraphLinksModel.makeLinkDataKeyUnique failed on "+t+". Data not added to model."),this.Di.set(i,t)}this.$o.add(t);let n=null;i&&(n=this.Ps.length,this.Jo(this.Ps,n,t)),this.vt("linkDataArray",3,"linkDataArray",this,null,t,null,n),this.KN(t)}addLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addLinkData(t)}}}removeLinkData(t){null!==t&&this.GT(t,!0)}GT(t,e){this.$o.delete(t);const i=this.getKeyForLinkData(t);void 0!==i&&this.Di.delete(i);let n=null;if(e){if(n=this.Ps.indexOf(t),n<0)return;this.uo(this.Ps,n)}this.vt("linkDataArray",4,"linkDataArray",this,t,null,n,null),this.$O(t)}removeLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeLinkData(t)}}}mergeLinkDataArray(t){if(""===this.linkKeyProperty&&e.o("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),t===this.linkDataArray||!Array.isArray(t))return;const i=new u;i.addAll(this.Di.iteratorKeys);const n=new u,s=t.length;for(let e=0;e<s;e++){const i=t[e],s=this.getKeyForLinkData(i);if(void 0!==s){n.add(s);const t=this.findLinkDataForKey(s);if(t===i)continue;if(null!==t)this.assignAllDataProperties(t,i),this.hD(i,t);else{const t=this.cloneDeep(i);this.setKeyForLinkData(t,s),this.addLinkData(t)}}else{const t=this.cloneDeep(i);this.addLinkData(t),n.add(this.getKeyForLinkData(t))}}const o=i.iterator;for(;o.next();){const t=o.value;if(!n.has(t)){const e=this.findLinkDataForKey(t);e&&this.removeLinkData(e)}}}KN(t){let e=this.Ae(t,!0);e=this.YN(e),null===this.findNodeDataForKey(e)&&this.Js(e,t),e=this.Ae(t,!1),e=this.YN(e),null===this.findNodeDataForKey(e)&&this.Js(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const n=i.length;for(let s=0;s<n;s++)e=i[s],null===this.findNodeDataForKey(e)&&this.Js(e,t)}}$O(t){let e=this.Ae(t,!0);this.Ws(e,t),e=this.Ae(t,!1),this.Ws(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const n=i.length;for(let s=0;s<n;s++)e=i[s],this.Ws(e,t)}}get copyLinkDataFunction(){return this.vf}set copyLinkDataFunction(t){const i=this.vf;i!==t&&(null!==t&&e.k(t,Xe,"copyLinkDataFunction"),this.vf=t,this.t("copyLinkDataFunction",i,t))}copyLinkData(t){if(null===t)return null;let i=null;const n=this.vf;return i=null!==n?n(t,this):this.X1(t,!0),e.K(i)&&(""!==this.go&&this.Z(i,this.go,void 0),""!==this.mo&&this.Z(i,this.mo,void 0),""!==this.$s&&this.Z(i,this.$s,[])),i}get nodeIsGroupProperty(){return this.Of}set nodeIsGroupProperty(t){const e=this.Of;e!==t&&(this.Pn(t,Xe,"nodeIsGroupProperty"),this.Of=t,this.t("nodeIsGroupProperty",e,t))}isGroupForNodeData(t){if(null===t)return!1;const e=this.Of;return""!==e&&!!this.yt(t,e)}isGroupForData(t){return this.isGroupForNodeData(t)}get nodeGroupKeyProperty(){return this.Sn}set nodeGroupKeyProperty(t){const e=this.Sn;e!==t&&(this.Pn(t,Xe,"nodeGroupKeyProperty"),this.Sn=t,this.t("nodeGroupKeyProperty",e,t))}get copiesGroupKeyOfNodeData(){return this.rg}set copiesGroupKeyOfNodeData(t){this.rg!==t&&(e.s(t,"boolean",Xe,"copiesGroupKeyOfNodeData"),this.rg=t)}getGroupKeyForNodeData(t){if(null===t)return;const i=this.Sn;if(""===i)return;const n=this.yt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("GroupKey value for node data "+t+" is not a number or a string: "+n)}}getGroupForData(t){return this.getGroupKeyForNodeData(t)}setGroupKeyForNodeData(t,i){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.Zi(i,"number or string",Xe,"setGroupKeyForNodeData:key"),null===t)return;const n=this.Sn;if(""===n)return;if(!this.containsNodeData(t))return void this.Z(t,n,i);const s=this.yt(t,n);s!==i&&(this.Ws(s,t),this.Z(t,n,i),null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt("nodeGroupKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}setGroupForData(t,e){this.setGroupKeyForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesGroupKeyOfNodeData&&""!==this.Sn&&void 0!==this.yt(e,this.Sn)&&this.Z(e,this.Sn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeGroupKeyProperty)return void this.setGroupKeyForNodeData(t,i)}else if(this.containsLinkData(t)){if(e===this.linkFromKeyProperty)return void this.Wd(t,i,!0);if(e===this.linkToKeyProperty)return void this.Wd(t,i,!1);if(e===this.linkFromPortIdProperty)return void this.Jd(t,i,!0);if(e===this.linkToPortIdProperty)return void this.Jd(t,i,!1);if(e===this.linkKeyProperty)return void this.setKeyForLinkData(t,i);if(e===this.linkCategoryProperty)return void this.setCategoryForLinkData(t,i);if(e===this.linkLabelKeysProperty)return void this.setLabelKeysForLinkData(t,i)}const n=this.yt(t,e);n!==i&&(this.Z(t,e,i),this.raiseDataChanged(t,e,n,i))}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t),n=this.containsLinkData(t);for(const s in e)if("__gohashid"!==s&&(!i||s!==this.nodeKeyProperty)){if(i&&s===this.nodeIsGroupProperty&&this.yt(t,s)===e[s])continue;if(n&&s===this.linkKeyProperty)continue;this.setDataProperty(t,s,e[s])}}Dy(t,e){super.Dy(t,e);const i=this.mi.iterator;for(;i.next();){const n=i.value;this.GN(n,t,e)}const n=this.$o.iterator;for(;n.next();){const i=n.value;this.ZO(i,t,e)}}GN(t,e,i){if(this.getGroupKeyForNodeData(t)===e){const n=this.Sn;this.Z(t,n,i),this.vt("nodeGroupKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}ZO(t,e,i){if(this.Ae(t,!0)===e){const n=this.go;this.Z(t,n,i),this.vt("linkFromKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}if(this.Ae(t,!1)===e){const n=this.mo;this.Z(t,n,i),this.vt("linkToKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}const n=this.getLabelKeysForLinkData(t);if(Array.isArray(n)){const s=n.length,o=this.$s;for(let r=0;r<s;r++)n[r]===e&&(this.iD(n,r,i),this.vt("linkLabelKeys",3,o,t,e,i,r,r))}}zN(){super.zN();const t=this.linkDataArray,e=t.length;for(let i=0;i<e;i++){const e=t[i];this.KN(e)}}ng(t){super.ng(t);const i=this.getKeyForNodeData(t),n=this.My(i);if(null!==n){const t=e.et(),s=n.iterator;for(;s.next();){const e=s.value;if(this.containsNodeData(e)){if(this.getGroupKeyForNodeData(e)===i){const n=this.Sn;this.vt("nodeGroupKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}}else{if(this.Ae(e,!0)===i){const n=this.go;this.vt("linkFromKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}if(this.Ae(e,!1)===i){const n=this.mo;this.vt("linkToKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}const n=this.getLabelKeysForLinkData(e);if(Array.isArray(n)){const s=n.length,o=this.$s;for(let r=0;r<s;r++)n[r]===i&&(this.vt("linkLabelKeys",3,o,e,i,i,r,r),t.push(e))}}}for(let e=0;e<t.length;e++)this.Ws(i,t[e]);e.J(t)}}og(t){super.og(t);const e=this.getGroupKeyForNodeData(t);null===this.findNodeDataForKey(e)&&this.Js(e,t)}Fy(t){super.Fy(t);const e=this.getGroupKeyForNodeData(t);this.Ws(e,t)}get linkCategoryProperty(){return this.qa}set linkCategoryProperty(t){const e=this.qa;e!==t&&(this.Pn(t,Xe,"linkCategoryProperty"),this.qa=t,this.t("linkCategoryProperty",e,t))}getCategoryForLinkData(t){if(null===t)return"";const i=this.qa;if(""===i)return"";const n=this.yt(t,i);return void 0===n?"":"string"==typeof n?n:void e.o("getCategoryForLinkData found a non-string category for "+t+": "+n)}getLinkCategoryForData(t){return this.getCategoryForLinkData(t)}setCategoryForLinkData(t,i){if(e.s(i,"string",Xe,"setCategoryForLinkData:cat"),null===t)return;const n=this.qa;if(""===n)return;if(!this.containsLinkData(t))return void this.Z(t,n,i);let s=this.yt(t,n);void 0===s&&(s=""),s!==i&&(this.Z(t,n,i),this.vt("linkCategory",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}setLinkCategoryForData(t,e){this.setCategoryForLinkData(t,e)}sg(t,e){super.sg(t,e),this.setGroupKeyForNodeData(e,this.getGroupKeyForNodeData(t))}hD(t,e){this.setCategoryForLinkData(e,this.getCategoryForLinkData(t)),this.setFromKeyForLinkData(e,this.getFromKeyForLinkData(t)),this.setToKeyForLinkData(e,this.getToKeyForLinkData(t)),this.setLabelKeysForLinkData(e,this.getLabelKeysForLinkData(t)),this.setFromPortIdForLinkData(e,this.getFromPortIdForLinkData(t)),this.setToPortIdForLinkData(e,this.getToPortIdForLinkData(t))}get type(){return"GraphLinksModel"}mm(){return!0}Ra(){return!0}Vw(){return!0}jc(){return!0}static EmptyArray=(()=>Object.freeze([]))()}Ue.cl(Xe,"GraphLinksModel"),Ue.tD=()=>new Xe,Ue.CM=()=>new Xe;class Ke extends Ue{Mn;lg;Wa;constructor(t,e){if(super(),this.Mn="parent",this.lg=!1,this.Wa="parentLinkCategory",void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Mn=this.Mn,t.lg=this.lg,t.Wa=this.Wa}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" TreeModel";if(t>0){e+="\n node data:";const t=this.nodeDataArray,i=t.length;for(let n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+je.toString(i)}}return e}}eg(){const t=super.eg();let e="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(e+=',\n  "nodeParentKeyProperty": '+this.De(this.nodeParentKeyProperty)),t+e}Ay(t){super.Ay(t),t.nodeParentKeyProperty&&(this.nodeParentKeyProperty=t.nodeParentKeyProperty)}Ty(t){void 0!==t.nodeParentKeyProperty&&t.nodeParentKeyProperty!==this.nodeParentKeyProperty&&e.o("applyIncrementalJson cannot change Model properties"),super.Ty(t)}maybeEnsureLinkReference(t){return t}get nodeParentKeyProperty(){return this.Mn}set nodeParentKeyProperty(t){const e=this.Mn;e!==t&&(this.Pn(t,Ke,"nodeParentKeyProperty"),this.Mn=t,this.t("nodeParentKeyProperty",e,t))}get copiesParentKeyOfNodeData(){return this.lg}set copiesParentKeyOfNodeData(t){this.lg!==t&&(e.s(t,"boolean",Ke,"copiesParentKeyOfNodeData"),this.lg=t)}getParentKeyForNodeData(t){if(null===t)return;const i=this.Mn;if(""===i)return;const n=this.yt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("ParentKey value for node data "+t+" is not a number or a string: "+n)}}setParentKeyForNodeData(t,i){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.Zi(i,"number or string",Ke,"setParentKeyForNodeData:key"),null===t)return;const n=this.Mn;if(""===n)return;if(i=this.maybeEnsureLinkReference(i),!this.containsNodeData(t))return void this.Z(t,n,i);const s=this.yt(t,n);s!==i&&(this.Ws(s,t),this.Z(t,n,i),null===this.findNodeDataForKey(i)&&this.Js(i,t),this.vt("nodeParentKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}get parentLinkCategoryProperty(){return this.Wa}set parentLinkCategoryProperty(t){const e=this.Wa;e!==t&&(this.Pn(t,Ke,"parentLinkCategoryProperty"),this.Wa=t,this.t("parentLinkCategoryProperty",e,t))}get linkCategoryProperty(){return this.parentLinkCategoryProperty}set linkCategoryProperty(t){this.parentLinkCategoryProperty=t}getParentLinkCategoryForNodeData(t){if(null===t)return"";const i=this.Wa;if(""===i)return"";const n=this.yt(t,i);return void 0===n?"":"string"==typeof n?n:void e.o("getParentLinkCategoryForNodeData found a non-string category for "+t+": "+n)}getLinkCategoryForData(t){return this.getParentLinkCategoryForNodeData(t)}setParentLinkCategoryForNodeData(t,i){if(e.s(i,"string",Ke,"setParentLinkCategoryForNodeData:cat"),null===t)return;const n=this.Wa;if(""===n)return;if(!this.containsNodeData(t))return void this.Z(t,n,i);let s=this.yt(t,n);void 0===s&&(s=""),s!==i&&(this.Z(t,n,i),this.vt("parentLinkCategory",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}setLinkCategoryForData(t,e){this.setParentLinkCategoryForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesParentKeyOfNodeData&&""!==this.Mn&&void 0!==this.yt(e,this.Mn)&&this.Z(e,this.Mn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeParentKeyProperty)return void this.setParentKeyForNodeData(t,i);if(e===this.parentLinkCategoryProperty)return void this.setParentLinkCategoryForNodeData(t,i)}const n=this.yt(t,e);n!==i&&(this.Z(t,e,i),this.raiseDataChanged(t,e,n,i))}Dy(t,e){super.Dy(t,e);const i=this.mi.iterator;for(;i.next();){const n=i.value;this.GN(n,t,e)}}GN(t,e,i){if(this.getParentKeyForNodeData(t)===e){const n=this.Mn;this.Z(t,n,i),this.vt("nodeParentKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}ng(t){super.ng(t);const i=this.getKeyForNodeData(t),n=this.My(i);if(null!==n){const t=e.et(),s=n.iterator;for(;s.next();){const e=s.value;if(this.containsNodeData(e)&&this.getParentKeyForNodeData(e)===i){const n=this.Mn;this.vt("nodeParentKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}}for(let e=0;e<t.length;e++)this.Ws(i,t[e]);e.J(t)}}og(t){super.og(t);let e=this.getParentKeyForNodeData(t);e=this.maybeEnsureLinkReference(e),null===this.findNodeDataForKey(e)&&this.Js(e,t)}Fy(t){super.Fy(t);const e=this.getParentKeyForNodeData(t);this.Ws(e,t)}sg(t,e){super.sg(t,e),this.setParentLinkCategoryForNodeData(e,this.getParentLinkCategoryForNodeData(t)),this.setParentKeyForNodeData(e,this.getParentKeyForNodeData(t))}get type(){return"TreeModel"}pm(){return!0}Vw(){return!0}}Ue.cl(Ke,"TreeModel");var Ge=(t=>(t[t.ConstantSpacing=0]="ConstantSpacing",t[t.ConstantDistance=1]="ConstantDistance",t[t.ConstantAngle=2]="ConstantAngle",t[t.Packed=3]="Packed",t))(Ge||{}),Ye=(t=>(t[t.Clockwise=10]="Clockwise",t[t.Counterclockwise=11]="Counterclockwise",t[t.BidirectionalLeft=12]="BidirectionalLeft",t[t.BidirectionalRight=13]="BidirectionalRight",t))(Ye||{}),qe=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t[t.Optimized=24]="Optimized",t))(qe||{}),He=(t=>(t[t.Pythagorean=30]="Pythagorean",t[t.Circular=31]="Circular",t))(He||{});class _e extends Le{le;If;K1;hg;G1;Dh;HN;jN;qN;Ss;Ry;vy;Ja;Oy;aD;ag;cg;fg;Ef;Xi;b;pe;ye;kn;ug;constructor(t){super(),this.le=0,this.If=0,this.K1=0,this.hg=360,this.G1=0,this.Dh=0,this.HN=new y,this.jN=30,this.qN=0,this.Ss=0,this.Ry=0,this.vy=new We,this.Ja=0,this.Oy=0,this.aD=600,this.ag=NaN,this.cg=1,this.fg=0,this.Ef=360,this.Xi=0,this.b=10,this.pe=24,this.ye=De.standardComparer,this.kn=6,this.ug=30,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.ag=this.ag,t.cg=this.cg,t.fg=this.fg,t.Ef=this.Ef,t.Xi=this.Xi,t.b=this.b,t.pe=this.pe,t.ye=this.ye,t.kn=this.kn,t.ug=this.ug}oi(t){t in qe?this.sorting=t:t in Ye?this.direction=t:t in Ge?this.arrangement=t:t in He?this.nodeDiameterFormula=t:super.oi(t)}createNetwork(){return new $e(this)}QO(t,e,i){t=this._O(t);let n=this.G1,s=this.jN,o=this.le,r=this.If,a=this.K1,h=this.hg,u=this.Dh,c=this.qN,d=this.Ss,f=this.Ry;if(n=this.arrangement,s=this.nodeDiameterFormula,o=this.radius,(!isFinite(o)||o<=0)&&(o=NaN),r=this.aspectRatio,(!isFinite(r)||r<=0)&&(r=1),a=this.startAngle,isFinite(a)||(a=0),h=this.sweepAngle,(!isFinite(h)||h>360||h<1)&&(h=360),u=this.spacing,isFinite(u)||(u=NaN),3===n&&31===s?n=0:3===n&&31!==s&&(s=31,n=this.arrangement),(12===this.direction||13===this.direction)&&24!==this.sorting){for(let n=0;!(n>=t.length||(e.add(t.elt(n)),n+1>=t.length));n+=2)i.add(t.elt(n+1));12===this.direction?(3===this.arrangement&&e.reverse(),(t=new l).addAll(e),t.addAll(i)):(3===this.arrangement&&i.reverse(),(t=new l).addAll(i),t.addAll(e))}const g=t.length;c=0;let p=0;for(let l=0;l<t.length;l++){const e=a+h*p*(10===this.direction?1:-1)/g;let i=t.elt(l).diameter;isNaN(i)&&(i=t.elt(l).Fh(e)),h<360&&(0===l||l===t.length-1)&&(i/=2),c+=i,p++}if(isNaN(o)||3===n){if(isNaN(u)&&(u=6),0!==n&&3!==n){let e=-1/0;for(let i=0;i<g;i++){const n=t.elt(i),s=t.elt(i===g-1?0:i+1);isNaN(n.diameter)&&n.Fh(0),isNaN(s.diameter)&&s.Fh(0),e=Math.max(e,(n.diameter+s.diameter)/2)}if(f=e+u,2===n){const t=(e+u)/(2*Math.PI/g);r>1?(o=t,d=o*r):(d=t,o=d)}else o=this.H1(f*(h>=360?g:g-1),r,a*Math.PI/180,h*Math.PI/180)}else o=this.H1(c+(h>=360?g:g-1)*(3!==n?u:1.6*u),r,a*Math.PI/180,h*Math.PI/180);d=o*r}else{d=o*r;const e=this.WN(o,d,a*Math.PI/180,h*Math.PI/180);if(isNaN(u))0===n&&(u=(e-c)/(h>=360?g:g-1));else if(0===n){const t=(e-c)/(h>=360?g:g-1);t<u?(o=this.H1(c+u*(h>=360?g:g-1),r,a*Math.PI/180,h*Math.PI/180),d=o*r):u=t}else{let i=-1/0;for(let e=0;e<g;e++){const n=t.elt(e),s=t.elt(e===g-1?0:e+1);isNaN(n.diameter)&&n.Fh(0),isNaN(s.diameter)&&s.Fh(0),i=Math.max(i,(n.diameter+s.diameter)/2)}const n=i+u,s=this.H1(n*(h>=360?g:g-1),r,a*Math.PI/180,h*Math.PI/180);s>o?(o=s,d=o*r,f=n):f=e/(h>=360?g:g-1)}}return this.G1=n,this.jN=s,this.le=o,this.If=r,this.K1=a,this.hg=h,this.Dh=u,this.qN=c,this.Ss=d,this.Ry=f,t}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.network.vertexes;if(e.count<=1){if(1===e.count){const t=e.first();t.centerX=0,t.centerY=0}return this.updateParts(),this.network=null,void(this.isValidLayout=!0)}let i=new l;i.addAll(e.iterator);const n=new l,s=new l;i=this.QO(i,n,s);const o=this.G1,r=this.le,a=this.K1,h=this.hg,u=this.Dh,c=this.Ss,d=this.Ry;if(12!==this.direction&&13!==this.direction||3!==o)if(12===this.direction||13===this.direction){let t=0;switch(o){case 1:t=180*this.j1(r,c,a,d)/Math.PI;break;case 0:{let e=0,i=0;const o=n.first();null!==o&&(e=o.Fh(Math.PI/2));const l=s.first();null!==l&&(i=l.Fh(Math.PI/2)),t=180*this.j1(r,c,a,u+(e+i)/2)/Math.PI;break}case 2:t=h/i.length}if(12===this.direction){switch(o){case 1:this.Iy(n,h/2,a,11);break;case 0:this.Ey(n,h/2,a,11);break;case 2:this.By(n,h/2,a,11)}switch(o){case 1:this.Iy(s,h/2,a+t,10);break;case 0:this.Ey(s,h/2,a+t,10);break;case 2:this.By(s,h/2,a+t,10)}}else{switch(o){case 1:this.Iy(s,h/2,a,11);break;case 0:this.Ey(s,h/2,a,11);break;case 2:this.By(s,h/2,a,11)}switch(o){case 1:this.Iy(n,h/2,a+t,10);break;case 0:this.Ey(n,h/2,a+t,10);break;case 2:this.By(n,h/2,a+t,10)}}}else switch(o){case 1:this.Iy(i,h,a,this.direction);break;case 0:this.Ey(i,h,a,this.direction);break;case 2:this.By(i,h,a,this.direction);break;case 3:this.cD(i,h,a,this.direction)}else this.cD(i,h,a-h/2,10);this.updateParts(),this.network=null,this.isValidLayout=!0}By(t,e,i,n){const s=this.hg,o=this.le,r=this.Ss,a=i*Math.PI/180,l=e*Math.PI/180,h=t.length;for(let u=0;u<h;u++){const e=a+(10===n?u*l/(s>=360?h:h-1):-u*l/h),i=t.elt(u),c=o*Math.tan(e)/r,d=Math.sqrt((o*o+r*r*c*c)/(1+c*c));i.centerX=d*Math.cos(e),i.centerY=d*Math.sin(e),i.actualAngle=180*e/Math.PI}}Ey(t,e,i,n){const s=this.le,o=this.Ss,r=this.Dh;let a=i*Math.PI/180;const l=t.length;for(let h=0;h<l;h++){const e=t.elt(h),i=t.elt(h===l-1?0:h+1),u=s*Math.cos(a),c=o*Math.sin(a);e.centerX=u,e.centerY=c,e.actualAngle=180*a/Math.PI,isNaN(e.diameter)&&e.Fh(0),isNaN(i.diameter)&&i.Fh(0);const d=(e.diameter+i.diameter)/2,f=this.j1(s,o,10===n?a:-a,d+r);a+=10===n?f:-f}}Iy(t,e,i,n){const s=this.le,o=this.Ss,r=this.Ry;let a=i*Math.PI/180;const l=t.length;for(let h=0;h<l;h++){const e=t.elt(h);e.centerX=s*Math.cos(a),e.centerY=o*Math.sin(a),e.actualAngle=180*a/Math.PI;const i=this.j1(s,o,10===n?a:-a,r);a+=10===n?i:-i}}cD(t,e,i,n){let s=this.Oy;const o=this.hg;if(this.Ja=0,this.vy=new We,e<360){for(s=i+(10===n?o:-o);s<0;)s+=360;s%=360,s>180&&(s-=360),s*=Math.PI/180,this.Oy=s,this.fD(t,e,i,n)}else this.uD(t,e,i,n);this.vy.commit(t)}uD(t,e,i,n){const s=this.le,o=this.Ss,r=this.Dh,a=this.If;let l=s*Math.cos(i*Math.PI/180),h=o*Math.sin(i*Math.PI/180);const u=t.toArray();if(3===u.length)return u[0].centerX=s,u[0].centerY=0,u[1].centerX=u[0].centerX-u[0].width/2-u[1].width/2-r,u[1].y=u[0].y,u[2].centerX=(u[0].centerX+u[1].centerX)/2,void(u[2].y=u[0].y-u[2].height-r);if(4===u.length)return u[0].centerX=s,u[0].centerY=0,u[2].centerX=-u[0].centerX,u[2].centerY=u[0].centerY,u[1].centerX=0,u[1].y=Math.min(u[0].y,u[2].y)-u[1].height-r,u[3].centerX=0,void(u[3].y=Math.max(u[0].y+u[0].height+r,u[2].y+u[2].height+r));const c=y.l();for(let y=0;y<u.length&&(u[y].centerX=l,u[y].centerY=h,!(y>=u.length-1));y++)this.dD(l,h,u,y,n,c)||this.gD(l,h,u,y,n,c),l=c.x,h=c.y;if(y.e(c),this.Ja++,this.Ja>23)return;const d=u[0].centerX,f=u[0].centerY,g=u[u.length-1].centerX,p=u[u.length-1].centerY;let m=Math.abs(d-g)-((u[0].width+u[u.length-1].width)/2+r);const x=Math.abs(f-p)-((u[0].height+u[u.length-1].height)/2+r);let v=0;if(Math.abs(x)<1){const t=Math.abs(d-g),e=(u[0].width+u[u.length-1].width)/2;t<e&&(v=0),m=t-e}else v=x>0?x:Math.abs(m)<1?0:m;let b=!1;b=Math.abs(g)>Math.abs(p)?g>0!=f>p:p>0!=d<g,b=10===n?b:!b,b&&(v=-Math.abs(v),v=Math.min(v,-u[u.length-1].width),v=Math.min(v,-u[u.length-1].height)),this.vy.tI(v,u),Math.abs(v)>1&&(this.Ja<8?this.le-=v/(2*Math.PI):u.length<5&&v>10?this.le/=2:this.le-=v>0?1.7:-2.3,this.Ss=this.le*a,this.uD(t,e,i,n))}fD(t,e,i,n){const s=this.le,o=this.Ss,r=this.If;let a=s*Math.cos(i*Math.PI/180),l=o*Math.sin(i*Math.PI/180);const h=y.l(),u=t.toArray();for(let g=0;g<u.length&&(u[g].centerX=a,u[g].centerY=l,!(g>=u.length-1));g++)this.dD(a,l,u,g,n,h)||this.gD(a,l,u,g,n,h),a=h.x,l=h.y;if(y.e(h),this.Ja++,this.Ja>23)return;const c=Math.atan2(l,a);let d=10===n?this.Oy-c:c-this.Oy;d=Math.abs(d)<Math.abs(d-2*Math.PI)?d:d-2*Math.PI;const f=d*(s+o)/2;this.vy.iI(f,u),Math.abs(f)>1&&(this.Ja<8?this.le-=f/(2*Math.PI):this.le-=f>0?1.7:-2.3,this.Ss=this.le*r,this.fD(t,e,i,n))}dD(t,e,i,n,s,o){const r=this.Dh,a=this.le,l=this.Ss;let h=0,u=0;const c=(i[n].width+i[n+1].width)/2+r;let d=!1;if(e>=0!=(10===s)){if(h=t+c,h>a){if(h=t-c,h<-a)return o.x=h,o.y=u,!1;d=!0}}else if(h=t-c,h<-a){if(h=t+c,h>a)return o.x=h,o.y=u,!1;d=!0}return u=Math.sqrt(1-Math.min(1,h*h/(a*a)))*l,e<0!==d&&(u=-u),Math.abs(e-u)>(i[n].height+i[n+1].height)/2?(o.x=h,o.y=u,!1):(o.x=h,o.y=u,!0)}gD(t,e,i,n,s,o){const r=this.Dh,a=this.le,l=this.Ss;let h=0,u=0;const c=(i[n].height+i[n+1].height)/2+r;let d=!1;if(t>=0!=(10===s)){if(u=e-c,u<-l){if(u=e+c,u>l)return o.x=h,o.y=u,!1;d=!0}}else if(u=e+c,u>l){if(u=e-c,u<-l)return o.x=h,o.y=u,!1;d=!0}return h=Math.sqrt(1-Math.min(1,u*u/(l*l)))*a,t<0!==d&&(h=-h),Math.abs(t-h)>(i[n].width+i[n+1].width)/2?(o.x=h,o.y=u,!1):(o.x=h,o.y=u,!0)}commitLayout(){this.commitNodes(),this.isRouting&&this.commitLinks()}commitNodes(){const t=null!==this.group&&this.group.hasPlaceholder(),e=t?this.group.location.copy():null;let i=this.actualCenter;t?i=new y(0,0):(i.x=this.arrangementOrigin.x+this.le,i.y=this.arrangementOrigin.y+this.Ss);const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;t.x+=i.x,t.y+=i.y,t.commit()}if(t){this.group.ensureBounds();const t=this.group.position.copy(),i=this.group.location.copy(),n=e.subtract(i.subtract(t));this.group.move(n),this.HN=n.subtract(t)}}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}WN(t,e,i,n){const s=this.aD;if(Math.abs(this.If-1)<.001)return void 0!==i&&void 0!==n?n*t:2*Math.PI*t;const o=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let r=0,a=0;a=void 0!==i&&void 0!==n?n/(s+1):Math.PI/(2*(s+1));let l=0;for(let h=0;h<=s;h++){l=void 0!==i&&void 0!==n?i+h*n/s:h*Math.PI/(2*s);const t=Math.sin(l);r+=Math.sqrt(1-o*o*t*t)*a}return void 0!==i&&void 0!==n?(t>e?t:e)*r:4*(t>e?t:e)*r}H1(t,e,i,n){let s=0;return s=void 0!==i&&void 0!==n?this.WN(1,e,i,n):this.WN(1,e),t/s}j1(t,e,i,n){if(Math.abs(this.If-1)<.001)return n/t;const s=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let o=0;const r=2*Math.PI/(700*this.network.vertexes.count);t>e&&(i+=Math.PI/2);for(let a=0;;a++){const l=i+a*r,h=Math.sin(l);if(o+=(t>e?t:e)*Math.sqrt(1-s*s*h*h)*r,o>=n)return a*r}}_O(t){switch(this.sorting){case 20:break;case 21:t.reverse();break;case 22:t.sort(this.comparer);break;case 23:t.sort(this.comparer),t.reverse();break;case 24:return this.eI(this.sI(t));default:e.o("Invalid sorting type.")}return t}sI(t){const e=[];for(let n=0;n<t.length;n++)e.push(0);const i=new l;for(let n=0;n<t.length;n++){let s=-1,o=-1;if(0===n)for(let e=0;e<t.length;e++){const i=t.elt(e).edgesCount;i>s&&(s=i,o=e)}else for(let i=0;i<t.length;i++){const t=e[i];t>s&&(s=t,o=i)}i.add(t.elt(o)),e[o]=-1;const r=t.elt(o);let a=0;const l=r.sourceEdges;for(;l.next();){const i=l.value.fromVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}const h=r.destinationEdges;for(;h.next();){const i=h.value.toVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}}return i}eI(t){const e=[];for(let l=0;l<t.length;l++){const i=t.elt(l);e[l]=[];let n=0;const s=i.destinationEdges;for(;s.next();){const i=s.value.toVertex;n=t.indexOf(i),n!==l&&e[l].indexOf(n)<0&&e[l].push(n)}const o=i.sourceEdges;for(;o.next();){const i=o.value.fromVertex;n=t.indexOf(i),n!==l&&e[l].indexOf(n)<0&&e[l].push(n)}}const i=[];for(let l=0;l<e.length;l++)i[l]=0;const n=[],s=[],o=[],r=[],a=new l;let h=0;for(let l=0;l<e.length;l++){const u=e[l].length;if(1===u){r.push(l);continue}if(0===u){a.add(t.elt(l));continue}if(0===h){n.push(l),h++;continue}let c=1/0,d=1/0,f=-1;const g=[];for(let t=0;t<n.length;t++)e[n[t]].indexOf(n[t===n.length-1?0:t+1])<0&&g.push(t===n.length-1?0:t+1);if(0===g.length)for(let t=0;t<n.length;t++)g.push(t);for(let t=0;t<g.length;t++){const r=g[t],a=this.nI(e[l],s,o,i,r,n);let h=0;for(let t=0;t<e[l].length;t++){const i=e[l][t],s=n.indexOf(i);if(s>=0){const t=Math.abs(r-(s>=r?s+1:s));h+=t<n.length+1-t?t:n.length+1-t}}for(let t=0;t<s.length;t++){let e=i[s[t]],a=i[o[t]];if(e>=r&&e++,a>=r&&a++,e>a){const t=a;a=e,e=t}a-e<(n.length+2)/2==(e<r&&r<=a)&&h++}(a<c||a===c&&h<d)&&(c=a,d=h,f=r)}n.splice(f,0,l);for(let t=0;t<n.length;t++)i[n[t]]=t;for(let t=0;t<e[l].length;t++){const i=e[l][t];n.indexOf(i)>=0&&(s.push(l),o.push(i))}h++}let u=!1;const c=n.length;for(;;){u=!0;for(let t=0;t<r.length;t++){const i=r[t],s=e[i][0],o=n.indexOf(s);if(o>=0){let a=0;for(let t=0;t<e[s].length;t++){const i=e[s][t],r=n.indexOf(i);if(r<0||r===o)continue;const l=r>o?r-o:o-r;a+=r<o!=l>c-l?1:-1}n.splice(a<0?o:o+1,0,i),r.splice(t,1),t--}else u=!1}if(u)break;n.push(r[0]),r.splice(0,1)}for(let l=0;l<n.length;l++){const e=n[l];a.add(t.elt(e))}return a}nI(t,e,i,n,s,o){let r=0;for(let a=0;a<e.length;a++){const l=e[a],h=i[a],u=n[l],c=n[h];let d=0,f=0;if(u<c?(d=u,f=c):(d=c,f=u),d<s&&s<=f)for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||d<n[i]&&n[i]<f||d===n[i]||f===n[i]||r++}else for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||!(d<n[i]&&n[i]<f)||d===n[i]||f===n[i]||r++}}return r}get radius(){return this.ag}set radius(t){this.ag!==t&&(e.s(t,"number",_e,"radius"),(t>0||isNaN(t))&&(this.ag=t,this.invalidateLayout()))}get aspectRatio(){return this.cg}set aspectRatio(t){this.cg!==t&&(e.s(t,"number",_e,"aspectRatio"),t>0&&(this.cg=t,this.invalidateLayout()))}get startAngle(){return this.fg}set startAngle(t){this.fg!==t&&(e.s(t,"number",_e,"startAngle"),this.fg=t,this.invalidateLayout())}get sweepAngle(){return this.Ef}set sweepAngle(t){this.Ef!==t&&(e.s(t,"number",_e,"sweepAngle"),this.Ef=t>0&&t<=360?t:360,this.invalidateLayout())}get arrangement(){return this.Xi}set arrangement(t){this.Xi!==t&&(3===t||0===t||1===t||2===t)&&(this.Xi=t,this.invalidateLayout())}get direction(){return this.b}set direction(t){this.b!==t&&(10===t||11===t||12===t||13===t)&&(this.b=t,this.invalidateLayout())}get sorting(){return this.pe}set sorting(t){this.pe!==t&&(this.pe=t,this.invalidateLayout())}get comparer(){return this.ye}set comparer(t){this.ye!==t&&(e.k(t,_e,"comparer"),this.ye=t,this.invalidateLayout())}get spacing(){return this.kn}set spacing(t){this.kn!==t&&(e.s(t,"number",_e,"spacing"),this.kn=t,this.invalidateLayout())}get nodeDiameterFormula(){return this.ug}set nodeDiameterFormula(t){this.ug!==t&&(30===t||31===t)&&(this.ug=t,this.invalidateLayout())}get actualXRadius(){return this.le}get actualYRadius(){return this.Ss}get actualSpacing(){return this.Dh}get actualCenter(){return this.HN}static ConstantSpacing=0;static ConstantDistance=1;static ConstantAngle=2;static Packed=3;static Clockwise=10;static Counterclockwise=11;static BidirectionalLeft=12;static BidirectionalRight=13;static Forwards=20;static Reverse=21;static Ascending=22;static Descending=23;static Optimized=24;static Pythagorean=30;static Circular=31}class We{Bf;$a;Uf;constructor(){this.Bf=-1/0,this.$a=null,this.Uf=null}tI(t,e){if(t>0&&this.Bf<0||Math.abs(t)<Math.abs(this.Bf)&&!(t<0&&this.Bf>0)){this.Bf=t,this.$a=[],this.Uf=[];for(let t=0;t<e.length;t++)this.$a[t]=e[t].bounds.x,this.Uf[t]=e[t].bounds.y}}iI(t,e){if(Math.abs(t)<Math.abs(this.Bf)){this.Bf=t,this.$a=[],this.Uf=[];for(let t=0;t<e.length;t++)this.$a[t]=e[t].bounds.x,this.Uf[t]=e[t].bounds.y}}commit(t){if(null!==this.$a&&null!==this.Uf)for(let e=0;e<this.$a.length;e++){const i=t.elt(e);i.x=this.$a[e],i.y=this.Uf[e]}}}class $e extends Ae{constructor(t){super(t)}createVertex(){return new Je(this)}createEdge(){return new Ze(this)}}class Je extends De{po;q1;constructor(t){super(t),this.po=NaN,this.q1=NaN}Fh(t){const e=this.network;if(null===e)return NaN;const i=e.layout;if(null===i)return NaN;if(3===i.arrangement){if(31===i.nodeDiameterFormula)return this.po=Math.max(this.width,this.height),this.po;{const e=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t));return 0===e?this.width:0===i?this.height:(this.po=Math.min(this.height/e,this.width/i),this.po)}}return 31===i.nodeDiameterFormula?(this.po=Math.max(this.width,this.height),this.po):(this.po=Math.sqrt(this.width*this.width+this.height*this.height),this.po)}get diameter(){return this.po}set diameter(t){this.po!==t&&(e.s(t,"number",Je,"diameter"),this.po=t)}get actualAngle(){return this.q1}set actualAngle(t){this.q1!==t&&(e.s(t,"number",Je,"actualAngle"),this.q1=t)}}class Ze extends Fe{constructor(t){super(t)}}class Qe extends Le{Uy;Rh;Ms;dg;Nn;Fe;gg;mg;pg;Vf;yg;wg;zf;Xf;Yf;Kf;xg;bg;Gf;Za;constructor(t){super(),this.Uy=0,this.Rh=0,this.Ms=new x(100,100).u(),this.dg=!1,this.Nn=!0,this.Fe=!1,this.gg=100,this.mg=300,this.pg=1,this.Vf=1e3,this.yg=10,this.wg=Math,this.zf=.05,this.Xf=50,this.Yf=150,this.Kf=0,this.xg=10,this.bg=5,this.Gf=NaN,this.Za=10,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ms.a(this.Ms),t.dg=this.dg,t.Nn=this.Nn,t.Fe=this.Fe,t.gg=this.gg,t.mg=this.mg,t.pg=this.pg,t.Vf=this.Vf,t.yg=this.yg,t.wg=this.wg,t.zf=this.zf,t.Xf=this.Xf,t.Yf=this.Yf,t.Kf=this.Kf,t.xg=this.xg,t.bg=this.bg,t.Gf=this.Gf,t.Za=this.Za}createNetwork(){return new ti(this)}doLayout(t){this.network=this.makeNetwork(t);let e=this.network.vertexes.iterator;const i=this.maxIterations;if(this.network.vertexes.count>0){for(this.network.deleteSelfEdges(),e=this.network.vertexes.iterator;e.next();){const t=e.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}const t=this.network.edges.iterator;for(;t.next();){const e=t.value;e.stiffness=this.springStiffness(e),e.length=this.springLength(e)}if(this.JN(),this.Rh=0,this.needsPrelayout()){const t=this.network,e=t.splitIntoSubNetworks(!1);let i=e.iterator;for(;i.next();){const t=i.value;this.doConnectedSubnetLayout(t)}for(i=e.iterator,this.oI(i,t),i=e.iterator;i.next();){const e=i.value,n=e.vertexes.iterator;for(;n.next();){const e=n.value;t.addVertex(e)}const s=e.edges.iterator;for(;s.next();){const e=s.value;t.addEdge(e)}}}else this.mD(this.network,this.maxIterations);this.updateParts()}this.maxIterations=i,this.isValidLayout=!0}needsPrelayout(){if(null===this.network||this.network.vertexes.count<3)return!1;let t=0,e=0;const i=this.network.vertexes.first().bounds,n=this.network.vertexes.iterator;for(;n.next();){const s=n.value,o=s.bounds;if(isNaN(s.x)||isNaN(s.y)||o.intersectsRect(i)&&(t++,t>2))return!0;if(e>10)return!1;e++}return!1}doConnectedSubnetLayout(t){let e=t.vertexes.iterator;for(;e.next();){const t=e.value;t.hierarchicalVertexes.add(t)}let i=t,n=this.Gf;if(isNaN(n)&&(n=t.edges.count/t.vertexes.count),n<t.vertexes.count)for(;i.vertexes.count>Math.max(100,Math.sqrt(n*t.vertexes.count));)i=this.coarsenNetwork(i);let s=0;e=i.vertexes.iterator;let o=this.randomNumberGenerator;for(null===o&&(this.randomNumberGenerator=o=new ni(0));e.next();){e.value.idInCluster=s++;const t=10*(o.random()-.5),i=10*(o.random()-.5);this.isFixed(e.value)||(e.value.x=t,e.value.y=i);const n=e.value.hierarchicalVertexes.iterator;for(;n.next();)this.isFixed(n.value)||(n.value.x=t,n.value.y=i)}const r=this.computePairwiseDistances(i);this.rI(i,r,this.maxPrelayoutIterations,t.vertexes.count),this.mD(t,this.maxIterations)}computePairwiseDistances(t){const e=t.vertexes.count,i=new Array(e);for(let r=0;r<e;r++)i[r]=new Array(e).fill(-1),i[r][r]=0;const n=t.vertexes.iterator;let s=new Map,o=[];for(;n.next();){const t=n.value;for(o=[t],s=new Map,s.set(t.idInCluster,0);o.length>0;){const t=o.shift(),e=t.vertexes.iterator;for(;e.next();){const i=e.value;s.has(i.idInCluster)||(s.set(i.idInCluster,s.get(t.idInCluster)+1),o.push(i))}}for(let n=0;n<e;n++){const e=Math.min(i[t.idInCluster][n],i[n][t.idInCluster]),o=s.get(n);(e<0||o<e)&&(i[t.idInCluster][n]=o,i[n][t.idInCluster]=o)}}return i}coarsenNetwork(t){const e=this.createNetwork(),i=new Map;let n=0,s=t.vertexes.iterator;for(;s.next();)s.value.idInCluster=n++;for(s=t.vertexes.iterator;s.next();){const t=s.value;if(i.has(t.idInCluster))continue;let n=Number.MAX_SAFE_INTEGER,o=null;const r=t.vertexes.iterator;for(;r.next();){const t=r.value;i.has(t.idInCluster)||t.hierarchicalVertexes.length<n&&(n=t.hierarchicalVertexes.length,o=t)}const a=e.createVertex();a.hierarchicalVertexes.addAll(t.hierarchicalVertexes),null!=o&&a.hierarchicalVertexes.addAll(o.hierarchicalVertexes),i.set(t.idInCluster,a),null!=o&&i.set(o.idInCluster,a),e.addVertex(a)}const o=t.edges.iterator;for(;o.next();){const t=o.value,n=i.get(t.fromVertex.idInCluster),s=i.get(t.toVertex.idInCluster);if(n===s)continue;const r=e.createEdge();r.fromVertex=n||null,r.toVertex=s||null,e.addEdge(r)}return e}Nw(t,e){let i=!0;const n=t.vertexes.iterator;for(;n.next();){const t=n.value;i?(i=!1,e.set(t.bounds)):e.unionRect(t.bounds)}return e}oI(t,i){const n=this.arrangementSpacing,s=t.count;let o=!0,r=0,a=0;const l=e.et();for(let e=0;e<s+i.vertexes.count+2;e++)l[e]=null;let h=0;t.reset();const u=v.l();let c;for(;t.next();){const e=t.value;if(this.Nw(e,u),o)o=!1,r=u.x+u.width/2,a=u.y+u.height/2,l[0]=new y(u.x+u.width+n.width,u.y),l[1]=new y(u.x,u.y+u.height+n.height),h=2;else{const t=this.pD(l,h,r,a,u.width,u.height,n),i=l[t],s=new y(i.x+u.width+n.width,i.y),o=new y(i.x,i.y+u.height+n.height);t+1<h&&l.splice(t+1,0,null),l[t]=s,l[t+1]=o,h++;const d=i.x-u.x,f=i.y-u.y;for(c=e.vertexes.iterator;c.next();){const t=c.value;this.isFixed(t)||(t.centerX+=d,t.centerY+=f)}}}for(v.e(u),c=i.vertexes.iterator;c.next();){const t=c.value,e=t.bounds;if(h<2){r=e.x+e.width/2,a=e.y+e.height/2,l[0]=new y(e.x+e.width+n.width,e.y),l[1]=new y(e.x,e.y+e.height+n.height),h=2;continue}const i=this.pD(l,h,r,a,e.width,e.height,n),s=l[i],o=new y(s.x+e.width+n.width,s.y),u=new y(s.x,s.y+e.height+n.height);i+1<h&&l.splice(i+1,0,null),l[i]=o,l[i+1]=u,h++,this.isFixed(t)||(t.centerX=s.x+t.width/2,t.centerY=s.y+t.height/2)}e.J(l)}pD(t,e,i,n,s,o,r){let a=9e19,l=-1;t:for(let h=0;h<e;h++){const u=t[h],c=u.x-i,d=u.y-n,f=c*c+d*d;if(f<a){for(let e=h-1;e>=0;e--)if(t[e].y>u.y&&t[e].x-u.x<s+r.width)continue t;for(let i=h+1;i<e;i++)if(t[i].x>u.x&&t[i].y-u.y<o+r.height)continue t;l=h,a=f}}return l}JN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.node;if(null!==e){const i=e.findNodesConnected();for(;i.next();){const e=i.value;if("Comment"!==e.category||!e.isVisible())continue;let n=this.network.findVertex(e);null===n&&(n=this.network.addNode(e)),n.charge=this.defaultCommentElectricalCharge;let s=null;const o=n.destinationEdges;for(;o.next();){const e=o.value;if(e.toVertex===t){s=e;break}}if(null===s){const e=n.sourceEdges;for(;e.next();){const i=e.value;if(i.fromVertex===t){s=i;break}}}null===s&&(s=this.network.linkVertexes(t,n,null)),s.length=this.defaultCommentSpringLength}}}$N(t,e){const i=t.bounds,n=i.x,s=i.y,o=i.width,r=i.height,a=e.bounds,l=a.x,h=a.y,u=a.width,c=a.height;if(n+o<l){if(s>h+c){const t=n+o-l,e=s-h-c;return S.bw(t*t+e*e)}if(s+r<h){const t=n+o-l,e=s+r-h;return S.bw(t*t+e*e)}return l-(n+o)}if(n>l+u){if(s>h+c){const t=n-l-u,e=s-h-c;return S.bw(t*t+e*e)}if(s+r<h){const t=n-l-u,e=s+r-h;return S.bw(t*t+e*e)}return n-(l+u)}return s>h+c?s-(h+c):s+r<h?h-(s+r):.1}mD(t,e){const i=this.Rh+e;for(;this.Rh<i&&(this.Rh++,this.lI(t)););}lI(t){const e=t.vertexes.toArray();if(e.length<=0)return!1;const i=e[0];i.forceX=0,i.forceY=0;let n=i.centerX,s=n,o=i.centerY,r=o;for(let g=1;g<e.length;g++){const t=e[g];t.forceX=0,t.forceY=0;const i=t.centerX,a=t.centerY;n=Math.min(n,i),s=Math.max(s,i),o=Math.min(o,a),r=Math.max(r,a)}const a=s-n>r-o;a?e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerX-e.centerX)):e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerY-e.centerY));const l=this.Vf;let h=0,u=0,c=0;for(let g=0;g<e.length;g++){const t=e[g],i=t.bounds,n=t.focus,s=i.x+n.x,o=i.y+n.y;u=t.charge*this.electricalFieldX(s,o),c=t.charge*this.electricalFieldY(s,o),u+=t.mass*this.gravitationalFieldX(s,o),c+=t.mass*this.gravitationalFieldY(s,o),t.forceX+=u,t.forceY+=c;for(let r=g+1;r<e.length;r++){const i=e[r];if(!this.shouldInteract(t,i)||r===g)continue;const n=i.bounds,d=i.focus,f=n.x+d.x,p=n.y+d.y;if(s-f>l||f-s>l){if(a)break;continue}if(o-p>l||p-o>l){if(!a)break;continue}const m=this.$N(t,i),y=2*t.charge,x=2*i.charge;if(m>1)h=y*x/(m*m),u=h*(s-f)/m,c=h*(o-p)/m;else{let e=this.randomNumberGenerator;null===e&&(this.randomNumberGenerator=e=new ni(0));const n=e.random(),r=e.random();if(s>f)u=Math.abs(i.bounds.right-t.bounds.x),u=y*x*(1+u)*n;else if(s<f)u=Math.abs(i.bounds.x-t.bounds.right),u=-y*x*(1+u)*n;else{const e=Math.max(i.width,t.width);u=y*x*((1+e)*n-e/2)}if(o>p)c=Math.abs(i.bounds.bottom-t.bounds.y),c=y*x*(1+c)*r;else if(s<f)c=Math.abs(i.bounds.y-t.bounds.bottom),c=-y*x*(1+c)*r;else{const e=Math.max(i.height,t.height);c=y*x*((1+e)*r-e/2)}}t.forceX+=u,t.forceY+=c,i.forceX-=u,i.forceY-=c}}const d=t.edges.iterator;for(;d.next();){const t=d.value,e=t.fromVertex,i=t.toVertex,n=e.bounds,s=e.focus,o=n.x+s.x,r=n.y+s.y,a=i.bounds,l=i.focus,f=a.x+l.x,g=a.y+l.y,p=this.$N(e,i);p>1&&(h=.1*t.stiffness*(p-t.length),u=.5*h*(e.width+i.height)*(o-f)/p,c=.5*h*(e.width+i.height)*(r-g)/p),e.forceX-=u,e.forceY-=c,i.forceX+=u,i.forceY+=c}let f=0;for(let g=0;g<e.length;g++){const t=e[g];this.isFixed(t)?this.moveFixedVertex(t):f=Math.max(f,this.moveVertex(t)||0)}return f>this.epsilonDistance*this.epsilonDistance}rI(t,e,i,n){const s=this.Rh+i,o=Math.sqrt(n);this.Uy=this.Za*t.vertexes.count;const r=t.vertexes.toArray();let a=0,l=0,h=0;for(;this.Rh<s;){this.Rh++,l=a,a=0;for(let t=0;t<r.length;t++){r[t].forceX=0,r[t].forceY=0;for(let n=0;n<r.length;n++){if(t===n)continue;const i=this.$N(r[t],r[n]),s=e[r[t].idInCluster][r[n].idInCluster],a=(i-this.Za*o*s)/i;r[t].forceX+=a*(r[n].x-r[t].x),r[t].forceY+=a*(r[n].y-r[t].y)}const i=Math.sqrt(r[t].forceX*r[t].forceX+r[t].forceY*r[t].forceY);if(i>0){r[t].forceX=this.Uy*r[t].forceX/i,r[t].forceY=this.Uy*r[t].forceY/i,this.isFixed(r[t])||(r[t].x+=r[t].forceX,r[t].y+=r[t].forceY);const e=r[t].hierarchicalVertexes.iterator;for(;e.next();){const i=e.value;this.isFixed(i)||(i.centerX+=r[t].forceX,i.centerY+=r[t].forceY)}}a+=i*i}if(a>=l){if(h++,h>=5)break}else h=0;this.Uy*=.95}}moveVertex(t){let e=t.forceX,i=t.forceY;const n=this.moveLimit;return e<-n?e=-n:e>n&&(e=n),i<-n?i=-n:i>n&&(i=n),t.centerX+=e,t.centerY+=i,e*e+i*i}shouldInteract(t,e){return!0}moveFixedVertex(t){}commitLayout(){this.Vy(),this.commitNodes(),this.isRouting&&this.commitLinks()}Vy(){if(!this.setsPortSpots)return;const t=this.network.edges.iterator;for(;t.next();){const e=t.value.link;null!==e&&(e.fromSpot=w.Default,e.toSpot=w.Default)}}commitNodes(){let t=0,e=0;if(this.arrangesToOrigin){const i=v.l();this.Nw(this.network,i);const n=this.arrangementOrigin;t=n.x-i.x,e=n.y-i.y,v.e(i)}const i=v.l(),n=this.network.vertexes.iterator;for(;n.next();){const s=n.value;(0!==t||0!==e)&&(i.a(s.bounds),i.x+=t,i.y+=e,s.bounds=i),s.commit()}v.e(i)}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}springStiffness(t){const e=t.stiffness;return isNaN(e)?this.zf:e}springLength(t){const e=t.length;return isNaN(e)?this.Xf:e}electricalCharge(t){const e=t.charge;return isNaN(e)?this.Yf:e}electricalFieldX(t,e){return 0}electricalFieldY(t,e){return 0}gravitationalMass(t){const e=t.mass;return isNaN(e)?this.Kf:e}gravitationalFieldX(t,e){return 0}gravitationalFieldY(t,e){return 0}isFixed(t){return t.isFixed}get currentIteration(){return this.Rh}get arrangementSpacing(){return this.Ms}set arrangementSpacing(t){this.Ms.equals(t)||(this.Ms.a(t),this.invalidateLayout())}get arrangesToOrigin(){return this.dg}set arrangesToOrigin(t){this.dg!==t&&(e.s(t,"boolean",Qe,"arrangesToOrigin"),this.dg=t,this.invalidateLayout())}get setsPortSpots(){return this.Nn}set setsPortSpots(t){this.Nn!==t&&(e.s(t,"boolean",Qe,"setsPortSpots"),this.Nn=t,this.invalidateLayout())}get comments(){return this.Fe}set comments(t){this.Fe!==t&&(e.s(t,"boolean",Qe,"comments"),this.Fe=t,this.invalidateLayout())}get maxPrelayoutIterations(){return this.gg}set maxPrelayoutIterations(t){this.gg!==t&&(e.s(t,"number",Qe,"maxPrelayoutIterations"),t>=0&&(this.gg=t,this.invalidateLayout()))}get maxIterations(){return this.mg}set maxIterations(t){this.mg!==t&&(e.s(t,"number",Qe,"maxIterations"),t>=0&&(this.mg=t,this.invalidateLayout()))}get epsilonDistance(){return this.pg}set epsilonDistance(t){this.pg!==t&&(e.s(t,"number",Qe,"epsilonDistance"),t>0&&(this.pg=t,this.invalidateLayout()))}get infinityDistance(){return this.Vf}set infinityDistance(t){this.Vf!==t&&(e.s(t,"number",Qe,"infinityDistance"),t>1&&(this.Vf=t,this.invalidateLayout()))}get moveLimit(){return this.yg}set moveLimit(t){this.yg!==t&&(e.s(t,"number",Qe,"moveLimit"),this.yg=t,this.invalidateLayout())}get randomNumberGenerator(){return this.wg}set randomNumberGenerator(t){this.wg!==t&&(null!==t&&!e.it(t.random)&&e.o('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+t),this.wg=t)}get defaultSpringStiffness(){return this.zf}set defaultSpringStiffness(t){this.zf!==t&&(e.s(t,"number",Qe,"defaultSpringStiffness"),this.zf=t,this.invalidateLayout())}get defaultSpringLength(){return this.Xf}set defaultSpringLength(t){this.Xf!==t&&(e.s(t,"number",Qe,"defaultSpringLength"),this.Xf=t,this.invalidateLayout())}get defaultElectricalCharge(){return this.Yf}set defaultElectricalCharge(t){this.Yf!==t&&(e.s(t,"number",Qe,"defaultElectricalCharge"),this.Yf=t,this.invalidateLayout())}get defaultGravitationalMass(){return this.Kf}set defaultGravitationalMass(t){this.Kf!==t&&(e.s(t,"number",Qe,"defaultGravitationalMass"),this.Kf=t,this.invalidateLayout())}get defaultCommentSpringLength(){return this.xg}set defaultCommentSpringLength(t){this.xg!==t&&(e.s(t,"number",Qe,"defaultCommentSpringLength"),this.xg=t,this.invalidateLayout())}get defaultCommentElectricalCharge(){return this.bg}set defaultCommentElectricalCharge(t){this.bg!==t&&(e.s(t,"number",Qe,"defaultCommentElectricalCharge"),this.bg=t,this.invalidateLayout())}get prelayoutQuality(){return this.Gf}set prelayoutQuality(t){this.Gf!==t&&(e.s(t,"number",Qe,"prelayoutQuality"),this.Gf=t,this.invalidateLayout())}get prelayoutSpread(){return this.Za}set prelayoutSpread(t){this.Za!==t&&(e.s(t,"number",Qe,"prelayoutSpread"),this.Za=t,this.invalidateLayout())}}class ti extends Ae{constructor(t){super(t)}createVertex(){return new ei(this)}createEdge(){return new ii(this)}}class ei extends De{W1;J1;$1;Z1;Q1;hierarchicalVertexes;idInCluster;constructor(t){super(t),this.W1=!1,this.J1=NaN,this.$1=NaN,this.Z1=0,this.Q1=0,this.hierarchicalVertexes=new l,this.idInCluster=-1}get isFixed(){return this.W1}set isFixed(t){this.W1!==t&&(e.s(t,"boolean",ei,"isFixed"),this.W1=t)}get charge(){return this.J1}set charge(t){this.J1!==t&&(e.s(t,"number",ei,"charge"),this.J1=t)}get mass(){return this.$1}set mass(t){this.$1!==t&&(e.s(t,"number",ei,"mass"),this.$1=t)}get forceX(){return this.Z1}set forceX(t){this.Z1!==t&&(e.s(t,"number",ei,"forceX"),this.Z1=t)}get forceY(){return this.Q1}set forceY(t){this.Q1!==t&&(e.s(t,"number",ei,"forceY"),this.Q1=t)}}class ii extends Fe{_1;tk;constructor(t){super(t),this._1=NaN,this.tk=NaN}get stiffness(){return this._1}set stiffness(t){this._1!==t&&(e.s(t,"number",ii,"stiffness"),this._1=t)}get length(){return this.tk}set length(t){this.tk!==t&&(e.s(t,"number",ii,"length"),this.tk=t)}}class ni{I;R;Q;M;A;seed;constructor(t){void 0===t&&(t=42),this.seed=t,this.A=48271,this.M=2147483647,this.Q=this.M/this.A,this.R=this.M%this.A,this.I=1/this.M,this.random()}random(){const t=this.seed/this.Q,e=this.seed%this.Q,i=this.A*e-this.R*t;return this.seed=i>0?i:i+this.M,this.seed*this.I}}var si=(t=>(t[t.DepthFirst=0]="DepthFirst",t[t.Greedy=1]="Greedy",t[t.FromLayers=2]="FromLayers",t))(si||{}),oi=(t=>(t[t.OptimalLinkLength=10]="OptimalLinkLength",t[t.LongestPathSink=11]="LongestPathSink",t[t.LongestPathSource=12]="LongestPathSource",t))(oi||{}),ri=(t=>(t[t.DepthFirstOut=20]="DepthFirstOut",t[t.DepthFirstIn=21]="DepthFirstIn",t[t.Naive=22]="Naive",t))(ri||{}),ai=(t=>(t[t.None=30]="None",t[t.Less=31]="Less",t[t.More=32]="More",t))(ai||{}),li=(t=>(t[t.None=0]="None",t[t.Expand=1]="Expand",t[t.Straighten=2]="Straighten",t[t.Median=4]="Median",t[t.MaybeExpand=8]="MaybeExpand",t[t.All=15]="All",t))(li||{}),hi=(t=>(t[t.None=0]="None",t[t.UpperLeft=1]="UpperLeft",t[t.UpperRight=2]="UpperRight",t[t.LowerLeft=4]="LowerLeft",t[t.LowerRight=8]="LowerRight",t[t.All=15]="All",t))(hi||{});class ui extends Le{Ns;Wi;b;Hf;jf;qf;Qa;Wf;Zo;Jf;Nn;kt;zy;zt;kg;Cs;ci;Zs;Ls;As;It;Pg;_a;Sg;Qs;$f;Qo;Cn;Ln;ZN;constructor(t){super(),this.Ns=25,this.Wi=25,this.b=0,this.Hf=0,this.jf=10,this.qf=20,this.Qa=4,this.Wf=31,this.Zo=15,this.Jf=10,this.Nn=!0,this.kt=-1,this.zy=-1,this.zt=-1,this.kg=0,this.Cs=0,this.ci=null,this.Zs=null,this.Ls=null,this.As=null,this.It=null,this.Pg=0,this._a=null,this.Sg=null,this.Qs=0,this.$f=null,this.Qo=new y,this.Cn=[],this.Cn.length=100,this.Ln=15,this.ZN=0,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ns=this.Ns,t.Wi=this.Wi,t.b=this.b,t.Hf=this.Hf,t.jf=this.jf,t.qf=this.qf,t.Qa=this.Qa,t.Wf=this.Wf,t.Zo=this.Zo,t.Jf=this.Jf,t.Nn=this.Nn,t.Ln=this.Ln}oi(t){t in ai?this.aggressiveOption=t:t in si?this.cycleRemoveOption=t:t in ri?this.initializeOption=t:t in oi?this.layeringOption=t:super.oi(t)}createNetwork(){return new ci(this)}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.hI(),this.network.vertexes.count>0&&(this.network.deleteSelfEdges(),2!==this.cycleRemoveOption&&this.removeCycles(),this.aI(),2===this.cycleRemoveOption&&this.removeCycles(),this.cI(),this.fI(),this.uI(),this.reduceCrossings(),this.straightenAndPack(),this.updateParts()),this.network=null,this.isValidLayout=!0}linkMinLength(t){return 1}linkLengthWeight(t){return 1}linkStraightenWeight(t){const e=t.fromVertex.node||t.fromVertex.data,i=t.toVertex.node||t.toVertex.data;return null===e&&null===i?8:null===e||null===i?4:1}nodeMinLayerSpace(t,e){return null===t.node&&null===t.data?0:90===this.b||270===this.b?e?t.focus.y+10:t.bounds.height-t.focus.y+10:e?t.focus.x+10:t.bounds.width-t.focus.x+10}nodeMinColumnSpace(t,e){if(null===t.node&&null===t.data)return 0;const i=e?t.ik:t.ek;if(null!==i)return i;const n=this.b;return 90===n||270===n?e?t.ik=t.focus.x/this.Wi+1|0:t.ek=(t.bounds.width-t.focus.x)/this.Wi+1|0:e?t.ik=t.focus.y/this.Wi+1|0:t.ek=(t.bounds.height-t.focus.y)/this.Wi+1|0}Ji(){null===this._a&&(this._a=[]);let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;this._a[t]=i.layer,t++,this._a[t]=i.column,t++,this._a[t]=i.index,t++}return this._a}We(t){let e=0;const i=this.network.vertexes.iterator;for(;i.next();){const n=i.value;n.layer=t[e],e++,n.column=t[e],e++,n.index=t[e],e++}}yD(t,e){const i=this.vh(t),n=this.ci[t];(null===this.Sg||this.Sg.length<n*n)&&(this.Sg=[]);const s=this.Sg;for(let o=0;o<n;o++){let r=0;const a=i[o],l=a.near;let h=0;null!==l&&l!==a&&l.layer===a.layer&&(r+=Math.max(0,Math.abs(l.index-a.index)-1));let u,c,d,f,g,p=0,m=0,y=0,x=0,v=0,b=0,w=0,k=0;if(e>=0)for(u=i[o].co,p=0;p<u.length;p++)if(c=u[p],c.valid&&c.fromVertex.layer!==t)for(m=c.fromVertex.index,y=c.portToPos,x=c.portFromPos,v=p+1;v<u.length;v++)f=u[v],f.valid&&f.fromVertex.layer!==t&&(b=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,y<w&&(m>b||m===b&&x>k)&&r++,w<y&&(b>m||b===m&&k>x)&&r++);if(e<=0)for(u=i[o].qo,p=0;p<u.length;p++)if(c=u[p],c.valid&&c.toVertex.layer!==t)for(m=c.toVertex.index,y=c.portToPos,x=c.portFromPos,v=p+1;v<u.length;v++)f=u[v],f.valid&&f.toVertex.layer!==t&&(b=f.toVertex.index,w=f.portToPos,k=f.portFromPos,x<k&&(m>b||m===b&&y>w)&&r++,k<x&&(b>m||b===m&&w>y)&&r++);for(s[o*n+o]=r,h=o+1;h<n;h++){let r=0,a=0;if(e>=0)for(d=i[o].co,g=i[h].co,p=0;p<d.length;p++)if(c=d[p],c.valid&&c.fromVertex.layer!==t)for(m=c.fromVertex.index,y=c.portToPos,x=c.portFromPos,v=0;v<g.length;v++)f=g[v],f.valid&&f.fromVertex.layer!==t&&(b=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,(m<b||m===b&&x<k)&&a++,(b<m||b===m&&k<x)&&r++);if(e<=0)for(d=i[o].qo,g=i[h].qo,p=0;p<d.length;p++)if(c=d[p],c.valid&&c.toVertex.layer!==t)for(m=c.toVertex.index,y=c.portToPos,x=c.portFromPos,v=0;v<g.length;v++)f=g[v],f.valid&&f.toVertex.layer!==t&&(b=f.toVertex.index,w=f.portToPos,k=f.portFromPos,(m<b||m===b&&y<w)&&a++,(b<m||b===m&&w<y)&&r++);s[o*n+h]=r,s[h*n+o]=a}}return this.Oh(t,i),s}countCrossings(){let t=0;for(let e=0;e<=this.kt;e++){const i=this.yD(e,1),n=this.ci[e];for(let e=0;e<n;e++)for(let s=e;s<n;s++)t+=i[e*n+s]}return t}dI(t,e,i){const n=this.vh(t),s=this.ci[t];let o=0;for(let r=0;r<s;r++){let s=null;e<=0&&(s=n[r].co);let a=null;e>=0&&(a=n[r].qo);let l,h=0,u=0;if(null!==s)for(let e=0;e<s.length;e++)l=s[e],l.valid&&l.fromVertex.layer!==t&&(h=l.fromVertex.column+l.portFromColOffset,u=l.toVertex.column+l.portToColOffset,o+=i?Math.abs(h-u)*this.linkStraightenWeight(l):Math.abs(h-u));if(null!==a)for(let e=0;e<a.length;e++)l=a[e],l.valid&&l.toVertex.layer!==t&&(h=l.fromVertex.column+l.portFromColOffset,u=l.toVertex.column+l.portToColOffset,o+=i?(Math.abs(h-u)+1)*this.linkStraightenWeight(l):Math.abs(h-u))}return this.Oh(t,n),o}sk(t){let e=0;for(let i=0;i<=this.kt;i++)e+=this.dI(i,1,t);return e}Xy(){let t=1/0;this.zt=-1;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=Math.min(t,i.column-this.nodeMinColumnSpace(i,!0)),this.zt=Math.max(this.zt,i.column+this.nodeMinColumnSpace(i,!1))}for(e.reset();e.next();){e.value.column-=t}this.zt-=t}Yy(t,e){const i=this.vh(t),n=this.ci[t],s=[];for(let o=0;o<n;o++){const n=i[o];let r=null;e<=0&&(r=n.co);let a=null;e>=0&&(a=n.qo);let l=0,h=0;const u=n.near;let c;if(null!==u&&u.layer===n.layer&&(l+=u.column-1,h++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(l+=i.column,h++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(l+=i.column,h++)}s[o]=0===h?-1:l/h}return this.Oh(t,i),s}wD(t,e){const i=this.vh(t),n=this.ci[t],s=[];for(let o=0;o<n;o++){const n=i[o];let r=null;e<=0&&(r=n.co);let a=null;e>=0&&(a=n.qo);let l=0;const h=[],u=n.near;let c;if(null!==u&&u.layer===n.layer&&(h[l]=u.column-1,l++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(h[l]=i.column+c.portFromColOffset,l++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(h[l]=i.column+c.portToColOffset,l++)}if(0===l)s[o]=-1;else{h.sort(((t,e)=>t-e));const t=l>>1;s[o]=1&l?h[t]:h[t-1]+h[t]>>1}}return this.Oh(t,i),s}Ky(t,e,i,n,s){if(t.component===i){t.component=e;let o=0,r=0;if(n){const a=t.destinationEdges;for(;a.next();){const l=a.value,h=l.toVertex;o=t.layer-h.layer,r=this.linkMinLength(l),o===r&&this.Ky(h,e,i,n,s)}}if(s){const a=t.sourceEdges;for(;a.next();){const l=a.value,h=l.fromVertex;o=h.layer-t.layer,r=this.linkMinLength(l),o===r&&this.Ky(h,e,i,n,s)}}}}QN(t,e,i,n,s){if(t.component===i){if(t.component=e,n){const o=t.destinationEdges;for(;o.next();){const t=o.value.toVertex;this.QN(t,e,i,n,s)}}if(s){const o=t.sourceEdges;for(;o.next();){const t=o.value.fromVertex;this.QN(t,e,i,n,s)}}}}removeCycles(){const t=this.network.edges.iterator;for(;t.next();){t.value.rev=!1}switch(this.Hf){default:case 1:this.gI();break;case 0:this.mI();break;case 2:this.pI()}}pI(){const t=this.network,e=t.vertexes.iterator;let i=1/0;for(;e.next();){const t=e.value;i=Math.min(i,t.layer)}if(i<1/0){if(i<0)for(e.reset();e.next();){e.value.layer-=i}const n=[];for(e.reset();e.next();){const t=e.value,i=n[t.layer];void 0===i?n[t.layer]=[t]:i.push(t)}let s=0;for(let t=0;t<n.length;t++){const e=n[t];if(e&&0!==e.length){if(t>0)for(let t=0;t<e.length;t++){e[t].layer-=s}}else s++}const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,n=e.toVertex;i.layer<n.layer&&(t.reverseEdge(e),e.rev=!0)}}}gI(){const t=this.network;let e=0,i=t.vertexes.count-1;const n=[];n.length=i+1;const s=t.vertexes.iterator;for(;s.next();){s.value.$i=!0}for(;null!==this.yI(t);){let s;for(s=this.xD(t);null!==s;)n[i]=s,i--,s.$i=!1,s=this.xD(t);for(s=this.bD(t);null!==s;)n[e]=s,e++,s.$i=!1,s=this.bD(t);s=this.wI(t),null!==s&&(n[e]=s,e++,s.$i=!1)}for(let r=0;r<t.vertexes.count;r++)n[r].index=r;const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,n=e.toVertex;i.index>n.index&&(t.reverseEdge(e),e.rev=!0)}}yI(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.$i)return t}return null}xD(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.$i){let e=!0;const i=t.destinationEdges;for(;i.next();)if(i.value.toVertex.$i){e=!1;break}if(e)return t}}return null}bD(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t.$i){let e=!0;const i=t.sourceEdges;for(;i.next();)if(i.value.fromVertex.$i){e=!1;break}if(e)return t}}return null}wI(t){let e=null,i=0;const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;if(t.$i){let n=0;const s=t.destinationEdges;for(;s.next();)s.value.toVertex.$i&&n++;let o=0;const r=t.sourceEdges;for(;r.next();)r.value.fromVertex.$i&&o++;(null===e||i<n-o)&&(e=t,i=n-o)}}return e}mI(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.Zf=-1,e.Xn=-1}const e=this.network.edges.iterator;for(;e.next();){e.value.forest=!1}for(this.Pg=0,t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this._N(e)}for(t.reset();t.next();){const e=t.value;-1===e.Zf&&this._N(e)}for(e.reset();e.next();){const t=e.value;if(!t.forest){const e=t.fromVertex,i=e.Zf,n=e.Xn,s=t.toVertex,o=s.Zf,r=s.Xn;o<i&&n<r&&(this.network.reverseEdge(t),t.rev=!0)}}}_N(t){t.Zf=this.Pg,this.Pg++;const e=t.destinationEdges;for(;e.next();){const t=e.value,i=t.toVertex;-1===i.Zf&&(t.forest=!0,this._N(i))}t.Xn=this.Pg,this.Pg++}aI(){const t=this.network.vertexes.iterator;for(;t.next();){t.value.layer=-1}for(this.kt=-1,this.assignLayers(),t.reset();t.next();){const e=t.value;this.kt=Math.max(this.kt,e.layer)}}assignLayers(){switch(this.jf){case 11:this.kD();break;case 12:this.xI();break;default:this.bI()}}kD(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=this.PD(e);this.kt=Math.max(i,this.kt)}}PD(t){let e=0;if(-1===t.layer){const i=t.destinationEdges;for(;i.next();){const t=i.value,n=t.toVertex,s=this.linkMinLength(t);e=Math.max(e,this.PD(n)+s)}t.layer=e}else e=t.layer;return e}xI(){let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=this.SD(i),this.kt=Math.max(t,this.kt)}for(e.reset();e.next();){const t=e.value;t.layer=this.kt-t.layer}}SD(t){let e=0;if(-1===t.layer){const i=t.sourceEdges;for(;i.next();){const t=i.value,n=t.fromVertex,s=this.linkMinLength(t);e=Math.max(e,this.SD(n)+s)}t.layer=e}else e=t.layer;return e}bI(){this.kD();const t=this.network.vertexes.iterator;for(;t.next();){t.value.$i=!1}for(t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this.MD(e)}let e=1/0;for(t.reset();t.next();){const i=t.value;e=Math.min(e,i.layer)}for(this.kt=-1,t.reset();t.next();){const i=t.value;i.layer-=e,this.kt=Math.max(this.kt,i.layer)}}MD(t){if(!t.$i){t.$i=!0;const e=t.destinationEdges;for(;e.next();){const t=e.value.toVertex;this.MD(t)}this.kI(t),this.SI(t)}}kI(t){const e=this.network.vertexes.iterator;for(;e.next();){e.value.component=-1}const i=t.co;let n=i.length;for(let s=0;s<n;s++){const t=i[s],e=t.fromVertex,n=t.toVertex,o=this.linkMinLength(t);e.layer-n.layer>o&&this.Ky(e,0,-1,!0,!1)}for(this.Ky(t,1,-1,!0,!0);0!==t.component;){let i=0,s=1/0,o=0,r=null;const a=this.network.vertexes.iterator;for(;a.next();){const t=a.value;if(1===t.component){let e=0,a=!1;const l=t.co;n=l.length;for(let o=0;o<n;o++){const n=l[o],r=n.fromVertex;if(e+=this.linkLengthWeight(n),1!==r.component){i+=this.linkLengthWeight(n);const e=r.layer-t.layer,o=this.linkMinLength(n);s=Math.min(s,e-o)}}const h=t.qo;n=h.length;for(let t=0;t<n;t++){const n=h[t],s=n.toVertex;e-=this.linkLengthWeight(n),1!==s.component?i-=this.linkLengthWeight(n):a=!0}(null===r||e<o)&&!a&&(r=t,o=e)}}if(i>0){for(e.reset();e.next();){const t=e.value;1===t.component&&(t.layer+=s)}t.component=0}else r.component=0}}SI(t){const e=this.network.vertexes.iterator;for(;e.next();){e.value.component=-1}for(this.Ky(t,1,-1,!0,!1);0!==t.component;){let i=0,n=1/0,s=0,o=null;const r=this.network.vertexes.iterator;for(;r.next();){const t=r.value;if(1===t.component){let e=0,r=!1;const a=t.co;let l=a.length;for(let t=0;t<l;t++){const n=a[t],s=n.fromVertex;e+=this.linkLengthWeight(n),1!==s.component?i+=this.linkLengthWeight(n):r=!0}const h=t.qo;l=h.length;for(let s=0;s<l;s++){const o=h[s],r=o.toVertex;if(e-=this.linkLengthWeight(o),1!==r.component){i-=this.linkLengthWeight(o);const e=t.layer-r.layer,s=this.linkMinLength(o);n=Math.min(n,e-s)}}(null===o||e>s)&&!r&&(o=t,s=e)}}if(i<0){for(e.reset();e.next();){const t=e.value;1===t.component&&(t.layer-=n)}t.component=0}else o.component=0}}cI(){const t=this.network,e=[],i=t.edges.iterator;for(;i.next();){const t=i.value;t.valid=!1,e.push(t)}for(let n=0;n<e.length;n++){const i=e[n];let s=i.fromVertex;const o=i.toVertex;if(i.valid||(null===s.node&&null===s.data||null===o.node&&null===o.data)&&s.layer===o.layer)continue;let r=0,a=0,l=0,h=0;if(null!==i.link){const t=i.link;if(null===t)continue;const e=s.node,n=o.node;if(null===e||null===n)continue;let u=t.fromNode,c=t.toNode,d=t.fromPort;for(;null!==d&&!d.isVisibleObject();)d=d.panel;let f=t.toPort;for(;null!==f&&!f.isVisibleObject();)f=f.panel;if(i.rev){const t=u,e=d;u=c,d=f,c=t,f=e}const g=s.focus,p=o.focus,m=i.rev?o.bounds:s.bounds,x=y.l();e!==u?m.isReal()&&u.isVisible()?u.actualBounds.isReal()?(u.getRelativePoint(d,w.Center,x),x.x+=u.actualBounds.x-m.x,x.y+=u.actualBounds.y-m.y):(u.getRelativePoint(d,w.Center,x),x.isReal()||x.a(g)):x.a(g):m.isReal()?(u.getRelativePoint(d,w.Center,x),x.isReal()||x.a(g)):x.a(g);const v=i.rev?s.bounds:o.bounds,b=y.l();n!==c?v.isReal()&&c.isVisible()?c.actualBounds.isReal()?(c.getRelativePoint(f,w.Center,b),b.x+=c.actualBounds.x-v.x,b.y+=c.actualBounds.y-v.y):(c.getRelativePoint(f,w.Center,b),b.isReal()||b.a(p)):b.a(p):v.isReal()?(c.getRelativePoint(f,w.Center,b),b.isReal()||b.a(p)):b.a(p),90===this.b||270===this.b?(r=Math.round((x.x-g.x)/this.Wi),l=x.x,a=Math.round((b.x-p.x)/this.Wi),h=b.x):(r=Math.round((x.y-g.y)/this.Wi),l=x.y,a=Math.round((b.y-p.y)/this.Wi),h=b.y),y.e(x),y.e(b),i.portFromColOffset=r,i.portFromPos=l,i.portToColOffset=a,i.portToPos=h}else i.portFromColOffset=0,i.portFromPos=0,i.portToColOffset=0,i.portToPos=0;let u=s.layer;const c=o.layer,d=this.MI(i),f=1===d||3===d,g=2===d||3===d;let p,m,x,v=null;g&&(v=this.NI(s,o),x=1,m=t.createVertex(),m.node=null,m.nk=1,m.layer=u,m.near=s,t.addVertex(m),p=t.linkVertexes(s,m,i.link),p.valid=!1,p.rev=i.rev,p.portFromColOffset=r,p.portToColOffset=0,p.portFromPos=l,p.portToPos=0,s=m);let b=1;if(f&&b--,u-c>b&&u>0){for(i.valid=!1,m=t.createVertex(),m.node=null,m.nk=2,m.layer=u-1,v&&x<v.length&&m.layer===v[x].layer&&(m.near=v[x++]),t.addVertex(m),p=t.linkVertexes(s,m,i.link),p.valid=!0,p.rev=i.rev,p.portFromColOffset=g?0:r,p.portToColOffset=0,p.portFromPos=g?0:l,p.portToPos=0,s=m,u--;u-c>b&&u>0;)m=t.createVertex(),m.node=null,m.nk=3,m.layer=u-1,v&&x<v.length&&m.layer===v[x].layer&&(m.near=v[x++]),t.addVertex(m),p=t.linkVertexes(s,m,i.link),p.valid=!0,p.rev=i.rev,p.portFromColOffset=0,p.portToColOffset=0,p.portFromPos=0,p.portToPos=0,s=m,u--;p=t.linkVertexes(m,o,i.link),p.valid=!f,f&&(m.near=o),p.rev=i.rev,p.portFromColOffset=0,p.portToColOffset=a,p.portFromPos=0,p.portToPos=h}else i.valid=!0}}MI(t){let e=0;const i=t.link;if(null!==i){const n=i.fromPort,s=i.toPort;if(null!==n&&null!==s){const o=i.fromNode,r=i.toNode;if(null!==o&&null!==r){const a=this.ok(!0),l=this.ok(!1),h=this.setsPortSpots?a:i.computeSpot(!0,n),u=this.setsPortSpots?l:i.computeSpot(!1,s),c=i.isOrthogonal;if(h.isSide()&&h.includesSide(l)&&u.isSide()&&u.includesSide(a))return 0;const d=i.getLinkPoint(o,n,h,!0,c,r,s,y.l()),f=i.getLinkDirection(o,n,d,h,!0,c,r,s);y.e(d),(!h.isNone()&&f===this.ND(t,!0)||this.setsPortSpots&&null!==o&&1===o.ports.count&&t.rev)&&(e+=1);const g=i.getLinkPoint(r,s,u,!1,c,o,n,y.l()),p=i.getLinkDirection(r,s,g,u,!1,c,o,n);y.e(g),(!u.isNone()&&p===this.ND(t,!1)||this.setsPortSpots&&null!==r&&1===r.ports.count&&t.rev)&&(e+=2)}}}return e}ND(t,e){return 90===this.b?e&&!t.rev||!e&&t.rev?270:90:180===this.b?e&&!t.rev||!e&&t.rev?0:180:270===this.b?e&&!t.rev||!e&&t.rev?90:270:e&&!t.rev||!e&&t.rev?180:0}NI(t,e){const i=[];return i.push(e),this.CD(t,i)?i.reverse():[]}CD(t,e){const i=e[e.length-1].sourceEdges.iterator;for(;i.next();){const n=i.value;if(n.rev||!n.valid)continue;const s=n.fromVertex;if(e.push(s),s===t||this.CD(t,e))return!0;e.pop()}return!1}fI(){const t=this.ci=[];for(let i=0;i<=this.kt;i++)t[i]=0;const e=this.network.vertexes.iterator;for(;e.next();){e.value.index=-1}this.initializeIndices(),this.zy=-1,this.kg=0,this.Cs=0;for(let i=0;i<=this.kt;i++)t[i]>t[this.Cs]&&(this.zy=t[i]-1,this.Cs=i),t[i]<t[this.kg]&&(this.kg=i);this.$f=[];for(let i=0;i<t.length;i++)this.$f[i]=[];for(e.reset();e.next();){const t=e.value,i=t.layer;this.$f[i][t.index]=t}}initializeIndices(){switch(this.qf){default:case 22:this.CI();break;case 20:this.LI();break;case 21:this.AI()}}CI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(e.reset();e.next();){const i=e.value;if(i.near)continue;const n=i.layer;if(i.index=this.ci[n],this.ci[n]++,!t)continue;const s=t.get(i);Array.isArray(s)&&s.forEach((t=>{t.index=this.ci[n],this.ci[n]++}))}}LI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=this.kt;i>=0;i--)for(e.reset();e.next();){const n=e.value;n.layer===i&&-1===n.index&&this.LD(n,t)}}LD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.ci[i],this.ci[i]++,e){const n=e.get(t);Array.isArray(n)&&n.forEach((t=>{t.index=this.ci[i],this.ci[i]++}))}const n=t.qo;let s=!0;for(;s;){s=!1;for(let t=0;t<n.length-1;t++){const e=n[t],i=n[t+1];e.portFromColOffset>i.portFromColOffset&&(s=!0,n[t]=i,n[t+1]=e)}}for(let o=0;o<n.length;o++){const t=n[o];if(t.valid){const i=t.toVertex;-1===i.index&&this.LD(i,e)}}}AI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=0;i<=this.kt;i++)for(e.reset();e.next();){const n=e.value;n.layer===i&&-1===n.index&&this.AD(n,t)}}AD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.ci[i],this.ci[i]++,e){const n=e.get(t);Array.isArray(n)&&n.forEach((t=>{t.index=this.ci[i],this.ci[i]++}))}const n=t.co;let s,o,r=!0,a=0;for(;r;)for(r=!1,a=0;a<n.length-1;a++){const t=n[a],e=n[a+1];t.portToColOffset>e.portToColOffset&&(r=!0,n[a]=e,n[a+1]=t)}for(a=0;a<n.length;a++)o=n[a],o.valid&&(s=o.fromVertex,-1===s.index&&this.AD(s,e))}uI(){this.zt=-1;for(let t=0;t<=this.kt;t++){const e=this.vh(t);let i=0;const n=this.ci[t];for(let t=0;t<n;t++){const n=e[t];i+=this.nodeMinColumnSpace(n,!0),n.column=i,i+=1,i+=this.nodeMinColumnSpace(n,!1)}this.zt=Math.max(this.zt,i-1),this.Oh(t,e)}}reduceCrossings(){let t=this.countCrossings(),e=this.Ji(),i=0,n=0,s=0;for(i=0;i<this.Qa;i++){for(n=0;n<=this.kt;n++)this.rk(n,1),this.rs(n,1,!1,1);for(s=this.countCrossings(),s<t&&(t=s,e=this.Ji()),n=this.kt;n>=0;n--)this.rk(n,-1),this.rs(n,-1,!1,-1);s=this.countCrossings(),s<t&&(t=s,e=this.Ji())}for(this.We(e),i=0;i<this.Qa;i++){for(n=0;n<=this.kt;n++)this.rk(n,0),this.rs(n,0,!1,0);for(s=this.countCrossings(),s<t&&(t=s,e=this.Ji()),n=this.kt;n>=0;n--)this.rk(n,0),this.rs(n,0,!1,0);s=this.countCrossings(),s<t&&(t=s,e=this.Ji())}this.We(e);let o=!1,r=0,a=0,l=0,h=0;switch(this.Wf){case 30:break;case 32:for(l=t+1;(h=this.countCrossings())<l;)for(l=h,r=this.kt;r>=0;r--)for(a=0;a<=r;a++){for(o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.rs(n,-1,!1,-1)||o;for(s=this.countCrossings(),s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.rs(n,1,!1,1)||o;for(s=this.countCrossings(),s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.rs(n,1,!1,1)||o;for(s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.rs(n,-1,!1,-1)||o;for(s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.rs(n,0,!1,0)||o;for(s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.rs(n,0,!1,0)||o;s>=t?this.We(e):(t=s,e=this.Ji())}break;default:for(r=this.kt,a=0,l=t+1;(h=this.countCrossings())<l;){for(l=h,o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.rs(n,-1,!1,-1)||o;for(s=this.countCrossings(),s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.rs(n,1,!1,1)||o;for(s=this.countCrossings(),s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.rs(n,1,!1,1)||o;for(s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.rs(n,-1,!1,-1)||o;for(s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.rs(n,0,!1,0)||o;for(s>=t?this.We(e):(t=s,e=this.Ji()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.rs(n,0,!1,0)||o;s>=t?this.We(e):(t=s,e=this.Ji())}}this.We(e)}rk(t,e){let i=0,n=!1;const s=this.vh(t),o=this.ci[t],r=this.wD(t,e),a=this.Yy(t,e);for(i=0;i<o;i++)-1===a[i]&&(a[i]=s[i].column),-1===r[i]&&(r[i]=s[i].column);let l,h=!0;for(;h;)for(h=!1,i=0;i<o-1;i++)if(r[i+1]<r[i]||r[i+1]===r[i]&&a[i+1]<a[i]){n=!0,h=!0;const t=r[i];r[i]=r[i+1],r[i+1]=t;const e=a[i];a[i]=a[i+1],a[i+1]=e,l=s[i],s[i]=s[i+1],s[i+1]=l}let u=0;for(i=0;i<o;i++)l=s[i],l.index=i,u+=this.nodeMinColumnSpace(l,!0),l.column=u,u+=1,u+=this.nodeMinColumnSpace(l,!1);return this.Oh(t,s),n}rs(t,e,i,n){const s=this.vh(t),o=this.ci[t],r=this.yD(t,e);let a,l,h=0;if(!i||n>0)for(a=[],h=0;h<o;h++)a[h]=-1;else a=this.Yy(t,-1);if(!i||n<0)for(l=[],h=0;h<o;h++)l[h]=-1;else l=this.Yy(t,1);let u=!1,c=!0;for(;c;)for(c=!1,h=0;h<o-1;h++){const e=r[s[h].index*o+s[h+1].index],d=r[s[h+1].index*o+s[h].index];let f=0,g=0;const p=s[h].column,m=s[h+1].column,y=this.nodeMinColumnSpace(s[h],!0),x=this.nodeMinColumnSpace(s[h],!1),v=p-y+this.nodeMinColumnSpace(s[h+1],!0),b=m-x+this.nodeMinColumnSpace(s[h+1],!1);let w,k,S=0,P=0,M=0,C=0,N=0,T=0,L=0,A=0,D=0;const F=s[h].sourceEdges.iterator;if(i&&n<=0)for(;F.next();){const e=F.value;w=e.fromVertex,e.valid&&w.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,T=w.column,S+=(Math.abs(p+N-(T+C))+1)*M,P+=(Math.abs(b+N-(T+C))+1)*M)}for(F.reset();F.next();){const e=F.value;if(w=e.fromVertex,e.valid&&w.layer===t){for(A=0;A<s.length&&s[A]!==w;)A++;A<h&&(f+=2*(h-A),g+=2*(h+1-A)),A===h+1&&(f+=1),A>h+1&&(f+=4*(A-h),g+=4*(A-(h+1)))}}const O=s[h].destinationEdges.iterator;if(i&&n>=0)for(;O.next();){const e=O.value;k=e.toVertex,e.valid&&k.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,L=k.column,S+=(Math.abs(p+C-(L+N))+1)*M,P+=(Math.abs(b+C-(L+N))+1)*M)}for(O.reset();O.next();){const e=O.value;if(k=e.toVertex,e.valid&&k.layer===t){for(D=0;D<s.length&&s[D]!==k;)D++;D===h+1&&(g+=1)}}const E=s[h+1].sourceEdges.iterator;if(i&&n<=0)for(;E.next();){const e=E.value;w=e.fromVertex,e.valid&&w.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,T=w.column,S+=(Math.abs(m+N-(T+C))+1)*M,P+=(Math.abs(v+N-(T+C))+1)*M)}for(E.reset();E.next();){const e=E.value;if(w=e.fromVertex,e.valid&&w.layer===t){for(A=0;A<s.length&&s[A]!==w;)A++;A<h&&(f+=2*(h+1-A),g+=2*(h-A)),A===h&&(g+=1),A>h+1&&(f+=4*(A-(h+1)),g+=4*(A-h))}}const R=s[h+1].destinationEdges.iterator;if(i&&n>=0)for(;R.next();){const e=R.value;k=e.toVertex,e.valid&&k.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,L=k.column,S+=(Math.abs(m+C-(L+N))+1)*M,P+=(Math.abs(v+C-(L+N))+1)*M)}for(R.reset();R.next();){const e=R.value;if(k=e.toVertex,e.valid&&k.layer===t){for(D=0;D<s.length&&s[D]!==k;)D++;D===h&&(f+=1)}}let B=0,I=0;const z=a[s[h].index],j=l[s[h].index],V=a[s[h+1].index],U=l[s[h+1].index];if(-1!==z&&(B+=Math.abs(z-p),I+=Math.abs(z-b)),-1!==j&&(B+=Math.abs(j-p),I+=Math.abs(j-b)),-1!==V&&(B+=Math.abs(V-m),I+=Math.abs(V-v)),-1!==U&&(B+=Math.abs(U-m),I+=Math.abs(U-v)),g<f-.5||g===f&&d<e-.5||g===f&&d===e&&P<S-.5||g===f&&d===e&&P===S&&I<B-.5){u=!0,c=!0,s[h].column=b,s[h+1].column=v;const t=s[h];s[h]=s[h+1],s[h+1]=t}}for(h=0;h<o;h++)s[h].index=h;return this.Oh(t,s),u}straightenAndPack(){if(0!==this.Ln)return void this.TI();let t=0,e=!1,i=0!==(1&this.Zo);const n=0!==(8&this.Zo);if(this.network.edges.count>1e3&&n&&(i=!1),i){const e=[];let i=0;for(i=0;i<=this.kt;i++)e[i]=0;let n=0;const s=this.network.vertexes.iterator;for(;s.next();){const i=s.value;t=i.layer,n=i.column;const o=this.nodeMinColumnSpace(i,!1);e[t]=Math.max(e[t],n+o)}const o=8;for(s.reset();s.next();){const i=s.value;t=i.layer,n=i.column,i.column=((this.zt-e[t])*o>>1)+n*o}this.zt*=o}if(2&this.Zo){e=!0;let i=0;for(;e&&i<this.Jf;){for(e=!1,t=this.Cs+1;t<=this.kt;t++)e=this.Mg(t,1)||e;for(t=this.Cs-1;t>=0;t--)e=this.Mg(t,-1)||e;e=this.Mg(this.Cs,0)||e,i++}}if(4&this.Zo){for(t=this.Cs+1;t<=this.kt;t++)this.tC(t,1);for(t=this.Cs-1;t>=0;t--)this.tC(t,-1);this.tC(this.Cs,0)}if(i&&(this.TD(-1),this.TD(1)),2&this.Zo){e=!0;let i=0;for(;e&&i<this.Jf;){for(e=!1,e=this.Mg(this.Cs,0)||e,t=this.Cs+1;t<=this.kt;t++)e=this.Mg(t,0)||e;for(t=this.Cs-1;t>=0;t--)e=this.Mg(t,0)||e;i++}}}Mg(t,e){let i=!1;for(;this.DI(t,e);)i=!0;return i}DI(t,e){let i=0;const n=this.vh(t),s=this.ci[t],o=this.Yy(t,-1);if(e>0)for(i=0;i<s;i++)o[i]=-1;const r=this.Yy(t,1);if(e<0)for(i=0;i<s;i++)r[i]=-1;let a=!1,l=!0;for(;l;)for(l=!1,i=0;i<s;i++){const h=n[i].column,u=this.nodeMinColumnSpace(n[i],!0),c=this.nodeMinColumnSpace(n[i],!1);let d=0;d=i-1<0||h-n[i-1].column-1>u+this.nodeMinColumnSpace(n[i-1],!1)?h-1:h;let f=0;f=i+1>=s||n[i+1].column-h-1>c+this.nodeMinColumnSpace(n[i+1],!0)?h+1:h;let g=0,p=0,m=0,y=0,x=0,v=0;if(e<=0){const e=n[i].sourceEdges.iterator;for(;e.next();){const i=e.value,n=i.fromVertex;if(i.valid&&n.layer!==t){y=this.linkStraightenWeight(i),x=i.portFromColOffset,v=i.portToColOffset;const t=n.column;g+=(Math.abs(h+v-(t+x))+1)*y,p+=(Math.abs(d+v-(t+x))+1)*y,m+=(Math.abs(f+v-(t+x))+1)*y}}}if(e>=0){const e=n[i].destinationEdges.iterator;for(;e.next();){const i=e.value,n=i.toVertex;if(i.valid&&n.layer!==t){y=this.linkStraightenWeight(i),x=i.portFromColOffset,v=i.portToColOffset;const t=n.column;g+=(Math.abs(h+x-(t+v))+1)*y,p+=(Math.abs(d+x-(t+v))+1)*y,m+=(Math.abs(f+x-(t+v))+1)*y}}}let b=0,w=0,k=0;const S=o[n[i].index],P=r[n[i].index];-1!==S&&(b+=Math.abs(S-h),w+=Math.abs(S-d),k+=Math.abs(S-f)),-1!==P&&(b+=Math.abs(P-h),w+=Math.abs(P-d),k+=Math.abs(P-f)),p<g||p===g&&w<b?(a=!0,l=!0,n[i].column=d):(m<g||m===g&&k<b)&&(a=!0,l=!0,n[i].column=f)}return this.Oh(t,n),this.Xy(),a}tC(t,e){let i=0;const n=this.vh(t),s=this.ci[t],o=this.wD(t,e),r=[];for(i=0;i<s;i++)r[i]=o[i];let a=!1,l=!0;for(;l;)for(l=!1,i=0;i<s;i++){const t=n[i].column,e=this.nodeMinColumnSpace(n[i],!0),o=this.nodeMinColumnSpace(n[i],!1);let h=0,u=0,c=0,d=0,f=0;-1===r[i]?0===i&&i===s-1?h=t:0===i?(u=n[i+1].column,h=u-t===o+this.nodeMinColumnSpace(n[i+1],!0)?t-1:t):i===s-1?(c=n[i-1].column,h=t-c===e+this.nodeMinColumnSpace(n[i-1],!1)?t+1:t):(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,h=(f+d)/2|0):0===i&&i===s-1?h=r[i]:0===i?(u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,h=Math.min(r[i],d)):i===s-1?(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,h=Math.max(r[i],f)):(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,f<r[i]&&r[i]<d?h=r[i]:f>=r[i]?h=f:d<=r[i]&&(h=d)),h!==t&&(a=!0,l=!0,n[i].column=h)}return this.Oh(t,n),this.Xy(),a}FI(){for(let t=0;t<=this.zt;t++)for(;this.RI(t,1););this.Xy()}RI(t,e){let i=!0;const n=this.network.vertexes.iterator;for(;n.next();){const e=n.value,s=this.nodeMinColumnSpace(e,!0),o=this.nodeMinColumnSpace(e,!1);if(e.column-s<=t&&e.column+o>=t){i=!1;break}}let s=!1;if(i){if(e>0)for(n.reset();n.next();){const e=n.value;e.column>t&&(e.column-=1,s=!0)}if(e<0)for(n.reset();n.next();){const e=n.value;e.column<t&&(e.column+=1,s=!0)}}return s}vI(){this.FI();for(let t=0;t<this.zt;t++)for(;this.OI(t,1););this.Xy()}OI(t,e){let i=t;e>0&&(i=t+1),e<0&&(i=t-1);let n=0;const s=[],o=[];for(n=0;n<=this.kt;n++)s[n]=!1,o[n]=!1;const r=this.network.vertexes.iterator;for(;r.next();){const e=r.value,n=e.column-this.nodeMinColumnSpace(e,!0),a=e.column+this.nodeMinColumnSpace(e,!1);n<=t&&a>=t&&(s[e.layer]=!0),n<=i&&a>=i&&(o[e.layer]=!0)}let a=!0,l=!1;for(n=0;n<=this.kt;n++)a=a&&!(s[n]&&o[n]);if(a){if(e>0)for(r.reset();r.next();){const e=r.value;e.column>t&&(e.column-=1,l=!0)}if(e<0)for(r.reset();r.next();){const e=r.value;e.column<t&&(e.column+=1,l=!0)}}return l}TD(t){this.vI();let e,i=0,n=0,s=0,o=0;if(t>0)for(i=0;i<=this.zt;i++)for(e=this.Ji(),n=this.sk(!0),s=n+1;n<s;)s=n,this.DD(i,1),o=this.sk(!0),o>n?this.We(e):o<n&&(n=o,e=this.Ji());if(t<0)for(i=this.zt;i>=0;i--)for(e=this.Ji(),n=this.sk(!0),s=n+1;n<s;)s=n,this.DD(i,-1),o=this.sk(!0),o>n?this.We(e):o<n&&(n=o,e=this.Ji());this.Xy()}DD(t,e){this.Qs=0;const i=this.network.vertexes.iterator;for(;i.next();){i.value.component=-1}if(e>0)for(i.reset();i.next();){const e=i.value;e.column-this.nodeMinColumnSpace(e,!0)<=t&&(e.component=this.Qs)}if(e<0)for(i.reset();i.next();){const e=i.value;e.column+this.nodeMinColumnSpace(e,!1)>=t&&(e.component=this.Qs)}for(this.Qs++,i.reset();i.next();){const t=i.value;-1===t.component&&(this.QN(t,this.Qs,-1,!0,!0),this.Qs++)}let n=0;const s=[];for(n=0;n<this.Qs*this.Qs;n++)s[n]=!1;const o=[];for(n=0;n<(this.kt+1)*(this.zt+1);n++)o[n]=-1;for(i.reset();i.next();){const t=i.value,e=t.layer,n=Math.max(0,t.column-this.nodeMinColumnSpace(t,!0)),s=Math.min(this.zt,t.column+this.nodeMinColumnSpace(t,!1));for(let i=n;i<=s;i++)o[e*(this.zt+1)+i]=t.component}for(let u=0;u<=this.kt;u++){if(e>0)for(let t=0;t<this.zt;t++)-1!==o[u*(this.zt+1)+t]&&-1!==o[u*(this.zt+1)+t+1]&&o[u*(this.zt+1)+t]!==o[u*(this.zt+1)+t+1]&&(s[o[u*(this.zt+1)+t]*this.Qs+o[u*(this.zt+1)+t+1]]=!0);if(e<0)for(let t=this.zt;t>0;t--)-1!==o[u*(this.zt+1)+t]&&-1!==o[u*(this.zt+1)+t-1]&&o[u*(this.zt+1)+t]!==o[u*(this.zt+1)+t-1]&&(s[o[u*(this.zt+1)+t]*this.Qs+o[u*(this.zt+1)+t-1]]=!0)}const r=[];for(n=0;n<this.Qs;n++)r[n]=!0;const a=[];a.push(0);let l=0;for(;0!==a.length;)if(l=a[a.length-1],a.pop(),r[l])for(r[l]=!1,n=0;n<this.Qs;n++)s[l*this.Qs+n]&&a.splice(0,0,n);let h=!1;if(e>0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column-=1,h=!0)}if(e<0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column+=1,h=!0)}return h}TI(){const t=e.et(),i=this.$f.length;for(let e=0;e<=i;e++)t[e]=[];const n=this.network.vertexes.iterator;for(;n.next();){const e=n.value;t[i-e.layer][e.index]=e}const s=new u;this.II(t,s);let o=null,r=null,a=null,l=null;const h=0!==(1&this.Ln),c=0!==(2&this.Ln),d=0!==(4&this.Ln),f=0!==(8&this.Ln);h&&(this._r(t,s,!0),o=this.lk(t,!0,!1)),t.reverse(),d&&(this._r(t,s,!1),a=this.lk(t,!1,!1));for(const e of t)e.reverse();f&&(this._r(t,s,!1),l=this.lk(t,!1,!0)),t.reverse(),c&&(this._r(t,s,!0),r=this.lk(t,!0,!0)),e.J(t),this.EI(o,r,a,l),this.network.vertexes.each((t=>{const i=t,n=e.et();h&&n.push(o.get(i)),c&&n.push(r.get(i)),d&&n.push(a.get(i)),f&&n.push(l.get(i)),n.sort(((t,e)=>t-e));const s=n.length,u=Math.floor((s-1)/2),g=Math.ceil((s-1)/2),p=(n[u]+n[g])/2;e.J(n),i.he=p}))}II(t,e){const i=t.length;for(let n=1;n<i-1;n++){let i=0,s=0;const o=t[n],r=t[n+1];for(let t=0;s<r.length;t++){const n=r[t],a=this.BI(n);if(t===r.length-1||a){let l=o.length-1;for(a&&(l=n.getProperSourceVertexes()[0].index);s<=t;){const t=r[s].getProperSourceEdges();for(const n of t){const t=n.fromVertex.index;(t<i||t>l)&&e.add(n)}s++}i=l}}}}BI(t){if(null===t.node){const e=t.getProperSourceVertexes();if(e.length>0)return null===e[0].node}return!1}_r(t,e,i){this.UI(t);for(const n of t){let t=-1;for(const s of n){const n=i?s.getProperSourceVertexes():s.getProperDestinationVertexes(),o=n.length;if(o>0){n.sort(((t,e)=>t.Ih-e.Ih));const r=(o-1)/2;for(let o=Math.floor(r),a=Math.ceil(r);o<=a;o++)if(s.An===s){const r=n[o];let a;a=i?r.getDestinationEdge(s):s.getDestinationEdge(r),!e.has(a)&&t<r.Ih&&(r.An=s,s.tc=r.tc,s.An=r.tc,t=r.Ih)}}}}}UI(t){for(let e=0;e<t.length;e++){const i=t[e];for(let t=0;t<i.length;t++){const n=i[t];n.tc=n,n.An=n,n.FD=e,n.Ih=t}}}lk(t,e,i){const n=90===this.b||270===this.b;for(const o of t)for(const t of o)t.Je=t,t.Qf=1/0,t.he=NaN,t.Tn=0;this.VI(t,e,i);for(const o of t)for(const e of o)e.tc===e&&this.RD(e,t);for(let o=0;o<t.length;o++){if(t[o].length<=0)continue;const e=t[o][0];if(e.Je===e){e.Je.Qf===1/0&&(e.Je.Qf=0);let i,s=o,r=0;do{for(i=t[s][r];i.An!==i.tc;)if(i=i.An,s++,i.Ih>0){const e=this.vD(i,t),s=n?e.width:e.height,o=i.Je.Qf+i.he+i.Tn-(e.he+e.Tn+s+this.columnSpacing);e.Je.Qf=Math.min(e.Je.Qf,o)}r=i.Ih+1}while(s<t.length&&r<t[s].length&&i.Je===t[s][r].Je)}}const s=new m;for(const o of t)for(const t of o){t.he=t.he+t.Je.Qf+t.Tn;const e=n?t.width:t.height;s.set(t,i?-t.he-e:t.he)}return s}VI(t,e,i){const n=90===this.b||270===this.b;for(const s of t)for(const t of s)if(t.tc===t){let s=0,o=t;for(;o.An!==t;){const t=o.An,r=n?o.width:o.height,a=n?t.width:t.height;let l,h,u,c;e?(u=o.getDestinationEdge(t),l=u.portFromPos,h=u.portToPos,null!==u.link&&(o.node&&o.node!==u.link.fromNode&&(l=n?o.focusX:o.focusY),t.node&&t.node!==u.link.toNode&&(h=n?t.focusX:t.focusY)),c=i?o.Tn+(r-l)-(a-h):o.Tn+l-h):(u=t.getDestinationEdge(o),l=u.portToPos,h=u.portFromPos,null!==u.link&&(o.node&&o.node!==u.link.toNode&&(l=n?o.focusX:o.focusY),t.node&&t.node!==u.link.fromNode&&(h=n?t.focusX:t.focusY)),c=i?o.Tn+(r-l)-(a-h):o.Tn+l-h),t.Tn=c,s=Math.min(s,c),o=o.An}o=t;do{o.Tn=o.Tn-s,o=o.An}while(o!==t)}}RD(t,e){if(!isNaN(t.he))return;t.he=0;let i=t;do{if(i.Ih>0){const n=this.vD(i,e),s=n.tc;this.RD(s,e),t.Je===t&&(t.Je=s.Je);const o=90===this.b||270===this.b?n.width:n.height;if(t.Je===s.Je){const e=s.he+n.Tn+o-i.Tn+this.columnSpacing;t.he=Math.max(t.he,e)}}i=i.An}while(i!==t);for(;i.An!==t;)i=i.An,i.he=t.he,i.Je=t.Je}vD(t,i){const n=t.FD,s=t.Ih;return s<1&&e.o("Could not determine previous vertex in layer"),i[n][s-1]}EI(){let t=-1;const i=e.et(),n=e.et();let s=1/0;for(let e=0;e<4;e++){if(!(e<0||arguments.length<=e?void 0:arguments[e]))continue;const o=this.zI(e<0||arguments.length<=e?void 0:arguments[e],i,n,e);o<s&&(t=e,s=o)}for(let e=0;e<4;e++){const s=e<0||arguments.length<=e?void 0:arguments[e];if(!s)continue;const o=0===e||2===e?i[t]-i[e]:n[t]-n[e];0!==o&&s.each((t=>{s.set(t.key,t.value+o)}))}e.J(i),e.J(n)}zI(t,e,i,n){if(!t||0===t.count)return e[n]=0,i[n]=0,1/0;let s=1/0,o=-1/0;return t.each((t=>{const e=t.key,i=t.value,n=90===this.b||270===this.b?e.width:e.height;i<s&&(s=i),i+n>o&&(o=i+n)})),e[n]=s,i[n]=o,o-s}commitLayout(){this.Vy(),this.commitNodes(),this.iC(),this.isRouting&&this.commitLinks()}Vy(){if(!this.setsPortSpots)return;const t=this.ok(!0),e=this.ok(!1),i=this.network.edges.iterator;for(;i.next();){const n=i.value.link;null!==n&&(n.fromSpot=t,n.toSpot=e)}}ok(t){return 270===this.b?t?w.MiddleTop:w.MiddleBottom:90===this.b?t?w.MiddleBottom:w.MiddleTop:180===this.b?t?w.MiddleLeft:w.MiddleRight:t?w.MiddleRight:w.MiddleLeft}commitNodes(){this.Zs=[],this.Ls=[],this.As=[],this.It=[];for(let f=0;f<=this.kt;f++)this.Zs[f]=0,this.Ls[f]=0,this.As[f]=0,this.It[f]=0;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=e.layer;this.Zs[i]=Math.max(this.Zs[i],this.nodeMinLayerSpace(e,!0)),this.Ls[i]=Math.max(this.Ls[i],this.nodeMinLayerSpace(e,!1))}let e=0;const i=this.Ns;for(let f=0;f<=this.kt;f++){let t=i;this.Zs[f]+this.Ls[f]<=0&&(t=0),f>0&&(e+=t/2),90===this.b||0===this.b?(e+=this.Ls[f],this.As[f]=e,e+=this.Zs[f]):(e+=this.Zs[f],this.As[f]=e,e+=this.Ls[f]),f<this.kt&&(e+=t/2),this.It[f]=e}const n=e,s=this.arrangementOrigin;for(let f=0;f<=this.kt;f++)270===this.b?this.As[f]=s.y+this.As[f]:90===this.b?(this.As[f]=s.y+n-this.As[f],this.It[f]=n-this.It[f]):180===this.b?this.As[f]=s.x+this.As[f]:(this.As[f]=s.x+n-this.As[f],this.It[f]=n-this.It[f]);const o=0!==this.Ln;t.reset();const r=270===this.b||90===this.b;let a=1/0,l=1/0,h=1/0,u=-1/0;for(;t.next();){const e=t.value,i=e.layer,n=0|e.column;let c=0,d=0;r?(c=s.x+this.Wi*n,d=this.As[i]):(c=this.As[i],d=s.y+this.Wi*n),e.centerX=c,e.centerY=d,o&&isFinite(e.he)&&(r?e.node?e.x=s.x+e.he:e.centerX=s.x+e.he:e.node?e.y=s.y+e.he:e.centerY=s.y+e.he),a=Math.min(e.x,a),l=Math.min(e.y,l),r?(h=a,u=Math.max(u,e.bounds.right)):(h=l,u=Math.max(u,e.bounds.bottom))}this.ZN=u-h;const c=s.x-a,d=s.y-l;for(this.Qo=new y(o&&r?0:c,o&&!r?0:d),t.reset();t.next();){const e=t.value;e.x+=c,e.y+=d,e.commit()}}iC(){let t=0;const e=this.Ns;for(let s=0;s<=this.kt;s++)t+=this.Zs[s],t+=this.Ls[s];t+=this.kt*e;const i=[],n=0!==this.Ln?this.ZN:this.Wi*this.zt;for(let s=this.maxLayer;s>=0;s--)270===this.b?0===s?i.push(new v(0,0,n,Math.abs(this.It[0]))):i.push(new v(0,this.It[s-1],n,Math.abs(this.It[s-1]-this.It[s]))):90===this.b?0===s?i.push(new v(0,this.It[0],n,Math.abs(this.It[0]-t))):i.push(new v(0,this.It[s],n,Math.abs(this.It[s-1]-this.It[s]))):180===this.b?0===s?i.push(new v(0,0,Math.abs(this.It[0]),n)):i.push(new v(this.It[s-1],0,Math.abs(this.It[s-1]-this.It[s]),n)):0===s?i.push(new v(this.It[0],0,Math.abs(this.It[0]-t),n)):i.push(new v(this.It[s],0,Math.abs(this.It[s-1]-this.It[s]),n));this.commitLayers(i,this.Qo)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;let e;for(;t.next();)e=t.value.link,null!==e&&(e.startRoute(),e.clearPoints(),e.commitRoute());for(t.reset();t.next();)e=t.value.link,null!==e&&e.updateRoute();for(t.reset();t.next();){const i=t.value;if(e=i.link,null===e||0===e.pointsCount)continue;e.startRoute();const n=e;let s=n.fromNode,o=n.toNode,r=n.fromPort,a=n.toPort;if(null!==s){const t=s.findVisibleNode();null!==t&&t!==s&&(s=t,r=t.port)}if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,a=t.port)}const l=e.computeSpot(!0,r),h=e.computeSpot(!1,a);let u=i.fromVertex,c=i.toVertex;if(i.valid){if(9===e.curve&&4===e.pointsCount)if(u.column===c.column&&0===this.alignOption){const t=e.getLinkPoint(s,r,l,!0,!1,o,a),i=e.getLinkPoint(o,a,h,!1,!1,s,r);t.isReal()||t.set(s.actualBounds.center),i.isReal()||i.set(o.actualBounds.center),e.clearPoints(),e.addPointAt(t.x,t.y),e.addPointAt((2*t.x+i.x)/3,(2*t.y+i.y)/3),e.addPointAt((t.x+2*i.x)/3,(t.y+2*i.y)/3),e.addPointAt(i.x,i.y)}else{let t=!1,i=!1;if(null!==r&&l===w.None&&(t=!0),null!==a&&h===w.None&&(i=!0),t||i){let n=null;t&&(n=e.getLinkPointFromPoint(s,r,r.getDocumentPoint(w.Center),e.getPoint(3),!0),n.isReal()||n.set(s.actualBounds.center),e.setPointAt(0,n.x,n.y));let l=null;if(i&&(l=e.getLinkPointFromPoint(o,a,a.getDocumentPoint(w.Center),e.getPoint(0),!1),l.isReal()||l.set(o.actualBounds.center),e.setPointAt(3,l.x,l.y)),n){const t=e.getPoint(2);e.setPointAt(1,(2*n.x+t.x)/3,(2*n.y+t.y)/3)}if(l){const t=e.getPoint(1);e.setPointAt(2,(2*l.x+t.x)/3,(2*l.y+t.y)/3)}}}e.commitRoute();continue}if(u.layer===c.layer){e.commitRoute();continue}let d=!1,f=!1;const g=this.Ns;let p=0,m=e.firstPickIndex+1;if(e.isOrthogonal)f=!0,p=e.pointsCount,p>4&&e.points.removeRange(2,p-3);else if(9===e.curve)d=!0,p=e.pointsCount,p>4&&e.points.removeRange(2,p-3),4===p&&(m=2);else{p=e.pointsCount;const t=l===w.None,i=h===w.None;p>2&&t&&i?e.points.removeRange(1,p-2):p>3&&t&&!i?e.points.removeRange(1,p-3):p>3&&!t&&i?e.points.removeRange(2,p-2):p>4&&!t&&!i&&e.points.removeRange(2,p-3)}let y,x,v=0,b=0,k=0,S=0,P=0,M=0,C=0;if(i.rev){let t=0;for(;null!==c&&u!==c;){y=null,x=null;const n=c.sourceEdges.iterator;for(;n.next();){const t=n.value;if(t.link===i.link&&(y=t.fromVertex,x=t.toVertex,null===y.node))break}if(null===y)break;if(y!==u)if(v=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=y.centerX,S=y.centerY,f)180===this.b||0===this.b?m===e.firstPickIndex+1?(e.insertPointAt(m++,v,b),e.insertPointAt(m++,v,S)):(null!==x?x.centerY:b)!==S&&(P=this.It[y.layer-1]+this.Qo.x,e.insertPointAt(m++,P,b),e.insertPointAt(m++,P,S)):m===e.firstPickIndex+1?(e.insertPointAt(m++,v,b),e.insertPointAt(m++,k,b)):(null!==x?x.centerX:v)!==k&&(P=this.It[y.layer-1]+this.Qo.y,e.insertPointAt(m++,v,P),e.insertPointAt(m++,k,P));else if(m===e.firstPickIndex+1)if(M=Math.max(10,this.Zs[c.layer]),C=Math.max(10,this.Ls[c.layer]),d)180===this.b?k<=c.bounds.x?(t=c.bounds.x,e.insertPointAt(m++,t-M,S),e.insertPointAt(m++,t,S),e.insertPointAt(m++,t+C,S)):(e.insertPointAt(m++,k-M,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k+C,S)):90===this.b?S>=c.bounds.bottom?(t=c.bounds.y+c.bounds.height,e.insertPointAt(m++,k,t+C),e.insertPointAt(m++,k,t),e.insertPointAt(m++,k,t-M)):(e.insertPointAt(m++,k,S+C),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S-M)):270===this.b?S<=c.bounds.y?(t=c.bounds.y,e.insertPointAt(m++,k,t-M),e.insertPointAt(m++,k,t),e.insertPointAt(m++,k,t+C)):(e.insertPointAt(m++,k,S-M),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S+C)):0===this.b&&(k>=c.bounds.right?(t=c.bounds.x+c.bounds.width,e.insertPointAt(m++,t+C,S),e.insertPointAt(m++,t,S),e.insertPointAt(m++,t-M,S)):(e.insertPointAt(m++,k+C,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k-M,S)));else{e.insertPointAt(m++,v,b);let t=0;180===this.b||0===this.b?((180===this.b?k>=c.bounds.right:k<=c.bounds.x)&&(t=(0===this.b?-M:C)/2),e.insertPointAt(m++,v+t,S)):((270===this.b?S>=c.bounds.bottom:S<=c.bounds.y)&&(t=(90===this.b?-M:C)/2),e.insertPointAt(m++,k,b+t)),e.insertPointAt(m++,k,S)}else M=Math.max(10,this.Zs[y.layer]),C=Math.max(10,this.Ls[y.layer]),d?180===this.b?(e.insertPointAt(m++,k-M-g,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k+C+g,S)):90===this.b?(e.insertPointAt(m++,k,S+C+g),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S-M-g)):270===this.b?(e.insertPointAt(m++,k,S-M-g),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S+C+g)):(e.insertPointAt(m++,k+C+g,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k-M-g,S)):(180===this.b||90===this.b||this.b,e.insertPointAt(m++,k,S));c=y}if(null===a||l!==w.None||f)if(v=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=e.getPoint(m).x,S=e.getPoint(m).y,f){const i=this.Ls[u.layer];let n=0;180===this.b||0===this.b?(n=b,n>=u.bounds.y&&n<=u.bounds.bottom&&(180===this.b?k>=u.bounds.x:k<=u.bounds.right)&&(t=u.centerX+(180===this.b?-i:i),n=n<u.bounds.y+u.bounds.height/2?u.bounds.y-this.Wi/2:u.bounds.bottom+this.Wi/2,e.insertPointAt(m++,t,b),e.insertPointAt(m++,t,n)),e.insertPointAt(m++,k,n),e.insertPointAt(m++,k,S)):(n=v,n>=u.bounds.x&&n<=u.bounds.right&&(270===this.b?S>=u.bounds.y:S<=u.bounds.bottom)&&(t=u.centerY+(270===this.b?-i:i),n=n<u.bounds.x+u.bounds.width/2?u.bounds.x-this.Wi/2:u.bounds.right+this.Wi/2,e.insertPointAt(m++,v,t),e.insertPointAt(m++,n,t)),e.insertPointAt(m++,n,S),e.insertPointAt(m++,k,S))}else if(d)M=Math.max(10,this.Zs[u.layer]),C=Math.max(10,this.Ls[u.layer]),180===this.b&&k>=u.bounds.x?(t=u.bounds.x+u.bounds.width,e.setPointAt(m-2,t,b),e.setPointAt(m-1,t+C,b)):90===this.b&&S<=u.bounds.bottom?(t=u.bounds.y,e.setPointAt(m-2,v,t),e.setPointAt(m-1,v,t-M)):270===this.b&&S>=u.bounds.y?(t=u.bounds.y+u.bounds.height,e.setPointAt(m-2,v,t),e.setPointAt(m-1,v,t+C)):0===this.b&&k<=u.bounds.right&&(t=u.bounds.x,e.setPointAt(m-2,t,b),e.setPointAt(m-1,t-M,b));else{M=Math.max(10,this.Zs[u.layer]),C=Math.max(10,this.Ls[u.layer]);let t=0;180===this.b||0===this.b?((180===this.b?k<=u.bounds.x:k>=u.bounds.right)&&(t=(0===this.b?C:-M)/2),e.insertPointAt(m++,k+t,b)):((270===this.b?S<=u.bounds.y:S>=u.bounds.bottom)&&(t=(90===this.b?C:-M)/2),e.insertPointAt(m++,v,S+t)),e.insertPointAt(m++,k,S)}}else{for(;null!==u&&u!==c;){y=null,x=null;const t=u.destinationEdges.iterator;for(;t.next();){const e=t.value;if(e.link===i.link&&(y=e.toVertex,x=e.fromVertex,null!==x.node&&(x=null),null===y.node))break}if(null===y)break;y!==c&&(v=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=y.centerX,S=y.centerY,f?180===this.b||0===this.b?(null!==x?x.centerY:b)!==S&&(P=this.It[y.layer]+this.Qo.x,m===e.firstPickIndex+1&&(P=0===this.b?Math.max(P,v):Math.min(P,v)),e.insertPointAt(m++,P,b),e.insertPointAt(m++,P,S)):(null!==x?x.centerX:v)!==k&&(P=this.It[y.layer]+this.Qo.y,m===e.firstPickIndex+1&&(P=90===this.b?Math.max(P,b):Math.min(P,b)),e.insertPointAt(m++,v,P),e.insertPointAt(m++,k,P)):(M=Math.max(10,this.Zs[y.layer]),C=Math.max(10,this.Ls[y.layer]),d?180===this.b?(e.insertPointAt(m++,k+C+g,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k-M-g,S)):90===this.b?(e.insertPointAt(m++,k,S-M-g),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S+C+g)):270===this.b?(e.insertPointAt(m++,k,S+C+g),e.insertPointAt(m++,k,Math.max(S+C-g/2,S)),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,Math.min(S-M+g/2,S)),e.insertPointAt(m++,k,S-M-g)):(e.insertPointAt(m++,k-M-g,S),e.insertPointAt(m++,Math.min(k-M+g/2,k),S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,k,S),e.insertPointAt(m++,Math.max(k+C-g/2,k),S),e.insertPointAt(m++,k+C+g,S)):180===this.b?(e.insertPointAt(m++,k+C,S),e.insertPointAt(m++,k-M,S)):90===this.b?(e.insertPointAt(m++,k,S-M),e.insertPointAt(m++,k,S+C)):270===this.b?(e.insertPointAt(m++,k,S+C),e.insertPointAt(m++,k,S-M)):(e.insertPointAt(m++,k-M,S),e.insertPointAt(m++,k+C,S)))),u=y}f&&(v=e.getPoint(m-1).x,b=e.getPoint(m-1).y,k=e.getPoint(m).x,S=e.getPoint(m).y,180===this.b||0===this.b?b!==S&&(P=0===this.b?Math.min(Math.max((k+v)/2,this.It[c.layer]+this.Qo.x),k):Math.max(Math.min((k+v)/2,this.It[c.layer]+this.Qo.x),k),e.insertPointAt(m++,P,b),e.insertPointAt(m++,P,S)):v!==k&&(P=90===this.b?Math.min(Math.max((S+b)/2,this.It[c.layer]+this.Qo.y),S):Math.max(Math.min((S+b)/2,this.It[c.layer]+this.Qo.y),S),e.insertPointAt(m++,v,P),e.insertPointAt(m++,k,P)))}if(null!==n&&d&&e.pointsCount>=4){if(null!==r){const t=l===w.None?e.getLinkPointFromPoint(s,r,r.getDocumentPoint(w.Center),e.getPoint(3),!0):e.getPoint(0);if(l===w.None){const i=e.getPoint(2),n=e.getPoint(3);90===this.direction||270===this.direction?(e.setPointAt(1,(t.x+i.x)/2,i.y),e.setPointAt(2,n.x,(i.y+n.y)/2)):(e.setPointAt(1,i.x,(t.y+i.y)/2),e.setPointAt(2,(i.x+n.x)/2,n.y))}t.isReal()||t.set(s.actualBounds.center),e.setPointAt(0,t.x,t.y)}if(null!==a){const t=h===w.None?e.getLinkPointFromPoint(o,a,a.getDocumentPoint(w.Center),e.getPoint(e.pointsCount-4),!1):e.getPoint(e.pointsCount-1);if(h===w.None){const i=e.getPoint(e.pointsCount-3),n=e.getPoint(e.pointsCount-4);90===this.direction||270===this.direction?(e.setPointAt(e.pointsCount-2,(t.x+i.x)/2,i.y),e.setPointAt(e.pointsCount-2,n.x,(i.y+n.y)/2)):(e.setPointAt(e.pointsCount-2,i.x,(t.y+i.y)/2),e.setPointAt(e.pointsCount-3,(i.x+n.x)/2,n.y))}t.isReal()||t.set(o.actualBounds.center),e.setPointAt(e.pointsCount-1,t.x,t.y)}}e.commitRoute(),i.commit()}}hI(){this.zy=-1,this.kg=0,this.Cs=0,this._a=null,this.Sg=null,this.$f=null;for(let t=0;t<this.Cn.length;t++)this.Cn[t]=null}vh(t){let e;const i=this.ci[t];if(i>=this.Cn.length){const t=[];for(let e=0;e<this.Cn.length;e++)t[e]=this.Cn[e];this.Cn=t}void 0===this.Cn[i]||null===this.Cn[i]?e=[]:(e=this.Cn[i],this.Cn[i]=null);const n=this.$f[t];for(let s=0;s<n.length;s++){const t=n[s];e[t.index]=t}return e}Oh(t,e){this.Cn[this.ci[t]]=e}get layerSpacing(){return this.Ns}set layerSpacing(t){this.Ns!==t&&(e.s(t,"number",ui,"layerSpacing"),t>=0&&(this.Ns=t,this.invalidateLayout()))}get columnSpacing(){return this.Wi}set columnSpacing(t){this.Wi!==t&&(e.s(t,"number",ui,"columnSpacing"),t>0&&(this.Wi=t,this.invalidateLayout()))}get direction(){return this.b}set direction(t){this.b!==t&&(e.s(t,"number",ui,"direction"),0===t||90===t||180===t||270===t?(this.b=t,this.invalidateLayout()):e.o("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}get cycleRemoveOption(){return this.Hf}set cycleRemoveOption(t){this.Hf!==t&&(1===t||0===t||2===t)&&(this.Hf=t,this.invalidateLayout())}get layeringOption(){return this.jf}set layeringOption(t){this.jf!==t&&(10===t||11===t||12===t)&&(this.jf=t,this.invalidateLayout())}get initializeOption(){return this.qf}set initializeOption(t){this.qf!==t&&(20===t||21===t||22===t)&&(this.qf=t,this.invalidateLayout())}get iterations(){return this.Qa}set iterations(t){this.Qa!==t&&t>=0&&(this.Qa=t,this.invalidateLayout())}get aggressiveOption(){return this.Wf}set aggressiveOption(t){this.Wf!==t&&(30===t||31===t||32===t)&&(this.Wf=t,this.invalidateLayout())}get packOption(){return this.Zo}set packOption(t){this.Zo!==t&&(e.s(t,"number",ui,"packOption"),t>=0&&t<8&&(this.Zo=t,this.invalidateLayout()))}get packIterations(){return this.Jf}set packIterations(t){this.Jf=t}get alignOption(){return this.Ln}set alignOption(t){this.Ln!==t&&(e.s(t,"number",ui,"align"),t>=0&&t<16&&(this.Ln=t,this.invalidateLayout()))}get setsPortSpots(){return this.Nn}set setsPortSpots(t){this.Nn!==t&&(e.s(t,"boolean",ui,"setsPortSpots"),this.Nn=t,this.invalidateLayout())}get maxLayer(){return this.kt}get maxIndex(){return this.zy}get maxColumn(){return this.zt}get minIndexLayer(){return this.kg}get maxIndexLayer(){return this.Cs}static CycleDepthFirst=0;static CycleGreedy=1;static CycleFromLayers=2;static LayerOptimalLinkLength=10;static LayerLongestPathSink=11;static LayerLongestPathSource=12;static InitDepthFirstOut=20;static InitDepthFirstIn=21;static InitNaive=22;static AggressiveNone=30;static AggressiveLess=31;static AggressiveMore=32;static PackNone=0;static PackExpand=1;static PackStraighten=2;static PackMedian=4;static PackAll=15;static AlignNone=0;static AlignUpperLeft=1;static AlignUpperRight=2;static AlignLowerLeft=4;static AlignLowerRight=8;static AlignAll=15}class ci extends Ae{constructor(t){super(t)}createVertex(){return new di(this)}createEdge(){return new fi(this)}}class di extends De{Xo;Gr;At;hk;ak;$i;Zf;Xn;nk;ik;ek;tc;An;FD;Ih;Je;Qf;he;Tn;Gy=null;Hy=null;jy=null;qy=null;constructor(t){super(t),this.Xo=-1,this.Gr=-1,this.At=-1,this.hk=NaN,this.ak=null,this.$i=!1,this.Zf=NaN,this.Xn=NaN,this.nk=0,this.ik=null,this.ek=null}static OD(t,e){return t.index-e.index}getProperSourceEdges(){if(!this.jy){const t=[];for(const e of this.co){const i=e;i.valid&&t.push(i)}this.jy=t}return this.jy}getProperDestinationEdges(){if(!this.qy){const t=[];for(const e of this.qo){const i=e;i.valid&&t.push(i)}this.qy=t}return this.qy}getDestinationEdge(t){const i=this.getProperDestinationEdges();for(const e of i)if(e.toVertex===t)return e;e.o("Unable to find destination edge to given vertex")}getProperSourceVertexes(){if(!this.Gy){const t=[];for(const e of this.co){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.fromVertex)}t.sort(di.OD),this.Gy=t}return this.Gy}getProperDestinationVertexes(){if(!this.Hy){const t=[];for(const e of this.qo){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.toVertex)}t.sort(di.OD),this.Hy=t}return this.Hy}addSourceEdge(t){super.addSourceEdge(t),this.Gy=null,this.jy=null}deleteSourceEdge(t){super.deleteSourceEdge(t),this.Gy=null,this.jy=null}addDestinationEdge(t){super.addDestinationEdge(t),this.Hy=null,this.qy=null}deleteDestinationEdge(t){super.deleteDestinationEdge(t),this.Hy=null,this.qy=null}get layer(){return this.Xo}set layer(t){this.Xo!==t&&(e.s(t,"number",di,"layer"),this.Xo=t)}get column(){return this.Gr}set column(t){this.Gr!==t&&(e.s(t,"number",di,"column"),this.Gr=t)}get index(){return this.At}set index(t){this.At!==t&&(e.s(t,"number",di,"index"),this.At=t)}get component(){return this.hk}set component(t){this.hk!==t&&(e.s(t,"number",di,"component"),this.hk=t)}get near(){return this.ak}set near(t){this.ak!==t&&(this.ak=t)}}class fi extends Fe{$i;ck;fk;uk;dk;gk;mk;constructor(t){super(t),this.$i=!1,this.ck=!1,this.fk=!1,this.uk=NaN,this.dk=NaN,this.gk=0,this.mk=0}get fromVertex(){return this.je}set fromVertex(t){this.je!==t&&(this.je=t)}get toVertex(){return this.qe}set toVertex(t){this.qe!==t&&(this.qe=t)}get valid(){return this.$i}set valid(t){this.$i!==t&&(e.s(t,"boolean",fi,"valid"),this.$i=t)}get rev(){return this.ck}set rev(t){this.ck!==t&&(e.s(t,"boolean",fi,"rev"),this.ck=t)}get forest(){return this.fk}set forest(t){this.fk!==t&&(e.s(t,"boolean",fi,"forest"),this.fk=t)}get portFromPos(){return this.uk}set portFromPos(t){this.uk!==t&&(e.s(t,"number",fi,"portFromPos"),this.uk=t)}get portToPos(){return this.dk}set portToPos(t){this.dk!==t&&(e.s(t,"number",fi,"portToPos"),this.dk=t)}get portFromColOffset(){return this.gk}set portFromColOffset(t){this.gk!==t&&(e.s(t,"number",fi,"portFromColOffset"),this.gk=t)}get portToColOffset(){return this.mk}set portToColOffset(t){this.mk!==t&&(e.s(t,"number",fi,"portToColOffset"),this.mk=t)}}var gi=(t=>(t[t.Default=0]="Default",t[t.Destination=1]="Destination",t[t.Source=2]="Source",t))(gi||{}),pi=(t=>(t[t.Forwards=10]="Forwards",t[t.Reverse=11]="Reverse",t[t.Ascending=12]="Ascending",t[t.Descending=13]="Descending",t))(pi||{}),mi=(t=>(t[t.CenterSubtrees=20]="CenterSubtrees",t[t.CenterChildren=21]="CenterChildren",t[t.Start=22]="Start",t[t.End=23]="End",t[t.Bus=24]="Bus",t[t.BusBranching=25]="BusBranching",t[t.TopLeftBus=26]="TopLeftBus",t[t.BottomRightBus=27]="BottomRightBus",t[t.Custom=28]="Custom",t))(mi||{}),yi=(t=>(t[t.None=30]="None",t[t.Block=31]="Block",t))(yi||{}),xi=(t=>(t[t.Layered=40]="Layered",t[t.LastParents=41]="LastParents",t[t.Alternating=42]="Alternating",t[t.RootOnly=43]="RootOnly",t))(xi||{}),vi=(t=>(t[t.Vertical=50]="Vertical",t[t.Horizontal=51]="Horizontal",t[t.FixedRoots=52]="FixedRoots",t))(vi||{}),bi=(t=>(t[t.Individual=60]="Individual",t[t.Siblings=61]="Siblings",t[t.Uniform=62]="Uniform",t))(bi||{});class wi extends Le{Fi;Li;_f;Ng;eC;Fe;Xi;Ms;B;U;pk;ls;constructor(t){super(),this.Fi=new u,this.Li=0,this.ls=1,this._f=40,this.Ng=60,this.eC=[],this.Fe=!0,this.Xi=50,this.Ms=new x(10,10).u();const e=new ki(this);this.B=new Si(e),this.U=new Si(e),this.pk=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Li=this.Li,t._f=this._f,t.Ng=this.Ng,t.Fe=this.Fe,t.Xi=this.Xi,t.Ms.a(this.Ms),t.B.copyInheritedPropertiesFrom(this.B),t.U.copyInheritedPropertiesFrom(this.U)}oi(t){t in mi?this.alignment=t:t in vi?this.arrangement=t:t in yi?this.compaction=t:t in gi?this.path=t:t in pi?this.sorting=t:t in xi?this.treeStyle=t:super.oi(t)}createNetwork(){return new ki(this)}makeNetwork(t){const e=this.createNetwork(),i=t=>{if(t instanceof pe)return!t.isLinkLabel&&"Comment"!==t.category;if(t instanceof be){const e=t.fromNode;if(null===e||e.isLinkLabel||"Comment"===e.category)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel||"Comment"===i.category)}return!1};return t instanceof vt?(e.addParts(t.nodes,!0,i),e.addParts(t.links,!0,i)):t instanceof Ne?e.addParts(t.memberParts,!1,i):e.addParts(t.iterator,!1,i),e}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),52!==this.arrangement&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));let e=this.diagram;null===e&&t instanceof vt&&(e=t),0===this.path&&null!==e?this.ls=e.isTreePathToChildren?1:2:this.ls=0===this.path?1:this.path,this.network.vertexes.count>0&&(this.HI(),this.jI(),this.qI(),this.WI(),this.JN(),this.JI(),this.arrangeTrees(),this.updateParts()),this.network=null,this.Fi=new u,this.isValidLayout=!0}HI(){this.network.deleteSelfEdges();const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.initialized=!1,e.level=0,e.parent=null,e.children=[]}if(this.Fi.count>0){const t=new u,e=this.Fi.iterator;for(;e.next();){const i=e.value;if(i instanceof pe){const e=this.network.findVertex(i);null!==e&&t.add(e)}else i instanceof Si&&t.add(i)}this.Fi=t}0===this.Fi.count&&this.findRoots();const e=this.Fi.copy().iterator;for(;e.next();){const t=e.value;t.initialized||(t.initialized=!0,this.sC(t))}let i=this.network.vertexes,n=null;for(;n=this.$I(i),n.count>0;){const t=this.ID(n);null!==t&&this.Fi.add(t),t.initialized=!0,this.sC(t),i=n}}$I(t){const e=new u,i=t.iterator;for(;i.next();){const t=i.value;t.initialized||e.add(t)}return e}findRoots(){const t=this.network.vertexes,i=t.iterator;for(;i.next();){const t=i.value;switch(this.ls){case 1:0===t.sourceEdges.count&&this.Fi.add(t);break;case 2:0===t.destinationEdges.count&&this.Fi.add(t);break;default:e.o("Unhandled path value "+this.ls.toString())}}if(0===this.Fi.count){const e=this.ID(t);null!==e&&this.Fi.add(e)}}ID(t){let i=999999,n=null;const s=t.iterator;for(;s.next();){const t=s.value;switch(this.ls){case 1:t.sourceEdges.count<i&&(i=t.sourceEdges.count,n=t);break;case 2:t.destinationEdges.count<i&&(i=t.destinationEdges.count,n=t);break;default:e.o("Unhandled path value "+this.ls.toString())}}return n}sC(t){if(null===t)return;switch(this.ls){case 1:if(t.destinationEdges.count>0){const e=new l,i=t.destinationVertexes;for(;i.next();){const n=i.value;this.ED(t,n)&&e.add(n)}e.count>0&&(t.children=e.toArray())}break;case 2:if(t.sourceEdges.count>0){const e=new l,i=t.sourceVertexes;for(;i.next();){const n=i.value;this.ED(t,n)&&e.add(n)}e.count>0&&(t.children=e.toArray())}break;default:e.o("Unhandled path value"+this.ls.toString())}const i=t.children,n=i.length;for(let e=0;e<n;e++){const n=i[e];n.initialized=!0,n.level=t.level+1,n.parent=t,this.Fi.delete(n)}for(let e=0;e<n;e++){const t=i[e];this.sC(t)}}ED(t,e){return!e.initialized||!(this.ZI(e,t)||e.level>t.level)&&(this.QI(e.parent,e),!0)}ZI(t,e){if(null===e)return!1;let i=e.parent;for(;null!==i&&i!==t;)i=i.parent;return i===t}QI(t,e){if(null===t||null===e)return;const i=t.children;let n=0;for(let s=0;s<i.length;s++)i[s]===e&&n++;if(n>0){const s=new Array(i.length-n);let o=0;for(let t=0;t<i.length;t++)i[t]!==e&&(s[o++]=i[t]);t.children=s}}jI(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.BD(e)}}BD(t){if(null===t)return;this.initializeTreeVertexValues(t),25===t.alignment&&this.sortTreeVertexChildren(t);let e=0,i=t.childrenCount,n=0;const s=t.children,o=s.length;for(let r=0;r<o;r++){const t=s[r];this.BD(t),e+=t.descendantCount+1,i=Math.max(i,t.maxChildrenCount),n=Math.max(n,t.maxGenerationCount)}t.descendantCount=e,t.maxChildrenCount=i,t.maxGenerationCount=i>0?n+1:0}_I(t){switch(this._f){default:case 40:return null!==t.parent?t.parent:this.B;case 43:return null===t.parent?this.B:null===t.parent.parent?this.U:t.parent;case 42:return null!==t.parent?null!==t.parent.parent?t.parent.parent:this.U:this.B;case 41:{let e=!0;if(0===t.childrenCount)e=!1;else{const i=t.children,n=i.length;for(let t=0;t<n;t++)if(i[t].childrenCount>0){e=!1;break}}return e&&null!==t.parent?this.U:null!==t.parent?t.parent:this.B}}}initializeTreeVertexValues(t){const e=this._I(t);if(t.copyInheritedPropertiesFrom(e),null!==t.parent&&25===t.parent.alignment){let e=t.angle;const i=t.parent.children;let n=0;for(;n<i.length&&t!==i[n];)n++;n%2===0?n!==i.length-1&&(e=90===e?180:180===e?270:270===e?180:270):e=90===e?0:180===e?90:270===e?0:90,t.angle=e}t.initialized=!0}qI(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.UD(e)}}UD(t){if(null===t)return;this.assignTreeVertexValues(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.UD(t)}}assignTreeVertexValues(t){}WI(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.VD(e)}}VD(t){if(null===t)return;25!==t.alignment&&this.sortTreeVertexChildren(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.VD(t)}}sortTreeVertexChildren(t){switch(t.sorting){default:case 10:break;case 11:t.children.reverse();break;case 12:t.children.sort(t.comparer);break;case 13:t.children.sort(t.comparer),t.children.reverse()}}JN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.angle,i=t.parent;let n=0,s=21,o=!1;null!==i&&(n=i.angle,s=i.alignment,o=this.isBusAlignment(s));const r=90===e||270===e,a=90===n||270===n,l=0===t.childrenCount;let h=0,u=0,c=0;const d=t.commentSpacing;if(null!==t.node){const e=t.node.findNodesConnected();for(;e.next();){const i=e.value;if("Comment"!==i.category||!i.canLayout())continue;null===t.comments&&(t.comments=[]),t.comments.push(i),i.ensureBounds();const n=i.measuredBounds;r&&!l||!o&&!a&&l||o&&a&&l?(h=Math.max(h,n.width),u+=n.height+Math.abs(c)):(h+=n.width+Math.abs(c),u=Math.max(u,n.height)),c=d}}if(null!==t.comments){r&&!l||!o&&!a&&l||o&&a&&l?(h+=Math.abs(t.commentMargin),u=Math.max(0,u-t.height)):(u+=Math.abs(t.commentMargin),h=Math.max(0,h-t.width));const e=v.V(0,0,t.bounds.width+h,t.bounds.height+u);t.bounds=e,v.e(e)}}isBusAlignment(t){return 24===t||25===t||26===t||27===t}Wy(t){return 24===t||25===t}nC(t){const e=t.parent;if(null!==e){const i=e.alignment;if(this.isBusAlignment(i)){if(this.Wy(i)){const i=e.children;let n=0;for(;n<i.length&&t!==i[n];)n++;return n%2===0}return 26===i}}return!1}layoutComments(t){if(null!==t.comments){const e=t.node.measuredBounds,i=t.parent,n=t.angle;let s=0,o=21,r=!1;null!==i&&(s=i.angle,o=i.alignment,r=this.isBusAlignment(o));const a=90===n||270===n,l=90===s||270===s,h=0===t.childrenCount,u=this.nC(t);let c=0;const d=t.comments,f=d.length,g=y.l();for(let m=0;m<f;m++){const e=d[m],i=e.measuredBounds;if(a&&!h||!r&&!l&&h||r&&l&&h){if(s>135&&!r||l&&u)if(t.commentMargin>=0){g.i(t.bounds.x-t.commentMargin-i.width,t.bounds.y+c),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleLeft,t.toSpot=w.MiddleRight}}else{g.i(t.bounds.x+2*t.focus.x-t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleRight,t.toSpot=w.MiddleLeft}}else if(t.commentMargin>=0){g.i(t.bounds.x+2*t.focus.x+t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleRight,t.toSpot=w.MiddleLeft}}else{g.i(t.bounds.x+t.commentMargin-i.width,t.bounds.y+c),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleLeft,t.toSpot=w.MiddleRight}}t.commentSpacing>=0?c+=i.height+t.commentSpacing:c+=t.commentSpacing-i.height}else{if(s>135&&!r||!l&&u)if(t.commentMargin>=0){g.i(t.bounds.x+c,t.bounds.y-t.commentMargin-i.height),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleTop,t.toSpot=w.MiddleBottom}}else{g.i(t.bounds.x+c,t.bounds.y+2*t.focus.y-t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleBottom,t.toSpot=w.MiddleTop}}else if(t.commentMargin>=0){g.i(t.bounds.x+c,t.bounds.y+2*t.focus.y+t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleBottom,t.toSpot=w.MiddleTop}}else{g.i(t.bounds.x+c,t.bounds.y+t.commentMargin-i.height),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleTop,t.toSpot=w.MiddleBottom}}t.commentSpacing>=0?c+=i.width+t.commentSpacing:c+=t.commentSpacing-i.width}}y.e(g);const p=c-t.commentSpacing-(a?e.height:e.width);if(1===this.ls){const e=t.destinationEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.fromEndSegmentLength=p>0?p:NaN)}}else{const e=t.sourceEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.toEndSegmentLength=p>0?p:NaN)}}}}JI(){if(62===this.layerStyle){const t=[];let e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;let n=i.parent;null===n&&(n=i);const s=0===n.angle||180===n.angle;let o=t[i.level];void 0===o&&(o=0),t[i.level]=Math.max(o,s?i.width:i.height)}for(let i=0;i<t.length;i++)void 0===t[i]&&(t[i]=0);for(this.eC=t,e=this.network.vertexes.iterator;e.next();){const i=e.value;let n=i.parent;null===n&&(n=i),0===n.angle||180===n.angle?(180===n.angle&&(i.focusX+=t[i.level]-i.width),i.width=t[i.level]):(270===n.angle&&(i.focusY+=t[i.level]-i.height),i.height=t[i.level])}}else if(61===this.layerStyle){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=0===e.angle||180===e.angle;let n=-1;for(let t=0;t<e.children.length;t++){const s=e.children[t];n=Math.max(n,i?s.width:s.height)}if(n>=0)for(let t=0;t<e.children.length;t++){const s=e.children[t];i?(180===e.angle&&(s.focusX+=n-s.width),s.width=n):(270===e.angle&&(s.focusY+=n-s.height),s.height=n)}}}const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.layoutTree(e)}}layoutTree(t){if(null===t)return;const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.layoutTree(t)}if(30===t.compaction)this.zD(t);else 25===t.alignment?this.zD(t):this.tE(t)}zD(t){if(0===t.childrenCount){let e=!1,i=0,n=21;null!==t.parent&&(i=t.parent.angle,n=t.parent.alignment,e=this.isBusAlignment(n));const s=this.nC(t);return t.O.i(0,0),t.ut.i(t.width,t.height),void(null===t.parent||null===t.comments||(180!==i&&270!==i||e)&&!s?t.lt.i(0,0):180===i&&!e||(90===i||270===i)&&s?t.lt.i(t.width-2*t.focus.x,0):t.lt.i(0,t.height-2*t.focus.y))}const e=this.orthoAngle(t),i=90===e||270===e;let n=0;const s=t.children,o=s.length;for(let D=0;D<o;D++){const t=s[D];n=Math.max(n,i?t.ut.width:t.ut.height)}const r=t.alignment,a=22===r,l=23===r,h=this.isBusAlignment(r),u=Math.max(0,t.breadthLimit),c=this.computeLayerSpacing(t),d=t.nodeSpacing,f=this.computeNodeIndent(t),g=a||l?0:f/2,p=t.rowSpacing;let m=0;(a||l)&&(m=Math.max(0,t.rowIndent));const y=t.width,x=t.height;let v=0,b=0,w=0,k=0,S=0,P=0,M=0,C=0,N=0,T=0;if(h&&!this.Wy(r)&&e>135&&s.reverse(),this.Wy(r))if(o>1)for(let D=0;D<o;D++){const t=s[D],e=t.ut;D%2===0&&D!==o-1?N=Math.max(N,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d):D%2!==0&&(T=Math.max(T,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d))}else 1===o&&(N=i?s[0].ut.width:s[0].ut.height);if(h)switch(r){case 24:case 25:let r;r=e<135?this.XD(t,s,N,T,v,b):this.YD(t,s,N,T,v,b),N=r.x,v=r.width,b=r.height;break;case 26:for(let t=0;t<o;t++){const e=s[t],o=e.ut,r=0===M?0:p;i?(e.O.i(n-o.width,S+r),v=Math.max(v,o.width),b=Math.max(b,S+r+o.height),S+=r+o.height):(e.O.i(k+r,n-o.height),v=Math.max(v,k+r+o.width),b=Math.max(b,o.height),k+=r+o.width),M++}break;case 27:for(let e=0;e<o;e++){const n=s[e],o=n.ut,r=0===M?0:p;i?(n.O.i(d/2+t.focus.x,S+r),v=Math.max(v,o.width),b=Math.max(b,S+r+o.height),S+=r+o.height):(n.O.i(k+r,d/2+t.focus.y),v=Math.max(v,k+r+o.width),b=Math.max(b,o.height),k+=r+o.width),M++}}else for(let D=0;D<o;D++){const o=s[D],a=o.ut;if(i){u>0&&M>0&&k+d+a.width>u&&(k<n&&this.ic(t,r,n-k,0,C,D-1),P++,M=0,C=D,w=b,k=0,S=e>135?-b-p:b+p);const i=0===M?g:d;this.yk(o,0,S),o.O.i(k+i,S),v=Math.max(v,k+i+a.width),b=Math.max(b,w+(0===P?0:p)+a.height),k+=i+a.width}else{u>0&&M>0&&S+d+a.height>u&&(S<n&&this.ic(t,r,0,n-S,C,D-1),P++,M=0,C=D,w=v,S=0,k=e>135?-v-p:v+p);const i=0===M?g:d;this.yk(o,k,0),o.O.i(k,S+i),b=Math.max(b,S+i+a.height),v=Math.max(v,w+(0===P?0:p)+a.width),S+=i+a.height}M++}P>0&&(i?(b+=Math.max(0,c),k<v&&this.ic(t,r,v-k,0,C,o-1),m>0&&(l||this.tu(t,m,0,0,o-1),v+=m)):(v+=Math.max(0,c),S<b&&this.ic(t,r,0,b-S,C,o-1),m>0&&(l||this.tu(t,0,m,0,o-1),b+=m)));let L=0,A=0;switch(r){case 20:i?L+=v/2-t.focus.x-f/2:A+=b/2-t.focus.y-f/2;break;default:case 21:if(P>0)i?L+=v/2-t.focus.x-f/2:A+=b/2-t.focus.y-f/2;else{const e=o;if(i){const i=s[0].O.x+s[0].lt.x;L+=i+(s[e-1].O.x+s[e-1].lt.x+2*s[e-1].focus.x-i)/2-t.focus.x-f/2}else{const i=s[0].O.y+s[0].lt.y;A+=i+(s[e-1].O.y+s[e-1].lt.y+2*s[e-1].focus.y-i)/2-t.focus.y-f/2}}break;case 22:i?(L-=f,v+=f):(A-=f,b+=f);break;case 23:i?(L+=v-t.width+f,v+=f):(A+=b-t.height+f,b+=f);break;case 24:case 25:i?L+=o>1?N+d/2-t.focus.x:s[0].focus.x-t.focus.x+s[0].lt.x:A+=o>1?N+d/2-t.focus.y:s[0].focus.y-t.focus.y+s[0].lt.y;break;case 26:i?L+=v+d/2-t.focus.x:A+=b+d/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,L,A,v,b);L=e[0],A=e[1],v=e[2],b=e[3]}for(let D=0;D<o;D++){const t=s[D];i?t.O.i(t.O.x+t.lt.x-L,t.O.y+(e>135?(h?-b:-t.ut.height)+t.lt.y-c:x+c+t.lt.y)):t.O.i(t.O.x+(e>135?(h?-v:-t.ut.width)+t.lt.x-c:y+c+t.lt.x),t.O.y+t.lt.y-A)}i?(v=this.oC(t,v,L),L<0&&(L=0),e>135&&(A+=b+c),b=Math.max(Math.max(b,x),b+x+c)):(e>135&&(L+=v+c),v=Math.max(Math.max(v,y),v+y+c),b=this.rC(t,b,A),A<0&&(A=0)),t.lt.i(L,A),t.ut.i(v,b)}customAlignment(t,e,i,n,s){return[e,i,n,s]}XD(t,e,i,n,s,o){const r=e.length;if(0===r)return new v(i,0,s,o);if(1===r){const t=e[0];return s=t.ut.width,o=t.ut.height,new v(i,0,s,o)}const a=t.nodeSpacing,l=t.rowSpacing,h=90===this.orthoAngle(t);let u=0,c=0,d=0;for(let p=0;p<r;p++){if(p%2!==0||r>1&&p===r-1)continue;const t=e[p],n=t.ut,f=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;t.O.i(i-(n.width+e),d+f),s=Math.max(s,n.width+e),o=Math.max(o,d+f+n.height),d+=f+n.height}else{const e=this.computeBusNodeSpacing(t)-a;t.O.i(c+f,i-(n.height+e)),o=Math.max(o,n.height+e),s=Math.max(s,c+f+n.width),c+=f+n.width}u++}u=0;const f=c,g=d;h?(c=i+a,d=0):(c=0,d=i+a);for(let p=0;p<r;p++){if(p%2===0)continue;const t=e[p],i=t.ut,n=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;t.O.i(c+e,d+n),s=Math.max(s,c+i.width+e),o=Math.max(o,d+n+i.height),d+=n+i.height}else{const e=this.computeBusNodeSpacing(t)-a;t.O.i(c+n,d+e),s=Math.max(s,c+n+i.width),o=Math.max(o,d+i.height+e),c+=n+i.width}u++}if(r>1&&r%2===1){const n=e[r-1],l=n.ut,u=this.computeBusLastRowSpacing(n,h?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(h){n.O.i(i+a/2-n.focus.x-n.lt.x,o+u);const e=i+a/2-n.focus.x-n.lt.x;s=Math.max(s,e+l.width),e<0&&(s-=e),o=Math.max(o,Math.max(g,d)+u+l.height),n.O.x<0&&(i=this.wk(t,n.O.x,!1,i,a))}else{n.O.i(s+u,i+a/2-n.focus.y-n.lt.y),s=Math.max(s,Math.max(f,c)+u+l.width);const e=i+a/2-n.focus.y-n.lt.y;o=Math.max(o,e+l.height),e<0&&(o-=e),n.O.y<0&&(i=this.wk(t,n.O.y,!0,i,a))}}return new v(i,0,s,o)}YD(t,e,i,n,s,o){const r=e.length;if(0===r)return new v(i,0,s,o);if(1===r){const t=e[0];return s=t.ut.width,o=t.ut.height,new v(i,0,s,o)}const a=t.nodeSpacing,l=t.rowSpacing,h=270===this.orthoAngle(t);let u=0,c=0,d=0;for(let p=0;p<r;p++){if(p%2!==0||r>1&&p===r-1)continue;const t=e[p],n=t.ut,f=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;d-=f+n.height,t.O.i(i-(n.width+e),d),s=Math.max(s,n.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=f+n.width,t.O.i(c,i-(n.height+e)),o=Math.max(o,n.height+e),s=Math.max(s,Math.abs(c))}u++}u=0;const f=c,g=d;h?(c=i+a,d=0):(c=0,d=i+a);for(let p=0;p<r;p++){if(p%2===0)continue;const t=e[p],i=t.ut,n=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;d-=n+i.height,t.O.i(c+e,d),s=Math.max(s,c+i.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=n+i.width,t.O.i(c,d+e),o=Math.max(o,d+i.height+e),s=Math.max(s,Math.abs(c))}u++}if(r>1&&r%2===1){const n=e[r-1],l=n.ut,u=this.computeBusLastRowSpacing(n,h?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(h){n.O.i(i+a/2-n.focus.x-n.lt.x,-o-l.height-u);const e=i+a/2-n.focus.x-n.lt.x;s=Math.max(s,e+l.width),e<0&&(s-=e),o=Math.max(o,Math.abs(Math.min(g,d))+u+l.height),n.O.x<0&&(i=this.wk(t,n.O.x,!1,i,a))}else{n.O.i(-s-l.width-u,i+a/2-n.focus.y-n.lt.y),s=Math.max(s,Math.abs(Math.min(f,c))+u+l.width);const e=i+a/2-n.focus.y-n.lt.y;o=Math.max(o,e+l.height),e<0&&(o-=e),n.O.y<0&&(i=this.wk(t,n.O.y,!0,i,a))}}for(let p=0;p<r;p++){const t=e[p];h?t.O.i(t.O.x,t.O.y+o):t.O.i(t.O.x+s,t.O.y)}return new v(i,0,s,o)}computeBusNodeSpacing(t){return null===t.parent?0:t.parent.nodeSpacing}computeBusLastRowSpacing(t,e){return null===t.parent?0:t.parent.rowSpacing}wk(t,e,i,n,s){const o=t.children,r=o.length;for(let l=0;l<r;l++)i?o[l].O.i(o[l].O.x,o[l].O.y-e):o[l].O.i(o[l].O.x-e,o[l].O.y);const a=o[r-1];return Math.max(n,i?a.lt.y+a.focus.y-s/2:a.lt.x+a.focus.x-s/2)}oC(t,e,i){switch(t.alignment){case 21:case 20:let n=e;return i+t.width>n&&(n=i+t.width),i<0&&(n-=i),n;case 22:return t.width>e?t.width:e;case 23:return 2*t.focus.x>e?t.width:e+t.width-2*t.focus.x;case 24:case 25:const s=Math.min(0,i),o=Math.max(e,i+t.width);return Math.max(t.width,o-s);case 26:return t.width-t.focus.x+t.nodeSpacing/2+e;case 27:return Math.max(t.width,t.focus.x+t.nodeSpacing/2+e);default:return e}}rC(t,e,i){switch(t.alignment){case 21:case 20:let n=e;return i+t.height>n&&(n=i+t.height),i<0&&(n-=i),n;case 22:return t.height>e?t.height:e;case 23:return 2*t.focus.y>e?t.height:e+t.height-2*t.focus.y;case 24:case 25:const s=Math.min(0,i),o=Math.max(e,i+t.height);return Math.max(t.height,o-s);case 26:return t.height-t.focus.y+t.nodeSpacing/2+e;case 27:return Math.max(t.height,t.focus.y+t.nodeSpacing/2+e);default:return e}}lC(t,i,n){switch(t){case 20:case 21:i/=2,n/=2;break;case 22:i=0,n=0;break;case 23:break;default:e.o("Unhandled alignment value "+t.toString())}return new y(i,n)}ic(t,e,i,n,s,o){const r=this.lC(e,i,n);this.tu(t,r.x,r.y,s,o)}tu(t,e,i,n,s){if(0===e&&0===i)return;const o=t.children;for(let r=n;r<=s;r++){const t=o[r].O;t.x+=e,t.y+=i}}yk(t,i,n){const s=t.parent;switch(this.ls){case 1:{const e=t.sourceEdges;for(;e.next();){const t=e.value;t.fromVertex===s&&t.relativePoint.i(i,n)}break}case 2:{const e=t.destinationEdges;for(;e.next();){const t=e.value;t.toVertex===s&&t.relativePoint.i(i,n)}break}default:e.o("Unhandled path value "+this.ls.toString())}}tE(t){if(0===t.childrenCount){const e=t.parent;let i=!1,n=0,s=21;null!==e&&(n=e.angle,s=e.alignment,i=this.isBusAlignment(s));const o=this.nC(t);return t.O.i(0,0),t.ut.i(t.width,t.height),null===t.parent||null===t.comments||(180!==n&&270!==n||i)&&!o?t.lt.i(0,0):180===n&&!i||(90===n||270===n)&&o?t.lt.i(t.width-2*t.focus.x,0):t.lt.i(0,t.height-2*t.focus.y),t.Cg=null,void(t.Lg=null)}const i=this.orthoAngle(t),n=90===i||270===i;let s=0;const o=t.children,r=o.length;for(let e=0;e<r;e++){const t=o[e];s=Math.max(s,n?t.ut.width:t.ut.height)}const a=t.alignment,l=22===a,h=23===a,u=this.isBusAlignment(a),c=Math.max(0,t.breadthLimit),d=this.computeLayerSpacing(t),f=t.nodeSpacing,g=this.computeNodeIndent(t),p=t.rowSpacing;let m=0;(l||h)&&(m=Math.max(0,t.rowIndent));const y=t.width,x=t.height;let v=0,b=0,w=0,k=null,S=null,P=0,M=0,C=0,N=0,T=0,L=0,A=0,D=0,F=0;if(u&&!this.Wy(a)&&i>135&&o.reverse(),this.Wy(a))if(r>1)for(let e=0;e<r;e++)e%2===0&&e!==r-1?D=Math.max(D,n?o[e].ut.width:o[e].ut.height):e%2!==0&&(F=Math.max(F,n?o[e].ut.width:o[e].ut.height));else 1===r&&(D=n?o[0].ut.width:o[0].ut.height);if(u){switch(a){case 24:let e;e=i<135?this.XD(t,o,D,F,v,b):this.YD(t,o,D,F,v,b),D=e.x,v=e.width,b=e.height;break;case 26:for(let t=0;t<r;t++){const e=o[t],i=e.ut,r=0===L?0:p;n?(e.O.i(s-i.width,N+r),v=Math.max(v,i.width),b=Math.max(b,N+r+i.height),N+=r+i.height):(e.O.i(C+r,s-i.height),v=Math.max(v,C+r+i.width),b=Math.max(b,i.height),C+=r+i.width),L++}break;case 27:for(let i=0;i<r;i++){const e=o[i],s=e.ut,r=0===L?0:p;n?(e.O.i(f/2+t.focus.x,N+r),v=Math.max(v,s.width),b=Math.max(b,N+r+s.height),N+=r+s.height):(e.O.i(C+r,f/2+t.focus.y),v=Math.max(v,C+r+s.width),b=Math.max(b,s.height),C+=r+s.width),L++}}k=this.ae(2),S=this.ae(2),n?(k[0].i(0,0),k[1].i(0,b),S[0].i(v,0),S[1].i(v,b)):(k[0].i(0,0),k[1].i(v,0),S[0].i(0,b),S[1].i(v,b))}else for(let j=0;j<r;j++){const r=o[j],l=r.ut;if(n){c>0&&L>0&&C+f+l.width>c&&(C<s&&this.ic(t,a,s-C,0,A,j-1),T++,L=0,A=j,w=b,C=0,N=i>135?-b-p:b+p),this.yk(r,0,N);let n=0;if(0===L)k=r.Cg,S=r.Lg,P=l.width,M=l.height,(null===k||null===S||i!==this.orthoAngle(r))&&(k=this.ae(2),S=this.ae(2),k[0].i(0,0),k[1].i(0,M),S[0].i(P,0),S[1].i(P,M));else{const i=e.et(),s=this.KD(t,r,k,S,P,M,i);n=s.x,k=i[0],S=i[1],P=s.width,M=s.height,e.J(i),C<l.width&&n<0&&(this.tu(t,-n,0,A,j-1),this.xk(k,-n,0),this.xk(S,-n,0),n=0)}r.O.i(n,N),v=Math.max(v,P),b=Math.max(b,w+(0===T?0:p)+l.height),C=P}else{c>0&&L>0&&N+f+l.height>c&&(N<s&&this.ic(t,a,0,s-N,A,j-1),T++,L=0,A=j,w=v,N=0,C=i>135?-v-p:v+p),this.yk(r,C,0);let n=0;if(0===L)k=r.Cg,S=r.Lg,P=l.width,M=l.height,(null===k||null===S||i!==this.orthoAngle(r))&&(k=this.ae(2),S=this.ae(2),k[0].i(0,0),k[1].i(P,0),S[0].i(0,M),S[1].i(P,M));else{const i=e.et(),s=this.KD(t,r,k,S,P,M,i);n=s.x,k=i[0],S=i[1],P=s.width,M=s.height,e.J(i),N<l.height&&n<0&&(this.tu(t,0,-n,A,j-1),this.xk(k,0,-n),this.xk(S,0,-n),n=0)}r.O.i(C,n),b=Math.max(b,M),v=Math.max(v,w+(0===T?0:p)+l.width),N=M}L++}T>0&&(n?(b+=Math.max(0,d),C<v&&this.ic(t,a,v-C,0,A,r-1),m>0&&(h||this.tu(t,m,0,0,r-1),v+=m)):(v+=Math.max(0,d),N<b&&this.ic(t,a,0,b-N,A,r-1),m>0&&(h||this.tu(t,0,m,0,r-1),b+=m)));let O=0,E=0;switch(a){case 20:n?O+=v/2-t.focus.x-g/2:E+=b/2-t.focus.y-g/2;break;default:case 21:if(T>0)n?O+=v/2-t.focus.x-g/2:E+=b/2-t.focus.y-g/2;else{const e=r;if(n){const i=o[0].O.x+o[0].lt.x;O+=i+(o[e-1].O.x+o[e-1].lt.x+2*o[e-1].focus.x-i)/2-t.focus.x-g/2}else{const i=o[0].O.y+o[0].lt.y;E+=i+(o[e-1].O.y+o[e-1].lt.y+2*o[e-1].focus.y-i)/2-t.focus.y-g/2}}break;case 22:n?(O-=g,v+=g):(E-=g,b+=g);break;case 23:n?(O+=v-t.width+g,v+=g):(E+=b-t.height+g,b+=g);break;case 24:n?O+=r>1?D+f/2-t.focus.x:o[0].focus.x-t.focus.x+o[0].lt.x:E+=r>1?D+f/2-t.focus.y:o[0].focus.y-t.focus.y+o[0].lt.y;break;case 26:n?O+=v+f/2-t.focus.x:E+=b+f/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,O,E,v,b);O=e[0],E=e[1],v=e[2],b=e[3]}for(let e=0;e<r;e++){const t=o[e];n?t.O.i(t.O.x+t.lt.x-O,t.O.y+(i>135?(u?-b:-t.ut.height)+t.lt.y-d:x+d+t.lt.y)):t.O.i(t.O.x+(i>135?(u?-v:-t.ut.width)+t.lt.x-d:y+d+t.lt.x),t.O.y+t.lt.y-E)}let R,B,I=0,z=0;if(u)n?(v=this.oC(t,v,O),O<0&&(O=0),i>135&&(E+=b+d),b+=x+d,27===a&&(I+=f/2+t.focus.x),z+=x+d):(i>135&&(O+=v+d),v+=y+d,b=this.rC(t,b,E),E<0&&(E=0),27===a&&(z+=f/2+t.focus.y),I+=y+d);else if(n){if(null===t.comments){if(y>v){const t=this.lC(a,y-v,0);I=t.x,z=t.y,v=y,O=0}}else v=this.oC(t,v,O);O<0&&(I-=O,O=0),i>135&&(E+=b+d),b=Math.max(Math.max(b,x),b+x+d),z+=x+d}else{if(i>135&&(O+=v+d),v=Math.max(Math.max(v,y),v+y+d),null===t.comments){if(x>b){const t=this.lC(a,0,x-b);I=t.x,z=t.y,b=x,E=0}}else b=this.rC(t,b,E);E<0&&(z-=E,E=0),I+=y+d}if(T>0)R=this.ae(4),B=this.ae(4),n?(R[2].i(0,x+d),R[3].i(R[2].x,b),B[2].i(v,R[2].y),B[3].i(B[2].x,R[3].y)):(R[2].i(y+d,0),R[3].i(v,R[2].y),B[2].i(R[2].x,b),B[3].i(R[3].x,B[2].y));else{R=this.ae(k.length+2),B=this.ae(S.length+2);for(let t=0;t<k.length;t++){const e=k[t];R[t+2].i(e.x+I,e.y+z)}for(let t=0;t<S.length;t++){const e=S[t];B[t+2].i(e.x+I,e.y+z)}}n?(R[0].i(O,0),R[1].i(R[0].x,x),R[2].y<R[1].y&&(R[2].x>R[0].x?R[2].a(R[1]):R[1].a(R[2])),R[3].y<R[2].y&&(R[3].x>R[0].x?R[3].a(R[2]):R[2].a(R[3])),B[0].i(O+y,0),B[1].i(B[0].x,x),B[2].y<B[1].y&&(B[2].x<B[0].x?B[2].a(B[1]):B[1].a(B[2])),B[3].y<B[2].y&&(B[3].x<B[0].x?B[3].a(B[2]):B[2].a(B[3])),R[2].y-=d/2,B[2].y-=d/2):(R[0].i(0,E),R[1].i(y,R[0].y),R[2].x<R[1].x&&(R[2].y>R[0].y?R[2].a(R[1]):R[1].a(R[2])),R[3].x<R[2].x&&(R[3].y>R[0].y?R[3].a(R[2]):R[2].a(R[3])),B[0].i(0,E+x),B[1].i(y,B[0].y),B[2].x<B[1].x&&(B[2].y<B[0].y?B[2].a(B[1]):B[1].a(B[2])),B[3].x<B[2].x&&(B[3].y<B[0].y?B[3].a(B[2]):B[2].a(B[3])),R[2].x-=d/2,B[2].x-=d/2),this._s(k),this._s(S),t.Cg=R,t.Lg=B,t.lt.i(O,E),t.ut.i(v,b)}xk(t,e,i){for(let n=0;n<t.length;n++){const s=t[n];s.x+=e,s.y+=i}}KD(t,e,i,n,s,o,r){const a=this.orthoAngle(t),l=90===a||270===a,h=t.nodeSpacing,u=i,c=n,d=s,f=o;let g=e.Cg,p=e.Lg;const m=e.ut,y=l?Math.max(f,m.height):Math.max(d,m.width);if((null===g||a!==this.orthoAngle(e))&&(g=this.ae(2),p=this.ae(2),l?(g[0].i(0,0),g[1].i(0,m.height),p[0].i(m.width,0),p[1].i(p[0].x,g[1].y)):(g[0].i(0,0),g[1].i(m.width,0),p[0].i(0,m.height),p[1].i(g[1].x,p[0].y))),l){const t=d;let e=t-this.iE(c,g,t);return e+=h,i=this.eE(u,g,e),n=this.sE(c,p,e),s=Math.max(0,e)+m.width,o=y,this._s(u),this._s(g),this._s(c),this._s(p),r[0]=i,r[1]=n,new v(e,0,s,o)}{const t=f;let e=t-this.nE(c,g,t);return e+=h,i=this.oE(u,g,e),n=this.rE(c,p,e),s=y,o=Math.max(0,e)+m.height,this._s(u),this._s(g),this._s(c),this._s(p),r[0]=i,r[1]=n,new v(e,0,s,o)}}oE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ae(t.length+e.length);let s=0,o=0,r=0;for(;o<e.length&&e[o].x<t[0].x;){const t=e[o++];n[r++].i(t.x,t.y+i)}for(;s<t.length;){const e=t[s++];n[r++].i(e.x,e.y)}const a=t[t.length-1].x;for(;o<e.length&&e[o].x<=a;)o++;for(;o<e.length&&e[o].x>a;){const t=e[o++];n[r++].i(t.x,t.y+i)}const l=this.ae(r);for(s=0;s<r;s++)l[s].a(n[s]);return this._s(n),l}eE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ae(t.length+e.length);let s=0,o=0,r=0;for(;o<e.length&&e[o].y<t[0].y;){const t=e[o++];n[r++].i(t.x+i,t.y)}for(;s<t.length;){const e=t[s++];n[r++].i(e.x,e.y)}const a=t[t.length-1].y;for(;o<e.length&&e[o].y<=a;)o++;for(;o<e.length&&e[o].y>a;){const t=e[o++];n[r++].i(t.x+i,t.y)}const l=this.ae(r);for(s=0;s<r;s++)l[s].a(n[s]);return this._s(n),l}rE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ae(t.length+e.length);let s=0,o=0,r=0;for(;s<t.length&&t[s].x<e[0].x;){const e=t[s++];n[r++].i(e.x,e.y)}for(;o<e.length;){const t=e[o++];n[r++].i(t.x,t.y+i)}const a=e[e.length-1].x;for(;s<t.length&&t[s].x<=a;)s++;for(;s<t.length&&t[s].x>a;){const e=t[s++];n[r++].i(e.x,e.y)}const l=this.ae(r);for(s=0;s<r;s++)l[s].a(n[s]);return this._s(n),l}sE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ae(t.length+e.length);let s=0,o=0,r=0;for(;s<t.length&&t[s].y<e[0].y;){const e=t[s++];n[r++].i(e.x,e.y)}for(;o<e.length;){const t=e[o++];n[r++].i(t.x+i,t.y)}const a=e[e.length-1].y;for(;s<t.length&&t[s].y<=a;)s++;for(;s<t.length&&t[s].y>a;){const e=t[s++];n[r++].i(e.x,e.y)}const l=this.ae(r);for(s=0;s<r;s++)l[s].a(n[s]);return this._s(n),l}nE(t,e,i){let n=9999999;if(null===t||t.length<2||null===e||e.length<2)return n;let s=0,o=0;for(;s<t.length&&o<e.length;){const r=t[s],a=e[o],l=a.x;let h=a.y;h+=i;let u=r;s+1<t.length&&(u=t[s+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,f+=i);let g=n;r.x===l?g=h-r.y:r.x>l&&r.x<d?g=h+(r.x-l)/(d-l)*(f-h)-r.y:l>r.x&&l<u.x&&(g=h-(r.y+(l-r.x)/(u.x-r.x)*(u.y-r.y))),g<n&&(n=g),u.x<=r.x?s++:d<=l?o++:(u.x<=d&&s++,d<=u.x&&o++)}return n}iE(t,e,i){let n=9999999;if(null===t||t.length<2||null===e||e.length<2)return n;let s=0,o=0;for(;s<t.length&&o<e.length;){const r=t[s],a=e[o];let l=a.x;const h=a.y;l+=i;let u=r;s+1<t.length&&(u=t[s+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,d+=i);let g=n;r.y===h?g=l-r.x:r.y>h&&r.y<f?g=l+(r.y-h)/(f-h)*(d-l)-r.x:h>r.y&&h<u.y&&(g=l-(r.x+(h-r.y)/(u.y-r.y)*(u.x-r.x))),g<n&&(n=g),u.y<=r.y?s++:f<=h?o++:(u.y<=f&&s++,f<=u.y&&o++)}return n}ae(t){const e=this.pk[t];if(void 0!==e){const t=e.pop();if(void 0!==t)return t}const i=[];for(let n=0;n<t;n++)i[n]=new y;return i}_s(t){if(!t)return;const e=t.length;let i=this.pk[e];void 0===i&&(i=[],this.pk[e]=i),i.push(t)}arrangeTrees(){if(52===this.Xi){const t=this.Fi.iterator;for(;t.next();){const e=t.value;if(!(e instanceof Si))continue;const i=e.node;if(null===i)continue;const n=i.position;let s=n.x,o=n.y;isFinite(s)||(s=0),isFinite(o)||(o=0),this.hC(e,s,o)}}else{const t=[],e=this.Fi.iterator;for(;e.next();){const i=e.value;i instanceof Si&&t.push(i)}switch(this.sorting){default:case 10:break;case 11:t.reverse();break;case 12:t.sort(this.comparer);break;case 13:t.sort(this.comparer),t.reverse()}const i=this.arrangementOrigin;let n=i.x,s=i.y;for(let o=0;o<t.length;o++){const e=t[o];if(50===(this.hC(e,n+e.lt.x,s+e.lt.y),this.Xi))s+=e.ut.height+this.Ms.height;else n+=e.ut.width+this.Ms.width}}}hC(t,e,i){if(null===t)return;t.x=e,t.y=i;const n=t.children,s=n.length;for(let o=0;o<s;o++){const t=n[o];this.hC(t,e+t.O.x,i+t.O.y)}}commitLayout(){this.Vy(),this.commitNodes(),this.iC(),this.isRouting&&this.commitLinks()}commitNodes(){const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();for(t.reset();t.next();){const e=t.value;this.layoutComments(e)}}iC(){if(62!==this.layerStyle)return;const t=this.eC,e=[];let i=null;const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;null===i?i=t.bounds.copy():i.unionRect(t.bounds);let s=e[t.level];s=void 0===s?this.computeLayerSpacing(t):Math.max(s,this.computeLayerSpacing(t)),e[t.level]=s}for(let l=0;l<e.length;l++)void 0===e[l]&&(e[l]=0);let s;90===this.angle||270===this.angle?(i.inflate(this.nodeSpacing/2,this.layerSpacing),s=new y(-this.nodeSpacing/2,-this.layerSpacing/2)):(i.inflate(this.layerSpacing,this.nodeSpacing/2),s=new y(-this.layerSpacing/2,-this.nodeSpacing/2));const o=[],r=90===this.angle||270===this.angle?i.width:i.height;let a=0;if(180===this.angle||270===this.angle)for(let l=0;l<t.length;l++)a+=t[l]+e[l];for(let l=0;l<t.length;l++){const i=t[l]+e[l];270===this.angle?(a-=i,o.push(new v(0,a,r,i))):90===this.angle?(o.push(new v(0,a,r,i)),a+=i):180===this.angle?(a-=i,o.push(new v(a,0,i,r))):(o.push(new v(a,0,i,r)),a+=i)}this.commitLayers(o,s)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}Vy(){const t=this.Fi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.GD(e)}}GD(t){if(null===t)return;this.setPortSpots(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.GD(t)}}setPortSpots(t){const e=t.alignment;if(this.isBusAlignment(e))this.lE(t,e);else{const e=this.orthoAngle(t);if(1===this.ls){const i=t.destinationEdges;for(;i.next();){const n=i.value.link;if(null!==n){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:n.fromSpot=w.MiddleRight;break;case 90:n.fromSpot=w.MiddleBottom;break;case 180:n.fromSpot=w.MiddleLeft;break;default:n.fromSpot=w.MiddleTop}else n.fromSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:n.toSpot=w.MiddleLeft;break;case 90:n.toSpot=w.MiddleTop;break;case 180:n.toSpot=w.MiddleRight;break;default:n.toSpot=w.MiddleBottom}else n.toSpot=t.childPortSpot}}}else{const i=t.sourceEdges;for(;i.next();){const n=i.value.link;if(null!==n){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:n.toSpot=w.MiddleRight;break;case 90:n.toSpot=w.MiddleBottom;break;case 180:n.toSpot=w.MiddleLeft;break;default:n.toSpot=w.MiddleTop}else n.toSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:n.fromSpot=w.MiddleLeft;break;case 90:n.fromSpot=w.MiddleTop;break;case 180:n.fromSpot=w.MiddleRight;break;default:n.fromSpot=w.MiddleBottom}else n.fromSpot=t.childPortSpot}}}}}lE(t,e){const i=1===this.ls,n=this.orthoAngle(t);let s;switch(n){case 0:s=w.MiddleRight;break;case 90:s=w.MiddleBottom;break;case 180:s=w.MiddleLeft;break;default:s=w.MiddleTop}const o=t.children,r=o.length;switch(e){case 24:case 25:for(let e=0;e<r;e++){const a=o[e],l=(i?a.sourceEdges:a.destinationEdges).first();if(null===l)continue;const h=l.link;if(null!==h){let o=90===n||270===n?w.MiddleLeft:w.MiddleTop;if(1===r||e===r-1&&r%2===1)switch(n){case 0:o=w.MiddleLeft;break;case 90:o=w.MiddleTop;break;case 180:o=w.MiddleRight;break;default:o=w.MiddleBottom}else e%2===0&&(o=90===n||270===n?w.MiddleRight:w.MiddleBottom);i?(t.setsPortSpot&&(h.fromSpot=s),t.setsChildPortSpot&&(h.toSpot=o)):(t.setsPortSpot&&(h.fromSpot=o),t.setsChildPortSpot&&(h.toSpot=s))}}break;case 26:{const e=90===n||270===n?w.MiddleRight:w.MiddleBottom,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const n=o.value.link;null!==n&&(i?(t.setsPortSpot&&(n.fromSpot=s),t.setsChildPortSpot&&(n.toSpot=e)):(t.setsPortSpot&&(n.fromSpot=e),t.setsChildPortSpot&&(n.toSpot=s)))}break}case 27:{const e=90===n||270===n?w.MiddleLeft:w.MiddleTop,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const n=o.value.link;null!==n&&(i?(t.setsPortSpot&&(n.fromSpot=s),t.setsChildPortSpot&&(n.toSpot=e)):(t.setsPortSpot&&(n.fromSpot=e),t.setsChildPortSpot&&(n.toSpot=s)))}break}}}orthoAngle(t){const e=t.angle;return e<=45?0:e<=135?90:e<=225?180:e<=315?270:0}computeLayerSpacing(t){const e=this.orthoAngle(t),i=90===e||270===e;let n=t.layerSpacing;if(t.layerSpacingParentOverlap>0){const e=Math.min(1,t.layerSpacingParentOverlap);n-=i?t.height*e:t.width*e}return n<(i?-t.height:-t.width)&&(n=i?-t.height:-t.width),n}computeNodeIndent(t){const e=this.orthoAngle(t),i=90===e||270===e;let n=t.nodeIndent;if(t.nodeIndentPastParent>0){const e=Math.min(1,t.nodeIndentPastParent);n+=i?t.width*e:t.height*e}return n=Math.max(0,n),n}get roots(){return this.Fi}set roots(t){this.Fi!==t&&(this.Fi=t,this.invalidateLayout())}get path(){return this.Li}set path(t){this.Li!==t&&(this.Li=t,this.invalidateLayout())}get treeStyle(){return this._f}set treeStyle(t){this._f!==t&&(40===t||42===t||41===t||43===t)&&(this._f=t,this.invalidateLayout())}get layerStyle(){return this.Ng}set layerStyle(t){this.Ng!==t&&(60===t||61===t||62===t)&&(this.Ng=t,this.invalidateLayout())}get comments(){return this.Fe}set comments(t){this.Fe!==t&&(e.s(t,"boolean",wi,"comments"),this.Fe=t,this.invalidateLayout())}get arrangement(){return this.Xi}set arrangement(t){this.Xi!==t&&(50===t||51===t||52===t)&&(this.Xi=t,this.invalidateLayout())}get arrangementSpacing(){return this.Ms}set arrangementSpacing(t){this.Ms.equals(t)||(this.Ms.a(t),this.invalidateLayout())}get rootDefaults(){return this.B}set rootDefaults(t){this.B!==t&&(this.B=t,this.invalidateLayout())}get alternateDefaults(){return this.U}set alternateDefaults(t){this.U!==t&&(this.U=t,this.invalidateLayout())}get sorting(){return this.B.sorting}set sorting(t){this.B.sorting!==t&&(this.B.sorting=t,this.invalidateLayout())}get comparer(){return this.B.comparer}set comparer(t){this.B.comparer!==t&&(e.k(t,wi,"comparer"),this.B.comparer=t,this.invalidateLayout())}get angle(){return this.B.angle}set angle(t){this.B.angle!==t&&(e.s(t,"number",wi,"angle"),0===t||90===t||180===t||270===t?(this.B.angle=t,this.invalidateLayout()):e.o("TreeLayout.angle must be 0, 90, 180, or 270"))}get alignment(){return this.B.alignment}set alignment(t){this.B.alignment!==t&&(this.B.alignment=t,this.invalidateLayout())}get nodeIndent(){return this.B.nodeIndent}set nodeIndent(t){this.B.nodeIndent!==t&&(e.s(t,"number",wi,"nodeIndent"),t>=0&&(this.B.nodeIndent=t,this.invalidateLayout()))}get nodeIndentPastParent(){return this.B.nodeIndentPastParent}set nodeIndentPastParent(t){this.B.nodeIndentPastParent!==t&&(e.s(t,"number",wi,"nodeIndentPastParent"),t>=0&&t<=1&&(this.B.nodeIndentPastParent=t,this.invalidateLayout()))}get nodeSpacing(){return this.B.nodeSpacing}set nodeSpacing(t){this.B.nodeSpacing!==t&&(e.s(t,"number",wi,"nodeSpacing"),this.B.nodeSpacing=t,this.invalidateLayout())}get layerSpacing(){return this.B.layerSpacing}set layerSpacing(t){this.B.layerSpacing!==t&&(e.s(t,"number",wi,"layerSpacing"),this.B.layerSpacing=t,this.invalidateLayout())}get layerSpacingParentOverlap(){return this.B.layerSpacingParentOverlap}set layerSpacingParentOverlap(t){this.B.layerSpacingParentOverlap!==t&&(e.s(t,"number",wi,"layerSpacingParentOverlap"),t>=0&&t<=1&&(this.B.layerSpacingParentOverlap=t,this.invalidateLayout()))}get compaction(){return this.B.compaction}set compaction(t){this.B.compaction!==t&&(30===t||31===t)&&(this.B.compaction=t,this.invalidateLayout())}get breadthLimit(){return this.B.breadthLimit}set breadthLimit(t){this.B.breadthLimit!==t&&(e.s(t,"number",wi,"breadthLimit"),t>=0&&(this.B.breadthLimit=t,this.invalidateLayout()))}get rowSpacing(){return this.B.rowSpacing}set rowSpacing(t){this.B.rowSpacing!==t&&(e.s(t,"number",wi,"rowSpacing"),this.B.rowSpacing=t,this.invalidateLayout())}get rowIndent(){return this.B.rowIndent}set rowIndent(t){this.B.rowIndent!==t&&(e.s(t,"number",wi,"rowIndent"),t>=0&&(this.B.rowIndent=t,this.invalidateLayout()))}get commentSpacing(){return this.B.commentSpacing}set commentSpacing(t){this.B.commentSpacing!==t&&(e.s(t,"number",wi,"commentSpacing"),this.B.commentSpacing=t,this.invalidateLayout())}get commentMargin(){return this.B.commentMargin}set commentMargin(t){this.B.commentMargin!==t&&(e.s(t,"number",wi,"commentMargin"),this.B.commentMargin=t,this.invalidateLayout())}get setsPortSpot(){return this.B.setsPortSpot}set setsPortSpot(t){this.B.setsPortSpot!==t&&(e.s(t,"boolean",wi,"setsPortSpot"),this.B.setsPortSpot=t,this.invalidateLayout())}get portSpot(){return this.B.portSpot}set portSpot(t){this.B.portSpot.equals(t)||(this.B.portSpot=t,this.invalidateLayout())}get setsChildPortSpot(){return this.B.setsChildPortSpot}set setsChildPortSpot(t){this.B.setsChildPortSpot!==t&&(e.s(t,"boolean",wi,"setsChildPortSpot"),this.B.setsChildPortSpot=t,this.invalidateLayout())}get childPortSpot(){return this.B.childPortSpot}set childPortSpot(t){this.B.childPortSpot.equals(t)||(this.B.childPortSpot=t,this.invalidateLayout())}get alternateSorting(){return this.U.sorting}set alternateSorting(t){this.U.sorting!==t&&(this.U.sorting=t,this.invalidateLayout())}get alternateComparer(){return this.U.comparer}set alternateComparer(t){this.U.comparer!==t&&(e.k(t,wi,"alternateComparer"),this.U.comparer=t,this.invalidateLayout())}get alternateAngle(){return this.U.angle}set alternateAngle(t){this.U.angle!==t&&(e.s(t,"number",wi,"alternateAngle"),(0===t||90===t||180===t||270===t)&&(this.U.angle=t,this.invalidateLayout()))}get alternateAlignment(){return this.U.alignment}set alternateAlignment(t){this.U.alignment!==t&&(this.U.alignment=t,this.invalidateLayout())}get alternateNodeIndent(){return this.U.nodeIndent}set alternateNodeIndent(t){this.U.nodeIndent!==t&&(e.s(t,"number",wi,"alternateNodeIndent"),t>=0&&(this.U.nodeIndent=t,this.invalidateLayout()))}get alternateNodeIndentPastParent(){return this.U.nodeIndentPastParent}set alternateNodeIndentPastParent(t){this.U.nodeIndentPastParent!==t&&(e.s(t,"number",wi,"alternateNodeIndentPastParent"),t>=0&&t<=1&&(this.U.nodeIndentPastParent=t,this.invalidateLayout()))}get alternateNodeSpacing(){return this.U.nodeSpacing}set alternateNodeSpacing(t){this.U.nodeSpacing!==t&&(e.s(t,"number",wi,"alternateNodeSpacing"),this.U.nodeSpacing=t,this.invalidateLayout())}get alternateLayerSpacing(){return this.U.layerSpacing}set alternateLayerSpacing(t){this.U.layerSpacing!==t&&(e.s(t,"number",wi,"alternateLayerSpacing"),this.U.layerSpacing=t,this.invalidateLayout())}get alternateLayerSpacingParentOverlap(){return this.U.layerSpacingParentOverlap}set alternateLayerSpacingParentOverlap(t){this.U.layerSpacingParentOverlap!==t&&(e.s(t,"number",wi,"alternateLayerSpacingParentOverlap"),t>=0&&t<=1&&(this.U.layerSpacingParentOverlap=t,this.invalidateLayout()))}get alternateCompaction(){return this.U.compaction}set alternateCompaction(t){this.U.compaction!==t&&(30===t||31===t)&&(this.U.compaction=t,this.invalidateLayout())}get alternateBreadthLimit(){return this.U.breadthLimit}set alternateBreadthLimit(t){this.U.breadthLimit!==t&&(e.s(t,"number",wi,"alternateBreadthLimit"),t>=0&&(this.U.breadthLimit=t,this.invalidateLayout()))}get alternateRowSpacing(){return this.U.rowSpacing}set alternateRowSpacing(t){this.U.rowSpacing!==t&&(e.s(t,"number",wi,"alternateRowSpacing"),this.U.rowSpacing=t,this.invalidateLayout())}get alternateRowIndent(){return this.U.rowIndent}set alternateRowIndent(t){this.U.rowIndent!==t&&(e.s(t,"number",wi,"alternateRowIndent"),t>=0&&(this.U.rowIndent=t,this.invalidateLayout()))}get alternateCommentSpacing(){return this.U.commentSpacing}set alternateCommentSpacing(t){this.U.commentSpacing!==t&&(e.s(t,"number",wi,"alternateCommentSpacing"),this.U.commentSpacing=t,this.invalidateLayout())}get alternateCommentMargin(){return this.U.commentMargin}set alternateCommentMargin(t){this.U.commentMargin!==t&&(e.s(t,"number",wi,"alternateCommentMargin"),this.U.commentMargin=t,this.invalidateLayout())}get alternateSetsPortSpot(){return this.U.setsPortSpot}set alternateSetsPortSpot(t){this.U.setsPortSpot!==t&&(e.s(t,"boolean",wi,"alternateSetsPortSpot"),this.U.setsPortSpot=t,this.invalidateLayout())}get alternatePortSpot(){return this.U.portSpot}set alternatePortSpot(t){this.U.portSpot.equals(t)||(this.U.portSpot=t,this.invalidateLayout())}get alternateSetsChildPortSpot(){return this.U.setsChildPortSpot}set alternateSetsChildPortSpot(t){this.U.setsChildPortSpot!==t&&(e.s(t,"boolean",wi,"alternateSetsChildPortSpot"),this.U.setsChildPortSpot=t,this.invalidateLayout())}get alternateChildPortSpot(){return this.U.childPortSpot}set alternateChildPortSpot(t){this.U.childPortSpot.equals(t)||(this.U.childPortSpot=t,this.invalidateLayout())}static PathDefault=0;static PathDestination=1;static PathSource=2;static SortingForwards=10;static SortingReverse=11;static SortingAscending=12;static SortingDescending=13;static AlignmentCenterSubtrees=20;static AlignmentCenterChildren=21;static AlignmentStart=22;static AlignmentEnd=23;static AlignmentBus=24;static AlignmentBusBranching=25;static AlignmentTopLeftBus=26;static AlignmentBottomRightBus=27;static CompactionNone=30;static CompactionBlock=31;static StyleLayered=40;static StyleLastParents=41;static StyleAlternating=42;static StyleRootOnly=43;static ArrangementVertical=50;static ArrangementHorizontal=51;static ArrangementFixedRoots=52;static LayerIndividual=60;static LayerSiblings=61;static LayerUniform=62}class ki extends Ae{constructor(t){super(t)}createVertex(){return new Si(this)}createEdge(){return new Pi(this)}}class Si extends De{O;ut;lt;bk;kk;Pk;Sk;Mk;Nk;Ck;Fe;Cg;Lg;pe;ye;Yt;hi;Jy;$y;Zy;Ns;Qy;_y;tw;iw;ew;nw;ow;lw;hw;aw;cw;constructor(t){super(t),this.bk=!1,this.kk=null,this.Pk=[],this.Sk=0,this.Mk=0,this.Nk=0,this.Ck=0,this.Fe=null,this.O=new y(0,0),this.ut=new x(0,0),this.lt=new y(0,0),this.Cg=null,this.Lg=null,this.pe=10,this.ye=De.standardComparer,this.Yt=0,this.hi=21,this.Jy=0,this.$y=0,this.Zy=20,this.Ns=50,this.Qy=0,this._y=31,this.tw=0,this.iw=25,this.ew=10,this.nw=10,this.ow=20,this.lw=!0,this.hw=w.Default,this.aw=!0,this.cw=w.Default}copyInheritedPropertiesFrom(t){null!==t&&(this.pe=t.sorting,this.ye=t.comparer,this.Yt=t.angle,this.hi=t.alignment,this.Jy=t.nodeIndent,this.$y=t.nodeIndentPastParent,this.Zy=t.nodeSpacing,this.Ns=t.layerSpacing,this.Qy=t.layerSpacingParentOverlap,this._y=t.compaction,this.tw=t.breadthLimit,this.iw=t.rowSpacing,this.ew=t.rowIndent,this.nw=t.commentSpacing,this.ow=t.commentMargin,this.lw=t.setsPortSpot,this.hw=t.portSpot,this.aw=t.setsChildPortSpot,this.cw=t.childPortSpot)}get initialized(){return this.bk}set initialized(t){this.bk!==t&&(e.s(t,"boolean",Si,"initialized"),this.bk=t)}get parent(){return this.kk}set parent(t){this.kk!==t&&(this.kk=t)}get children(){return this.Pk}set children(t){if(this.Pk!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Si,"children:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.Pk=t}}get level(){return this.Sk}set level(t){this.Sk!==t&&(e.s(t,"number",Si,"level"),this.Sk=t)}get descendantCount(){return this.Mk}set descendantCount(t){this.Mk!==t&&(e.s(t,"number",Si,"descendantCount"),this.Mk=t)}get maxChildrenCount(){return this.Nk}set maxChildrenCount(t){this.Nk!==t&&(e.s(t,"number",Si,"maxChildrenCount"),this.Nk=t)}get maxGenerationCount(){return this.Ck}set maxGenerationCount(t){this.Ck!==t&&(e.s(t,"number",Si,"maxGenerationCount"),this.Ck=t)}get comments(){return this.Fe}set comments(t){if(this.Fe!==t){if(null!==t&&!Array.isArray(t)&&e.Zi(t,"Array",Si,"comments:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.Fe=t}}get sorting(){return this.pe}set sorting(t){this.pe!==t&&(this.pe=t)}get comparer(){return this.ye}set comparer(t){this.ye!==t&&(e.k(t,Si,"comparer"),this.ye=t)}get angle(){return this.Yt}set angle(t){this.Yt!==t&&(e.s(t,"number",Si,"angle"),this.Yt=t)}get alignment(){return this.hi}set alignment(t){this.hi!==t&&(this.hi=t)}get nodeIndent(){return this.Jy}set nodeIndent(t){this.Jy!==t&&(e.s(t,"number",Si,"nodeIndent"),this.Jy=t)}get nodeIndentPastParent(){return this.$y}set nodeIndentPastParent(t){this.$y!==t&&(e.s(t,"number",Si,"nodeIndentPastParent"),this.$y=t)}get nodeSpacing(){return this.Zy}set nodeSpacing(t){this.Zy!==t&&(e.s(t,"number",Si,"nodeSpacing"),this.Zy=t)}get layerSpacing(){return this.Ns}set layerSpacing(t){this.Ns!==t&&(e.s(t,"number",Si,"layerSpacing"),this.Ns=t)}get layerSpacingParentOverlap(){return this.Qy}set layerSpacingParentOverlap(t){this.Qy!==t&&(e.s(t,"number",Si,"layerSpacingParentOverlap"),this.Qy=t)}get compaction(){return this._y}set compaction(t){this._y!==t&&(this._y=t)}get breadthLimit(){return this.tw}set breadthLimit(t){this.tw!==t&&(e.s(t,"number",Si,"breadthLimit"),this.tw=t)}get rowSpacing(){return this.iw}set rowSpacing(t){this.iw!==t&&(e.s(t,"number",Si,"rowSpacing"),this.iw=t)}get rowIndent(){return this.ew}set rowIndent(t){this.ew!==t&&(e.s(t,"number",Si,"rowIndent"),this.ew=t)}get commentSpacing(){return this.nw}set commentSpacing(t){this.nw!==t&&(e.s(t,"number",Si,"commentSpacing"),this.nw=t)}get commentMargin(){return this.ow}set commentMargin(t){this.ow!==t&&(e.s(t,"number",Si,"commentMargin"),this.ow=t)}get setsPortSpot(){return this.lw}set setsPortSpot(t){this.lw!==t&&(e.s(t,"boolean",Si,"setsPortSpot"),this.lw=t)}get portSpot(){return this.hw}set portSpot(t){this.hw.equals(t)||(this.hw=t)}get setsChildPortSpot(){return this.aw}set setsChildPortSpot(t){this.aw!==t&&(e.s(t,"boolean",Si,"setsChildPortSpot"),this.aw=t)}get childPortSpot(){return this.cw}set childPortSpot(t){this.cw.equals(t)||(this.cw=t)}get childrenCount(){return this.children.length}get relativePosition(){return this.O}set relativePosition(t){this.O.set(t)}get subtreeSize(){return this.ut}set subtreeSize(t){this.ut.set(t)}get subtreeOffset(){return this.lt}set subtreeOffset(t){this.lt.set(t)}}class Pi extends Fe{Lk;constructor(t){super(t),this.Lk=new y(0,0)}commit(){const t=this.link;if(null===t||t.isAvoiding)return;const i=this.network.layout;let n=null,s=null;switch(i.ls){case 1:n=this.fromVertex,s=this.toVertex;break;case 2:n=this.toVertex,s=this.fromVertex;break;default:e.o("Unhandled path value "+i.ls.toString())}if(null===n||null===s)return;const o=this.Lk;if(0===o.x&&0===o.y)return void this.hE(n,s);const r=n.bounds,a=i.orthoAngle(n),l=i.computeLayerSpacing(n),h=n.rowSpacing;t.updateRoute();const u=9===t.curve,c=t.isOrthogonal;let d,f,g=0;if(t.startRoute(),c||u){for(g=2;t.pointsCount>4;)t.removePoint(2);d=t.getPoint(1),f=t.getPoint(2)}else{for(g=1;t.pointsCount>3;)t.removePoint(1);d=t.getPoint(0),f=t.getPoint(t.pointsCount-1)}const p=t.getPoint(t.pointsCount-1);let m=0;0===a?(23===n.alignment?(m=r.bottom+o.y,0===o.y&&d.y>p.y+n.rowIndent&&(m=Math.min(m,Math.max(d.y,m-i.computeNodeIndent(n))))):22===n.alignment?(m=r.top+o.y,0===o.y&&d.y<p.y-n.rowIndent&&(m=Math.max(m,Math.min(d.y,m+i.computeNodeIndent(n))))):m=r.y+r.height/2+o.y,u?(t.insertPointAt(g,d.x,m),g++,t.insertPointAt(g,r.right+l,m),g++,t.insertPointAt(g,r.right+l+(o.x-h)/3,m),g++,t.insertPointAt(g,r.right+l+2*(o.x-h)/3,m),g++,t.insertPointAt(g,r.right+l+(o.x-h),m),g++,t.insertPointAt(g,f.x,m),g++):(c&&(t.insertPointAt(g,r.right+l/2,d.y),g++),t.insertPointAt(g,r.right+l/2,m),g++,t.insertPointAt(g,r.right+l+o.x-(c?h/2:h),m),g++,c&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):90===a?(23===n.alignment?(m=r.right+o.x,0===o.x&&d.x>p.x+n.rowIndent&&(m=Math.min(m,Math.max(d.x,m-i.computeNodeIndent(n))))):22===n.alignment?(m=r.left+o.x,0===o.x&&d.x<p.x-n.rowIndent&&(m=Math.max(m,Math.min(d.x,m+i.computeNodeIndent(n))))):m=r.x+r.width/2+o.x,u?(t.insertPointAt(g,m,d.y),g++,t.insertPointAt(g,m,r.bottom+l),g++,t.insertPointAt(g,m,r.bottom+l+(o.y-h)/3),g++,t.insertPointAt(g,m,r.bottom+l+2*(o.y-h)/3),g++,t.insertPointAt(g,m,r.bottom+l+(o.y-h)),g++,t.insertPointAt(g,m,f.y),g++):(c&&(t.insertPointAt(g,d.x,r.bottom+l/2),g++),t.insertPointAt(g,m,r.bottom+l/2),g++,t.insertPointAt(g,m,r.bottom+l+o.y-(c?h/2:h)),g++,c&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):180===a?(23===n.alignment?(m=r.bottom+o.y,0===o.y&&d.y>p.y+n.rowIndent&&(m=Math.min(m,Math.max(d.y,m-i.computeNodeIndent(n))))):22===n.alignment?(m=r.top+o.y,0===o.y&&d.y<p.y-n.rowIndent&&(m=Math.max(m,Math.min(d.y,m+i.computeNodeIndent(n))))):m=r.y+r.height/2+o.y,u?(t.insertPointAt(g,d.x,m),g++,t.insertPointAt(g,r.left-l,m),g++,t.insertPointAt(g,r.left-l+(o.x+h)/3,m),g++,t.insertPointAt(g,r.left-l+2*(o.x+h)/3,m),g++,t.insertPointAt(g,r.left-l+(o.x+h),m),g++,t.insertPointAt(g,f.x,m),g++):(c&&(t.insertPointAt(g,r.left-l/2,d.y),g++),t.insertPointAt(g,r.left-l/2,m),g++,t.insertPointAt(g,r.left-l+o.x+(c?h/2:h),m),g++,c&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):270===a?(23===n.alignment?(m=r.right+o.x,0===o.x&&d.x>p.x+n.rowIndent&&(m=Math.min(m,Math.max(d.x,m-i.computeNodeIndent(n))))):22===n.alignment?(m=r.left+o.x,0===o.x&&d.x<p.x-n.rowIndent&&(m=Math.max(m,Math.min(d.x,m+i.computeNodeIndent(n))))):m=r.x+r.width/2+o.x,u?(t.insertPointAt(g,m,d.y),g++,t.insertPointAt(g,m,r.top-l),g++,t.insertPointAt(g,m,r.top-l+(o.y+h)/3),g++,t.insertPointAt(g,m,r.top-l+2*(o.y+h)/3),g++,t.insertPointAt(g,m,r.top-l+(o.y+h)),g++,t.insertPointAt(g,m,f.y),g++):(c&&(t.insertPointAt(g,d.x,r.top-l/2),g++),t.insertPointAt(g,m,r.top-l/2),g++,t.insertPointAt(g,m,r.top-l+o.y+(c?h/2:h)),g++,c&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):e.o("Invalid angle "+a),t.commitRoute()}hE(t,e){const i=this.link;if(null===i)return;const n=this.network.layout,s=n.orthoAngle(t);if(s===n.orthoAngle(e))return;const o=n.computeLayerSpacing(t),r=t.bounds,a=e.bounds;if(0===s&&a.left-r.right<o+1||90===s&&a.top-r.bottom<o+1||180===s&&r.left-a.right<o+1||270===s&&r.top-a.bottom<o+1)return;i.updateRoute();const l=9===i.curve,h=i.isOrthogonal,u=this.fromVertex,c=n.isBusAlignment(u.alignment);if(i.startRoute(),0===s){const t=r.right+o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t-20,i.getPoint(1).y),i.insertPointAt(2,t-20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t+20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(90===s){const t=r.bottom+o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t-20),i.insertPointAt(2,e,t-20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t+20),i.setPointAt(5,e,i.getPoint(5).y)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}else if(180===s){const t=r.left-o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t+20,i.getPoint(1).y),i.insertPointAt(2,t+20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t-20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(270===s){const t=r.top-o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t+20),i.insertPointAt(2,e,t+20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t-20),i.setPointAt(5,e,i.getPoint(5).y)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}i.commitRoute()}get fromVertex(){return this.je}set fromVertex(t){this.je!==t&&(this.je=t)}get toVertex(){return this.qe}set toVertex(t){this.qe!==t&&(this.qe=t)}get relativePoint(){return this.Lk}set relativePoint(t){this.Lk.set(t)}}class Mi{constructor(){}static Light=(()=>({colors:{text:"#0a0a0a",comment:"#ca8a04",link:"#0a0a0a",group:"#a3a3a344",outline:"#a3a3a3",selection:"#0ea5e9",div:"#fff",gridMinor:"#e5e5e5",gridMajor:"#a3a3a3",overviewBox:"#c026d3",tempLink:"#2563eb",tempPort:"#c026d3",adornmentFill:"#0ea5e9",adornmentStroke:"#1e40af",dragSelect:"#c026d3"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new b(5)},arrowheads:{toArrow:"Standard"}}))();static Dark=(()=>({colors:{text:"#f5f5f5",comment:"#facc15",link:"#f5f5f5",group:"#a3a3a388",outline:"#a3a3a3",selection:"#38bdf8",div:"#171717",gridMinor:"#262626",gridMajor:"#404040",overviewBox:"#e879f9",tempLink:"#60a5fa",tempPort:"#e879f9",adornmentFill:"#38bdf8",adornmentStroke:"#2563eb",dragSelect:"#e879f9"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new b(5)},arrowheads:{toArrow:"Standard"}}))()}class Ci{ts=(()=>new Set)();iu=(()=>new m)();Ak="light";Tk="light";Dk=!1;Ag="light";HD=t=>{const e=t.matches?"dark":"light";e!==this.Ag&&(this.Ag=e,"system"===this.Tk&&this.fw())};constructor(e){e&&Object.assign(this,e),e?.themeMap||(this.iu.set("light",{colors:{...Mi.Light.colors},fonts:{...Mi.Light.fonts},numbers:{...Mi.Light.numbers},margins:{...Mi.Light.margins},arrowheads:{...Mi.Light.arrowheads}}),this.iu.set("dark",{colors:{...Mi.Dark.colors},fonts:{...Mi.Dark.fonts},numbers:{...Mi.Dark.numbers},margins:{...Mi.Dark.margins},arrowheads:{...Mi.Dark.arrowheads}})),t.matchMedia&&(this.Ag=t.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}get themeMap(){return this.iu}set themeMap(t){this.iu!==t&&(this.iu=t,this.fw())}get defaultTheme(){return this.Ak}set defaultTheme(t){this.Ak!==t&&(e.s(t,"string",Ci,"defaultTheme"),this.Ak=t,this.fw())}get currentTheme(){return this.Tk}set currentTheme(t){this.Tk!==t&&(e.s(t,"string",Ci,"currentTheme"),this.Tk=t,this.fw())}get changesDivBackground(){return this.Dk}set changesDivBackground(t){if(this.Dk!==t&&(this.Dk=t,t))for(const e of this.ts)e.setDivBackground(this.findValue("div","","fill")),e.D("ThemeChanged",this)}get preferredColorScheme(){return this.Ag}addDiagram(t){return this.ts.add(t),this.aC(t),this}removeDiagram(t){return this.ts.delete(t),this.aC(t),this}lR(){0===this.ts.size&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)")?.addEventListener("change",this.HD)}hR(){0===this.ts.size&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)")?.removeEventListener("change",this.HD)}set(t,e){""===t&&(t=this.Ak),"system"===t&&(t=this.Ag);let i=this.iu.get(t);return i=i?this.jD(i,e):e,this.iu.set(t,i),this.fw(),this}findValue(t,e,i){return this.getValue(this.findTheme(this.currentTheme),t,e,i)||this.getValue(this.findTheme(this.defaultTheme),t,e,i)}getValue(t,e,i,n){if(!t)return;null==i&&(i="");let s=t;const o=t=>{if(void 0===s||""===t)return;if("number"==typeof t||!Array.isArray(t)&&!t.includes("."))return s[t];const e=Array.isArray(t)?t:t.split(".");for(let i=0;i<e.length;i++){const t=e[i];if(""!==t&&(s=s[t],void 0===s))return}return s},r=()=>{if(""===i||(s=o(i),void 0!==s))return s=Array.isArray(s)&&"number"==typeof e?s[e%s.length]:o(e),s};if(s=r(),void 0===s&&"string"==typeof n&&n.length>0){let e=t.targetPropertyMap?.get(n);if(e?s=t[e]:(e=Ci.aE.get(n),s=e?t[e]:t.colors),s=r(),void 0!==s)return s}return s}findTheme(t){return this.themeMap.get("system"===t?this.Ag:t)}aC(t){const e=t.skipsUndoManager;t.skipsUndoManager=!0,t.updateAllThemeBindings(),this.Dk&&t.setDivBackground(this.findValue("div","","fill")),t.skipsUndoManager=e,t.D("ThemeChanged",this)}fw(){for(const t of this.ts)this.aC(t)}jD(t,i){for(const n in i)if(e.uw(i,n))try{i[n].constructor===Object?t[n]=this.jD(t[n]??{},i[n]):t[n]=i[n]}catch{delete t[n]}return t}static aE=(()=>new Map([["background","colors"],["defaultColumnSeparatorStroke","colors"],["defaultRowSeparatorStroke","colors"],["shadowColor","colors"],["fill","colors"],["stroke","colors"],["font","fonts"],["angle","numbers"],["fromEndSegmentLength","numbers"],["fromShortLength","numbers"],["height","numbers"],["opacity","numbers"],["scale","numbers"],["toEndSegmentLength","numbers"],["toShortLength","numbers"],["width","numbers"],["defaultColumnSeparatorStrokeWidth","numbers"],["defaultRowSeparatorStrokeWidth","numbers"],["shadowBlur","numbers"],["corner","numbers"],["curviness","numbers"],["smoothness","numbers"],["parameter1","numbers"],["parameter2","numbers"],["strokeWidth","numbers"],["strokeDashOffset","numbers"],["maxLines","numbers"],["spacingAbove","numbers"],["spacingBelow","numbers"],["position","points"],["shadowOffset","points"],["desiredSize","sizes"],["maxSize","sizes"],["minSize","sizes"],["margin","margins"],["defaultSeparatorPadding","margins"],["padding","margins"],["alignment","spots"],["alignmentFocus","spots"],["fromSpot","spots"],["toSpot","spots"],["defaultAlignment","spots"],["spot1","spots"],["spot2","spots"],["verticalAlignment","spots"],["imageAlignment","spots"],["fromArrow","arrowheads"],["toArrow","arrowheads"]]))()}class Ni{Pt;N;Oi;al;constructor(){this.N=vt.um(),this.Pt="",this.Oi=!0,this.al=!0}get name(){return this.Pt}set name(t){this.Pt=t}get isEnabled(){return this.Oi}set isEnabled(t){this.Oi=t}get isRealtime(){return this.al}set isRealtime(t){this.al=t}get diagram(){return this.N}set diagram(t){this.N!==t&&(this.N=t,t.xl=!0,t.requestUpdate())}invalidateRouter(){null!==this.N&&(this.N.xl=!0,this.N.requestUpdate())}canRoute(t){if(!this.isEnabled)return!1;const e=this.diagram;return!(e&&(!this.isRealtime&&e.gu||e.animationManager.isTicking))}routeLinks(t,e){}toString(){return""!==this.name?this.name+" Router":e.Dn(this.constructor)}}class Ti extends Ni{constructor(t){super(),this.name="AvoidsNodes",t&&Object.assign(this,t)}canRoute(t){return!!(t instanceof vt?t.Vm:t.diagram.Vm)&&super.canRoute(t)}routeLinks(t,e){const i=e instanceof vt?null:e,n=t.iterator,s=this.diagram.getPositions(!0,i,null);for(;n.next();){const t=n.value;if(!t.isAvoiding||t.containingGroup!==i||null===t.toNode||null===t.fromNode||t.pointsCount<4)continue;t.startRoute();const e=t.pointsCount,o=t.getPoint(1),r=t.getPoint(e-2),a=t.fromNode.actualBounds.copy();a.inflate(be.Ba,be.Ba),a.unionPoint(t.getPoint(0));const l=t.toNode.actualBounds.copy();l.inflate(be.Ba,be.Ba),l.unionPoint(t.getPoint(e-1)),this.cE(t,a,l,s)&&this.fE(t,o,t.uN,r,t.dN,a,l,s),t.commitRoute()}}cE(t,e,i,n){const s=t.diagram,o=t.pointsCount;if(null===s||t.fromNode===t.toNode||t.layer.isTemporary||e.containsPoint(t.getPoint(o-1))&&!t.toNode.isMemberOf(t.fromNode)||i.containsPoint(t.getPoint(0))&&!t.fromNode.isMemberOf(t.toNode)||!t.isOrthogonal)return!1;if(17===t.segmentIndex)return!0;const r=t.getPoint(1),a=t.getPoint(o-2),l=t.getPoint(2);if(!n.isUnoccupied(Math.min(r.x,l.x),Math.min(r.y,l.y),Math.abs(r.x-l.x),Math.abs(r.y-l.y)))return!0;for(let u=2;u<o-3;u++){const e=t.getPoint(u),i=t.getPoint(u+1);if(!n.isUnoccupied(Math.min(e.x,i.x),Math.min(e.y,i.y),Math.abs(e.x-i.x),Math.abs(e.y-i.y)))return!0}const h=t.getPoint(o-3);return!n.isUnoccupied(Math.min(h.x,a.x),Math.min(h.y,a.y),Math.abs(h.x-a.x),Math.abs(h.y-a.y))}fE(t,e,i,n,s,o,r,a){const l=e,h=n;let u=null,c=null;if(t.diagram.isVirtualized){const o=a.bounds.copy(),r=t.getPoint(2),l=t.getPoint(t.pointsCount-3);o.inflate(-a.cellWidth,-a.cellHeight);const h=y.l();a.vd(e.x,e.y)||(S.dl(o.x,o.y,o.x+o.width,o.y+o.height,e.x,e.y,r.x,r.y,h)?(u=e=h.copy(),i=h.directionPoint(r)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,l.x,l.y,h)?(u=e=h.copy(),i=h.directionPoint(l)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,l.x,l.y,n.x,n.y,h)&&(u=e=h.copy(),i=h.directionPoint(n))),a.vd(n.x,n.y)||(S.dl(o.x,o.y,o.x+o.width,o.y+o.height,n.x,n.y,l.x,l.y,h)?(c=n=h.copy(),s=l.directionPoint(h)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,l.x,l.y,r.x,r.y,h)?(c=n=h.copy(),s=r.directionPoint(h)):S.dl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,e.x,e.y,h)&&(c=n=h.copy(),s=e.directionPoint(h))),y.e(h)}const d=o.copy().unionRect(r);d.inflate(a.cellWidth*a.Kc,a.cellHeight*a.Kc),a.NT(e,i,n,s,d,!0);let f=a.ro(n.x,n.y);if(!a.xy&&f>=ke.Rd&&(a.rA(),d.inflate(a.cellWidth*a.HM,a.cellHeight*a.jM),a.NT(e,i,n,s,d,!1),f=a.ro(n.x,n.y)),!a.xy&&f<ke.Rd&&!a.TO(n.x,n.y)){t.points.removeRange(2,t.pointsCount-3),this.cC(t,a,n.x,n.y,s,!0);const o=0,r=90,d=180,f=270,g=t.getPoint(2);if(t.pointsCount<4)i===o||i===d?(g.x=e.x,g.y=n.y):(g.x=n.x,g.y=e.y),t.setPointAt(2,g.x,g.y),t.insertPointAt(3,g.x,g.y);else{const n=t.getPoint(3);if(i===o||i===d)if(S.f(g.x,n.x)){const s=i===o?Math.max(g.x,e.x):Math.min(g.x,e.x);t.setPointAt(2,s,e.y),t.setPointAt(3,s,n.y)}else S.f(g.y,n.y)?(Math.abs(e.y-g.y)<=a.cellHeight/2&&(t.setPointAt(2,g.x,e.y),t.setPointAt(3,n.x,e.y)),t.insertPointAt(2,g.x,e.y)):t.setPointAt(2,e.x,g.y);else if(i===r||i===f)if(S.f(g.y,n.y)){const s=i===r?Math.max(g.y,e.y):Math.min(g.y,e.y);t.setPointAt(2,e.x,s),t.setPointAt(3,n.x,s)}else S.f(g.x,n.x)?(Math.abs(e.x-g.x)<=a.cellWidth/2&&(t.setPointAt(2,e.x,g.y),t.setPointAt(3,e.x,n.y)),t.insertPointAt(2,e.x,g.y)):t.setPointAt(2,g.x,e.y)}if(null!==u){const e=t.getPoint(1),n=t.getPoint(2);e.x!==n.x&&e.y!==n.y?i===o||i===d?t.insertPointAt(2,e.x,n.y):t.insertPointAt(2,n.x,e.y):i===o||i===d?t.insertPointAt(2,l.x,u.y):t.insertPointAt(2,u.x,l.y)}null!==c&&(s===o||s===d?t.insertPointAt(t.pointsCount-2,h.x,c.y):t.insertPointAt(t.pointsCount-2,c.x,h.y))}}cC(t,e,i,n,s,o){const r=e.cellWidth,a=e.cellHeight;let l=e.ro(i,n),h=i,u=n,c=h,d=u;for(0===s?c+=r:90===s?d+=a:180===s?c-=r:d-=a,t.pN&&l>ke.Xa&&e.ro(c,d)!==l-1&&(e.ro(h-r,u)===l-1?(s=180,c=h-r,d=u):e.ro(h+r,u)===l-1?(s=0,c=h+r,d=u):e.ro(h,u-a)===l-1?(s=270,c=h,d=u-a):e.ro(h,u+a)===l-1&&(s=90,c=h,d=u+a));l>ke.Xa&&e.ro(c,d)===l-1;)h=c,u=d,0===s?c+=r:90===s?d+=a:180===s?c-=r:d-=a,l-=1;if(o?l>ke.Xa&&(180===s||0===s?h=Math.floor(h/r)*r+r/2:(90===s||270===s)&&(u=Math.floor(u/a)*a+a/2)):(h=Math.floor(h/r)*r+r/2,u=Math.floor(u/a)*a+a/2),l>ke.Xa){let i=s,n=h,o=u;if(0===s?(i=90,o+=a):90===s?(i=180,n-=r):180===s?(i=270,o-=a):270===s&&(i=0,n+=r),e.ro(n,o)===l-1)this.cC(t,e,n,o,i,!1);else{let n=h,o=u;0===s?(i=270,o-=a):90===s?(i=0,n+=r):180===s?(i=90,o+=a):270===s&&(i=180,n-=r),e.ro(n,o)===l-1&&this.cC(t,e,n,o,i,!1)}}t.insertPointAt(t.pointsCount-2,h,u)}}V.prototype.initializeStandardTools=function(){this.Jt("Action",new J,this.mouseDownTools),this.Jt("Relinking",new Y,this.mouseDownTools),this.Jt("LinkReshaping",new H,this.mouseDownTools),this.Jt("Rotating",new W,this.mouseDownTools),this.Jt("Resizing",new _,this.mouseDownTools),this.Jt("Linking",new G,this.mouseMoveTools),this.Jt("Dragging",new U,this.mouseMoveTools),this.Jt("DragSelecting",new Q,this.mouseMoveTools),this.Jt("Panning",new tt,this.mouseMoveTools),this.Jt("ContextMenu",new nt,this.mouseUpTools),this.Jt("TextEditing",new at,this.mouseUpTools),this.Jt("ClickCreating",new Z,this.mouseUpTools),this.Jt("ClickSelecting",new $,this.mouseUpTools)},vt.NM("GraphLinksModel",class extends Ie{VM(){const t=this.diagram.model;this.Py(t.nodeDataArray),this.XT(t.linkDataArray)}Py(t){super.Py(t,!1);const e=this.links.iterator;for(;e.next();)e.value.Pd();this.diagram.Nb(!1)}XT(t){t.forEach((t=>{this.YT(t)})),this.diagram.Nb(!1)}YT(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.findLinkForData(t))return null;const e=this.getLinkCategoryForData(t),i=this.findLinkTemplateForCategory(e);if(null!==i){i.Et();const n=i.copy();if(null!==n){const i=this.diagram.fe;this.diagram.fe=!0,n.Vo=e,n._t=t;const s=this.diagram.model,o=s.O1(t,!0);""!==o&&(n.fromPortId=o);const r=s.Ae(t,!0);if(void 0!==r){const t=this.findNodeForKey(r);t instanceof pe&&(n.fromNode=t)}const a=s.O1(t,!1);""!==a&&(n.toPortId=a);const l=s.Ae(t,!1);if(void 0!==l){const t=this.findNodeForKey(l);t instanceof pe&&(n.toNode=t)}const h=s.getLabelKeysForLinkData(t);return Array.isArray(h)&&h.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=n)})),this.addsToTemporaryLayer&&(n.sl="Tool"),this.diagram.add(n),n._t=null,n.data=t,this.diagram.fe=i,n}}return null}RT(){const t=this.diagram.model;this.KT(t.linkDataArray),this.MN(t.nodeDataArray)}KT(t){t.forEach((t=>{this.R1(t)}))}getLinkCategoryForData(t){return this.diagram.model.getCategoryForLinkData(t)}setLinkCategoryForData(t,e){return this.diagram.model.setCategoryForLinkData(t,e)}setFromNodeForLink(t,e){const i=this.diagram.model,n=null!==e?e.data:null;i.setFromKeyForLinkData(t.data,i.getKeyForNodeData(n))}setToNodeForLink(t,e){const i=this.diagram.model,n=null!==e?e.data:null;i.setToKeyForLinkData(t.data,i.getKeyForNodeData(n))}mN(t){this.diagram.model.removeLinkData(t.data)}findPartForKey(t){const e=super.findPartForKey(t);if(null===e){const e=this.diagram.model.findLinkDataForKey(t);if(null!==e)return this.findLinkForData(e)}return e}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findLinkDataForKey(t);return null!==e?this.findLinkForData(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const i=this.diagram;if(t.model!==i.model)return;const n=t.change;if(i.X){i.X=!1;try{const s=t.modelChange;if(""!==s){if(2===n){if("linkFromKey"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,n=this.findNodeForKey(e);i.fromNode=n}}else if("linkToKey"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,n=this.findNodeForKey(e);i.toNode=n}}else if("linkFromPortId"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.fromPortId=e)}}else if("linkToPortId"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.toPortId=e)}}else if("nodeGroupKey"===s){const e=t.object,i=this.findPartForData(e);if(null!==i){const e=t.newValue;if(void 0!==e){const t=this.findNodeForKey(e);i.containingGroup=t instanceof Ne?t:null}else i.containingGroup=null}}else if("linkLabelKeys"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.oldValue,n=t.newValue;Array.isArray(e)&&e.forEach((t=>{if(n.indexOf(t)>=0)return;const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=null)})),Array.isArray(n)&&n.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=i)}))}}else if("linkCategory"===s){const e=t.object,i=this.findLinkForData(e),n=t.newValue;null!==i&&"string"==typeof n&&(i.category=n)}else if("linkDataArray"===s){const e=t.oldValue;this.KT(e);const i=t.newValue;this.XT(i)}i.isModified=!0}else if(3===n){const n=t.newValue;if("linkDataArray"===s&&e.K(n))this.YT(n);else if("linkLabelKeys"===s&&t.model.isKeyType(n)){const e=t.object,i=this.findLinkForData(e),s=this.findNodeForKey(n);null!==i&&null!==s&&(s.labeledLink=i)}i.isModified=!0}else if(4===n){const n=t.oldValue;if("linkDataArray"===s&&e.K(n))this.R1(n);else if("linkLabelKeys"===s&&t.model.isKeyType(n)){const t=this.findNodeForKey(n);null!==t&&(t.labeledLink=null)}i.isModified=!0}}else if(2===n){const e=t.propertyName,n=t.object;n===i.model&&("linkFromKeyProperty"===e||"linkToKeyProperty"===e||"linkFromPortIdProperty"===e||"linkToPortIdProperty"===e||"linkLabelKeysProperty"===e||"nodeIsGroupProperty"===e||"nodeGroupKeyProperty"===e||"linkCategoryProperty"===e)&&(i.undoManager.isUndoingRedoing||this.rebuildParts()),i.isModified=!0}}finally{i.X=!0}}}zT(){const t=this.diagram.model,e=new u,i=t.linkDataArray;i.forEach((t=>{e.add(t)}));const n=[];this.links.each((t=>{null!==t.data&&!e.has(t.data)&&n.push(t.data)})),n.forEach((e=>{t.GT(e,!1)})),i.forEach((e=>{null===this.findLinkForData(e)&&t.HT(e,!1)}))}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const n=i.model;if(t instanceof be){let s=n.Ae(e,!0),o=i.findNodeForKey(s);t.fromNode=o,s=n.Ae(e,!1),o=i.findNodeForKey(s),t.toNode=o;const r=n.getLabelKeysForLinkData(e);if(r.length>0||t.labelNodes.count>0){if(1===r.length&&1===t.labelNodes.count){const e=r[0],i=t.labelNodes.first();if(n.getKeyForNodeData(i.data)===e)return}const e=(new u).addAll(r),s=new u;t.labelNodes.each((t=>{if(null!==t.data){const e=n.getKeyForNodeData(t.data);void 0!==e&&s.add(e)}}));const o=s.copy();o.removeAll(e);const a=e.copy();if(a.removeAll(s),o.count>0||a.count>0){const e=t;o.each((t=>{const n=i.findNodeForKey(t);null!==n&&n.labeledLink===e&&(n.labeledLink=null)})),a.each((t=>{const n=i.findNodeForKey(t);null!==n&&n.labeledLink!==e&&(n.labeledLink=e)}))}}}else if(!(t instanceof fe)){const s=n.getGroupKeyForNodeData(e),o=i.findPartForKey(s);(null===o||o instanceof Ne)&&(t.containingGroup=o)}}F1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const n=e.My(i),s=this.findPartForData(t);if(null!==n&&null!==s){const t=n.iterator;for(;t.next();){const n=t.value;if(e.containsNodeData(n)){if(s instanceof Ne&&e.getGroupKeyForNodeData(n)===i){const t=this.findPartForData(n);null!==t&&(t.containingGroup=s)}}else{const t=this.findLinkForData(n);if(null!==t&&s instanceof pe){e.Ae(n,!0)===i&&(t.fromNode=s),e.Ae(n,!1)===i&&(t.toNode=s);const o=e.getLabelKeysForLinkData(n);Array.isArray(o)&&o.some((e=>e===i&&(s.labeledLink=t,!0)))}}}e.Ws(i)}const o=e.getGroupKeyForNodeData(t);if(void 0!==o){const t=this.findNodeForKey(o);t instanceof Ne&&(s.containingGroup=t)}}}NN(t){const e=this.diagram.model;if(t instanceof pe){const i=e.getKeyForNodeData(t.data);if(void 0!==i){const n=t.linksConnected;for(;n.next();){const t=n.value;e.Js(i,t.data)}if(t.isLinkLabel){const n=t.labeledLink;null!==n&&e.Js(i,n.data)}if(t instanceof Ne){const n=t.memberParts;for(;n.next();){const t=n.value.data;e.containsNodeData(t)&&e.Js(i,t)}}}}}AN(t,i){let n=super.AN(t,i);if(t instanceof be){const s=t.data;if(null!==s&&null!==i){const t=i.model,o=t.copyLinkData(s);e.K(o)&&(t.addLinkData(o),n=i.findLinkForData(o))}else if(null!==n){const t=this.diagram;if(null!==s&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const i=t.model.copyLinkData(s);e.K(i)&&(n.data=i)}}}return n}insertLink(t,i,n,s){const o=this.diagram,r=o.model,a=o.toolManager.findTool("Linking");let l="";null!==t&&(null===i&&(i=t),l=i.portId,null===l&&(l=""));let h="";null!==n&&(null===s&&(s=n),h=s.portId,null===h&&(h=""));const u=a.archetypeLinkData;if(u instanceof be){u.Et();const e=u.copy();if(null!==e){e.fromNode=t,e.fromPortId=l,e.toNode=n,e.toPortId=h,o.add(e);const i=a.archetypeLabelNodeData;if(i instanceof pe){i.Et();const t=i.copy();null!==t&&(t.labeledLink=e,o.add(t))}return e}}else if(null!==u){const i=r.copyLinkData(u);if(e.K(i)){null!==t&&r.Wd(i,r.getKeyForNodeData(t.data),!0),r.Jd(i,l,!0),null!==n&&r.Wd(i,r.getKeyForNodeData(n.data),!1),r.Jd(i,h,!1),r.addLinkData(i);const s=a.archetypeLabelNodeData;if(null!==s&&!(s instanceof pe)){const t=r.copyNodeData(s);if(e.K(t)){r.addNodeData(t);const e=r.getKeyForNodeData(t);void 0!==e&&r.addLabelKeyForLinkData(i,e)}}return o.findLinkForData(i)}}return null}}),vt.NM("TreeModel",class extends Ie{Mh=null;I1(t,e){if(null===t||null===e||null!==e.findTreeParentLink())return null;const i=this.diagram.toolManager.findTool("Linking");let n=t,s=e;if(this.diagram.isTreePathToChildren){if(null!==i&&i.yu(n,s,null,!0))return null}else if(n=e,s=t,null!==i&&i.yu(n,s,null,!0))return null;const o=this.getLinkCategoryForData(e.data),r=this.findLinkTemplateForCategory(o);if(null!==r){r.Et();const t=r.copy();if(null!==t){const i=this.diagram.fe;return this.diagram.fe=!0,t.Vo=o,t._t=e.data,t.fromNode=n,t.toNode=s,this.diagram.add(t),t._t=null,t.data=e.data,this.diagram.fe=i,t}}return null}getLinkCategoryForData(t){return this.diagram.model.getParentLinkCategoryForNodeData(t)}setLinkCategoryForData(t,e){this.diagram.model.setParentLinkCategoryForNodeData(t,e)}setFromNodeForLink(t,e,i){const n=this.diagram.model;void 0===i&&(i=null);const s=null!==e?e.data:null;if(this.diagram.isTreePathToChildren)n.setParentKeyForNodeData(t.data,n.getKeyForNodeData(s));else{const e=this.Mh;this.Mh=t,null!==i&&n.setParentKeyForNodeData(i.data,void 0);const o=null!==t.toNode?t.toNode.data:null;n.setParentKeyForNodeData(s,n.getKeyForNodeData(o)),this.Mh=e}}setToNodeForLink(t,e,i){const n=this.diagram.model;void 0===i&&(i=null);const s=null!==e?e.data:null;if(this.diagram.isTreePathToChildren){const e=this.Mh;this.Mh=t,null!==i&&n.setParentKeyForNodeData(i.data,void 0);const o=null!==t.fromNode?t.fromNode.data:null;n.setParentKeyForNodeData(s,n.getKeyForNodeData(o)),this.Mh=e}else n.setParentKeyForNodeData(t.data,n.getKeyForNodeData(s))}mN(t){this.diagram.model.setParentKeyForNodeData(t.data,void 0)}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.findLinkForData(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const e=this.diagram;if(t.model!==e.model)return;const i=t.change;if(e.X){e.X=!1;try{const n=t.modelChange;if(""!==n){if(2===i){if("nodeParentKey"===n){const i=t.object,n=t.newValue,s=this.findNodeForKey(n),o=this.findNodeForData(i);if(null!==this.Mh)null!==s&&(this.Mh.data=i,this.Mh.category=this.getLinkCategoryForData(i));else if(null!==o){const t=o.findTreeParentLink();null!==t?null===s?e.remove(t):e.isTreePathToChildren?t.fromNode=s:t.toNode=s:this.I1(s,o)}}else if("parentLinkCategory"===n){const e=t.object,i=this.findNodeForData(e),n=t.newValue;if(null!==i&&"string"==typeof n){const t=i.findTreeParentLink();null!==t&&(t.category=n)}}e.isModified=!0}}else if(2===i){const i=t.propertyName,n=t.object;n===e.model&&"nodeParentKeyProperty"===i&&(e.undoManager.isUndoingRedoing||this.rebuildParts()),e.isModified=!0}}finally{e.X=!0}}}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const n=i.model;if(t instanceof pe){const s=n.getParentKeyForNodeData(e),o=i.findNodeForKey(s);if(o!==t.findTreeParentNode()){const e=t.findTreeParentLink();null!==o?null!==e?i.isTreePathToChildren?e.fromNode=o:e.toNode=o:this.I1(o,t):null!==e&&i.EM(e,!1)}}}Sy(t,e){if(super.Sy(t,e),"string"==typeof e&&null!==this.findPartForData(t)){const i=this.findLinkForData(t);null!==i&&i.updateTargetBindings(e)}}F1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const n=e.My(i),s=this.findPartForData(t);if(null!==n&&null!==s){const t=n.iterator;for(;t.next();){const n=t.value;if(e.containsNodeData(n)&&s instanceof pe&&e.getParentKeyForNodeData(n)===i){const t=this.findNodeForData(n);this.I1(s,t)}}e.Ws(i)}const o=e.getParentKeyForNodeData(t);if(void 0!==o&&s instanceof pe){const t=this.findNodeForKey(o);this.I1(t,s)}}}NN(t){const e=this.diagram.model;if(t instanceof pe){const i=e.getKeyForNodeData(t.data),n=this.findLinkForData(t.data);if(null!==n){n.isSelected=!1,n.isHighlighted=!1;const t=n.layer;if(null!==t){const e=t.te(-1,n,!1);e>=0&&this.diagram.raiseChangedEvent(4,"parts",t,n,null,e,null);const i=n.layerChanged;null!==i&&i(n,t,null)}}const s=this.diagram.isTreePathToChildren,o=t.linksConnected;for(;o.next();){const t=o.value,n=(s?t.toNode:t.fromNode).data;e.containsNodeData(n)&&e.Js(i,n)}}}insertLink(t,e,i,n){const s=this.diagram.model;let o=t,r=i;if(this.diagram.isTreePathToChildren||(o=i,r=t),null!==o&&null!==r){const t=o.data,e=r.data;return s.setParentKeyForNodeData(e,s.getKeyForNodeData(t)),r.findTreeParentLink()}return null}});const Li=t.go,Ai={get version(){return vt.version},Group:Ne,List:l,Set:u,Map:m,Point:y,Size:x,Rect:v,Margin:b,Spot:w,Geometry:N,PathFigure:T,PathSegment:A,InputEvent:D,DiagramEvent:F,ChangedEvent:E,Model:Ue,GraphLinksModel:Xe,TreeModel:Ke,Binding:je,ThemeBinding:Ve,Transaction:R,UndoManager:B,CommandHandler:Ct,Tool:I,DraggingTool:U,DraggingInfo:wt,DraggingOptions:St,LinkingBaseTool:X,LinkingTool:G,RelinkingTool:Y,LinkReshapingTool:H,ResizingTool:_,RotatingTool:W,ClickSelectingTool:$,ActionTool:J,ClickCreatingTool:Z,HTMLInfo:et,ContextMenuTool:nt,DragSelectingTool:Q,PanningTool:tt,TextEditingTool:at,ToolManager:V,Animation:ut,AnimationManager:ht,AnimationTrigger:ft,Layer:gt,Diagram:vt,Palette:class extends vt{constructor(i,n){let s;return void 0===i||"string"==typeof i||t.Element&&i instanceof Element?s=i:e.K(i)&&(n=i),super(s),this.dA(),n&&this.setProperties(n),this}dA(){this.allowDragOut=!0,this.allowMove=!1,this.isReadOnly=!0,this.contentAlignment=w.TopCenter,this.layout=new Be}setupRouters(){}reset(){super.reset(),this.dA()}},Overview:Pt,Brush:Ut,GraphObject:At,Panel:Yt,RowColumnDefinition:$t,Shape:Jt,TextBlock:ie,Picture:re,Part:ce,Adornment:fe,Node:pe,Link:be,Placeholder:Te,Layout:Le,LayoutNetwork:Ae,LayoutVertex:De,LayoutEdge:Fe,GridLayout:Be,PanelLayout:Xt,CircularLayout:_e,CircularNetwork:$e,CircularVertex:Je,CircularEdge:Ze,ForceDirectedLayout:Qe,ForceDirectedNetwork:ti,ForceDirectedVertex:ei,ForceDirectedEdge:ii,LayeredDigraphLayout:ui,LayeredDigraphNetwork:ci,LayeredDigraphVertex:di,LayeredDigraphEdge:fi,TreeLayout:wi,TreeNetwork:ki,TreeVertex:Si,TreeEdge:Pi,Themes:Mi,ThemeManager:Ci,Router:Ni,AnimationStyle:lt,AutoScale:pt,CycleMode:mt,Flip:Lt,TextFormat:ee,ImageStretch:oe,LayoutConditions:ue,LinkAdjusting:ye,Curve:ve,Routing:xe,Orientation:Tt,TextOverflow:te,PortSpreading:ge,ScrollMode:yt,CollapsePolicy:xt,Sizing:Wt,TriggerStart:dt,Stretch:Nt,ViewboxStretch:Gt,Wrap:Qt,BrushType:zt,ColorSpace:jt,GeometryStretch:C,GeometryType:M,SegmentType:L,BindingMode:ze,ChangeType:O,CircularArrangement:Ge,CircularDirection:Ye,CircularNodeDiameterFormula:He,CircularSorting:qe,GridAlignment:Oe,GridArrangement:Ee,GridSorting:Re,LayeredDigraphAggressive:ai,LayeredDigraphAlign:hi,LayeredDigraphCycleRemove:si,LayeredDigraphInit:ri,LayeredDigraphLayering:oi,LayeredDigraphPack:li,TreeAlignment:mi,TreeArrangement:vi,TreeCompaction:yi,TreeLayerStyle:bi,TreePath:gi,TreeSorting:pi,TreeStyle:xi,GestureMode:j,LinkingDirection:K,ReshapingBehavior:q,TextEditingAccept:st,TextEditingStarting:ot,TextEditingState:rt,WheelMode:z};for(const Di in Ai){const t=Ai[Di];e.it(t)&&t!==ee&&(t.className=Di)}e.K(Li)&&Li.version&&e.ni("WARNING: a `go` object on the root object is already defined.  "+("Debug"in Li?"debug ":"")+"version: "+Li.version+", replaced with version: "+Ai.version),vt.prototype.go=Ai,t.go=Ai}();"undefined"!==typeof global?global.go:self.go;const p="undefined"!==typeof global?global.go:self.go,m=(p.Group,p.List,p.Set,p.Map,p.Point,p.Size,p.Rect,p.Margin),y=p.Spot,x=(p.Geometry,p.PathFigure,p.PathSegment,p.InputEvent,p.DiagramEvent,p.ChangedEvent,p.Model,p.GraphLinksModel),v=(p.TreeModel,p.Binding),b=(p.ThemeBinding,p.Transaction,p.UndoManager,p.CommandHandler,p.Tool,p.DraggingTool,p.DraggingInfo,p.DraggingOptions,p.LinkingBaseTool,p.LinkingTool,p.RelinkingTool,p.LinkReshapingTool,p.ResizingTool,p.RotatingTool,p.ClickSelectingTool,p.ActionTool,p.ClickCreatingTool,p.HTMLInfo,p.ContextMenuTool,p.DragSelectingTool,p.PanningTool,p.TextEditingTool,p.ToolManager,p.Animation,p.AnimationManager,p.AnimationTrigger,p.Layer,p.Diagram),w=(p.Palette,p.Overview,p.Brush,p.GraphObject),k=p.Panel,S=(p.RowColumnDefinition,p.Shape),P=p.TextBlock,M=(p.Picture,p.Part,p.Adornment,p.Node),C=(p.Link,p.Placeholder,p.Layout,p.LayoutNetwork,p.LayoutVertex,p.LayoutEdge,p.GridLayout,p.PanelLayout,p.CircularLayout,p.CircularNetwork,p.CircularVertex,p.CircularEdge,p.ForceDirectedLayout,p.ForceDirectedNetwork,p.ForceDirectedVertex,p.ForceDirectedEdge,p.LayeredDigraphLayout),N=(p.LayeredDigraphNetwork,p.LayeredDigraphVertex,p.LayeredDigraphEdge,p.TreeLayout,p.TreeNetwork,p.TreeVertex,p.TreeEdge,p.Themes,p.ThemeManager,p.Router,p.version,p.AnimationStyle,p.AutoScale,p.Curve,p.CycleMode,p.Flip,p.ImageStretch,p.LayoutConditions,p.LinkAdjusting,p.Orientation,p.PortSpreading,p.Routing,p.ScrollMode,p.CollapsePolicy,p.Sizing,p.TriggerStart,p.Stretch,p.TextFormat,p.TextOverflow,p.ViewboxStretch,p.Wrap,p.BrushType,p.ColorSpace,p.GeometryStretch,p.GeometryType,p.SegmentType,p.BindingMode,p.ChangeType,p.CircularArrangement,p.CircularDirection,p.CircularNodeDiameterFormula,p.CircularSorting,p.GridAlignment,p.GridArrangement,p.GridSorting,p.LayeredDigraphAggressive,p.LayeredDigraphAlign,p.LayeredDigraphCycleRemove,p.LayeredDigraphInit,p.LayeredDigraphLayering,p.LayeredDigraphPack,p.TreeAlignment,p.TreeArrangement,p.TreeCompaction,p.TreeLayerStyle,p.TreePath,p.TreeSorting,p.TreeStyle,p.GestureMode,p.LinkingDirection,p.ReshapingBehavior,p.TextEditingAccept,p.TextEditingStarting,p.TextEditingState,p.WheelMode,e=>{let{expression:i,type:n="SOP"}=e;const s=(0,t.useRef)(null);(0,t.useEffect)((()=>{if(!s.current)return;const t=b.fromDiv(s.current);t&&(t.div=null);const e=w.make,n=e(b,s.current,{autoScale:b.Uniform,contentAlignment:y.Center,"undoManager.isEnabled":!1,allowMove:!1,allowSelect:!1,allowZoom:!1,layout:e(C,{direction:0,layerSpacing:40,columnSpacing:20})});n.nodeTemplateMap.add("AND",e(M,"Auto",e(S,{geometryString:"F M0 0 L0 40 L20 40 Q40 20 20 0 Z",fill:"orange",stroke:null}),e(P,"AND",{margin:5,stroke:"white",font:"bold 12px sans-serif"}))),n.nodeTemplateMap.add("OR",e(M,"Auto",e(S,{geometryString:"F M0 0 Q30 20 0 40 Q10 20 0 0 Z",fill:"lightgreen",stroke:null}),e(P,"OR",{margin:5,stroke:"black",font:"bold 12px sans-serif"}))),n.nodeTemplateMap.add("NOT",e(M,"Spot",e(k,"Auto",e(S,{geometryString:"F M0 0 L60 30 L0 60 Z",fill:"red",stroke:null}),e(P,"NOT",{margin:new m(10,20,10,0),stroke:"white",font:"bold 14px sans-serif"})),e(S,"Circle",{alignment:y.Right,width:8,height:8,fill:"white",stroke:"black"}))),n.nodeTemplateMap.add("LITERAL",e(M,"Auto",e(S,"RoundedRectangle",{fill:"lightblue",stroke:null}),e(P,{margin:6,font:"bold 12px sans-serif"},new v("text","label")))),n.nodeTemplateMap.add("BULB",e(M,"Auto",e(S,"Circle",{fill:"yellow",stroke:"orange",strokeWidth:2}),e(P,"OUT",{margin:4,font:"bold 12px sans-serif"})));const o=r(i),{nodeDataArray:l,linkDataArray:h}=a(o);return console.log("Parsed Expression: ",o),n.model=new x(l,h),()=>n.clear()}),[i,n]);const r=t=>t.replace(/'([A-Z])/g,"$1'"),a=t=>{const e=[],i=[];if(!t||""===t.trim()||"0"===t.trim()||"1"===t.trim())return{nodeDataArray:e,linkDataArray:i};const s=t.split("SOP"===n?"+":"\xb7").map((t=>t.trim())),o="SOP"===n?"OR":"AND",r="SOP"===n?"AND":"OR";if(s.forEach(((t,n)=>{const s=`${r}${n}`;e.push({key:s,category:r});const o=t.match(/([A-Z]'+|[A-Z])/g);null===o||void 0===o||o.forEach(((t,n)=>{const o=t.endsWith("'"),r=t.replace("'",""),a=`LIT_${r}_${s}_${n}`,l=`NOT_${r}_${s}_${n}`;e.push({key:a,category:"LITERAL",label:r}),o?(e.push({key:l,category:"NOT"}),i.push({from:a,to:l}),i.push({from:l,to:s})):i.push({from:a,to:s})}))})),s.length>1){e.push({key:o,category:o});for(let t=0;t<s.length;t++)i.push({from:`${r}${t}`,to:o})}const a=s.length>1?o:`${r}0`;return e.push({key:"BULB",category:"BULB"}),i.push({from:a,to:"BULB"}),{nodeDataArray:e,linkDataArray:i}};return(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"20px"},children:(0,o.jsxs)("div",{style:{backgroundColor:"white",border:"1px solid #ccc",borderRadius:"10px",padding:"20px",boxShadow:"0 0 5px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,o.jsx)("h3",{style:{marginTop:0},children:"Kombina\u010dn\xed logick\xfd obvod"}),i&&""!==i.trim()&&"0"!==i.trim()&&"1"!==i.trim()?(0,o.jsx)("div",{ref:s,style:{backgroundColor:"white",padding:"30px",width:"fit-content",maxWidth:"100%",minWidth:"1000px",minHeight:"500px",display:"flex",flexDirection:"column",alignItems:"center",clipPath:"inset(0 0 0 175px)"}}):(0,o.jsx)("div",{style:{minHeight:"100px",display:"flex",alignItems:"center",justifyContent:"center",fontStyle:"italic",color:"#888"},children:"Nen\xed co zobrazit"})]})})});class T extends t.Component{constructor(t){super(t),this.setEquationType=t=>{this.setState({EquationType:t})};let e=this.getMatrixSquare(4),i=this.getMatrixPerm(4),n=this.setCoord(e,i,4);this.state={squares:n,typeMap:4,perm:i,typeSol:"SOP",logicExpression:"",inputMinterms:"",inputDontCares:"",allValidSolutions:[],currentSolutionIndex:0,EquationType:"Dis"}}getMatrixPerm(t){let e=t,i=Math.pow(2,t),n=[];for(let s=0;s<i;s++){let t=[];for(let i=0;i<e;i++)t[i]=0;n[s]=t}for(let s=0;s<e;s++){let e=Math.pow(2,t)/2;for(let t=0;t<i;t++){let i=t%(2*e)<e?0:1;n[t][s]=""+i}t--}return n}getMatrixSquare(t){let e=t,i=t;3===t&&(e=2,i=4);let n=[];for(let s=0;s<e;s++){let t=[];for(let e=0;e<i;e++){let i=[];for(let t=0;t<2;t++)i[t]=0;t[e]=i}n[s]=t}return n}setMatrixSquare(t){const e=this.state.squares,i=this.state.typeMap;let n=i,s=i;3===i&&(n=2,s=4);for(let o=0;o<n;o++)for(let i=0;i<s;i++)e[o][i][0]=t;this.reset(),this.setState({squares:e,inputMinterms:"",inputDontCares:""})}reset(){this.clearDrawings();const t=this.state.typeMap;let e=t,i=t;3===t&&(e=2,i=4),s()("#elabora").prop("disabled",!1);for(let n=0;n<e;n++)for(let t=0;t<i;t++){s()("#output_"+n+t).removeClass(),s()("#output_"+n+t).html("");for(let e=0;e<10;e++)s()("#"+n+t+e).remove()}s()("#sol").html(""),s()("#cost").html(""),s()(".Solution").hide(),s()(".kMapOutput").hide(),s()(".truthTable").hide(),s()(".nameTab").hide(),s()(".solutionSwitcher").hide(),s()(".Solution").css("left","720px")}setCoord(t,e,i){let n=i,s=i;3===i&&(s=4,n=2);for(let o=0;o<s;o++){let s;s=2===o?3:3===o?2:o;for(let r=0;r<n;r++){let a;a=r%n===2?3:r%n===3?2:r;let l="",h=i,u=0;do{l+=e[o*n+r][u],u++}while(u<h/2);t[a][s][1]=l,l="",u=Math.floor(h/2),3===i&&(h=2,u=Math.floor(h/2+1));do{l+=e[o*n+r][u],u++}while(u<h);t[a][s][2]=l}}return t}setTypeMap(t){let e=this.getMatrixSquare(t),i=this.getMatrixPerm(t),n=this.setCoord(e,i,t);this.reset(),this.setState({typeMap:t,squares:n,perm:i,inputMinterms:"",inputDontCares:""})}setTypeSol(t){this.clearDrawings(),this.reset();const{inputMinterms:e,inputDontCares:i}=this.state;this.setState({typeSol:t,inputMinterms:e,inputDontCares:i,allValidSolutions:[],currentSolutionIndex:0},(()=>{this.Algorithm(this.state.squares)}))}handleClick(t,e){const i=this.state.squares;1===i[t][e][0]?i[t][e][0]=0:0===i[t][e][0]?i[t][e][0]="X":"X"===i[t][e][0]&&(i[t][e][0]=1),this.clearDrawings(),this.reset(),this.setState({squares:i,allValidSolutions:[],currentSolutionIndex:0,logicExpression:""},(()=>{this.updateInputsAndFunctionFromMap()}))}updateInputsAndFunctionFromMap(){const t=this.state.squares,e=[],i=[];for(let n=0;n<t.length;n++)for(let s=0;s<t[0].length;s++){let o;if(4===this.state.typeMap)o=D[n][s];else{const e=t[n][s][1]+t[n][s][2];o=parseInt(e,2)}("SOP"===this.state.typeSol||"POS"===this.state.typeSol)&&(1===t[n][s][0]?e.push(o):"X"===t[n][s][0]&&i.push(o))}this.setState({inputMinterms:e.sort(((t,e)=>t-e)).join(","),inputDontCares:i.sort(((t,e)=>t-e)).join(",")})}getFunctionLabel(){return`f(${["a","b","c","d"].slice(0,this.state.typeMap).join(",")}) =`}applyExpressionInputs(){const t=Math.pow(2,this.state.typeMap)-1,e=(this.state.typeSol,/^[0-9\s,]*$/);if(this.state.inputMinterms&&!e.test(this.state.inputMinterms)||this.state.inputDontCares&&!e.test(this.state.inputDontCares))return void alert("Chyba: Vstupy mus\xed obsahovat pouze \u010d\xedsla odd\u011blen\xe1 \u010d\xe1rkami.");const i=this.state.inputMinterms.split(",").map((t=>parseInt(t.trim()))).filter((t=>!isNaN(t))),n=this.state.inputDontCares.split(",").map((t=>parseInt(t.trim()))).filter((t=>!isNaN(t)));if(i.some((e=>e<0||e>t)))return void alert(`Chyba: \u010c\xedsla mus\xed b\xfdt v rozsahu 0 a\u017e ${t}.`);if(n.some((e=>e<0||e>t)))return void alert(`Chyba: \u010c\xedsla mus\xed b\xfdt v rozsahu 0 a\u017e ${t}.`);if(i.filter((t=>n.includes(t))).length>0)return void alert("Chyba: N\u011bkter\xe1 \u010d\xedsla jsou stejn\xe1 v mintermech a don't care.");const s=this.getMatrixSquare(this.state.typeMap),o=this.getMatrixPerm(this.state.typeMap),r=this.setCoord(s,o,this.state.typeMap),a="SOP"===this.state.typeSol?0:1;for(let l=0;l<r.length;l++)for(let t=0;t<r[0].length;t++)r[l][t][0]=a;for(let l=0;l<r.length;l++)for(let t=0;t<r[0].length;t++){let e;if(4===this.state.typeMap)e=D[l][t];else{const i=r[l][t][1]+r[l][t][2];e=parseInt(i,2)}"SOP"===this.state.typeSol?i.includes(e)?r[l][t][0]=1:n.includes(e)&&(r[l][t][0]="X"):"POS"===this.state.typeSol&&(i.includes(e)?r[l][t][0]=0:n.includes(e)&&(r[l][t][0]="X"))}this.reset(),this.setState({squares:r})}clearDrawings(){const t=this.state.typeMap;let e=t,i=t;3===t&&(e=2,i=4);for(let n=0;n<e;n++)for(let t=0;t<i;t++){const e=`#output_${n}${t}`;s()(e).removeClass(),s()(e).css("border-color",""),s()(e).html("");for(let t=0;t<10;t++)s()(`${e}${t}`).remove()}}Algorithm(t){var e,i;s()("#elabora").prop("disabled",!0);let n="SOP"===this.state.typeSol?1:0;4===this.state.typeMap?(e=4,i=4):3===this.state.typeMap?(e=4,i=2):(e=2,i=2);var o=new Array(i);for(let s=0;s<i;s++){o[s]=new Array(e);for(let t=0;t<e;t++)o[s][t]=[]}var r=0;for(let s=0;s<i;s++)for(let g=0;g<e;g++){var a=0;if(t[s][g][0]===n||"X"===t[s][g][0]&&this.hasOneNeighbour(t,s,g,n)){var l,h=s,u=g;if(g===e-1){let a=!0,l=0;for(let h=s;h<i&&a;h++)t[h][e-1][0]!==n&&"X"!==t[h][e-1][0]||t[h][0][0]!==n&&"X"!==t[h][0][0]?a=!1:(o[h][0].push(r),o[h][e-1].push(r),l++);l>0&&(r++,L(2,l)||(o[s+l-1][0].pop(),o[s+l-1][e-1].pop()))}if(s===i-1){let s=!0,a=0;for(let l=g;l<e&&s;l++)t[i-1][l][0]!==n&&"X"!==t[i-1][l][0]||t[0][l][0]!==n&&"X"!==t[0][l][0]?s=!1:(o[i-1][l].push(r),o[0][l].push(r),a++);a>0&&(r++,L(2,a)||(o[i-1][g+a-1].pop(),o[0][g+a-1].pop()))}do{o[h][u].push(r),a++,u++}while(u<e&&(t[h][u][0]===n||"X"===t[h][u][0]));L(2,a)||(o[h][u-1].pop(),a--);var c=100,d=!0;for(let e=0;e<a;e++){for(h=s+1,u=g+e,l=1;h<i&&l<c;){if(t[h][u][0]!==n&&"X"!==t[h][u][0]){if(0!==e&&l!==c){var f=h;if(!L(2,e)){for(L(2,l)||f--,o[h][u].push(r),h>=c?c=h:c--;f<=c;f++)for(let t=u-1;t<=e;t++)o[f][t].pop();d=!1}}break}o[h][u].push(r),h++,l++}l<c&&(c=l),!L(2,l)&&d&&(o[h-1][u].pop(),c--)}r++}}t[0][e-2][0]!==n&&"X"!==t[0][e-2][0]||t[0][e-1][0]!==n&&"X"!==t[0][e-1][0]||t[i-1][e-2][0]!==n&&"X"!==t[i-1][e-2][0]||t[i-1][e-1][0]!==n&&"X"!==t[i-1][e-1][0]||(o[0][e-2].push(r),o[0][e-1].push(r),o[i-1][e-2].push(r),o[i-1][e-1].push(r),r++),console.log("Algorithm:"),console.log(o),this.setState({showSolutionButtons:!0}),this.GroupUp(t,s().extend(!0,[],o))}hasOneNeighbour(t,e,i,n){const s=t.length,o=t[0].length,r=[[0,1],[1,0],[0,-1],[-1,0]];for(let[a,l]of r){const r=(i+l+o)%o,h=t[(e+a+s)%s][r][0];if(h===n||"X"===h)return!0}return!1}GroupUp(t,e){var i,n,o,r,a=[],l=[],h=[];let u="SOP"===this.state.typeSol?1:0;4===this.state.typeMap?(o=4,r=4):3===this.state.typeMap?(o=4,r=2):(o=2,r=2),t[0][0][0]!==u&&"X"!==t[0][0][0]||t[0][o-1][0]!==u&&"X"!==t[0][o-1][0]||t[r-1][0][0]!==u&&"X"!==t[r-1][0][0]||t[r-1][o-1][0]!==u&&"X"!==t[r-1][o-1][0]||(i={row:0,col:0},l.push(i),i={row:0,col:o-1},l.push(i),i={row:r-1,col:0},l.push(i),i={row:r-1,col:o-1},l.push(i),a.push(l),l.some((e=>t[e.row][e.col][0]===u))&&a.push(l),l=[]);for(let s=0;s<r;s++)for(let p=0;p<o;p++)if(t[s][p][0]===u||"X"===t[s][p][0]&&this.hasOneNeighbour(t,s,p,u)){var c=e[s][p][0],d=s,f=p;if(p===o-1){for(;d<r&&e[d][p][0]===c&&e[d][0][0]===c;)i={row:d,col:0},n={row:d,col:p},e[d][p].shift(),e[d][0].shift(),l.push(i),l.push(n),d++;l.length>0&&(l.some((e=>t[e.row][e.col][0]===u))&&a.push(l),l=[],c=e[s][p][0]),d=s,f=p}if(s===r-1){for(;f<o&&e[s][f][0]===c&&e[0][f][0]===c;)i={row:s,col:f},n={row:0,col:f},e[0][f].shift(),e[s][f].shift(),l.push(i),l.push(n),f++;l.length>0&&(l.sort((function(t,e){return t.row-e.row})),l.some((e=>t[e.row][e.col][0]===u))&&a.push(l),l=[],c=e[s][p][0]),d=s,f=p}for(;f<o&&e[d][f][0]===c;)f++;for(;d<r&&e[d][f-1][0]===c;)d++;for(let t=s;t<d;t++)for(let e=p;e<f;e++)i={row:t,col:e},l.push(i);for(l.some((e=>t[e.row][e.col][0]===u))&&a.push(l),d=s,f=p;d<r&&e[d][f][0]===c;)d++;for(;f<o&&e[d-1][f][0]===c;)f++;for(let t=s;t<d;t++)for(let e=p;e<f;e++)i={row:t,col:e},h.push(i);var g=!0;if(l.length===h.length)for(let t=0;t<l.length&&g;t++)l[t].row!==h[t].row&&l[t].col!==h[t].col&&(g=!1);else h.some((e=>t[e.row][e.col][0]===u))&&a.push(h);g||h.some((e=>t[e.row][e.col][0]===u))&&a.push(h),l=[],h=[];for(let t=0;t<r;t++)for(let i=0;i<o;i++)e[t][i][0]===c&&e[t][i].shift()}console.log("GroupUp:"),console.log(a),this.CleanAlgorithm(s().extend(!0,[],a))}CleanAlgorithm(t){4===this.state.typeMap&&(t=function(t){return t.filter(((e,i)=>1===e.length||!t.some(((t,n)=>i!==n&&e.every((e=>t.some((t=>t.row===e.row&&t.col===e.col))))))))}(t=function(t,e,i){const n="SOP"===i?1:0,s=new Set;for(const o of t)if(o.length>1)for(const t of o)s.add(t.row+","+t.col);return t.filter((t=>{if(!t||0===t.length)return!1;if(t.length>1)return!0;const i=t[0],o=i.row+","+i.col,r=e[i.row][i.col][0];return!s.has(o)&&r===n}))}(t,this.state.squares,this.state.typeSol))),t.sort(((t,e)=>e.length-t.length));const e=s().extend(!0,[],t),i=[];for(let s=0;s<this.state.squares.length;s++)for(let t=0;t<this.state.squares[0].length;t++)"SOP"===this.state.typeSol?1===this.state.squares[s][t][0]&&i.push(s+","+t):"POS"===this.state.typeSol&&0===this.state.squares[s][t][0]&&i.push(s+","+t);const n=e.length,o=[];let r=null;for(let s=1;s<=n;s++){const t=A(e,s);for(const e of t){const t=new Set;for(const i of e)for(const e of i)t.add(e.row+","+e.col);i.every((e=>t.has(e)))&&(null===r&&(r=s),s===r&&o.push(e))}if(null!==r)break}console.log("\u2705 V\u0161echna minim\xe1ln\xed \u0159e\u0161en\xed:",o),o.length>0&&this.setState({allValidSolutions:o,currentSolutionIndex:0},(()=>{this.Solution(this.state.allValidSolutions[0],this.state.allValidSolutions[0]),this.drawGroup(this.state.allValidSolutions[0],this.state.allValidSolutions[0])}))}Solution(t,e){const i=this.state.squares;var n,s,o,r,a,l,h,u,c=["A","B","C","D"],d="",f=[],g=this.state.typeSol;for(let p=0;p<t.length;p++)if(t[p].length>0){for(n=0,r=e[p][0].row,a=e[p][0].col,u=0;u<e[p].length&&e[p][u].row===r;)u++;for(o=0,h=i[r][a][1];o<h.length;){for(s=1,l=!0;s<e[p].length&&e[p][s].row===r;){if(h.charAt(o)!==i[r][e[p][s].col][1].charAt(o)){l=!1;break}s++}l&&("SOP"===g?"0"===h.charAt(o)?d+="'"+c[n]:d+=c[n]:("0"===h.charAt(o)?d+=c[n]:d+="'"+c[n],d+="+")),n++,o++}for(o=0,h=i[r][a][2];o<h.length;){for(s=u,l=!0;s<e[p].length&&e[p][s].col===a;){if(h.charAt(o)!==i[e[p][s].row][a][2].charAt(o)){l=!1;break}s+=u}l&&("SOP"===g?"0"===h.charAt(o)?d+="'"+c[n]:d+=c[n]:("0"===h.charAt(o)?d+=c[n]:d+="'"+c[n],d+="+")),n++,o++}"POS"===g&&(d=d.substr(0,d.length-1)),f.push(d),d=""}""!==f[0]&&f[0]||(0===i[0][0][0]?f[0]="0":f[0]="1"),console.log("Expression sent to LogicCircuitGo:",f.join(" + ")),this.setState({logicExpression:f.join(" + ")}),this.drawSolution(f)}prevSolution(){const{currentSolutionIndex:t,allValidSolutions:e}=this.state;if(t>0){const e=t-1;this.setState({currentSolutionIndex:e},(()=>{this.clearDrawings();const t=this.state.allValidSolutions[e];this.Solution(t,t),this.drawGroup(t,t)}))}}nextSolution(){const{currentSolutionIndex:t,allValidSolutions:e}=this.state;if(t<e.length-1){const e=t+1;this.setState({currentSolutionIndex:e},(()=>{this.clearDrawings();const t=this.state.allValidSolutions[e];this.Solution(t,t),this.drawGroup(t,t)}))}}drawGroup(t,e){let i=["red","blue","green","orange","#50C878","lightblue","#CD7F32","#ff6699"],n=-1;for(let o=0;o<t.length;o++)if(t[o].length>0&&e[o].length!==Math.pow(2,this.state.typeMap)){n++;let t=0,r=e[o][0].col,a=e[o][0].row;for(;t<e[o].length;){let l="output_",h=s()("#"+l+e[o][t].row+e[o][t].col);h.attr("class")&&s()("#"+h.attr("id")+n)&&(h.after("<div id="+h.attr("id")+n+"></div>"),h=s()("#"+l+e[o][t].row+e[o][t].col+n)),h.css("border-color",i[n]),h.append("<div class='backgr' style='background-color: "+i[n]+"'></div>");let u=this.checkElInGroups(t,e[o],"right"),c=this.checkElInGroups(t,e[o],"below"),d=this.checkElInGroups(t,e[o],"left"),f=this.checkElInGroups(t,e[o],"above");u?c?d?e[o][t].col===r?h.addClass("TopLeft"):t===e[o].length/2-1||t===e[o].length-1?h.addClass("TopRig"):h.addClass("top"):f?t===e[o].length-2||t===e[o].length-1?h.addClass("BotLeft"):e[o][t].row===a?h.addClass("TopLeft"):h.addClass("left"):h.addClass("TopLeft"):f?d?e[o][t].col===r?h.addClass("BotLeft"):t===e[o].length-1||t===e[o].length/2-1?h.addClass("BotRig"):h.addClass("bot"):h.addClass("BotLeft"):d?0===t?h.addClass("ClosedLeft"):t===e[o].length-1?h.addClass("ClosedRig"):h.addClass("top-bot"):h.addClass("ClosedLeft"):f?d?c?e[o][t].row===a?h.addClass("TopRig"):t===e[o].length-1||t===e[o].length-2?h.addClass("BotRig"):h.addClass("right"):h.addClass("BotRig"):c?0===t?h.addClass("ClosedTop"):t===e[o].length-1?h.addClass("ClosedBot"):h.addClass("left-right"):h.addClass("ClosedBot"):d?c?h.addClass("TopRig"):h.addClass("ClosedRig"):c?h.addClass("ClosedTop"):h.addClass("monoGroup"),t++}}}checkElInGroups(t,e,i){const n=this.state.squares;let s=n[0].length,o=n[0].length;3===this.state.typeMap&&(s=2,o=4);for(let r=0;r<e.length;r++){if("right"===i&&e[r].col===(e[t].col+1)%o&&e[r].row===e[t].row%s)return!0;if("below"===i&&e[r].col===e[t].col%o&&e[r].row===(e[t].row+1)%s)return!0;if("left"===i){let i=e[t].col-1;if(i<0&&(i=o-1),e[r].col===i%o&&e[r].row===e[t].row%s)return!0}if("above"===i){let i=e[t].row-1;if(i<0&&(i=s-1),e[r].col===e[t].col%o&&e[r].row===i%s)return!0}}return!1}drawSolution(t){s()(".Solution").show(),s()(".kMapOutput").show(),s()(".truthTable").show(),s()(".nameTab").show(),s()("#sol").html("");if("0"===t[0]||"1"===t[0])s()("#sol").append("<div>"+t[0]+"</div>");else{const e=this.state.typeSol;let i="SOP"===e?"+":"\xb7",n="SOP"===e?"groupSop":"groupPos",o=["red","blue","green","orange","#50C878","lightblue","#CD7F32","#ff6699"];for(let r=0;r<t.length;r++){s()("#sol").append("<div id='sol"+r+"' class='"+n+"' style='background-color: "+o[r]+"'></div>");for(let e=0;e<t[r].length;e++)"'"!==t[r][e]?s()("#sol"+r).append(t[r][e]+" "):s()("#sol"+r).append("<span style='text-decoration: overline'>"+t[r][++e]+"</span> "),"+"!==t[r][e]&&0;r!==t.length-1&&s()("#sol").append("<div class='plus'> "+i+" </div>")}}s()(".Solution").css("left",parseInt(s()(".Solution").css("left"))-parseInt(s()(".Solution").css("width"))/2)}render(){const t=this.state.squares,e=this.state.typeMap,i=this.state.perm,n=this.state.typeSol;let s=0;return(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"title",children:(0,o.jsx)("h1",{children:" Minimalizace Karnaughovy mapy "})}),(0,o.jsxs)("div",{className:"mapContainer",children:[(0,o.jsxs)("div",{className:"expressionInput",children:[(0,o.jsx)("div",{className:"functionLabel",children:this.getFunctionLabel()}),(0,o.jsx)("label",{htmlFor:"mintermsInput",children:"Dis"===this.state.EquationType?"\u03a3m (mintermy):":"\u03a0M (maxtermy):"}),(0,o.jsx)("input",{className:"inputField",type:"text",value:this.state.inputMinterms,onChange:t=>{this.setState({inputMinterms:t.target.value},(()=>{this.applyExpressionInputs()}))}}),(0,o.jsx)("label",{htmlFor:"dontCaresInput",children:"Dis"===this.state.EquationType?"+\u03a3d (don't care):":"+\u03a0d (don't care):"}),(0,o.jsx)("input",{className:"inputField",type:"text",value:this.state.inputDontCares,onChange:t=>{this.setState({inputDontCares:t.target.value},(()=>{this.applyExpressionInputs()}))}})]}),(0,o.jsxs)("div",{className:"mapAndOptions",children:[(0,o.jsx)("div",{className:"kMap",children:(0,o.jsx)(h,{squares:t,typeMap:e,onClick:(t,e)=>this.handleClick(t,e),readOnly:!1,idPrefix:"input_"})}),(0,o.jsx)(g,{squares:t,typeMap:e,typeSol:n,onClick:()=>this.Algorithm(t),setTypeSol:t=>this.setTypeSol(t),setMatrixSquare:t=>this.setMatrixSquare(t),setTypeMap:t=>this.setTypeMap(t),setEquationType:this.setEquationType})]})]}),(0,o.jsx)("div",{className:"kMapOutput",children:(0,o.jsx)(h,{squares:t,typeMap:e,onClick:(t,e)=>this.handleClick(t,e),readOnly:!0,idPrefix:"output_"})}),this.state.allValidSolutions.length>1&&(0,o.jsxs)("div",{className:"solutionSwitcher",children:[(0,o.jsx)("button",{className:"btn btn-type",onClick:()=>this.prevSolution(),disabled:0===this.state.currentSolutionIndex,children:"P\u0159edchoz\xed \u0159e\u0161en\xed"}),(0,o.jsx)("button",{className:"btn btn-type",onClick:()=>this.nextSolution(),disabled:this.state.currentSolutionIndex===this.state.allValidSolutions.length-1,children:"Dal\u0161\xed \u0159e\u0161en\xed"}),(0,o.jsxs)("div",{className:"solutionInfo",children:[this.state.currentSolutionIndex+1," / ",this.state.allValidSolutions.length]})]}),(0,o.jsxs)("div",{className:"Solution",children:[(0,o.jsxs)("div",{children:[n," tvar:"]}),(0,o.jsx)("div",{className:"sol",id:"sol"}),(0,o.jsx)(N,{expression:this.state.logicExpression,type:this.state.typeSol})]}),(0,o.jsxs)("div",{className:"bodyPage",children:[(0,o.jsx)("p",{className:"nameTab",children:" Pravdivostn\xed tabulka "}),(0,o.jsx)("div",{className:"truthTable",children:(0,o.jsx)(u,{squares:t,typeMap:e,perm:i})},s++)]},s++)]},s++)}}function L(t,e){if(1===t)return 1===e;for(var i=1;i<e;)i*=t;return i===e}function A(t,e){const i=[];return function n(s,o){if(o.length!==e)for(let e=s;e<t.length;e++)n(e+1,o.concat([t[e]]));else i.push(o)}(0,[]),i}const D=[[0,2,6,4],[1,3,7,5],[9,11,15,13],[8,10,14,12]];e.render((0,o.jsx)(T,{},0),document.getElementById("root"))})()})();
//# sourceMappingURL=main.be341b11.js.map